# -*-coding: utf-8 -*-
from aiogram.contrib.fsm_storage.memory import MemoryStorage
from aiogram.types import ChatMemberAdministrator, ChatMemberOwner, ChatPermissions, Message
from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton

from middlewares.Throttling import ThrottlingMiddleware
from misc import rate_limit
import logging

import random
import time
from aiogram import Bot, Dispatcher, executor, types
from filters.admins import IsBot,IsBot2
from filters.register import IsRegister2,IsRegister3
from decimal import Decimal
import config as cfg
#from pyqiwip2p import QiwiP2P
from datetime import datetime, timedelta
from aiogram.utils.markdown import quote_html
import sqlite3
from aiogram.dispatcher import FSMContext
from captcha.image import ImageCaptcha
from keyboard.menu import help_menu,help_back,help_topback,list_clans_get,list_clans_get2
from keyboard.main import (gamevbmenu,help_perexod,help_donat,help_top,help_invite,help_bonus,help_bonus2
                           ,unmute_kb,unban_kb)
from keyboard.jobs import help_mine,help_mine2,help_ferma,help_biz,back_menuadmin,help_city,back_city,oer_sell,oer_cycl,earning_sell,ear_work
#from keyboard.qiwi import apanel,gamestavka,buy_menu,help_donat2,back,srez2,men,razda,uchas
from keyboard.marry import button_marry,button_divorce
from states.main import Rass,solve,dialog,Srez,razzdacha
import secrets
import string
import asyncio
from handlers.functions import status_users
from apscheduler.schedulers.asyncio import AsyncIOScheduler
#import numpy as np

logging.basicConfig(level=logging.INFO)

storage = MemoryStorage()
# bot init
bot = Bot(token=cfg.BOT_TOKEN)
dp = Dispatcher(bot, storage=storage)

scheduler =AsyncIOScheduler(timezone="Asia/Almaty")
# datebase
#p2p = QiwiP2P(auth_key=cfg.QIWI_TOKEN)



connect = sqlite3.connect("himera.db")
cursor = connect.cursor()

cursor.execute("""CREATE TABLE IF NOT EXISTS users(
    user_id BIGINT NOT NULL,
    level INT NOT NULL,
    balance NUMERIC,
    bank NUMERIC NOT NULL,
    fantom NUMERIC NOT NULL,
    ecoins NUMERIC NOT NULL,
    energy INT NOT NULL,
    expe NUMERIC NOT NULL,
    games INT NOT NULL,
    user_name text NOT NULL,
    user_status text NOT NULL,
    rating NUMERIC NOT NULL,
    work INT NOT NULL,
    pet1 INT NOT NULL,
    pet2 INT NOT NULL,
    pet3 INT NOT NULL,
    pet4 INT NOT NULL,
    pet5 INT NOT NULL,
    pet6 INT NOT NULL,
    pet7 INT NOT NULL,
    pet8 INT NOT NULL,
    pet9 INT NOT NULL,
    pet10 INT NOT NULL,
    pet_name text NOT NULL,
    pet_hp INT NOT NULL,
    pet_eat INT NOT NULL,
    pet_mood INT NOT NULL,
    checking INT NOT NULL,
    checking1 INT NOT NULL,
    checking2 INT NOT NULL,
    checking3 INT NOT NULL,
    status_block text NOT NULL,
    cards INT NOT NULL,
    ferma NUMERIC NOT NULL ,
    ferma_money NUMERIC NOT NULL ,
    Farm INT NOT NULL ,
    case1 NUMERIC,
    case2 NUMERIC,
    case3 NUMERIC,
    case4 NUMERIC,
    limitpered NUMERIC,
    bonus INT,
    cardslimit NUMERIC,
    limitbank NUMERIC,
    bonusvip INT,
    bonusprem INT,
    limitvidach NUMERIC,
    limitvidach2 NUMERIC,
    bal INT,
    referrer_id NUMERIC,
    countref NUMERIC,
    game NUMERIC,
    warn INT,
    marry NUMERIC,
    marry_time NUMERIC,
    marry_date timestamp,
    stavka INT,
    num_lose INT,
    num_win INT,
    ticket NUMERIC,
    time_register timestamp without time zone,
    deposit_donate int,
    procent_donate int,
    case5 NUMERIC,
    Admin_time NUMERIC
)
""")
cursor.execute("""CREATE TABLE IF NOT EXISTS ferma(
    user_id NUMERIC NOT NULL ,
    user_name text NOT NULL ,
    cards INT NOT NULL,
    cards2 INT NOT NULL,
    ferma_money NUMERIC NOT NULL ,
    Farm INT NOT NULL,
    Farm2 INT NOT NULL
)
""")

cursor.execute("""CREATE TABLE IF NOT EXISTS mine(
    user_id NUMERIC NOT NULL,
    user_name text NOT NULL,
    iron NUMERIC NOT NULL,
    gold NUMERIC NOT NULL,
    diamonds NUMERIC NOT NULL,
    amethysts NUMERIC NOT NULL,
    aquamarine NUMERIC NOT NULL,
    emeralds NUMERIC NOT NULL,
    pick NUMERIC NOT NULL,
    hp REAL NOT NULL
)
""")
cursor.execute("""CREATE TABLE IF NOT EXISTS workshop(
    user_id NUMERIC NOT NULL,
    user_name text NOT NULL,
    work_shop INT NOT NULL,
    workshop_c INT NOT NULL
)
""")

cursor.execute("""CREATE TABLE IF NOT EXISTS property(
    user_id NUMERIC NOT NULL,
    user_name text NOT NULL,
    have text NOT NULL,
    yacht INT NOT NULL,
    cars INT NOT NULL,
    plane INT NOT NULL,
    helicopter INT NOT NULL,
    house INT NOT NULL,
    phone INT NOT NULL

)
""")
cursor.execute("""CREATE TABLE IF NOT EXISTS business(
    user_id NUMERIC NOT NULL ,
    user_name text NOT NULL ,
    business INT NOT NULL ,
    balance NUMERIC NOT NULL ,
    workers NUMERIC,
    have text NOT NULL
)
""")

cursor.execute("""CREATE TABLE IF NOT EXISTS chats(    
    chat_name text NOT NULL,
    chat_id NUMERIC NOT NULL,
    chat_balance NUMERIC NOT NULL
)
""")

cursor.execute("""CREATE TABLE IF NOT EXISTS puzzles(    
    puzz_name text NOT NULL,
    activate INT NOT NULL,
    balance NUMERIC NOT NULL
)
""")
cursor.execute("""CREATE TABLE IF NOT EXISTS puzzles_old(    
    puzz_name text NOT NULL
)
""")
cursor.execute("""CREATE TABLE IF NOT EXISTS ban_list(
    user_id NUMERIC NOT NULL,
    user_name text NOT NULL,
    Cause text NOT NULL,
    time NUMERIC
)
""")
cursor.execute("""CREATE TABLE IF NOT EXISTS fzve(
    user_id NUMERIC ,
    money NUMERIC ,
    bill_id text NOT NULL
)
""")
cursor.execute("""CREATE TABLE IF NOT EXISTS kurs(
    valut NUMERIC ,
    valut2 NUMERIC ,
    valut3 NUMERIC,
    valut4 NUMERIC
)
""")
cursor.execute("""CREATE TABLE IF NOT EXISTS wdzy(
    summ NUMERIC,
    wdz text,
    chat_id NUMERIC,
    count NUMERIC
)
""")
cursor.execute("""CREATE TABLE IF NOT EXISTS cars(
    user_id NUMERIC,
    user_name text,
    hp INT,
    benz INT
)
""")
cursor.execute("""CREATE TABLE IF NOT EXISTS promo(
    user_id NUMERIC,
    user_name text,
    activ NUMERIC,
    summ NUMERIC,
    name text,
    comment text
)
""")
cursor.execute("""CREATE TABLE IF NOT EXISTS promold(
    user_id NUMERIC,
    user_name text,
    name text
)
""")
cursor.execute("""CREATE TABLE IF NOT EXISTS clan(
    user_id NUMERIC,
    user_name text,
    status text,
    clan_id NUMERIC,
    clan_name text)
""")
cursor.execute("""CREATE TABLE IF NOT EXISTS clans(
    members NUMERIC,
    clan_id NUMERIC,
    clan_name text,
    kazna NUMERIC,
    type_clan INT,
    new_clan_id NUMERIC,
    power NUMERIC,
    win NUMERIC,
    lose NUMERIC,
    last_stavka NUMERIC NOT NULL
)
""")
cursor.execute("""CREATE TABLE IF NOT EXISTS razdachi(
    user_id NUMERIC,
    balik NUMERIC
)
""")
cursor.execute("""CREATE TABLE IF NOT EXISTS clans_id(
    new_clan_id NUMERIC,
    type_raz INT,
    type_valut INT,
    summ NUMERIC,
    count NUMERIC,
    event_febiz INT
    
)
""")
cursor.execute("""CREATE TABLE IF NOT EXISTS city(
    citizens NUMERIC,
    user_id NUMERIC,
    user_name text,
    kazna NUMERIC,
    city_name text,
    happynes NUMERIC,
    electricity NUMERIC,
    water NUMERIC,
    factory NUMERIC,
    road NUMERIC NOT NULL,
    houses NUMERIC,
    work_place NUMERIC,
    taxes NUMERIC,
    material NUMERIC,
    ore_processing_plant NUMERIC,
    earning NUMERIC
)
""")

marry_me = []
marry_rep = []
divorce_me = []
divorce_rep = []
first_p=[]
second_p=[]
summ_stavka=[]


CHAT_BY_DATETIME = dict()#бонус задержка
CHAT_BY_DATETIME1 = dict()#бонус задержка
CHAT_BY_DATETIME2 = dict()#бонус задержка
CHAT_BY_DATETIME3 = dict()#бонус задержка
game_time=dict()
work_time= dict() #задержка работы

def calc(token):
    while (True):
        try:
            if token == "":
                return None
            return eval(token)
        except:
            return None
def add_check(user_id, money, bill_id):
    cursor.execute("INSERT INTO fzve VALUES(?, ? ,?)",
                   (user_id, money, bill_id,))
    connect.commit()


def get_check(bill_id):
    result = cursor.execute("SELECT * FROM fzve WHERE bill_id =?", (bill_id,))
    result = cursor.fetchone()
    if not bool(len(result)):
        return False
    return result[0]

# start command https://t.me/HimeraGame_bot?startgroup=true


async def get_marry(message: types.Message):
    user = message.from_user
    marry = cursor.execute("SELECT marry FROM users WHERE user_id=?", (user.id,))
    marry=cursor.fetchall()
    return marry
async def get_any(id,table,id2):
    cursor.execute(f"SELECT * FROM {table} WHERE {id2}=?", (id,))
    data = cursor.fetchone()
    return data
async def get_rang(message: types.Message):
    user = message.from_user
    cursor.execute("SELECT * FROM users WHERE user_id=?", (user.id,))
    data = cursor.fetchone()
    return data
async def get_property(id):
    cursor.execute("SELECT * FROM property WHERE user_id=?", (id,))
    data = cursor.fetchone()
    return data
async def get_rang2(id):
    cursor.execute("SELECT * FROM users WHERE user_id=?", (id,))
    data = cursor.fetchone()
    return data
async def reply_get_rang(message: types.Message):
    reply = message.reply_to_message
    replyuser = reply.from_user
    cursor.execute("SELECT * FROM users WHERE user_id=?", (replyuser.id,))
    data = cursor.fetchone()
    return data

async def get_clan(id):
    cursor.execute("SELECT * FROM clan WHERE user_id=?", (id,))
    data_c = cursor.fetchone()
    return data_c
def transform(value):
    balance32=0
    if int(value) <= 0:
        balance32 = 0
    if int(value) in range(1000, 999999):
        balance1 = value / 1000
        balance2 = int(balance1)
        balance32 = f'{balance2} тыс'

    if int(value) in range(1000000, 999999999):
        balance1 = value / 1000000
        balance2 = int(balance1)
        balance32 = f'{balance2} млн'

    if int(value) in range(1000000000, 999999999999):
        balance1 = value / 1000000000
        balance2 = int(balance1)
        balance32 = f'{balance2} млрд'

    if int(value) in range(1000000000000, 999999999999999):
        balance1 = value / 1000000000000
        balance2 = int(balance1)
        balance32 = f'{balance2} трлн'

    if int(value) in range(1000000000000000, 999999999999999999):
        balance1 = value / 1000000000000000
        balance2 = int(balance1)
        balance32 = f'{balance2} квдр'

    if int(value) in range(1000000000000000000, 999999999999999999999):
        balance1 = value / 1000000000000000000
        balance2 = int(balance1)
        balance32 = f'{balance2} квнт'

    if int(value) in range(1_000_000_000_000_000_000_000, 999_999_999_999_999_999_999_999):
        balance1 = value / 1000000000000000000000
        balance2 = int(balance1)
        balance32 = f'{balance2} скст'
    if int(value) in range(1000_000_000_000_000_000_000_000, 999_999_999_999_999_999_999_999_999):
        balance1 = value / 1000_000_000_000_000_000_000_000
        balance2 = round(balance1)
        balance32 = f'{balance2} трикс'
    if int(value) >= 1000_000_000_000_000_000_000_000_000:
        balance1 = value / 1000000000000000000000000000
        balance2 = round(balance1)
        balance32 = f'{balance2} твинкс'
    if int(value) in range(1000000000000000_000_000_000_000_000, 999999999999999999999999999999999):
        balance1 = value / 1000000000000000000000000000000
        balance2 = round(balance1)
        balance32 = f'{balance2} септ'
    if int(value) in range(1000000000000000000000000000000000, 999999999999999999999999999999999999):
        balance1 = value / 1000000000000000000000000000000000
        balance2 = round(balance1)
        balance32 = f'{balance2} октл'
    if int(value) in range(1000000000000000000000000000000000000, 999999999999999999999999999999999999999):
        balance1 = value / 1000000000000000000000000000000000000
        balance2 = round(balance1)
        balance32 = f'{balance2} нонл'
    if int(value) in range(1000000000000000000000000000000000000000, 999999999999999999999999999999999999999999):
        balance1 = value / 1000000000000000000000000000000000000000
        balance2 = round(balance1)
        balance32 = f'{balance2} декал'
    if int(value) in range(1000000000000000000000000000000000000000000,
                             999999999999999999999999999999999999999999999):
        balance1 = value / 1000000000000000000000000000000000000000000
        balance2 = round(balance1)
        balance32 = f'{balance2} эндк'
    if int(value) in range(1000000000000000000000000000000000000000000000,
                             999999999999999999999999999999999999999999999999):
        balance1 = value / 1000000000000000000000000000000000000000000000
        balance2 = round(balance1)
        balance32 = f'{balance2} доктл'
    if int(value) in range(1000000000000000000000000000000000000000000000000,
                             999999999999999999999999999999999999999999999999999):
        balance1 = value / 1000000000000000000000000000000000000000000000000
        balance2 = round(balance1)
        balance32 = f'{balance2} гугл'
    if int(value) in range(1000000000000000000000000000000000000000000000000000,
                             999999999999999999999999999999999999999999999999999999):
        balance1 = value / 1000000000000000000000000000000000000000000000000000
        balance2 = round(balance1)
        balance32 = f'{balance2} кинд'
    if int(value) in range(1000000000000000000000000000000000000000000000000000000,
                             999999999999999999999999999999999999999999999999999999999):
        balance1 = value / 1000000000000000000000000000000000000000000000000000000
        balance2 = round(balance1)
        balance32 = f'{balance2} трипт'
    if int(value) in range(1000000000000000000000000000000000000000000000000000000000,
                             999999999999999999999999999999999999999999999999999999999999):
        balance1 = value / 1000000000000000000000000000000000000000000000000000000000
        balance2 = round(balance1)
        balance32 = f'{balance2} срист'
    if int(value) in range(1000000000000000000000000000000000000000000000000000000000000,
                             999999999999999999999999999999999999999999999999999999999999999):
        balance1 = value / 1000000000000000000000000000000000000000000000000000000000000
        balance2 = round(balance1)
        balance32 = f'{balance2} манит'

    if int(value) >= 1000000000000000000000000000000000000000000000000000000000000000:
        balance1 = value / 1000000000000000000000000000000000000000000000000000000000000000
        balance2 = round(balance1)
        balance32 = f'{balance2} гвинт'
    return balance32
###########################################ПОМОЩЬ###########################################

@dp.message_handler(commands=['reset'])
async def start_cmd(message):
    msg = message
    user_id = msg.from_user.id
    data = await get_rang(message)
    user_status = str(data[10])
    data = await get_rang(message)
    user_name = str(data[9])

    if user_status == 'Rab':
        await bot.send_message(message.chat.id,
                               f"⛔️ |Администратор: <a href='tg://user?id={user_id}'>{user_name}</a>\n⚙️ |Действие: Масовое обнуление\n👨 |Игроку: Всем игрокам",
                               parse_mode='html')
        cursor.execute(f'UPDATE users SET balance = {10000}')
        cursor.execute(f'UPDATE users SET bank = {1000}')
        cursor.execute(f'UPDATE users SET level = {1}')
        cursor.execute(f'UPDATE users SET fantom = {0}')
        cursor.execute(f'UPDATE users SET rating = {0}')
        cursor.execute(f'UPDATE users SET expe = {0}')
        cursor.execute(f'UPDATE users SET games = {0}')
        cursor.execute(f'UPDATE users SET work = {0}')
        cursor.execute(f'UPDATE users SET pet1 = {0}')
        cursor.execute(f'UPDATE users SET pet2 = {0}')
        cursor.execute(f'UPDATE users SET pet3 = {0}')
        cursor.execute(f'UPDATE users SET pet4 = {0}')
        cursor.execute(f'UPDATE users SET pet5 = {0}')
        cursor.execute(f'UPDATE users SET pet6 = {0}')
        cursor.execute(f'UPDATE users SET pet7 = {0}')
        cursor.execute(f'UPDATE users SET pet8 = {0}')
        cursor.execute(f'UPDATE users SET pet9 = {0}')
        cursor.execute(f'UPDATE users SET pet10 = {0}')
        cursor.execute(f'UPDATE users SET game = {0}')
        cursor.execute(f'UPDATE users SET stavka = {0}')
        cursor.execute(f'UPDATE ferma SET cards = {0}')
        cursor.execute(f'UPDATE ferma SET ferma_money = {0}')
        cursor.execute(f'UPDATE ferma SET Farm = {0}')
        cursor.execute(f'UPDATE users SET case1 = {0}')
        cursor.execute(f'UPDATE users SET case2 = {0}')
        cursor.execute(f'UPDATE users SET case3 = {0}')
        cursor.execute(f'UPDATE users SET case4 = {0}')
        cursor.execute(f'UPDATE mine SET iron = {0}')
        cursor.execute(f'UPDATE mine SET gold = {0}')
        cursor.execute(f'UPDATE mine SET diamonds = {0}')
        cursor.execute(f'UPDATE mine SET amethysts = {0}')
        cursor.execute(f'UPDATE mine SET aquamarine = {0}')
        cursor.execute(f'UPDATE mine SET emeralds = {0}')
        cursor.execute(f'UPDATE mine SET pick = {0}')
        cursor.execute(f'UPDATE mine SET hp = {100}')
        cursor.execute(f'UPDATE property SET yacht = {0}')
        cursor.execute(f'UPDATE property SET cars = {0}')
        cursor.execute(f'UPDATE property SET plane = {0}')
        cursor.execute(f'UPDATE property SET helicopter = {0}')
        cursor.execute(f'UPDATE property SET house = {0}')
        cursor.execute(f'UPDATE property SET phone = {0}')
        cursor.execute(f"UPDATE property SET have = 'off' ")
        cursor.execute(f"UPDATE business SET have = 'off' ")
        cursor.execute(f'UPDATE business SET balance = {0}')
        cursor.execute(f'UPDATE business SET workers = {0}')
        cursor.execute(f'UPDATE business SET business = {0}')
        cursor.execute(f"TRUNCATE TABLE cars")
        cursor.execute(f"TRUNCATE TABLE promo")
        cursor.execute(f"TRUNCATE TABLE promold")
        cursor.execute(f"TRUNCATE TABLE city")
        cursor.execute(f'UPDATE chats SET balance = {0}')
        cursor.execute(f'UPDATE clans SET kazna = {0}')
        cursor.execute(f'UPDATE clans SET power = {0}')
        cursor.execute(f'UPDATE clans SET win = {0}')
        cursor.execute(f'UPDATE clans SET lose = {0}')
        cursor.execute(f'UPDATE wdzy SET summ = {1000000}')
        connect.commit()
        full_name = msg.from_user.full_name
        print(f'{full_name} масовое обнуление')

        return
    else:
        await bot.send_message(message.chat.id,
                               f"‼️ <a href='tg://user?id={user_id}'>{user_name}</a> , данная функция доступна только RAZRABY",
                               parse_mode='html')
@dp.message_handler(commands=['menu'])
async def menu_bog(message):
    if message.from_user.id == cfg.owner_id:
        await bot.send_message(message.chat.id,"""
           <b>Админ меню</b> 

<b>Рассылка</b> - <i>рассылает всем сообщение</i>

<b>Срез</b> - <i>срезает всем 
~ баланс на определеную сумму
~ рейтинг на определеную сумму
~ фантом на определеную сумму
~ банк на определеную сумму
~ казну клана на определеную сумму</i>

<b>ВДЗУ</b> - <i>выдача за добавление участников</i>""",parse_mode="html",reply_markup=men)
@dp.message_handler(commands=['reset_id'])
async def start_cmd(message):
    msg = message
    user_id = msg.from_user.id
    data = await get_rang(message)
    user_status = str(data[10])
    data=await get_rang(message)
    user_name = str(data[9])
    try:
        id = message.text.split()[1]
        if id.isdigit():
            pass
        else:
            await message.reply('‼️ Не хватает аргументов!\nПример: /reset_id id ')
            return
    except:
        await message.reply('‼️  Неправильный ввод команды!\nПример: /reset_id id ')
        return
    data = await get_rang2(id)
    ruser_name = str(data[9])

    if user_status == 'Rab':
        await bot.send_message(message.chat.id,
                               f"👮️ Администратор: <a href='tg://user?id={user_id}'>{user_name}</a>\n⚙️ Действие: обнуление\n👨 Игроку:<a href='tg://user?id={id}'>{ruser_name}</a> ",
                               parse_mode='html')
        cursor.execute(f'UPDATE users SET balance = {10000} WHERE user_id={id}')
        cursor.execute(f'UPDATE users SET bank = {1000} WHERE user_id={id}')
        cursor.execute(f'UPDATE users SET level = {1} WHERE user_id={id}')
        cursor.execute(f'UPDATE users SET fantom = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE users SET rating = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE users SET expe = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE users SET games = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE users SET work = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE ferma SET cards = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE ferma SET ferma_money = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE ferma SET Farm = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE users SET case1 = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE users SET case2 = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE users SET case3 = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE users SET case4 = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE mine SET iron = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE mine SET gold = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE mine SET diamonds = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE mine SET amethysts = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE mine SET aquamarine = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE mine SET emeralds = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE property SET yacht = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE property SET cars = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE property SET plane = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE property SET helicopter = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE property SET house = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE property SET phone = {0} WHERE user_id={id}')
        cursor.execute(f"UPDATE property SET have = 'off' WHERE user_id={id} ")
        cursor.execute(f'UPDATE business SET balance = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE business SET workers = {0} WHERE user_id={id}')
        cursor.execute(f'UPDATE business SET business = {0} WHERE user_id={id}')

        connect.commit()

        return
    else:
        await bot.send_message(message.chat.id,
                               f"‼️ <a href='tg://user?id={user_id}'>{user_name}</a> , данная функция доступна только RAZRABY",
                               parse_mode='html')



@dp.message_handler(IsBot(),content_types=["new_chat_members"])
async def bot_added_to_chat(message):
    if message.chat.type != 'supergroup':
        await message.answer("""
<b>❌ Ваша группа не является супергруппой❌</b>

Пожалуйста, превратите вашу группу в супергруппу 
(просто запретите кому-то отправлять медиафайлы и заново разрешите) 
и пригласите бота повторно."""
                             , parse_mode='html')
        await bot.leave_chat(message.chat.id)
    else:
        await message.answer("""
<b>Привет!</b>
Я игровой бот 💲
Для того чтобы я мог начать работу, выдай мне пожалуйста права администрации.

Появились предложения или же вопросы?
<a href="https://t.me/corching">>Обратись ко мне</a>

<a href="https://t.me/himera_bo1">>Так же у нас есть общая беседа </a>"""
    ,parse_mode = 'html')


@dp.message_handler(content_types=["new_chat_members"])
async def handler_new_member(message):

    try:
        wdz1=cursor.execute("SELECT wdz FROM wdzy WHERE chat_id=?",(message.chat.id,))
        wdz1=cursor.fetchone()
        wdz1=str(wdz1[0])
    except:
        wdz1="off"
    if wdz1 =="on":
        name1 = message.new_chat_members[0].get_mention(as_html=True)

        user_id = message.new_chat_members[0].id
        user_name = message.new_chat_members[0].full_name

        chat_id = message.chat.id

        user_sd=cursor.execute(f"SELECT user_id FROM users WHERE user_id = {user_id}")
        user_sd=cursor.fetchone()
        user_name = user_name.replace('<', '').replace('>', '')
        if user_sd is None:

            await message.reply(f' 👋Привет {name1}\nЯ бот для игры в различные игры.\nПерейди в лс для получения полного доступа в боте',
                parse_mode="html",reply_markup=help_perexod)
            try:
                user_id1 = message.from_user.id
                user_name1 = message.from_user.first_name

                balance = cursor.execute(
                    "SELECT balance from users where user_id = ?", (message.from_user.id,))
                balance = cursor.fetchone()
                balance = int(balance[0])
                summ = cursor.execute(f"SELECT summ FROM wdzy WHERE chat_id={chat_id}")
                summ = cursor.fetchone()
                summ = int(summ[0])
                count = cursor.execute(f"SELECT count FROM wdzy WHERE chat_id={chat_id}")
                count = cursor.fetchone()
                count = int(count[0])
                summ2 = '{:,}'.format(summ).replace(',', '.')
                cursor.execute(
                    f"UPDATE users SET balance={balance + summ} WHERE user_id = ?", (user_id1,))
                cursor.execute(
                    f"UPDATE wdzy SET count={count + 1} WHERE chat_id = {chat_id}")
                connect.commit()
                await bot.send_message(user_id1,
                                       f"‼️ <a href='tg://user?id={user_id1}'>{user_name1}</a>,Вам была выдана награда в размере {summ2}",
                                       parse_mode='html')
            except:
                pass
        if user_sd != None:
            await message.reply(
                f' 👋Привет {name1}\nЯ бот для игры в различные игры.\nПерейди в лс для получения полного доступа в боте',parse_mode="html",reply_markup=help_perexod)
            connect.commit()
            try:
                user_id1 = message.from_user.id
                user_name1 = message.from_user.first_name
                if user_id1 != message.new_chat_members[0].id:
                    await bot.send_message(user_id1,
                                       f"🚫 <a href='tg://user?id={user_id1}'>{user_name1}</a>, Игрок уже есть в базе данных бота ",
                                       parse_mode='html')
            except:
                pass
@rate_limit(limit=1)
@dp.message_handler(IsRegister2(),commands=['gamevb'])
async def startq_cmd(message):
    status_block = cursor.execute("SELECT status_block from users where user_id = ?",
                                  (message.from_user.id,))
    status_block = cursor.fetchone()
    status_block = str(status_block[0])
    if status_block == 'on':
        pass

    else:
        if message.forward_date != None:
            return

        msg = message
        user_id = msg.from_user.id
        data = await get_rang(message)
        user_name = str(data[9])
        chat_id = message.chat.id
        balance = cursor.execute(
            "SELECT balance from users where user_id = ?", (message.from_user.id,))
        balance = cursor.fetchone()
        balance = int(balance[0])

        if balance > 0:
            await bot.send_message(message.chat.id, f"""
<a href='tg://user?id={user_id}'>{user_name}</a>, 
вы уверены что хотите сыграть в gamevb ? 

🎮 Игра /gamevb это где ставка это ваще весь баланс
⏺️Нажми на кнопку если уверен что хочешь сыграть        
""", reply_markup=gamevbmenu,  parse_mode='html')
        else:
            await bot.send_message(message.chat.id, f"‼️ <a href='tg://user?id={user_id}'>{user_name}</a>, ошибка! У вас недостаточно средств! ", parse_mode='html')

@rate_limit(limit=1)
@dp.message_handler(IsRegister2(),text=['Помощь', 'помощь'])
async def stats(message):
    status_block = cursor.execute("SELECT status_block from users where user_id = ?",
                                  (message.from_user.id,))
    status_block = cursor.fetchone()
    status_block = str(status_block[0])

    if status_block == 'on':
        pass
    else:
        if message.forward_date != None:
            return
        if message.chat.type == 'private':

            data = await get_rang(message)
            user_name = str(data[9])
            user_id = message.from_user.id
            await bot.send_message(message.chat.id,
                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, выберите категорию:\n  💡 Основные\n  🎲 Игры\n  💥 Развлекательное\n  🛠 Модерация чата\n  ⚔️ Кланы  \n  🌇 Город\n'
        
                                   f'🗯Вот наша беседа бота t.me/himera_bo1\n'
                                   f'📣 Официальный канал: t.me/himera_news',
                                   reply_markup=help_menu, parse_mode='html')
        else:


            user_id = message.from_user.id
            data = await get_rang(message)
            user_name = str(data[9])
            try:
                await bot.send_message(message.from_user.id,
                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, выберите категорию:\n  💡 Основные\n  🎲 Игры\n  💥 Развлекательное\n  🛠 Модерация чата\n  ⚔️ Кланы  \n  🌇 Город\n'
    
                                       f'🗯Вот наша беседа бота t.me/himera_bo1\n'
                                       f'📣 Официальный канал: t.me/himera_news',
                                       reply_markup=help_menu, parse_mode='html')
                await bot.send_message(message.chat.id,
                                       f" <i>❕ Сообщение было отправлено в лс</i>", parse_mode='html',reply_markup=help_perexod)
            except:
                await bot.send_message(message.chat.id,
                                       f" <i>❕ Для начало напишить команду /start в лс бота</i>", parse_mode='html',reply_markup=help_perexod)


@dp.message_handler(commands=['unban_idb'])
async def unban_id(message):
    data = await get_rang(message)
    user_name = str(data[9])
    user_id = message.from_user.id


    win = ['🙂', '😋', '😄', '🤑', '😃']
    rwin = random.choice(win)
    data = await get_rang(message)
    user_status = str(data[10])

    try:
        reply_user_id = message.text.split()[1]
        if reply_user_id.isdigit():
            pass
        else:
            await message.reply('‼️ Не хватает аргументов!\nПример:/unban_idb id ')
            return
    except :
        await message.reply('‼️  Не хватает аргументов!\nПример:\n/unban_idb id ')
        return
    data = await get_rang2(reply_user_id)
    reply_user_name = str(data[9])

    if user_status == 'Rab' or user_status == 'Admin':
        await message.reply(
            f'Администратор снял бан игроку <a href="tg://user?id={reply_user_id}">{reply_user_name}</a> ⛔️',
            parse_mode='html')
        cursor.execute(
            f"UPDATE users SET status_block = 'off' WHERE user_id = {reply_user_id}")
        cursor.execute(f"DELETE from ban_list where user_id = {reply_user_id}")
        await bot.send_message(cfg.log_group, f"""
⚙️LOG: #Админ
Администратор <a href="tg://user?id={user_id}">{user_name}</a>(<code>{user_id}</code>)  снял бан игроку 
<a href="tg://user?id={reply_user_id}">{reply_user_name}</a>(<code>{reply_user_id}</code>) 
""", parse_mode='html')
        connect.commit()

    if user_status == 'Player':
        await message.reply(
            f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>, Доступ к данной команде ограничен. Для покупки администратора обратитесь к создателю 👨‍🦰',
            parse_mode='html')
        
@dp.message_handler(commands=['ban_idb'])
async def ban_id(message):
    data = await get_rang(message)
    user_name = str(data[9])

    user_id = message.from_user.id
    win = ['🙂', '😋', '😄', '🤑', '😃']
    rwin = random.choice(win)

    data = await get_rang(message)
    user_status = str(data[10])
    try:
        id = int(message.text.split()[1])
        muteint = int(message.text.split()[2])
        mutetype = message.text.split()[3]
        comment = " ".join(message.text.split()[4:])
    except :
        await message.reply('‼️  Не хватает аргументов!\nПример:\n/ban_idb id 1 ч причина')
        return
    data = await get_rang2(id)
    reply_user_name = str(data[9])
    data = await get_rang2(id)
    user_status2 = str(data[10])
    if user_status == 'Rab' or user_status == 'Admin':
        if user_status2 != 'Rab' and user_status2 != 'Admin':
            if mutetype == "м" or mutetype == "минут" or mutetype == "минуты":
                timestamp = muteint * 60
                await message.reply(
                    f'Администратор выдал бан игроку <a href="tg://user?id={id}">{reply_user_name}</a> ⛔',
                    parse_mode='html')
                cursor.execute(
                    f"UPDATE users SET status_block = 'on' WHERE user_id = {id}")
                cursor.execute(
                    "INSERT INTO ban_list VALUES(?, ?,?, ?);",
                    (id, reply_user_name, comment, timestamp))
                await bot.send_message(cfg.log_group, f"""
⚙️LOG: #Админ
Администратор <a href="tg://user?id={user_id}">{user_name}</a>(<code>{user_id}</code>)  выдал бан игроку 
<a href="tg://user?id={id}">{reply_user_name}</a>(<code>{id}</code>) 
причина: {comment}
На:{timestamp}
""", parse_mode='html')
                connect.commit()
            if mutetype == "ч" or mutetype == "часов" or mutetype == "час":

                timestamp=muteint * 60 * 60
                await message.reply(
                    f'Администратор выдал бан игроку <a href="tg://user?id={id}">{reply_user_name}</a> ⛔'
                    f'️',
                    parse_mode='html')
                cursor.execute(
                    f"UPDATE users SET status_block = 'on' WHERE user_id = {id}")
                cursor.execute(
                    "INSERT INTO ban_list VALUES(?, ?,?, ?);", (id, reply_user_name,comment,timestamp))
                await bot.send_message(cfg.log_group, f"""
⚙️LOG: #Админ
Администратор <a href="tg://user?id={user_id}">{user_name}</a>(<code>{user_id}</code>)  выдал бан игроку 
<a href="tg://user?id={id}">{reply_user_name}</a>(<code>{id}</code>) 
причина: {comment}
На:{timestamp}
""", parse_mode='html')
                connect.commit()
            if mutetype == "д" or mutetype == "дней" or mutetype == "день":

                timestamp = muteint * 60 * 60 * 24
                await message.reply(
                    f'Администратор выдал бан игроку <a href="tg://user?id={id}">{reply_user_name}</a> ⛔'
                    f'️',
                    parse_mode='html')
                cursor.execute(
                    f"UPDATE users SET status_block = 'on' WHERE user_id = {id}")
                cursor.execute(
                    "INSERT INTO ban_list VALUES(?, ?,?, ?);",
                    (id, reply_user_name, comment, timestamp))
                await bot.send_message(cfg.log_group, f"""
⚙️LOG: #Админ
Администратор <a href="tg://user?id={user_id}">{user_name}</a>(<code>{user_id}</code>)  выдал бан игроку 
<a href="tg://user?id={id}">{reply_user_name}</a>(<code>{id}</code>) 
причина: {comment}
На:{timestamp}
""", parse_mode='html')
                connect.commit()
    if user_status == 'Player':
        await message.reply(
            f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>, Доступ к данной команде ограничен. Для покупки администратора обратитесь к создателю 👨‍🦰',
            parse_mode='html')
@rate_limit(limit=1)
@dp.message_handler(text=['Донаты', 'Донат', 'донат'])
async def stats(message):

    name = message.from_user.get_mention(as_html=True)
    await bot.send_message(message.chat.id, f"""{name}💸, список доступного доната:
⭐️ Статус «VIP» — 50 🍭.
💎 Статус «Premium» — 150 🍭.
🔥 Статус «Deluxe» — 300 🍭.
💱 Валюта 
1 руб = 2 🍭\n""", reply_markup=help_donat,
                           parse_mode='html')

@rate_limit(limit=1)
@dp.message_handler(IsRegister2(),text=['топ', 'Топ'])
async def stats(message):
    status_block = cursor.execute("SELECT status_block from users where user_id = ?",
                                  (message.from_user.id,))
    status_block = cursor.fetchone()
    status_block = str(status_block[0])

    if status_block == 'on':
        pass
    else:
        if message.forward_date != None:
            return



        user_id = message.from_user.id

        list = cursor.execute(f"SELECT * FROM users ORDER BY rating DESC")
        list = cursor.fetchmany(1000)
        top_list = []
        chat_id = message.chat.id
        name = message.from_user.get_mention(as_html=True)
        num = 1
        my_list = []
        top_list2 = []
        stop = ["0️⃣", "1️⃣", "2️⃣", "3️⃣", "4️⃣", "5️⃣", "6️⃣", "7️⃣", "8️⃣", "9️⃣", "🔟"]

        for user in list:
            c6 = user[11]

            c = Decimal(c6)
            c2 = '{:,}'.format(c).replace(',', '.')
            if user[0]==user_id:
                for x in str(num):
                    my_list.append(int(x))
                    if len(my_list)==1:
                        first = stop[my_list[0]]
                        count=first
                    elif len(my_list)==2:
                        first = stop[my_list[0]]
                        second = stop[my_list[1]]
                        count = first + second
                    elif len(my_list)==3:
                        first = stop[my_list[0]]
                        second = stop[my_list[1]]
                        third=stop[my_list[2]]
                        count=first+second+third
                    else:
                        count="⬅️"
                player = status_users(user[0])
                top_list2.append(
                    f"{count} <b>{player} ➪ </b><i> {user[9]} </i> —  | 🔍ID: <code>{user[0]}</code> | <b>👑{c2}</b> ")

            if user[10] == 'Admin' or user[10] == 'Rab':
                pass
            else:
                if num <= 10:

                    user_status = cursor.execute("SELECT user_status from users where user_id = ?",
                                                 (user[0],))
                    user_status = cursor.fetchone()
                    if user_status[0] == 'delux':
                        user_status2 = '<b>🔥DELUXE ➪ </b>'
                    else:
                        user_status2 = ''
                    top_list.append(
                        f"{stop[num]} {user_status2}<i> {user[9]} </i> —  | 🔍ID: <code>{user[0]}</code> | <b>👑{c2}</b> ")
                num += 1
        top2 = "\n".join(top_list2)
        top = "\n".join(top_list)
        await bot.send_message(message.chat.id, f"{name}, Топ 10 игроков бота:\n" + top + f"""
    \n➖➖➖➖➖➖➖➖➖➖➖ \n """+top2, reply_markup=help_top, parse_mode='html')


@rate_limit(limit=1)
@dp.message_handler(text=['/rules', '/правила', '/Правила'])
async def rules(message):
    await message.answer("https://teletype.in/@corching/himer_rules")

@rate_limit(limit=1)
@dp.message_handler(commands=['reset_promo'])
async def time_cmd(message):

    if message.from_user.id == cfg.owner_id:
        cursor.execute(f"TRUNCATE TABLE promo")
        cursor.execute(f"TRUNCATE TABLE promold")
        connect.commit()
        await message.answer("промо сброшены")
    else:
        await message.answer("❌ Эта команда доступна только создателю бота")

@rate_limit(limit=1)
@dp.message_handler(commands=['time'])
async def time36(message):
    if message.from_user.id == cfg.owner_id:
        times2=[]
        times = []
        jobs=["⚡️Энергия","♻️Ферма","🏦 Банк","🛡️ Клан","⛔️ Лимит"]

        for job in scheduler.get_jobs():
            times2.append("name: ? ,  ? " % (
                job.name, job.next_run_time))
        times2=str(times2)
        time2 = times2.split(",")
        j=0
        for i in range(1,10,2):
            time3 = time2[i].split('.')
            for g in range(1):
                times.append(f" <i>{jobs[j]} </i> — <b>{time3[0]}</b> ")
            j+= 1
        time3 = time2[3].split('.')
        times.append(f" <i>💠 Курс фантома</i> — <b>{time3[0]}</b> ")
        time4 = "\n".join(times)

        await message.answer(time4,parse_mode='html')
    else:
        await message.answer("❌ Эта команда доступна только создателю бота")

@rate_limit(limit=1)
@dp.message_handler(commands=['start'])
async def start_cmd(message):

    msg = message
    pet_name = "name"
    user_id = msg.from_user.id
    user_name = msg.from_user.full_name
    user_status = "Player"
    have = 'off'
    status_block = 'off'
    chat_id = message.chat.id
    cursor.execute(f"SELECT user_id FROM users WHERE user_id = {user_id}")
    user_name = user_name.replace('<', '').replace('>', '')

    referrer_id = None
    if cursor.fetchone() is None:
        start_command = message.text
        referrer_id = str(start_command[7:])
        if str(referrer_id) != '' and referrer_id.isdigit():
            if str(referrer_id) != str(msg.from_user.id):
                global referrer_id2
                referrer_id2=referrer_id
                await dialog.captcha.set()
                alphabet = string.digits
                # password = ''.join(secrets.choice(alphabet) for i in range(20))
                image = ImageCaptcha()
                data = ''.join(secrets.choice(alphabet) for i in range(random.randint(3, 4)))
                image.write(data, 'out.png')
                solve.nameCaptcha = data
                await message.answer('Привет, пройди капчу для получения награды за реф ссылку!')
                lenght = len(data[0].split(','))
                kb = InlineKeyboardMarkup(row_width=lenght)
                for z in range(4):
                    name = ''.join(secrets.choice(alphabet) for i in range(random.randint(5, 6)))
                    name=str(name)
                    kb.insert(InlineKeyboardButton(text=name,callback_data='check2_' + name))


                kb.insert(InlineKeyboardButton(text=data,callback_data='check2_' + data))
                await bot.send_photo(chat_id=message.chat.id, photo=types.InputFile('out.png'),reply_markup=kb)


            else:
                await bot.send_message(msg.from_user.id, 'Нельзя регестрироваться по собственной ссылке')

        else:
            referrer_id = None
            cursor.execute(
                "INSERT INTO users VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?,?,?,?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?, ?, ?, ?,?,?,?,?,?,?,?,?);",
                (user_id, 1, 10000, 0, 0, 0, 10, 0, 0, user_name, user_status, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 pet_name, 0, 0, 0, 0, 0, 0, 0, status_block, 0, 0, 0, 0, 0, 0, 0, 0, 1000000000000, 1, 1000,
                 500000000000,
                 0, 0, 100000000000, 50000000000, 1, referrer_id, 0, 0, 0, 0, 0, None, 0, 0, 0, 0, datetime.now(), 1, 0,
                 0,0))
            cursor.execute("INSERT INTO property VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?);",
                           (user_id, user_name, have, 0, 0, 0, 0, 0, 0))
            cursor.execute("INSERT INTO mine VALUES(?, ?, ?, ?, ?,  ?, ?, ?, ?, ?);",
                           (user_id, user_name, 0, 0, 0, 0, 0, 0, 0, 0))

            cursor.execute(
                "INSERT INTO workshop VALUES(?, ?, ?, ?);", (user_id, user_name, 0, 0))

            cursor.execute("INSERT INTO ferma VALUES(?, ?,?, ?,?, ?, ?);",
                           (user_id, user_name, 1,1,0, 0,0))

            cursor.execute("INSERT INTO business VALUES(?, ?,?, ?,?, ?);",
                           (user_id, user_name, 0, 0, 1, have))
            connect.commit()
            name1 = message.from_user.get_mention(as_html=True)
            await message.reply(
                f' 👋 Добро пожаловать {name1}!\n🎳 Я - игровой бот Химера!\n🔮 Во мне довольно много развлекательных команд, которые помогут тебе скоротать время и найти новых друзей ❤️\n‼️  Чтобы узнать все команды введи "Помощь"\nПриятной игры!😊'
                f'\n• Наш чат: t.me/himera_bo1'
                f'\n• Официальный канал: : t.me/himera_news'
                ,
                reply_markup=help_invite, parse_mode='html')
    else:
        name1 = message.from_user.get_mention(as_html=True)
        await message.reply(
            f' 😉 {name1} вы уже зарегистрированы в игровом боте Himera',
            parse_mode="html", reply_markup=help_invite)


@dp.callback_query_handler(text_contains="check2_",state=dialog.captcha)
async def checkrty2(callback: types.CallbackQuery,state: FSMContext):

    data = str(callback.data[7:])
    if data == solve.nameCaptcha.lower():
        expire_date = datetime.now() + timedelta(minutes=1)
        pet_name = "name"
        user_id = callback.from_user.id
        user_name = callback.from_user.full_name
        user_status = "Player"
        have = 'off'
        status_block = 'off'
        chat_id = callback.from_user.id
        cursor.execute(f"SELECT user_id FROM users WHERE user_id = {user_id}")
        user_name = user_name.replace('<', '').replace('>', '')

        cursor.execute(
            "INSERT INTO users VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?,?,?,?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?, ?, ?, ?,?,?,?,?,?,?,?,?);",
            (user_id, 1, 10000, 0, 0, 0, 10, 0, 0, user_name, user_status, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             pet_name, 0, 0, 0, 0, 0, 0, 0, status_block, 0, 0, 0, 0, 0, 0, 0, 0, 1000000000000, 1, 1000,
             500000000000,
             0, 0, 100000000000, 50000000000, 1, referrer_id2, 0, 0, 0, 0, 0, None, 0, 0, 0, 0, datetime.now(), 1, 0,
             0,0))
        cursor.execute("INSERT INTO property VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?);",
                       (user_id, user_name, have, 0, 0, 0, 0, 0, 0))
        cursor.execute("INSERT INTO mine VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?, ?);",
                       (user_id, user_name, 0, 0, 0, 0, 0, 0, 0,  0))

        cursor.execute(
            "INSERT INTO workshop VALUES(?, ?, ?, ?);", (user_id, user_name, 0, 0))

        cursor.execute("INSERT INTO ferma VALUES(?, ?,?, ?,?, ?, ?);",
                       (user_id, user_name, 1, 1, 0, 0, 0))

        cursor.execute("INSERT INTO business VALUES(?, ?,?, ?,?, ?);",
                       (user_id, user_name, 0, 0, 1, have))
        connect.commit()

        ticket = cursor.execute(
            "SELECT ticket from users where user_id = ?", (referrer_id2,))
        ticket = cursor.fetchone()
        ticket = int(ticket[0])
        balance = cursor.execute(
            "SELECT balance from users where user_id = ?", (referrer_id2,))
        balance = cursor.fetchone()
        balance = int(balance[0])
        countref = cursor.execute(
            "SELECT countref from users where user_id = ?", (referrer_id2,))
        countref = cursor.fetchone()
        countref = int(countref[0])
        cursor.execute(
            f"UPDATE users SET ticket={ticket + 5} WHERE user_id = {referrer_id2}")
        cursor.execute(
            f"UPDATE users SET countref={countref + 1} WHERE user_id = {referrer_id2}")
        cursor.execute(
            f"UPDATE users SET balance={balance + 25000000000} WHERE user_id = {referrer_id2}")
        connect.commit()
        name1 = callback.from_user.get_mention(as_html=True)
        await callback.message.answer(
            f' 👋 Добро пожаловать {name1}!\n🎳 Я - игровой бот Химера!\n🔮 Во мне довольно много развлекательных команд, которые помогут тебе скоротать время и найти новых друзей ❤️\n‼️  Чтобы узнать все команды введи "Помощь"\nПриятной игры!😊'
            f'\n• Наш чат: t.me/himera_bo1'
            f'\n• Официальный канал: : t.me/himera_news'
            ,
            reply_markup=help_invite, parse_mode='html')
        try:

            await bot.send_message(referrer_id2, f"""
🙂 Дорогой пользователь!
Спасибо за приглашение пользователя Игрок
Вам было выдано 25.000.000.000 и 5 тикетов 
с помощью тикетов можно крутить кейсы с которых могут выпасть донат вещи
""")
            await bot.send_message(callback.from_user.id, f"""
🙂 Дорогой пользователь!
Вы перешли по реферально ссылке
Вам было выдано 25.000.000.000 и 5 тикетов 
с помощью тикетов можно крутить кейсы с которых могут выпасть донат вещи
                    """)

        except:
            pass
        await state.finish()
    else:
        await callback.message.answer('Ты не правильно ввел капчу, перейди снова по реф ссылке что бы начать заново')
        await state.finish()

@dp.callback_query_handler(lambda c: c.data == "wdzy")
async def check5rty(callback: types.CallbackQuery):
    usid = callback.from_user.id
    if usid == cfg.owner_id:

        chat_id=callback.message.chat.id
        chat_name = callback.message.chat.title
        try:
            summ = cursor.execute(f"SELECT summ FROM wdzy WHERE chat_id={chat_id}")
            summ = cursor.fetchone()
            summ = int(summ[0])
            count = cursor.execute(f"SELECT count FROM wdzy WHERE chat_id={chat_id}")
            count = cursor.fetchone()
            count = int(count[0])
            summ2 = '{:,}'.format(summ).replace(',', '.')
            count2 = '{:,}'.format(count).replace(',', '.')
            wdz = cursor.execute(f"SELECT wdz FROM wdzy WHERE chat_id={chat_id}")
            wdz = cursor.fetchone()
        except:
            await callback.message.answer("Чат не привязан")
            return
        wdz2=""
        if wdz[0]=="on":
            wdz2="включен"
        if wdz[0]=="off":
            wdz2="выключен"

        await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                    text=f"""
 <b>ВДЗУ (Выдача денег за участников)</b>
💭 Чат <b>{chat_name}</b> (<code>{chat_id}</code>)
💰 Сумма за 1 чел : <code>{summ2}</code>
🌝 Статус - {wdz2}
🔢 Всего добавлено - <b>{count2}</b> людей.""" ,parse_mode='html', reply_markup=back_menuadmin)
@dp.callback_query_handler(lambda c: c.data == "back_menuadmins")
async def back_men(callback: types.CallbackQuery):

    if callback.from_user.id == cfg.owner_id:
        await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                    text=f"""
           <b>Админ меню</b> 

<b>Рассылка</b> - <i>рассылает всем сообщение</i>

<b>Срез</b> - <i>срезает всем 
~ баланс на определеную сумму
~ рейтинг на определеную сумму
~ фантом на определеную сумму
~ банк на определеную сумму
~ казну клана на определеную сумму</i>

<b>ВДЗУ</b> - <i>выдача за добавление участников</i>""", parse_mode="html", reply_markup=men)
@dp.callback_query_handler(lambda c: c.data == "srez")
async def srez(callback_query: types.CallbackQuery):
    usid = callback_query.from_user.id
    if usid == cfg.owner_id:
       await Srez.bank.set()
       return await callback_query.message.answer('Срезать bank у кого больше:',reply_markup=back)

@dp.message_handler(content_types=types.ContentType.ANY, state=Srez.bank)
async def srez_step2_handler(message, state: FSMContext):
    if message.text == 'Отмена':
        await message.answer('Отмена! Возвращаю в главное меню.', reply_markup=types.ReplyKeyboardRemove())
        await message.answer("Вернуться в админ понель", reply_markup=back_menuadmin)
        await state.finish()
    else:
        await Srez.next()
        await state.update_data(bank=message.text)
        return await message.answer('Срезать balance у кого больше:',reply_markup=back)
@dp.message_handler(content_types=types.ContentType.ANY, state=Srez.balance)
async def srez_step3_handler(message, state: FSMContext):
    if message.text == 'Отмена':
        await message.answer('Отмена! Возвращаю в главное меню.', reply_markup=types.ReplyKeyboardRemove())
        await message.answer("Вернуться в админ понель", reply_markup=back_menuadmin)
        await state.finish()
    else:
        await Srez.next()
        await state.update_data(balance=message.text)
        return await message.answer('Срезать rating у кого больше:',reply_markup=back)
@dp.message_handler(content_types=types.ContentType.ANY, state=Srez.rating)
async def srez_step4_handler(message, state: FSMContext):
    if message.text == 'Отмена':
        await message.answer('Отмена! Возвращаю в главное меню.', reply_markup=types.ReplyKeyboardRemove())
        await message.answer("Вернуться в админ понель", reply_markup=back_menuadmin)
        await state.finish()
    else:
        await Srez.next()
        await state.update_data(rating=message.text)
        return await message.answer('Срезать fantom у кого больше:',reply_markup=back)
@dp.message_handler(content_types=types.ContentType.ANY, state=Srez.fantom)
async def srez_step5_handler(message, state: FSMContext):
    if message.text == 'Отмена':
        await message.answer('Отмена! Возвращаю в главное меню.', reply_markup=types.ReplyKeyboardRemove())
        await message.answer("Вернуться в админ понель", reply_markup=back_menuadmin)
        await state.finish()
    else:
        await Srez.next()
        await state.update_data(fantom=message.text)
        return await message.answer('Срезать kazna у кого больше:',reply_markup=back)
@dp.message_handler(content_types=types.ContentType.ANY, state=Srez.kazna)
async def srez_step6_handler(message, state: FSMContext):
    if message.text == 'Отмена':
        await message.answer('Отмена! Возвращаю в главное меню.', reply_markup=types.ReplyKeyboardRemove())
        await message.answer("Вернуться в админ понель", reply_markup=back_menuadmin)
        await state.finish()
    else:
        await state.update_data(kazna=message.text)
        data = await state.get_data()
        await state.finish()
        balance = data['balance']

        bank = data['bank']

        kazna = data['kazna']

        rating = data['rating']

        fantom = data['fantom']

        cursor.execute(f"UPDATE users SET balance=100000000000000 WHERE balance>={int(balance)}")
        cursor.execute(f"UPDATE users SET rating=100000 WHERE rating>={int(rating)}")
        cursor.execute(f"UPDATE users SET fantom=1000 WHERE fantom>={int(fantom)}")
        cursor.execute(f"UPDATE users SET bank=10000000000 WHERE bank>={int(bank)}")
        cursor.execute(f"UPDATE clans SET kazna=10000000000 WHERE kazna>={int(kazna)}")
        return await message.answer(f"""
👾 Успешно срезали
👛 Баланс:100.000.000.000.000 если был больше :{balance}
👑 Рейтинг:100.000 если был больше :{rating}
💠 Фантом:1.000 если был больше :{fantom}
💳 Банк:10.000.000.000 если был больше :{bank}
💸 Казна клана:10.000.000.000 если был больше :{kazna}""",reply_markup=types.ReplyKeyboardRemove())
@dp.message_handler(commands=['srez'])
async def srez(message: types.Message):
   if message.from_user.id == cfg.owner_id:
     await message.answer('Добро пожаловать в админ панель.', reply_markup=srez2)
   else:
     await message.answer('Вы не являетесь создателем бота!')
@dp.callback_query_handler(lambda c: c.data == "rass")
async def rass(callback_query: types.CallbackQuery):
    usid = callback_query.from_user.id
    if usid == cfg.owner_id:
       await Rass.post.set()
       return await callback_query.message.answer('📃 Пришлите мне сообщение для рассылки:')

@dp.message_handler(content_types=types.ContentType.ANY, state=Rass.post)
async def rass_step2_handler(message, state: FSMContext):
    await Rass.next()
    await state.update_data(msg=message)
    return await message.answer('🎙️ Клавиатура (name|btn, name|btn\\n) или "-" чтобы пропустить',reply_markup=back)


@dp.message_handler(content_types="text",state=Rass.kb)
async def rass_finish_handler(message, state: FSMContext):
    if message.text == 'Отмена':
        await message.answer('Отмена! Возвращаю в главное меню.', reply_markup=types.ReplyKeyboardRemove())
        await state.finish()
    else:
        data = await state.get_data()
        await state.finish()
        text = message.text
        if message.text != '-':
            text = message.text.split('\n')
            lenght = len(text[0].split(','))
            kb = InlineKeyboardMarkup(row_width=lenght)
            for i in text:
                i = i.split(',')
                for z in i:
                    name, url = z.split('|')
                    kb.insert(InlineKeyboardButton(text=name, url=url))
        else:
            kb = None

        msg = data['msg']
        cursor.execute(f'SELECT user_id FROM users')
        row = cursor.fetchall()
        connect.commit()
        users = [user[0] for user in row]
        cursor.execute(f'SELECT chat_id FROM chats')
        row2 = cursor.fetchall()
        connect.commit()
        chats = [chat[0] for chat in row2]
        send=0
        error=0
        all=0
        await message.answer('Начинаю рассылку...')

        for i in chats:
            all += 1
            try:
                await asyncio.sleep(3)
                await msg.send_copy(chat_id=i,reply_markup=kb)

                send+=1
            except:
                error+=1

        for i in users:
            all += 1
            try:
                await asyncio.sleep(3)
                await msg.send_copy(chat_id=i,reply_markup=kb)

                send+=1
            except:
                error+=1
        await message.answer(f'Отправлено: {all}\n'
                          f'Успешно: {send}\n'
                          f'Неуспешно: {error}',reply_markup=types.ReplyKeyboardRemove())

@dp.message_handler(commands=['rasylka'])
async def adminstration(message: types.Message):
   if message.from_user.id == cfg.owner_id:
     await message.answer('Добро пожаловать в админ панель.', reply_markup=apanel)
   else:
     await message.answer('Вы не являетесь создателем бота!')


@dp.callback_query_handler(lambda c: c.data == "razdacha")
async def rass(callback_query: types.CallbackQuery):
    usid = callback_query.from_user.id
    if usid == cfg.owner_id:
       await razzdacha.post.set()
       return await callback_query.message.answer('📃 Пришлите мне сообщение для раздачи:')

@dp.message_handler(content_types=types.ContentType.ANY, state=razzdacha.post)
async def rass_step2_handler(message, state: FSMContext):
    await razzdacha.next()
    await state.update_data(msg=message)
    return await message.answer('📃 Пришлите мне сумму для раздачи:')
@dp.message_handler(content_types=types.ContentType.ANY, state=razzdacha.summ)
async def rass_step2_handler(message, state: FSMContext):
    await razzdacha.next()
    await state.update_data(msg2=message.text)
    return await message.answer('🎙️ Клавиатура (name) или "-" чтобы пропустить',reply_markup=back)

@dp.message_handler(content_types="text",state=razzdacha.kb)
async def rass_finish_handler(message, state: FSMContext):
    if message.text == 'Отмена':
        await message.answer('Отмена! Возвращаю в главное меню.', reply_markup=types.ReplyKeyboardRemove())
        await state.finish()
    else:
        data = await state.get_data()
        await state.finish()
        text = message.text
        if message.text != '-':
            kb = InlineKeyboardMarkup(row_width=1)
            kb.insert(InlineKeyboardButton(text='(0)✅Участвовать', callback_data='raz'))
        else:
            kb = None

        # -1001856941506 test
        msg = data['msg']
        msg2= data['msg2']
        cursor.execute(f"UPDATE clans_id SET summ={msg2}")
        cursor.execute(f"UPDATE clans_id SET count=0 ")

        connect.commit()
        await msg.send_copy(chat_id=cfg.channel_offical,
                            reply_markup=kb)


@dp.callback_query_handler(lambda c: c.data =='raz')
async def srez(callback_query: types.CallbackQuery):
    usid = callback_query.from_user.id

    type = cursor.execute(f"SELECT type_raz from clans_id ")
    type=cursor.fetchone()
    type=type[0]
    if type==1:
        cursor.execute(f"SELECT user_id from razdachi WHERE user_id={usid}")
        if cursor.fetchone() == None:
            cursor.execute(f"SELECT user_id FROM users WHERE user_id = {usid}")
            if cursor.fetchone() != None:
                user_channel_status = await bot.get_chat_member(chat_id=cfg.channel_offical, user_id=usid)
                if user_channel_status["status"] == 'left':
                    await bot.answer_callback_query(callback_query.id, show_alert=True, text='⁉️ Для начала подпишись на канал !')
                else:
                    summ = cursor.execute(f"SELECT summ from clans_id ")
                    summ = cursor.fetchone()
                    summ = summ[0]
                    cursor.execute("INSERT INTO razdachi VALUES(?,?);",
                                   (usid,summ))
                    connect.commit()

                    cursor.execute(f"UPDATE clans_id SET count=count+1 ")
                    connect.commit()
                    count = cursor.execute(f"SELECT count from clans_id ")
                    count = cursor.fetchone()
                    count = count[0]
                    await bot.edit_message_reply_markup(chat_id=callback_query.message.chat.id,message_id=callback_query.message.message_id,reply_markup=uchas(count))
                    await bot.answer_callback_query(callback_query.id, show_alert=True, text='Вы приняли участие в розыгреше ✅')
            else:
                await bot.answer_callback_query(callback_query.id, show_alert=True, text='⁉️ Для участья напишите /start в лс https://t.me/HimeraGame_bot')
        else:
            await bot.answer_callback_query(callback_query.id, show_alert=True, text='⁉️ Вы уже участвуете !')
    else:
        await bot.answer_callback_query(callback_query.id, show_alert=True, text='❌ На данный момент нету раздач!')
@dp.message_handler(commands=['раздать'])
async def adminstration2(message: types.Message):
   if message.from_user.id == cfg.owner_id:

       cursor.execute(f'SELECT user_id FROM razdachi')
       row = cursor.fetchall()
       connect.commit()
       users = [user[0] for user in row]
       send = 0
       error = 0
       all = 0
       for i in users:
           user_channel_status = await bot.get_chat_member(chat_id=cfg.channel_offical, user_id=i)
           if user_channel_status["status"] == 'left':
               pass
           else:
               try:
                   all += 1
                   balik = cursor.execute(f'SELECT balik FROM razdachi WHERE user_id={i}')
                   balik=cursor.fetchone()
                   balik=int(balik[0])

                   await asyncio.sleep(3)

                   type = cursor.execute(f"SELECT type_valut from clans_id ")
                   type = cursor.fetchone()
                   type = type[0]
                   if type == 1:
                       balik2 = '{:,}'.format(balik).replace(',', '.')
                       cursor.execute(f"UPDATE users SET balance=balance+{balik} WHERE user_id={i}")
                       await bot.send_message(chat_id=i, text=f"🎁 Вам была выдана награда за участие в розыгрыше!\n💰Награда: {balik2}₸")
                   if type == 2:
                       cursor.execute(f"UPDATE users SET case5=case5+{balik} WHERE user_id={i}")
                       await bot.send_message(chat_id=i, text=f"🎁 Вам была выдана награда за участие в розыгрыше!\n💼Награда: {balik}\n➖Для открытья команда: Открыть кейс 5")
                   if type == 3:
                       cursor.execute(f"UPDATE users SET ecoins=ecoins+{balik} WHERE user_id={i}")
                       await bot.send_message(chat_id=i, text=f"🎁 Вам была выдана награда за участие в розыгрыше!\n👛Награда: {balik}🍭")
                   send += 1
               except:
                   error+=1
                   pass


       await message.answer(f'Отправлено: {all}\n'
                            f'Успешно: {send}\n'
                            f'Неуспешно: {error}', reply_markup=types.ReplyKeyboardRemove())
       cursor.execute(f'TRUNCATE TABLE razdachi')
       cursor.execute(f"UPDATE clans_id SET count=0 ")
       connect.commit()
   else:
     await message.answer('Вы не являетесь создателем бота!')
@dp.message_handler(commands=['razdacha'])
async def adminstration2(message: types.Message):
   if message.from_user.id == cfg.owner_id:
     await message.answer('Меню раздач', reply_markup=razda)
   else:
     await message.answer('Вы не являетесь создателем бота!')

@dp.callback_query_handler(lambda c: c.data == 'raz_pere')
async def raz_pered(callback_query: types.CallbackQuery):
    user_id = callback_query.from_user.id
    chat=callback_query.message.chat.id
    if user_id == cfg.owner_id:
        type = cursor.execute(f"SELECT type_raz from clans_id ")
        type = cursor.fetchone()
        type = type[0]

        if type!=1:
            cursor.execute(f"UPDATE clans_id SET type_raz = {1}")
            connect.commit()

            text = f'''
        ♻️ <b>Доступ к раздаче открыт</b> 
                    '''
            await bot.send_message(chat_id=chat, text=text,parse_mode='html')

        else:

            cursor.execute(f"UPDATE clans_id SET type_raz = {0}")
            connect.commit()

            text = f'''
                                    ♻️ <b>Доступ к раздаче закрыт</b> 
                                                '''
            await bot.send_message(chat_id=chat, text=text,parse_mode='html')
@dp.message_handler(commands=['razdacha_type'])
async def raz_pered(message: types.Message):
    user_id = message.from_user.id
    chat=message.chat.id
    if user_id == cfg.owner_id:

        type = message.text.split()[1]

        if type=='1':
            cursor.execute(f"UPDATE clans_id SET type_valut = {1}")
            connect.commit()

            text = f'''
        ♻️ <b>Выбран тип  денги</b> 
                    '''
            await bot.send_message(chat_id=chat, text=text,parse_mode='html')

        if type == '3':

            cursor.execute(f"UPDATE clans_id SET type_valut = {3}")
            connect.commit()

            text = f'''
                                    ♻️ <b>Выбран тип  донат-конфеты</b> 
                                                '''
            await bot.send_message(chat_id=chat, text=text,parse_mode='html')
        if type =='2':
            cursor.execute(f"UPDATE clans_id SET type_valut = {2}")
            connect.commit()

            text = f'''
                                    ♻️ <b>Выбран тип  донат-case</b> 
                                                '''
            await bot.send_message(chat_id=chat, text=text, parse_mode='html')
async def get_datetime(text: str):
    days, hours, minutes = timedelta(seconds=0), timedelta(seconds=0), timedelta(seconds=0)

    if 'д' in text or 'd' in text:
        if 'д' in text:
            xd = text.split('д')[0]
        else:
            xd = text.split('d')[0]
        if len(xd.split()) == 1:
            xd = xd.split()[0]
        else:
            xd = xd.split()[1]
        days = timedelta(days=int(xd))
    if 'м' in text or 'm' in text:
        if 'м' in text:
            xd = text.split('м')[0]
        else:
            xd = text.split('m')[0]

        if len(xd.split()) == 1:
            xd = xd.split()[0]
        else:
            xd = xd.split()[1]
        minutes = timedelta(minutes=int(xd))
    if 'ч' in text or 'h' in text:
        if 'h' in text:
            xd = text.split('h')[0]
        else:
            xd = text.split('ч')[0]
        if len(xd.split()) == 1:
            xd = xd.split()[0]
        else:
            xd = xd.split()[1]
        hours = timedelta(hours=int(xd))

    result = days + hours + minutes
    return result if result.total_seconds() > 30 else None
unmute_perms = ChatPermissions(
    can_send_messages=True,
    can_send_media_messages=False,
    can_send_polls=False,
    can_send_other_messages=True,
    can_add_web_page_previews=True,
    can_invite_users=True,
)
mute_perms = ChatPermissions(
    can_send_messages=False,
    can_send_media_messages=False,
    can_send_polls=False,
    can_send_other_messages=False,
    can_add_web_page_previews=False,
    can_change_info=False,
    can_invite_users=False,
    can_pin_messages=False
)

@dp.message_handler(commands=['заткнуть'], commands_prefix='.')
async def mute_handler(message):

    bot = await message.chat.get_member(user_id=message.bot.id)
    text = ''
    if not isinstance(bot, (ChatMemberOwner, ChatMemberAdministrator)):
        return await message.reply('👾 У бота нет админки в чате :(')
    elif not bot.can_delete_messages:
        text += '[+] <code>🗑️ Удаление сообщений</code>\n'
    elif not bot.can_restrict_members:
        text += '[+] <code>👤 Блокировка пользователей</code>\n'
    if text:
        return await message.reply(f'👾 Боту нужны такие разрешения:\n\n{text}\n\n📞 Администраторы должны выдать их '
                                   f'боту чтобы был доступ к командам модерирования!',parse_mode='html')

    member = await message.chat.get_member(user_id=message.from_user.id)
    usid = message.from_user.id
    if usid != cfg.owner_id:
        if not isinstance(member, (ChatMemberOwner, ChatMemberAdministrator)):
            return await message.reply('👾 У вас нет админки в этом чате!')

    arg = message.text.split()[1:]

    if len(arg) > 0:

        data = await get_datetime(''.join(arg[:-1]))

        if data is None:
            data = timedelta(minutes=15)

        if message.reply_to_message:
            user = message.reply_to_message.from_user.id
            data = await get_datetime(''.join(arg[0]))
            if data is None:
                data = timedelta(minutes=15)
        elif arg[-1].isdigit():
            user = arg[-1]

        else:
            return await message.reply('🤐 Вы не указали кому дать мут!')

        try:
            try:
                user_name = cursor.execute(
                    "SELECT user_name from users where user_id = ?", (user,))
                user_name = cursor.fetchone()
                user_name = user_name[0]
            except Exception as ex:
                return await message.reply(f'Ошибка: <code>{ex}</code>',
                                           parse_mode='html')
            await message.chat.restrict(user_id=user,
                                        permissions=mute_perms,
                                        until_date=data)
            await message.reply(text=f'🤐 Пользователь  <a href="tg://user?id={user}">{user_name}</a> был замучен на <code>{str(data)}</code>',
                                       reply_markup=unmute_kb(user),parse_mode='html')
        except Exception as ex:
            await message.reply(f'👾 Не удалось замутить {arg[-1]}\n'
                                       f'Ошибка: <code>{ex}</code>',parse_mode='html')
    else:
        await message.reply('👾 Используйте: <code>.заткнуть число *ссылка</code>',parse_mode='html')


@dp.message_handler(commands=['голос'], commands_prefix='.')
async def unmute_handler(message:Message):

    call = message
    if not isinstance(message,Message):
        message = message.message
    bot = await message.chat.get_member(user_id=message.bot.id)
    text = ''
    if not isinstance(bot, (ChatMemberOwner, ChatMemberAdministrator)):
        return await message.reply('👾 У бота нет админки в чате :(')
    elif not bot.can_delete_messages:
        text += '[+] <code>🗑️ Удаление сообщений</code>\n'
    elif not bot.can_restrict_members:
        text += '[+] <code>👤 Блокировка пользователей</code>\n'
    if text:
        return await message.reply(f'👾 Боту нужны такие разрешения:\n\n{text}\n\n📞 Администраторы должны выдать их '
                                   f'боту чтобы был доступ к командам модерирования!',parse_mode='html')

    member = await message.chat.get_member(user_id=call.from_user.id)
    usid = message.from_user.id
    if usid != cfg.owner_id:
        if not isinstance(member, (ChatMemberOwner, ChatMemberAdministrator)):
            return await message.reply('👾 У вас нет админки в этом чате!')

    if isinstance(call,Message):
        arg = message.text.split()[1:]
        if len(arg) == 0 and not message.reply_to_message:
            return await message.reply('👾 Используйте: <code>.голос *{ссылка}</code>',parse_mode='html')

    if isinstance(call,Message):
        if message.reply_to_message:
            user = message.reply_to_message.from_user.id
        else:
            try:
                if arg[-1].isdigit():
                    user = arg[-1]
            except:
                return await message.reply(f'👾 Вы не указали кого размутить!')
    else:
        user = int(call.data.split('_')[1])

    try:
        try:
            user_name = cursor.execute(
                "SELECT user_name from users where user_id = ?", (user,))
            user_name = cursor.fetchone()
            user_name = user_name[0]
        except Exception as ex:
            return await message.reply(f'Ошибка: <code>{ex}</code>',
                                       parse_mode='html')
        await message.chat.restrict(user_id=user,
                                    permissions=unmute_perms)
        await message.reply(text=f' <a href="tg://user?id={user}">{user_name}</a> 🤤 Пользователь был размучен!',parse_mode='html')
    except Exception as ex:
        await message.reply(f'👾 Не удалось размутить \n'
                                   f'Ошибка: <code>{ex}</code>',parse_mode='html')

@dp.callback_query_handler(text_contains='unmute_')
async def craft_resurs3(callback: types.CallbackQuery):

    bot = await callback.message.chat.get_member(user_id=callback.message.bot.id)
    text = ''
    if not isinstance(bot, (ChatMemberOwner, ChatMemberAdministrator)):
        return await callback.answer('👾 У бота нет админки в чате :(')
    elif not bot.can_delete_messages:
        text += '[+] <code>🗑️ Удаление сообщений</code>\n'
    elif not bot.can_restrict_members:
        text += '[+] <code>👤 Блокировка пользователей</code>\n'
    if text:
        return await callback.message.reply(f'👾 Боту нужны такие разрешения:\n\n{text}\n📞 Администраторы должны выдать их '
                                   f'боту чтобы был доступ к командам модерирования!',parse_mode='html')

    member = await callback.message.chat.get_member(user_id=callback.from_user.id)
    usid = callback.from_user.id
    if usid != cfg.owner_id:
        if not isinstance(member, (ChatMemberOwner, ChatMemberAdministrator)):
            return await callback.answer('👾 У вас нет админки в этом чате!')

    user = int(callback.data.split('_')[1])

    try:
        try:
            user_name = cursor.execute(
                "SELECT user_name from users where user_id = ?", (user,))
            user_name = cursor.fetchone()
            user_name = user_name[0]
        except Exception as ex:
            return await callback.message.reply(f'Ошибка: <code>{ex}</code>',
                                       parse_mode='html')
        await callback.message.chat.restrict(user_id=user,
                                    permissions=unmute_perms)
        await callback.message.reply(text=f' <a href="tg://user?id={user}">{user_name}</a> 🤤 Пользователь был размучен!',parse_mode='html')
    except Exception as ex:
        await callback.message.reply(f'👾 Не удалось размутить \n'
                                   f'Ошибка: <code>{ex}</code>',
                                   parse_mode='html')
@dp.message_handler(commands=['гбан'], commands_prefix='.')
async def ban_handler(message: Message):

    bot = await message.chat.get_member(user_id=message.bot.id)
    text = ''
    if not isinstance(bot, (ChatMemberOwner, ChatMemberAdministrator)):
        return await message.reply('👾 У бота нет админки в чате :(')
    elif not bot.can_delete_messages:
        text += '[+] <code>🗑️ Удаление сообщений</code>\n'
    elif not bot.can_restrict_members:
        text += '[+] <code>👤 Блокировка пользователей</code>\n'
    if text:
        return await message.reply(f'👾 Боту нужны такие разрешения:\n\n{text}\n\n📞 Администраторы должны выдать их '
                                   f'боту чтобы был доступ к командам модерирования!',parse_mode='html')

    member = await message.chat.get_member(user_id=message.from_user.id)
    usid = message.from_user.id
    if usid != cfg.owner_id:
        if not isinstance(member, (ChatMemberOwner, ChatMemberAdministrator)):
            return await message.reply('👾 У вас нет админки в этом чате!')

    arg = message.text.split()[1:]
    if len(arg) == 0:
        return await message.reply('👾 Используйте: <code>Бан {число} *{ссылка}</code>',parse_mode='html')

    data = await get_datetime(''.join(arg[:-1]))
    if data is None:
        data = timedelta(seconds=30)

    if message.reply_to_message:
        user = message.reply_to_message.from_user.id
        data = await get_datetime(''.join(arg[0]))
        if data is None:
            data = timedelta(seconds=30)
    elif arg[-1].isdigit():
        user = arg[-1]
    else:
        return await message.reply('👾 Вы не указали кого забанить!')

    try:
        try:
            user_name = cursor.execute(
                "SELECT user_name from users where user_id = ?", (user,))
            user_name = cursor.fetchone()
            user_name = user_name[0]
        except Exception as ex:
            return await message.reply(f'Ошибка: <code>{ex}</code>',
                                       parse_mode='html')

        await message.chat.kick(user_id=user,until_date=data)
        xd = f'до <code>{str(data)}</code>' if data.total_seconds() > 30 else 'навсегда'
        await message.reply(text=f'👾 Пользователь  <a href="tg://user?id={user}">{user_name}</a> был забанен {xd}',
                                   reply_markup=unban_kb(user),parse_mode='html')
    except Exception as ex:
        await message.reply(f'👾 Не удалось забанить \n'
                                   f'Ошибка: <code>{ex}</code>',
                                   parse_mode='html')

@dp.message_handler(commands=['гразбан'], commands_prefix='.')
async def unban_handler(message: Message):

    call = message
    if not isinstance(message, Message):
        message = message.message

    bot = await message.chat.get_member(user_id=message.bot.id)
    text = ''
    if not isinstance(bot, (ChatMemberOwner, ChatMemberAdministrator)):
        return await message.reply('👾 У бота нет админки в чате :(')
    elif not bot.can_delete_messages:
        text += '[+] <code>🗑️ Удаление сообщений</code>\n'
    elif not bot.can_restrict_members:
        text += '[+] <code>👤 Блокировка пользователей</code>\n'
    if text:
        return await message.reply(f'👾 Боту нужны такие разрешения:\n\n{text}\n\n📞 Администраторы должны выдать их '
                                   f'боту чтобы был доступ к командам модерирования!')

    member = await message.chat.get_member(user_id=message.from_user.id)
    usid = message.from_user.id
    if usid != cfg.owner_id:
        if not isinstance(member, (ChatMemberOwner, ChatMemberAdministrator)):
            return await message.reply('👾 У вас нет админки в этом чате!')

    arg = message.text.split()[1:]


    if message.reply_to_message:
        user = message.reply_to_message.from_user.id
        
    elif arg[-1].isdigit():
        user = arg[-1]
    else:
        return await message.reply('👾 Вы не указали кого забанить!')

    try:
        try:
            user_name = cursor.execute(
                "SELECT user_name from users where user_id = ?", (user,))
            user_name = cursor.fetchone()
            user_name = user_name[0]
        except Exception as ex:
            return await message.reply(f'Ошибка: <code>{ex}</code>',
                                   parse_mode='html')

        await message.chat.unban(user_id=user)
        await message.reply(text=f'👾 Пользователь <a href="tg://user?id={user}">{user_name}</a> был разбанен',parse_mode='html')
    except Exception as ex:
        await message.reply(f'👾 Не удалось разбанить <a href="tg://user?id={user}">{user_name}</a>\n'
                                   f'Ошибка: <code>{ex}</code>',
                                   parse_mode='html')
@dp.callback_query_handler(text_contains='unban_')
async def craft_redsurs3(callback: types.CallbackQuery):

    bot = await callback.message.chat.get_member(user_id=callback.message.bot.id)
    text = ''
    if not isinstance(bot, (ChatMemberOwner, ChatMemberAdministrator)):
        return await callback.answer('👾 У бота нет админки в чате :(')
    elif not bot.can_delete_messages:
        text += '[+] <code>🗑️ Удаление сообщений</code>\n'
    elif not bot.can_restrict_members:
        text += '[+] <code>👤 Блокировка пользователей</code>\n'
    if text:
        return await callback.message.reply(f'👾 Боту нужны такие разрешения:\n\n{text}\n\n📞 Администраторы должны выдать их '
                                   f'боту чтобы был доступ к командам модерирования!',parse_mode='html')

    member = await callback.message.chat.get_member(user_id=callback.from_user.id)
    usid = callback.from_user.id
    if usid != cfg.owner_id:
        if not isinstance(member, (ChatMemberOwner, ChatMemberAdministrator)):
            return await callback.answer('👾 У вас нет админки в этом чате!')


    user =int(callback.data.split('_')[1])
    try:
        try:
            user_name = cursor.execute(
                "SELECT user_name from users where user_id = ?", (user,))
            user_name = cursor.fetchone()
            user_name = user_name[0]
        except Exception as ex:
            return await callback.message.reply(f'Ошибка: <code>{ex}</code>',
                                       parse_mode='html')
        await callback.message.chat.unban(user_id=user,only_if_banned=True)
        await callback.message.reply(text=f'👾 Пользователь <a href="tg://user?id={user}">{user_name}</a> был разбанен',parse_mode='html')
    except Exception as ex:
        await callback.message.reply(f'👾 Не удалось разбанить \n'
                                   f'Ошибка: <code>{ex}</code>',parse_mode='html')
"""PAYMENTS_TOKEN="1744374395:TEST:73552a7ac91471d4b987"
PRICE = types.LabeledPrice(label="Подписка на 1 месяц", amount=10 * 100)  # в копейках (руб)


# buy
@dp.message_handler(commands=['buy'])
async def buy(message: types.Message):
    if PAYMENTS_TOKEN.split(':')[1] == 'TEST':
        await bot.send_message(message.chat.id, "Тестовый платеж!!!")

    await bot.send_invoice(message.chat.id,
                           title="Delux",
                           description="Превилигия delux",
                           provider_token=PAYMENTS_TOKEN,
                           currency="rub",
                           photo_url="https://www.aroged.com/wp-content/uploads/2022/06/Telegram-has-a-premium-subscription.jpg",
                           photo_width=416,
                           photo_height=234,
                           photo_size=416,
                           is_flexible=False,
                           prices=[PRICE],
                           start_parameter="one-month-subscription",
                           payload="Delux")


# pre checkout  (must be answered in 10 seconds)
@dp.pre_checkout_query_handler(lambda query: True)
async def pre_checkout_query(pre_checkout_q: types.PreCheckoutQuery):
    await bot.answer_pre_checkout_query(pre_checkout_q.id, ok=True)


# successful payment
@dp.message_handler(content_types=ContentTypes.SUCCESSFUL_PAYMENT)
async def successful_payment(message: types.Message):
    print("SUCCESSFUL PAYMENT:")
    payment_info = message.successful_payment.to_python()
    for k, v in payment_info.items():
        print(f"{k} = {v}")
    user_id=message.from_user.id
    cursor.execute(
        f"UPDATE users SET user_status = 'delux'  WHERE user_id = {user_id}")
    cursor.execute(
        f'UPDATE users SET limitpered = 50000000000000  WHERE user_id = {user_id}')
    cursor.execute(
        f'UPDATE users SET cardslimit = 5000  WHERE user_id = {user_id}')
    cursor.execute(
        f'UPDATE users SET bonusvip = 1  WHERE user_id = {user_id}')
    cursor.execute(
        f'UPDATE users SET bonusprem = 1  WHERE user_id = {user_id}')
    cursor.execute(
        f'UPDATE users SET limitvidach = 1000000000000  WHERE user_id = {user_id}')
    cursor.execute(
        f'UPDATE users SET limitvidach2 = 50000000000  WHERE user_id = {user_id}')
    connect.commit()
    await bot.send_message(message.chat.id,
                           f"Платёж на сумму {message.successful_payment.total_amount // 100} {message.successful_payment.currency} прошел успешно!!!")
    """
@rate_limit(limit=1)
@dp.message_handler(text=['Статистика бота'])
async def statistica(message):
    if message.from_user.id == cfg.owner_id:
        premium = "SELECT * from users where user_status='premium'"
        cursor.execute(premium)
        premium = cursor.fetchall()
        vip = "SELECT * from users where user_status='vip'"
        cursor.execute(vip)
        vip = cursor.fetchall()
        admins = "SELECT * from users where user_status='Admin'"
        cursor.execute(admins)
        admins = cursor.fetchall()
        delux = "SELECT * from users where user_status='delux'"
        cursor.execute(delux)
        delux = cursor.fetchall()
        users = """SELECT * from users"""
        cursor.execute(users)
        records = cursor.fetchall()
        chats = """SELECT * from chats"""
        cursor.execute(chats)
        chats = cursor.fetchall()
        ban_list = """SELECT * from ban_list"""
        cursor.execute(ban_list)
        ban_list = cursor.fetchall()
        await bot.send_message(
                    chat_id=message.chat.id,
    text=
        f"""
<b>👥 Пользователей в боте: </b> <code>{len(records)}</code>
<b>💬 Чатов в которых есть бот: </b><code>{len(chats)} </code>
<b>👮‍♂️ ADMIN's: </b><code>{len(admins)} </code>
<b>⭐️ VIP пользователей: </b><code>{len(vip)} </code>
<b>💎PREMIUM пользователей: </b><code>{len(premium)} </code>
<b>🔥DELUXE пользователей: </b><code>{len(delux)} </code>
<b>⛔️Забаненых пользователей: </b><code>{len(ban_list)} </code>

<b>Версия бота : 2.4.1</b>
    
    """

            ,parse_mode='html')





@rate_limit(limit=1)
@dp.message_handler(commands=['блокировки','Блокировки'], commands_prefix=["!"])
async def statistic2a(message):
    if message.from_user.id == cfg.owner_id:
        try:
            user_id = message.text.split()[1]
            if user_id.isdigit():
                pass
            else:
                await message.reply('‼️ Не хватает аргументов!\nПример: !блокировки id ')
                return
        except:
            await message.reply('‼️  Не хватает аргументов!\nПример: !блокировки id ')
            return

        user_name = cursor.execute(
            "SELECT user_name from users where user_id = ?", (user_id,))
        user_name = cursor.fetchone()
        user_name = user_name[0]

        warn = cursor.execute("SELECT warn FROM users WHERE user_id=? ", (user_id,))
        warn = cursor.fetchone()
        warn = int(warn[0])

        cursor.execute(f'SELECT * from ban_list WHERE user_id={user_id}')
        ban_list = cursor.fetchone()
        if ban_list is None:
            ban_list="НЕТ"
            text=""
        else:
            ban_list = "ДА"
            why = cursor.execute(f"SELECT cause FROM ban_list WHERE user_id={user_id}")
            why = cursor.fetchone()
            why=why[0]

            time1 = cursor.execute(f"SELECT time FROM ban_list WHERE user_id={user_id}")
            time1 = cursor.fetchone()
            time2 = round(int(time1[0]) / 60)
            time3 = round(int(time1[0]) / 60 / 60 / 24)
            text=f'<b>🤷🏻‍♂️ Причина: </b><code>{why} </code>\n<b>⌛️ Время: </b><code>{time2} минут({time3} Дней)</code>'
        await bot.send_message(
            chat_id=message.chat.id,
            text=
            f"""
<a href="tg://user?id={user_id}">{user_name}</a>
<b>⚠️ Warnov: </b> <code>{warn}</code>
<b>🆔 ID: </b><code>{user_id} </code>
<b>⛔ Заблокирован: </b><code>{ban_list} </code>
{text}
    """

            , parse_mode='html')
@rate_limit(limit=1)
@dp.message_handler(commands=['sql'])
async def sql(message: types.Message):

    if message.from_user.id == cfg.owner_id:
        try:
            cursor.execute(message.text[message.text.find(' '):])
            connect.commit()
            a = time.time()
            bot_msg = await message.answer(f'🕘Please wait while me doing SQL request', parse_mode="Markdown")
            if bot_msg:
                b = time.time()
                await bot_msg.edit_text(f"🚀*SQL Запрос был выполнен за {round((b - a) * 1000)} ms*",
                                        parse_mode="Markdown")
        except Exception as e:
            connect.rollback()
            await message.answer(f"❌ Возникла ошибка при изменении\n⚠️ Ошибка: {e}")
    else:
        await message.answer("❌ *Эта команда доступна только создателю бота*",parse_mode="Markdown")

@rate_limit(limit=1)
@dp.message_handler(IsRegister2(),text=['Инфо', 'инфо'])
async def info_user(message: types.Message):

    data = await get_rang(message)
    user_status = str(data[10])
    user_status2 = ''
    name = message.from_user.get_mention(as_html=True)
    if not message.reply_to_message:

        await message.reply("‼️ Эта команда должна быть ответом на сообщение!")
        return

    else:
        user_id = message.reply_to_message.from_user.id
        data = await get_rang(message)
        user_name = str(data[9])

        if user_status == 'premium' or user_status == 'delux' or user_status == 'Rab' or user_status == 'Admin':
            msg = message
            chat_id = message.chat.id

            balance = cursor.execute(
                "SELECT balance from users where user_id = ?", (message.reply_to_message.from_user.id,))
            balance = cursor.fetchone()
            balance = int(balance[0])

            bank = cursor.execute(
                "SELECT bank from users where user_id = ?", (message.reply_to_message.from_user.id,))
            bank = cursor.fetchone()
            bank = int(bank[0])

            rating = cursor.execute(
                "SELECT rating from users where user_id = ?", (message.reply_to_message.from_user.id,))
            rating = cursor.fetchone()
            rating = int(rating[0])

            fantom = cursor.execute(
                "SELECT fantom from users where user_id = ?", (message.reply_to_message.from_user.id,))
            fantom = cursor.fetchone()
            fantom = int(fantom[0])

            level = cursor.execute(
                "SELECT level from users where user_id = ?", (message.reply_to_message.from_user.id,))
            level = cursor.fetchone()
            level = int(level[0])


            work = cursor.execute(
                "SELECT work from users where user_id = ?", (message.reply_to_message.from_user.id,))
            work = cursor.fetchone()
            work = int(work[0])

            energy = cursor.execute(
                "SELECT energy from users where user_id = ?", (message.reply_to_message.from_user.id,))
            energy = cursor.fetchone()
            energy = int(energy[0])

            expe = cursor.execute(
                "SELECT expe from users where user_id = ?", (message.reply_to_message.from_user.id,))
            expe = cursor.fetchone()
            expe = int(expe[0])

            games = cursor.execute(
                "SELECT games from users where user_id = ?", (message.reply_to_message.from_user.id,))
            games = cursor.fetchone()
            games = int(games[0])

            Ecoins = cursor.execute(
                "SELECT ecoins from users where user_id = ?", (message.reply_to_message.from_user.id,))
            Ecoins = cursor.fetchone()
            Ecoins = int(Ecoins[0])


            expe2 = '{:,}'.format(expe).replace(",", ".")

            work_shop = cursor.execute("SELECT work_shop from workshop where user_id = ?",
                                       (message.reply_to_message.from_user.id,))
            work_shop = cursor.fetchone()
            work_shop = int(work_shop[0])

            games2 = '{:,}'.format(games).replace(',', '.')

            Ecoins2 = "{:,}".format(Ecoins).replace(",", ".")


            data2 = await get_property(message.reply_to_message.from_user.id)
            have = str(data2[2])
            yacht = int(data2[3])
            cars = int(data2[4])
            plane = int(data2[5])
            helicopter = int(data2[6])
            house = int(data2[7])
            phone = int(data2[8])
            data3 = await get_rang2(message.reply_to_message.from_user.id)
            Farm = int(data3[35])

            business = cursor.execute(
                "SELECT business from business where user_id = ?", (message.reply_to_message.from_user.id,))
            business = cursor.fetchone()
            business = int(business[0])
            data = await get_rang2(message.reply_to_message.from_user.id)
            register_time = str(data[60])
            register_time2 = register_time.split('.')[0]
            try:
                data = await get_any(message.reply_to_message.from_user.id,table='clan',id2='user_id')
                clan_id = data[3]
                data = await get_any(clan_id, table='clans',id2='clan_id')
                name = data[2]
                data = await get_any(clan_id, table='clans', id2='clan_id')
                type_clan = int(data[4])
                status = cursor.execute("SELECT status FROM clan WHERE user_id=? and clan_id=?",
                                        (message.reply_to_message.from_user.id, clan_id,))
                status = cursor.fetchone()
                status = status[0]
                if status == "SOZD":
                    rang = '👑 Владелец клана'
                if status == "member":
                    rang = '👤 участник '
                if status == "soryk":
                    rang = '👮 Соруководитель '
                if type_clan == 1:
                    type = ' 🔓 Открытый'
                if type_clan == 0:
                    type = '🔒 Закрытый'
                sozd = cursor.execute(f"SELECT user_name FROM clan WHERE status='SOZD' and clan_id=?", (clan_id,))
                sozd = cursor.fetchone()
                sozd = sozd[0]

                data_с = await get_clan(user_id)
                if data_с is None:
                    have_clan = '\n‼️ Он не состоите в клане!'
                if data_с != None:
                    have_clan = f"""
☑️ Название клана: {name}
🤴 Создатель клана: {sozd}
🔶 Ранг в клане: {rang}
🆔 Айди клана: {clan_id}
⚔️ Тип клана: {type}
                                        """
            except:
                have_clan = '\n‼️ Он не состоите в клане!'
            if Farm == 1:
                farm2 = '♻️NVIDIA GeForce GTX 1650'
            if Farm == 2:
                farm2 = '♻️NVIDIA GeForce RTX 3100'
            if Farm == 3:
                farm2 = '♻️NVIDIA GeForce RTX 4100'
            if Farm == 0:
                farm2 = ' '

            if business == 1:
                business2 = '🏪 Ларек'
            if business == 2:
                business2 = '🛍️ Маркет'
            if business == 3:
                business2 = '🍟 Сеть кафешек'
            if business == 4:
                business2 = '🌐 Интернет-агенство '
            if business == 5:
                business2 = '🧥 Ателье'
            if business == 6:
                business2 = '🏠 Сеть ресторанов'
            if business == 7:
                business2 = '💵  Банк'
            if business == 8:
                business2 = '💶 Международный банк'
            if business == 9:
                business2 = '🛌 Порностудия'
            if business == 10:
                business2 = '🏬 Ялан '
            if business == 0:
                business2 = ''
            if work == 0:
                work2 = 'Без работный'
                zp = '0₸ '
            if work == 1:
                work2 = 'Фермер🍎'
                zp = '50.000.000₸ '
            if work == 2:
                work2 = 'Шахтёр⛏'
                zp = '100.000.000₸ '
            if work == 3:
                work2 = 'Строитель🧱'
                zp = ' 500.000.000₸ '
            if work == 4:
                work2 = 'Сантехник🛠'
                zp = '1.000.000.000₸ '
            if work == 5:
                work2 = 'Электрик💡'
                zp = '10.000.000.000₸ '
            if work == 6:
                work2 = 'Пожарник🧯'
                zp = '30.000.000.000₸ '
            if work == 7:
                work2 = 'Официант☕️'
                zp = ' 50.000.000.000 ₸ '
            if work == 8:
                work2 = 'Повар🍰'
                zp = '80.000.000.000₸ '
            if work == 9:
                work2 = 'Полицейский👮‍♂'
                zp = '90.000.000.000₸ '
            if work == 10:
                work2 = 'Доктор👨‍⚕'
                zp = '100.000.000.000₸ '
            if work == 11:
                work2 = 'Педагог👩‍🏫'
                zp = '300.000.000.000₸ '
            if work == 12:
                work2 = 'Пилот✈️'
                zp = '500.000.000.000₸ '
            if work == 13:
                work2 = 'Генерал👨‍✈️'
                zp = '800.000.000.000₸ '
            if work == 14:
                work2 = 'Бизнесмен💍'
                zp = '900.000.000.000₸ '
            if work == 15:
                work2 = 'Программист🖥'
                zp = '1.000.000.000.000₸ '

            # Телефоны
            if phone == 0:
                phone2 = ''
            if phone == 1:
                phone2 = '📱 Телефон: Nokia 3310'
            if phone == 2:
                phone2 = '📱 Телефон: ASUS ZenFone 4'
            if phone == 3:
                phone2 = '📱 Телефон: BQ Aquaris X'
            if phone == 4:
                phone2 = '📱 Телефон: Huawei P40'
            if phone == 5:
                phone2 = '📱 Телефон: Samsung Galaxy S21 Ultra'
            if phone == 6:
                phone2 = '📱 Телефон: Xiaomi Mi 11'
            if phone == 7:
                phone2 = '📱 Телефон: iPhone 11 Pro'
            if phone == 8:
                phone2 = '📱 Телефон: iPhone 12 Pro Max'
            if phone == 9:
                phone2 = '📱 Телефон: Blackberry'
            # Дома
            if house == 0:
                house2 = ''
            if house == 1:
                house2 = '🏠 Дом: Коробка'
            if house == 2:
                house2 = '🏠 Дом: Подвал'
            if house == 3:
                house2 = '🏠 Дом: Сарай'
            if house == 4:
                house2 = '🏠 Дом: Маленький домик'
            if house == 5:
                house2 = '🏠 Дом: Квартира'
            if house == 6:
                house2 = '🏠 Дом: Огромный дом'
            if house == 7:
                house2 = '🏠 Дом: Коттедж'
            if house == 8:
                house2 = '🏠 Дом: Вилла'
            if house == 9:
                house2 = '🏠 Дом: Таунхаус  '
            if house == 10:
                house2 = '🏠 Дом: Небоскрёб'
            if house == 11:
                house2 = '🏠 Дом: плавучий дом '
            if house == 12:
                house2 = '🏠 Дом: Технологичный небосрёб'
            if house == 13:
                house2 = '🏠 Дом: Собственный остров'
            if house == 14:
                house2 = '🏠 Дом: Общежитие '
            if house == 15:
                house2 = '🏠 Дом: Приют '
            if house == 16:
                house2 = '🏠 Дом: Дом престарелых'

            # Вертолёты
            if helicopter == 0:
                helicopter2 = ''
            if helicopter == 1:
                helicopter2 = '🚁 Вертолёт: Воздушный шар'
            if helicopter == 2:
                helicopter2 = '🚁 Вертолёт: RotorWay Exec 162F'
            if helicopter == 3:
                helicopter2 = '🚁 Вертолёт: Robinson R44'
            if helicopter == 4:
                helicopter2 = '🚁 Вертолёт: Hiller UH-12C'
            if helicopter == 5:
                helicopter2 = '🚁 Вертолёт: AW119 Koala'
            if helicopter == 6:
                helicopter2 = '🚁 Вертолёт: MBB BK 117'
            if helicopter == 7:
                helicopter2 = '🚁 Вертолёт: Eurocopter EC130'
            if helicopter == 8:
                helicopter2 = '🚁 Вертолёт: Leonardo AW109 Power'
            if helicopter == 9:
                helicopter2 = '🚁 Вертолёт: Sikorsky S-76'
            if helicopter == 10:
                helicopter2 = '🚁 Вертолёт: Bell 429WLG'
            if helicopter == 11:
                helicopter2 = '🚁 Вертолёт: NHI NH90'
            if helicopter == 12:
                helicopter2 = '🚁 Вертолёт: Kazan Mi-35M'
            if helicopter == 13:
                helicopter2 = '🚁 Вертолёт: Bell V-22 Osprey'
            # Самолёты
            if plane == 0:
                plane2 = ''
            if plane == 1:
                plane2 = '✈️ Самолёт: Параплан'
            if plane == 2:
                plane2 = '✈️ Самолёт: АН-2'
            if plane == 3:
                plane2 = '✈️ Самолёт: Cessna-172E'
            if plane == 4:
                plane2 = '✈️ Самолёт: BRM NG-5'
            if plane == 5:
                plane2 = '✈️ Самолёт: Cessna T210'
            if plane == 6:
                plane2 = '✈️ Самолёт: Beechcraft 1900D'
            if plane == 7:
                plane2 = '✈️ Самолёт: Cessna 550'
            if plane == 8:
                plane2 = '✈️ Самолёт: Hawker 4000'
            if plane == 9:
                plane2 = '✈️ Самолёт: Learjet 31'
            if plane == 10:
                plane2 = '✈️ Самолёт: Airbus A318'
            if plane == 11:
                plane2 = '✈️ Самолёт: F-35A'
            if plane == 12:
                plane2 = '✈️ Самолёт: Boeing 747-430'
            if plane == 13:
                plane2 = '✈️ Самолёт: C-17A Globemaster III'
            if plane == 14:
                plane2 = '✈️ Самолёт: F-22 Raptor'
            if plane == 15:
                plane2 = '✈️ Самолёт: Airbus 380 Custom'
            if plane == 16:
                plane2 = '✈️ Самолёт: B-2 Spirit Stealth Bomber'
            # Машины
            if cars == 0:
                cars2 = ''
            if cars == 1:
                cars2 = '🚗 Машина: Самокат'
            if cars == 2:
                cars2 = '🚗 Машина: Велосипед'
            if cars == 3:
                cars2 = '🚗 Машина: Гироскутер'
            if cars == 4:
                cars2 = '🚗 Машина: Сегвей'
            if cars == 5:
                cars2 = '🚗 Машина: Мопед'
            if cars == 6:
                cars2 = '🚗 Машина: Мотоцикл'
            if cars == 7:
                cars2 = '🚗 Машина: ВАЗ 2109'
            if cars == 8:
                cars2 = '🚗 Машина: Квадроцикл'
            if cars == 9:
                cars2 = '🚗 Машина: Багги'
            if cars == 10:
                cars2 = '🚗 Машина: Вездеход'
            if cars == 11:
                cars2 = '🚗 Машина: Лада Xray'
            if cars == 12:
                cars2 = '🚗 Машина: Audi Q7'
            if cars == 13:
                cars2 = '🚗 Машина: BMW X6'
            if cars == 14:
                cars2 = '🚗 Машина: Toyota FT-HS'
            if cars == 15:
                cars2 = '🚗 Машина: BMW Z4 M'
            if cars == 16:
                cars2 = '🚗 Машина: Subaru WRX STI'
            if cars == 17:
                cars2 = '🚗 Машина: Lamborghini Veneno'
            if cars == 18:
                cars2 = '🚗 Машина: Tesla Roadster'
            if cars == 19:
                cars2 = '🚗 Машина: Yamaha YZF R6'
            if cars == 20:
                cars2 = '🚗 Машина: Bugatti Chiron'
            if cars == 21:
                cars2 = '🚗 Машина: Thrust SSC'
            if cars == 22:
                cars2 = '🚗 Машина: Ferrari LaFerrari'
            if cars == 23:
                cars2 = '🚗 Машина: Koenigsegg Regear'
            if cars == 24:
                cars2 = '🚗 Машина: Tesla Semi'
            if cars == 25:
                cars2 = '🚗 Машина: Venom GT'
            if cars == 26:
                cars2 = '🚗 Машина: Rolls-Royce'
            # Яхты
            if yacht == 0:
                yacht2 = ''
            if yacht == 1:
                yacht2 = '🛥 Яхта: Ванна'
            if yacht == 2:
                yacht2 = '🛥 Яхта: Nauticat 331'
            if yacht == 3:
                yacht2 = '🛥 Яхта: Nordhavn 56 MS'
            if yacht == 4:
                yacht2 = '🛥 Яхта: Princess 60'
            if yacht == 5:
                yacht2 = '🛥 Яхта: Bayliner 288'
            if yacht == 6:
                yacht2 = '🛥 Яхта: Dominator 40M'
            if yacht == 7:
                yacht2 = '🛥 Яхта: Sessa Marine C42'
            if yacht == 8:
                yacht2 = '🛥 Яхта: Wider 150'
            if yacht == 9:
                yacht2 = '🛥 Яхта: Palmer Johnson 42M SuperSport'
            if yacht == 10:
                yacht2 = '🛥 Яхта: Serene'
            if yacht == 11:
                yacht2 = '🛥 Яхта: Dubai'
            if yacht == 12:
                yacht2 = '🛥 Яхта: Azzam'
            if yacht == 13:
                yacht2 = '🛥 Яхта: Streets of Monaco'

            if have == 'off':
                have2 = '\n‼️  У него нету имущества!'

            if have == 'on':
                have2 = f"""
📦 Имущество:
🛥 Яхта ›{yacht2}
🚘 Машина ›{cars2}
✈ Самолет ›{plane2}
🚁 Вертолет ›{helicopter2}
🏚 Дом ›{house2}
📱 Телефон ›{phone2}
                            """
            balance3=transform(balance)

            rating3 = '{:,}'.format(rating).replace(',', '.')
            bank3 = '{:,}'.format(bank).replace(',', '.')
            fantom3 = '{:,}'.format(fantom).replace(',', '.')
            user_status2=status_users(message.reply_to_message.from_user.id)


            await bot.send_message(message.chat.id,
                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, профиль:\n🔎 ID: <code>{user_id}</code>\n📇 Статус: {user_status2} \n💰 Баланс: {balance3}₸ \n🏦 В банке: {bank3}₸ \n💠 Фантомов: {fantom3}\n🍭 Конфет в корзинке : {Ecoins2} 🍭\n📈 Вакансия: {work2}\n💵 Зарплата: {zp}\n👑 Рейтинг: {rating3}\n🎮 Игр: {games2}\n⚡️ Энергия: {energy}\n📊 Уровень: {level}\n♻️ Ферма: {farm2}\n🏬 Бизнес: {business2}\n➰➰➰➰➰➰➰➰➰➰{have2}\n➰➰➰➰➰➰➰➰➰➰{have_clan}\n📅 Дата регистрации: {register_time2}',
                                   parse_mode='html')
        else:
            await bot.send_message(message.chat.id,
                                   f'{name}, Доступ к данной команде ограничен. Для покупки введите Донат',
                                   parse_mode='html')

@rate_limit(limit=1)
@dp.message_handler(IsRegister2(),text=['.ид'])
async def info_us(message: types.Message):
    if message.forward_date != None:
        return
    if not message.reply_to_message:
        await message.reply("‼️ Эта команда должна быть ответом на сообщение!")
        return
    else:
        name = message.from_user.get_mention(as_html=True)
        user_id = message.reply_to_message.from_user.id
        data = await get_rang2(message.reply_to_message.from_user.id)
        user_name = str(data[9])

        await bot.send_message(message.chat.id, f'''
        {name}, информация о игроке:
    
👫Ник: {user_name}
🔎ID:  <code>{user_id}</code>
            ''', parse_mode='html')

@rate_limit(limit=1)
@dp.message_handler(commands=['info_idb'])
async def start_cmd(message):

    if message.forward_date != None:
        return

    data = await get_rang(message)
    user_status = str(data[10])
    user_status2 = ''
    name = message.from_user.get_mention(as_html=True)

    try:
        reply_user_id = message.text.split()[1]
        if reply_user_id.isdigit():
            pass
        else:
            await message.reply('‼️ Не хватает аргументов!\nПример:/info_idb id ')
            return
    except:
        await message.reply('‼️  Не хватает аргументов!\nПример:\n/info_idb id ')
        return

    if user_status == 'premium' or user_status == 'delux' or user_status == 'Rab' or user_status == 'Admin':

        user_name = cursor.execute(
            "SELECT user_name from users where user_id = ?", (reply_user_id,))
        user_name = cursor.fetchone()
        user_name=user_name[0]
        user_id = reply_user_id
        msg = message
        chat_id = message.chat.id

        balance =cursor.execute(
            "SELECT balance from users where user_id = ?", (reply_user_id,))
        balance = cursor.fetchone()
        balance = int(balance[0])
        bank =cursor.execute(
            "SELECT bank from users where user_id = ?", (reply_user_id,))
        bank = cursor.fetchone()
        bank = int(bank[0])
        rating =cursor.execute(
            "SELECT rating from users where user_id = ?", (reply_user_id,))
        rating = cursor.fetchone()
        rating = int(rating[0])
        fantom = cursor.execute(
            "SELECT fantom from users where user_id = ?", (reply_user_id,))
        fantom = cursor.fetchone()
        fantom = int(fantom[0])
        level = cursor.execute(
            "SELECT level from users where user_id = ?", (reply_user_id,))
        level = cursor.fetchone()
        level = int(level[0])
        work = cursor.execute(
            "SELECT work from users where user_id = ?", (reply_user_id,))
        work = cursor.fetchone()
        work = int(work[0])
        energy =cursor.execute(
            "SELECT energy from users where user_id = ?", (reply_user_id,))
        energy = cursor.fetchone()
        energy=int(energy[0])
        expe = cursor.execute(
            "SELECT expe from users where user_id = ?", (reply_user_id,))
        expe = cursor.fetchone()
        games =cursor.execute(
            "SELECT games from users where user_id = ?", (reply_user_id,))
        games = cursor.fetchone()
        Ecoins =cursor.execute(
            "SELECT ecoins from users where user_id = ?", (reply_user_id,))
        Ecoins = cursor.fetchone()
        expe2 = '{:,}'.format(int(expe[0])).replace(",", ".")

        work_shop = cursor.execute("SELECT work_shop from workshop where user_id = ?",
                                   (reply_user_id,))
        work_shop = cursor.fetchone()
        work_shop = int(work_shop[0])

        games2 = '{:,}'.format(int(games[0])).replace(',', '.')

        Ecoins2 = "{:,}".format(int(Ecoins[0])).replace(",", ".")

        data2 = await get_property(reply_user_id)
        have = str(data2[2])
        yacht = int(data2[3])
        cars = int(data2[4])
        plane = int(data2[5])
        helicopter = int(data2[6])
        house = int(data2[7])
        phone = int(data2[8])
        data = await get_rang2(reply_user_id)
        Farm = int(data[35])

        business = cursor.execute(
            "SELECT business from business where user_id = ?", (reply_user_id,))
        business = cursor.fetchone()
        business = int(business[0])
        register_time = cursor.execute(
            "SELECT time_register from users where user_id = ?", (reply_user_id,))
        register_time = cursor.fetchone()
        register_time=str(register_time[0])
        register_time2=register_time.split('.')[0]
        try:
            data = await get_any(reply_user_id, table='clan', id2='user_id')
            clan_id = data[3]
            data = await get_any(clan_id, table='clans', id2='clan_id')
            name = data[2]
            type_clan = int(data[4])

            status = cursor.execute("SELECT status FROM clan WHERE user_id=? and clan_id=?",
                                    (reply_user_id, clan_id,))
            status = cursor.fetchone()
            status = status[0]
            if status == "SOZD":
                rang = '👑 Владелец клана'
            if status == "member":
                rang = '👤 участник '
            if status == "soryk":
                rang = '👮 Соруководитель '
            if type_clan == 1:
                type = ' 🔓 Открытый'
            if type_clan == 0:
                type = '🔒 Закрытый'
            sozd = cursor.execute(f"SELECT user_name FROM clan WHERE status='SOZD' and clan_id=?", (clan_id,))
            sozd = cursor.fetchone()
            sozd = sozd[0]

            data_с = await get_clan(reply_user_id)
            if data_с is None:
                have_clan = '\n‼️ Он не состоите в клане!'
            if data_с != None:
                have_clan = f"""
☑️ Название клана: {name}
🤴 Создатель клана: {sozd}
🔶 Ранг в клане: {rang}
🆔 Айди клана: {clan_id}
⚔️ Тип клана: {type}
                                                """
        except:
            have_clan = '\n‼️ Он не состоите в клане!'
        if Farm == 1:
            farm2 = '♻️NVIDIA GeForce GTX 1650'
        if Farm == 2:
            farm2 = '♻️NVIDIA GeForce RTX 3100'
        if Farm == 3:
            farm2 = '♻️NVIDIA GeForce RTX 4100'
        if Farm == 0:
            farm2 = 'У него нету майнинг фермы'

        if business == 1:
            business2 = '🏪 Ларек'
        if business == 2:
            business2 = '🛍️ Маркет'
        if business == 3:
            business2 = '🍟 Сеть кафешек'
        if business == 4:
            business2 = '🌐 Интернет-агенство '
        if business == 5:
            business2 = '🧥 Ателье'
        if business == 6:
            business2 = '🏠 Сеть ресторанов'
        if business == 7:
            business2 = '💵  Банк'
        if business == 8:
            business2 = '💶 Международный банк'
        if business == 9:
            business2 = '🛌 Порностудия'
        if business == 10:
            business2 = '🏬 Ялан '
        if business == 0:
            business2 = 'У него нету бизнеса'
        if work == 0:
            work2 = 'Без работный'
            zp = '0₸ '
        if work == 1:
            work2 = 'Фермер🍎'
            zp = '50.000.000₸ '
        if work == 2:
            work2 = 'Шахтёр⛏'
            zp = '100.000.000₸ '
        if work == 3:
            work2 = 'Строитель🧱'
            zp = ' 500.000.000₸ '
        if work == 4:
            work2 = 'Сантехник🛠'
            zp = '1.000.000.000₸ '
        if work == 5:
            work2 = 'Электрик💡'
            zp = '10.000.000.000₸ '
        if work == 6:
            work2 = 'Пожарник🧯'
            zp = '30.000.000.000₸ '
        if work == 7:
            work2 = 'Официант☕️'
            zp = ' 50.000.000.000 ₸ '
        if work == 8:
            work2 = 'Повар🍰'
            zp = '80.000.000.000₸ '
        if work == 9:
            work2 = 'Полицейский👮‍♂'
            zp = '90.000.000.000₸ '
        if work == 10:
            work2 = 'Доктор👨‍⚕'
            zp = '100.000.000.000₸ '
        if work == 11:
            work2 = 'Педагог👩‍🏫'
            zp = '300.000.000.000₸ '
        if work == 12:
            work2 = 'Пилот✈️'
            zp = '500.000.000.000₸ '
        if work == 13:
            work2 = 'Генерал👨‍✈️'
            zp = '800.000.000.000₸ '
        if work == 14:
            work2 = 'Бизнесмен💍'
            zp = '900.000.000.000₸ '
        if work == 15:
            work2 = 'Программист🖥'
            zp = '1.000.000.000.000₸ '

        # Телефоны
        if phone == 0:
            phone2 = ''
        if phone == 1:
            phone2 = '📱 Телефон: Nokia 3310'
        if phone == 2:
            phone2 = '📱 Телефон: ASUS ZenFone 4'
        if phone == 3:
            phone2 = '📱 Телефон: BQ Aquaris X'
        if phone == 4:
            phone2 = '📱 Телефон: Huawei P40'
        if phone == 5:
            phone2 = '📱 Телефон: Samsung Galaxy S21 Ultra'
        if phone == 6:
            phone2 = '📱 Телефон: Xiaomi Mi 11'
        if phone == 7:
            phone2 = '📱 Телефон: iPhone 11 Pro'
        if phone == 8:
            phone2 = '📱 Телефон: iPhone 12 Pro Max'
        if phone == 9:
            phone2 = '📱 Телефон: Blackberry'
        # Дома
        if house == 0:
            house2 = ''
        if house == 1:
            house2 = '🏠 Дом: Коробка'
        if house == 2:
            house2 = '🏠 Дом: Подвал'
        if house == 3:
            house2 = '🏠 Дом: Сарай'
        if house == 4:
            house2 = '🏠 Дом: Маленький домик'
        if house == 5:
            house2 = '🏠 Дом: Квартира'
        if house == 6:
            house2 = '🏠 Дом: Огромный дом'
        if house == 7:
            house2 = '🏠 Дом: Коттедж'
        if house == 8:
            house2 = '🏠 Дом: Вилла'
        if house == 9:
            house2 = '🏠 Дом: Таунхаус  '
        if house == 10:
            house2 = '🏠 Дом: Небоскрёб'
        if house == 11:
            house2 = '🏠 Дом: плавучий дом '
        if house == 12:
            house2 = '🏠 Дом: Технологичный небосрёб'
        if house == 13:
            house2 = '🏠 Дом: Собственный остров'
        if house == 14:
            house2 = '🏠 Дом: Общежитие '
        if house == 15:
            house2 = '🏠 Дом: Приют '
        if house == 16:
            house2 = '🏠 Дом: Дом престарелых'

        # Вертолёты
        if helicopter == 0:
            helicopter2 = ''
        if helicopter == 1:
            helicopter2 = '🚁 Вертолёт: Воздушный шар'
        if helicopter == 2:
            helicopter2 = '🚁 Вертолёт: RotorWay Exec 162F'
        if helicopter == 3:
            helicopter2 = '🚁 Вертолёт: Robinson R44'
        if helicopter == 4:
            helicopter2 = '🚁 Вертолёт: Hiller UH-12C'
        if helicopter == 5:
            helicopter2 = '🚁 Вертолёт: AW119 Koala'
        if helicopter == 6:
            helicopter2 = '🚁 Вертолёт: MBB BK 117'
        if helicopter == 7:
            helicopter2 = '🚁 Вертолёт: Eurocopter EC130'
        if helicopter == 8:
            helicopter2 = '🚁 Вертолёт: Leonardo AW109 Power'
        if helicopter == 9:
            helicopter2 = '🚁 Вертолёт: Sikorsky S-76'
        if helicopter == 10:
            helicopter2 = '🚁 Вертолёт: Bell 429WLG'
        if helicopter == 11:
            helicopter2 = '🚁 Вертолёт: NHI NH90'
        if helicopter == 12:
            helicopter2 = '🚁 Вертолёт: Kazan Mi-35M'
        if helicopter == 13:
            helicopter2 = '🚁 Вертолёт: Bell V-22 Osprey'
        # Самолёты
        if plane == 0:
            plane2 = ''
        if plane == 1:
            plane2 = '✈️ Самолёт: Параплан'
        if plane == 2:
            plane2 = '✈️ Самолёт: АН-2'
        if plane == 3:
            plane2 = '✈️ Самолёт: Cessna-172E'
        if plane == 4:
            plane2 = '✈️ Самолёт: BRM NG-5'
        if plane == 5:
            plane2 = '✈️ Самолёт: Cessna T210'
        if plane == 6:
            plane2 = '✈️ Самолёт: Beechcraft 1900D'
        if plane == 7:
            plane2 = '✈️ Самолёт: Cessna 550'
        if plane == 8:
            plane2 = '✈️ Самолёт: Hawker 4000'
        if plane == 9:
            plane2 = '✈️ Самолёт: Learjet 31'
        if plane == 10:
            plane2 = '✈️ Самолёт: Airbus A318'
        if plane == 11:
            plane2 = '✈️ Самолёт: F-35A'
        if plane == 12:
            plane2 = '✈️ Самолёт: Boeing 747-430'
        if plane == 13:
            plane2 = '✈️ Самолёт: C-17A Globemaster III'
        if plane == 14:
            plane2 = '✈️ Самолёт: F-22 Raptor'
        if plane == 15:
            plane2 = '✈️ Самолёт: Airbus 380 Custom'
        if plane == 16:
            plane2 = '✈️ Самолёт: B-2 Spirit Stealth Bomber'
        # Машины
        if cars == 0:
            cars2 = ''
        if cars == 1:
            cars2 = '🚗 Машина: Самокат'
        if cars == 2:
            cars2 = '🚗 Машина: Велосипед'
        if cars == 3:
            cars2 = '🚗 Машина: Гироскутер'
        if cars == 4:
            cars2 = '🚗 Машина: Сегвей'
        if cars == 5:
            cars2 = '🚗 Машина: Мопед'
        if cars == 6:
            cars2 = '🚗 Машина: Мотоцикл'
        if cars == 7:
            cars2 = '🚗 Машина: ВАЗ 2109'
        if cars == 8:
            cars2 = '🚗 Машина: Квадроцикл'
        if cars == 9:
            cars2 = '🚗 Машина: Багги'
        if cars == 10:
            cars2 = '🚗 Машина: Вездеход'
        if cars == 11:
            cars2 = '🚗 Машина: Лада Xray'
        if cars == 12:
            cars2 = '🚗 Машина: Audi Q7'
        if cars == 13:
            cars2 = '🚗 Машина: BMW X6'
        if cars == 14:
            cars2 = '🚗 Машина: Toyota FT-HS'
        if cars == 15:
            cars2 = '🚗 Машина: BMW Z4 M'
        if cars == 16:
            cars2 = '🚗 Машина: Subaru WRX STI'
        if cars == 17:
            cars2 = '🚗 Машина: Lamborghini Veneno'
        if cars == 18:
            cars2 = '🚗 Машина: Tesla Roadster'
        if cars == 19:
            cars2 = '🚗 Машина: Yamaha YZF R6'
        if cars == 20:
            cars2 = '🚗 Машина: Bugatti Chiron'
        if cars == 21:
            cars2 = '🚗 Машина: Thrust SSC'
        if cars == 22:
            cars2 = '🚗 Машина: Ferrari LaFerrari'
        if cars == 23:
            cars2 = '🚗 Машина: Koenigsegg Regear'
        if cars == 24:
            cars2 = '🚗 Машина: Tesla Semi'
        if cars == 25:
            cars2 = '🚗 Машина: Venom GT'
        if cars == 26:
            cars2 = '🚗 Машина: Rolls-Royce'
        # Яхты
        if yacht == 0:
            yacht2 = ''
        if yacht == 1:
            yacht2 = '🛥 Яхта: Ванна'
        if yacht == 2:
            yacht2 = '🛥 Яхта: Nauticat 331'
        if yacht == 3:
            yacht2 = '🛥 Яхта: Nordhavn 56 MS'
        if yacht == 4:
            yacht2 = '🛥 Яхта: Princess 60'
        if yacht == 5:
            yacht2 = '🛥 Яхта: Bayliner 288'
        if yacht == 6:
            yacht2 = '🛥 Яхта: Dominator 40M'
        if yacht == 7:
            yacht2 = '🛥 Яхта: Sessa Marine C42'
        if yacht == 8:
            yacht2 = '🛥 Яхта: Wider 150'
        if yacht == 9:
            yacht2 = '🛥 Яхта: Palmer Johnson 42M SuperSport'
        if yacht == 10:
            yacht2 = '🛥 Яхта: Serene'
        if yacht == 11:
            yacht2 = '🛥 Яхта: Dubai'
        if yacht == 12:
            yacht2 = '🛥 Яхта: Azzam'
        if yacht == 13:
            yacht2 = '🛥 Яхта: Streets of Monaco'

        if have == 'off':
            have2 = '\n‼️  У него нету имущества!'

        if have == 'on':
            have2 = f"""
📦 Имущество:
🛥 Яхта ›{yacht2}
🚘 Машина ›{cars2}
✈ Самолет ›{plane2}
🚁 Вертолет ›{helicopter2}
🏚 Дом ›{house2}
📱 Телефон ›{phone2}
                                    """
        balance3=transform(balance)

        rating3 = '{:,}'.format(rating).replace(',', '.')
        bank3 = '{:,}'.format(bank).replace(',', '.')
        fantom3 = '{:,}'.format(fantom).replace(',', '.')
        user_status2=status_users(reply_user_id)

        await bot.send_message(message.chat.id,
                               f'Профиль <a href="tg://user?id={user_id}">{user_name}</a>:\n🔎 ID: <code>{user_id}</code>\n📇 Статус: {user_status2} \n💰 Баланс: {balance3}₸ \n🏦 В банке: {bank3}₸ \n💠 Фантомов: {fantom3}\n🍭 Конфет в корзинке : {Ecoins2} 🍭\n📈 Вакансия: {work2}\n💵 Зарплата: {zp}\n👑 Рейтинг: {rating3}\n🎮 Игр: {games2}\n⚡️ Энергия: {energy}\n📊 Уровень: {level}\n♻️ Ферма: {farm2}\n🏬 Бизнес: {business2}\n➰➰➰➰➰➰➰➰➰➰{have2}\n➰➰➰➰➰➰➰➰➰➰{have_clan}\n📅 Дата регистрации: {register_time2}',
                               parse_mode='html')
    else:
        pass

@rate_limit(limit=1)
@dp.message_handler(commands=['ping', 'пинг'], commands_prefix=["/", "!"])
async def ping(message: types.Message):
    if message.forward_date != None:
        return
    a = time.time()
    bot_msg = await message.answer(f'⚙ Проверка пинга....')
    if bot_msg:
        b = time.time()
        await bot_msg.edit_text(f'🏓 Пинг: {round((b - a) * 1000)} ms')

@rate_limit(limit=1)
@dp.message_handler(lambda t: t.text.startswith("Шанс"))
async def fff(message: types.Message):
    h = ["37%", "20%", "29%", "10%", "100%", "21%,", "22%", "52%", "55%", "2%", "6%", "8%", "7%", "11%", "54%", "45%",
         "21%", "1%", "87%", "0%", "12%", "76%"]
    g = random.choice(h)
    await message.reply(f"""Шанс этого {g} """)

@rate_limit(limit=1)
@dp.message_handler(lambda t: t.text.startswith("Шар"))
async def fff(message: types.Message):
    h = ["Мой ответ - нет", "Мне кажется - да", "Сейчас нельзя предсказать", "Мне кажется - нет", "Знаки говорят - нет",
         "Да", "Нет", "Можешь быть уверен в этом"]
    g = random.choice(h)
    await message.reply(f"""{g} """)

@rate_limit(limit=1)
@dp.message_handler(lambda t: t.text.startswith("Выбери"))
async def fff(message: types.Message):
    h = ["Мне кажется,что 1 вариант лучше", "Однозначно второй", "Однозначно первый", "Второй вариант лучше",
         "Первый вариант лучше"]
    g = random.choice(h)
    await message.reply(f"""{g} """)



@rate_limit(limit=1)
@dp.message_handler(commands=['report'])
async def report(message: types.Message):

    try:
        if message.text == '/report' or not message.reply_to_message:
            await bot.send_message(message.chat.id, '''Вот информация за систему репортов ⛔️

⚠️ Правила по использованию репортов
      1️⃣ Материться, оскорблять кого-либо, проявлять неуважение к администрации и тому подобное.
      2️⃣ Капсить, писать неразборчиво, использовать спам, писать один и тот-же текст несколько раз получивши на него ответ.
      3️⃣ Всячески дразнить администрацию и отвлекать от работы.
      4️⃣ Запрещено интересоваться/писать вещи которые ни коем образом ни относятся к игре
      5️⃣ Запрещена реклама в любом её проявлении
      6️⃣ Запрещено обращаться к своим друзьям администраторам по личным вопросам
      7️⃣ Запрещено клеветать на игроков, обвинять их в нарушениях, которые они не совершали.
      8️⃣ Репорт работает по принципу - Вопрос/Просьба/Жалоба (исключение - Приветствие) и не иначе. Иные формы обращения будут оставаться без ответа и будет выдано наказание.

⚠️ Форма отправки репорта - /report [сообщение]

⛔️ Прошу вас соблюдать правила отправки репорта''')
        else:

            if message.chat.id == cfg.offical_group:
                members = await message.chat.get_member(message.reply_to_message.from_user.id)
                info = await bot.get_chat_member(message.chat.id, message.from_user.id)
                report = message.text.replace('/report ', '')

                send = 0

                try:
                    await bot.send_message(cfg.report_group, f'📬  Репорт по причине: ' + str(
                        report) + f'\n\nhttps://t.me/{message.chat.username}/{message.reply_to_message.message_id}')
                    send = 1
                except:
                    pass


                if send == 0:
                    await bot.send_message(message.chat.id,
                                           '👮  Админы не оповещены, для отправки им репортов надо чтобы они запустили меня в лс!')
                else:
                    await bot.send_message(message.chat.id, '''✅  ваш репорт был успешно отправлен администрации''')
            else:
                await bot.send_message(message.chat.id, '''⛔ Cистема репортов работает только в официальных группах''')
    except:
        pass




###########################################БАЛАНС###########################################
@rate_limit(limit=1)
@dp.message_handler(IsBot2())
async def prof_user(message: types.Message):
    msg=message
    if message.chat.type != 'private':
        chat_name = message.chat.title
        cursor.execute("SELECT chat_name FROM chats WHERE chat_id=?", (message.chat.id,))
        if cursor.fetchone() is None:

            cursor.execute("INSERT INTO chats VALUES(?, ?, ?);",
                           (chat_name, message.chat.id, 0))
            connect.commit()
        else:
            pass
    pet_name = "name"
    user_id = msg.from_user.id
    user_name = msg.from_user.full_name
    user_status = "Player"
    have = 'off'
    status_block = 'off'
    chat_id = message.chat.id
    referrer_id = None
    cursor.execute(f"SELECT user_id FROM users WHERE user_id = {user_id}")
    user_name = user_name.replace('<', '').replace('>', '')
    if cursor.fetchone() is None:
        cursor.execute(
            "INSERT INTO users VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?,?,?,?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?, ?, ?, ?,?,?,?,?,?,?,?,?);",
            (user_id, 1, 10000, 0, 0, 0, 10, 0, 0, user_name, user_status, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
             pet_name, 0, 0, 0, 0, 0, 0, 0, status_block, 0, 0, 0, 0, 0, 0, 0, 0, 1000000000000, 1, 1000,
             500000000000,
             0, 0, 100000000000, 50000000000, 1, referrer_id, 0, 0, 0, 0, 0, None, 0, 0, 0, 0, datetime.now(), 1, 0,
             0, 0))
        cursor.execute("INSERT INTO property VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?);",
                       (user_id, user_name, have, 0, 0, 0, 0, 0, 0))
        cursor.execute("INSERT INTO mine VALUES(?, ?, ?, ?, ?,  ?, ?, ?, ?, ?);",
                       (user_id, user_name, 0, 0, 0, 0, 0, 0, 0, 0))

        cursor.execute(
            "INSERT INTO workshop VALUES(?, ?, ?, ?);", (user_id, user_name, 0, 0))

        cursor.execute("INSERT INTO ferma VALUES(?, ?,?, ?,?, ?, ?);",
                       (user_id, user_name, 1, 1, 0, 0, 0))

        cursor.execute("INSERT INTO business VALUES(?, ?,?, ?,?, ?);",
                       (user_id, user_name, 0, 0, 1, have))
        connect.commit()
        name1 = message.from_user.get_mention(as_html=True)
        if message.chat.type != 'private':
            await message.reply(
                f' 👋Привет <a href="tg://user?id={user_id}">{user_name}</a> \nЯ бот для игры в различные игры.\nПерейди в лс для получения инструкций в боте',
                reply_markup=help_perexod, parse_mode='html')
        else:
            await message.reply(
                f' 👋 Добро пожаловать {name1}!\n🎳 Я - игровой бот Химера!\n🔮 Во мне довольно много развлекательных команд, которые помогут тебе скоротать время и найти новых друзей ❤️\n‼️  Чтобы узнать все команды введи "Помощь"\nПриятной игры!😊'
                f'\n• Наш чат: t.me/himera_bo1'
                f'\n• Официальный канал: : t.me/himera_news'
                ,
                reply_markup=help_invite, parse_mode='html')
    user_id = message.from_user.id
    name = message.from_user.get_mention(as_html=True)
    status_block = cursor.execute("SELECT status_block from users where user_id = ?",
                                  (message.from_user.id,))
    status_block = cursor.fetchone()
    status_block = str(status_block[0])

    if status_block == 'on':
        if message.chat.type == 'private':

            chat_id = message.chat.id
            data = await get_rang(message)
            user_name = str(data[9])
            user_id = message.from_user.id
            why=cursor.execute(f"SELECT cause FROM ban_list WHERE user_id={user_id}")
            why = cursor.fetchone()
            time1 = cursor.execute(f"SELECT time FROM ban_list WHERE user_id={user_id}")
            time1=cursor.fetchone()
            time1=int(time1[0])  / 60
            await bot.send_message(message.chat.id,
f"""<a href="tg://user?id={user_id}">{user_name}</a> 
Вы были забанены в <b>HimeraBot</b>
Причина :<b> {why[0]}</b>
До : <b>{time1} минут</b>"""
                               ,
                               parse_mode='html')

    else:
        if message.forward_date != None:
            return
        need_seconds = 1.5
        current_time = datetime.now()
        last_datetime = CHAT_BY_DATETIME.get(message.from_user.id)
        CHAT_BY_DATETIME[message.from_user.id] = current_time

        # Если первое сообщение (время не задано)
        if not last_datetime:
            CHAT_BY_DATETIME[message.from_user.id] = current_time
            last_datetime=datetime.fromtimestamp(0)
        if last_datetime:
            # Разница в секундах между текущим временем и временем последнего сообщения
            delta_seconds = (current_time - last_datetime).total_seconds()

            # Осталось ждать секунд перед отправкой
            seconds_left =  int(need_seconds - delta_seconds)
            # Если время ожидания не закончилось
            if seconds_left > 0:
                text = f'🛡️𝙰𝙽𝚃𝙸-𝙵𝙻𝙾𝙾𝙳 ➪ стоит задержка в 1 секунду'
                await message.reply(text)
            else:
                CHAT_BY_DATETIME[message.from_user.id] = current_time

                if message.text.lower() in ["баланс", "Баланс", "Б", "б"]:
                    data = await get_rang(message)
                    user_name = str(data[9])

                    user_id = msg.from_user.id

                    if not message.reply_to_message:
                        msg = message
                        user_id = msg.from_user.id

                        chat_id = message.chat.id
                        data = await get_rang(message)
                        user_name = str(data[9])
                        fantom = cursor.execute(
                            "SELECT fantom from users where user_id = ?", (message.from_user.id,))
                        fantom = cursor.fetchone()
                        fantom = int(fantom[0])
                        fantom2 = '{:,}'.format(fantom).replace(',', '.')
                        balance =cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])
                        bank = cursor.execute(
                            "SELECT bank from users where user_id = ?", (message.from_user.id,))
                        bank = cursor.fetchone()
                        bank = int(bank[0])
                        balance2 = '{:,}'.format(balance).replace(',', '.')
                        bank2 = '{:,}'.format(bank).replace(',', '.')
                        balance2 = '{:,}'.format(balance).replace(',', '.')
                        ecoins =int(data[5])

                        ecoins2 = '{:,}'.format(ecoins).replace(',', '.')
                        player = status_users(message.from_user.id)
                        all_money = bank+balance
                        all_money = round(int(all_money))
                        all_money1 = '{:,}'.format(all_money).replace(',', '.')
                        #photo = open("assets/money.jpg", 'rb')
                        balance3=transform(balance)
                        if ecoins > 0:
                            await bot.send_message(message.chat.id, text=f"""  
{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, данные о ваших средствах
👛 На руках: <code>{balance2}</code>({balance3}) ₸ 
💳 В банке: <code>{bank2}</code> ₸ 
💠 Фантом: <code>{fantom2}</code> 💠
🍭 Конфет в корзинке :<code>{ecoins2}</code> 🍭

💸 Всего средств: <code>{all_money1}</code> ₸ 

📣 Официальный канал: @himera_news
                            """,
                                                 reply_markup=help_bonus,parse_mode='html')
                        else:
                            await bot.send_message(message.chat.id, text=f"""  
{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, данные о ваших средствах
    
👛 На руках: <code>{balance2}</code>({balance3}) ₸ 
💳 В банке: <code>{bank2}</code> ₸ 
💠 Фантом: <code>{fantom2}</code> 💠

💸 Всего средств: <code>{all_money1}</code> ₸ 

📣 Официальный канал: @himera_news
                                            """,
                                                 reply_markup=help_bonus,parse_mode='html')

                    elif message.reply_to_message:

                        message = message
                        user_id2 = message.reply_to_message.from_user.id
                        data = await get_rang2(user_id2)
                        chat_id = message.reply_to_message.chat.id
                        user_name2=data[9]
                        fantom = cursor.execute(
                            "SELECT fantom from users where user_id = ?", (message.reply_to_message.from_user.id,))
                        fantom = cursor.fetchone()
                        fantom = int(fantom[0])
                        fantom2 = '{:,}'.format(fantom).replace(',', '.')
                        balance =cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.reply_to_message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])
                        balance2 = '{:,}'.format(balance).replace(',', '.')
                        bank = cursor.execute(
                            "SELECT bank from users where user_id = ?", (message.reply_to_message.from_user.id,))
                        bank = cursor.fetchone()
                        bank = int(bank[0])
                        bank2 = '{:,}'.format(bank).replace(',', '.')
                        balance2 = '{:,}'.format(balance).replace(',', '.')
                        ecoins = cursor.execute(
                            "SELECT ecoins from users where user_id = ?", (message.reply_to_message.from_user.id,))
                        ecoins = cursor.fetchone()
                        ecoins = int(ecoins[0])
                        ecoins2 = '{:,}'.format(ecoins).replace(',', '.')
                        player = status_users(message.reply_to_message.from_user.id)
                        all_money = bank + balance
                        all_money = round(int(all_money))
                        all_money1 = '{:,}'.format(all_money).replace(',', '.')
                        #photo = open("assets/money.jpg", 'rb')
                        bal = int(data[48])
                        balance3 = transform(balance)
                        if bal == 1:
                            if ecoins > 0:
                                await bot.send_message(message.chat.id,text=f"""  
{player} ➪ <a href="tg://user?id={user_id2}">{user_name2}</a>,  данные о  средствах
👛 На руках: <code>{balance2}</code>({balance3}) ₸ 
💳 В банке: <code>{bank2}</code> ₸ 
💠 Фантом: <code>{fantom2}</code> 💠
🍭 Конфет в корзинке :<code>{ecoins2}</code> 🍭

💸 Всего средств: <code>{all_money1}</code> ₸ 
                                           """,
                                                     reply_markup=help_bonus,parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,text=f"""  
{player} ➪ <a href="tg://user?id={user_id2}">{user_name2}</a>,  данные о средствах
    
👛 На руках: <code>{balance2}</code>({balance3}) ₸ 
💳 В банке: <code>{bank2}</code> ₸ 
💠 Фантом: <code>{fantom2}</code> 💠

💸 Всего средств: <code>{all_money1}</code> ₸ 
                                                           """,
                                                     reply_markup=help_bonus,parse_mode='html')
                        else:
                            await bot.send_message(message.chat.id, f'<a href="tg://user?id={user_id}">{user_name}</a>, Пользователь скрыл баланс', parse_mode='html')
                if message.text.lower() in ["статус", 'лимит', 'лимиты', 'мой статус',]:
                    data = await get_rang(message)
                    user_name = data[9]
                    user_id = msg.from_user.id
                    player = status_users(user_id)
                    limitbank = round(int(data[43]))
                    limit = int(data[40])
                    limitvidach = int(data[46])
                    user_status = str(data[10])


                    if user_status == 'Player':
                        limit=5000000000000-limit
                        limit2 = '{:,}'.format(limit).replace(',', '.')

                        await bot.send_message(message.chat.id,f"""
🔷 Превилигия: {player}

🏦 Лимит банка: 500.000.000.000 ₸
💱 Возможность передать: 5.000.000.000.000 ₸/день

💱 Передано: {limit2}/5.000.000.000.000 ₸                 """,
                                       parse_mode='html')
                    if user_status == 'premium':
                        limit = 20000000000000- limit
                        limit2 = '{:,}'.format(limit).replace(',', '.')

                        await bot.send_message(message.chat.id, f"""
🔷 Превилигия: {player}

➖ Команда: «Валюта» 
➖ Команда: «инфо»

🏦 Лимит банка: 10.000.000.000.000 ₸
💱 Возможность передать: 20.000.000.000.000 ₸/день

💱 Передано: {limit2}/20.000.000.000.000  ₸                """,
                                   parse_mode='html')
                    if user_status == 'vip':
                        limit = 10000000000000 - limit
                        limit2 = '{:,}'.format(limit).replace(',', '.')

                        await bot.send_message(message.chat.id, f"""
🔷 Превилигия: {player}

🏦 Лимит банка: 1.000.000.000.000 ₸
💱 Возможность передать: 10.000.000.000.000 ₸/день

💱 Передано: {limit2}/10.000.000.000.000  ₸                """,
                               parse_mode='html')
                    if user_status == 'delux':
                        limit = 70000000000000 - limit
                        limitvidach=1000000000000 -limitvidach
                        limit2 = '{:,}'.format(limit).replace(',', '.')
                        limitvidach2 = '{:,}'.format(limitvidach).replace(',', '.')
                        await bot.send_message(message.chat.id, f"""
🔷 Превилигия: {player}

➖ Команда: «Валюта» 
➖ Команда: «инфо»
➖ Команда: «выдать [сумма]» до 1.000.000.000.000₸

🏦 Лимит банка: неограничена
💱 Возможность передать: 70.000.000.000.000 ₸/день

💰 Выдано: {limitvidach2} / 1.000.000.000.000 ₸
💱 Передано: {limit2}/ 70.000.000.000.000  ₸                """,
                           parse_mode='html')
                    if user_status == 'Admin':
                        limit = 200000000000000 - limit
                        limitvidach = 10000000000000 - limitvidach
                        limit2 = '{:,}'.format(limit).replace(',', '.')
                        limitvidach2 = '{:,}'.format(limitvidach).replace(',', '.')
                        await bot.send_message(message.chat.id, f"""
🔷 Превилигия: {player}

🏦 Лимит банка: неограничена
💱 Возможность передать: 200.000.000.000.000 ₸/день

💰 Выдано: {limitvidach2} / 10.000.000.000.000 ₸
💱 Передано: {limit2}/ 200.000.000.000.000  ₸                """,
                       parse_mode='html')
                    if user_status == 'Rab':
                        await bot.send_message(message.chat.id,"<b>Лимиты для нищих тебе они не нужны</b>",parse_mode='html')

                if message.text.lower() in ["Приватность", 'приватность']:
                    msg = message
                    chat_id = message.chat.id
                    data = await get_rang(message)
                    user_name = data[9]
                    user_id = msg.from_user.id
                    bal = int(data[48])

                    if bal == 1:
                        cursor.execute("UPDATE users SET bal=0 where user_id = ?",
                                       (message.from_user.id,))
                        await bot.send_message(message.chat.id,
                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, Приватность вкл',
                                               parse_mode='html')
                    else:
                        cursor.execute("UPDATE users SET bal=1 where user_id = ?",
                                       (message.from_user.id,))
                        await bot.send_message(message.chat.id,
                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, Приватность выкл',
                                               parse_mode='html')

                ################################################ПРОФИЛЬ#############################################################
                if message.text.lower() in [ "инфо чат", "Инфо чат"]:
                    if message.chat.type != 'private':
                        chat_id=message.chat.id
                        chat_name = cursor.execute(f"SELECT chat_name FROM chats WHERE chat_id={message.chat.id}")
                        chat_name=cursor.fetchone()

                        if chat_name[0] != message.chat.title:
                            cursor.execute(f"UPDATE chats SET chat_name='{message.chat.title}' WHERE chat_id={message.chat.id}")
                            connect.commit()
                        all_users = await bot.get_chat_member_count(chat_id=chat_id)
                        chat_name = cursor.execute(f"SELECT chat_name FROM chats WHERE chat_id={message.chat.id}")
                        chat_name = cursor.fetchone()
                        balance_chat = cursor.execute(f"SELECT balance FROM chats WHERE chat_id={message.chat.id}")
                        balance_chat = cursor.fetchone()
                        balance_chat2='{:,}'.format(balance_chat[0]).replace(',', '.')
                        await message.answer(f"""
        
📋️ Информация о чате:

├ 📄 Имя чата: {chat_name[0]}
├ 🆔 ID чата: {chat_id}
├ 👥 Всего пользователей: {all_users}
└ 💰 Баланс чата: {balance_chat2}

""")
                    else:
                        await message.answer('‼️ Это команда работает только в группах')
                if message.text.startswith("Чат пополнить"):
                    if message.chat.type != 'private':
                        try:
                            su = msg.text.split()[2]
                            su2 = (su).replace('к', '000')
                            su3 = (su2).replace('м', '000000')
                            su4 = (su3).replace('.', '')
                            su5 = float(su4)
                            summ = int(su5)
                            summ2 = '{:,}'.format(summ).replace(',', '.')
                        except:
                            await message.reply('‼️ Неправильный ввод команды!\nПример: Чат пополнить 1 ')
                            return
                        chat_id = message.chat.id
                        balance_chat = cursor.execute(f"SELECT balance FROM chats WHERE chat_id={message.chat.id}")
                        balance_chat = cursor.fetchone()
                        data = await get_rang(message)
                        user_name = data[9]
                        user_id = message.from_user.id
                        balance = int(data[2])
                        if summ>0:
                            if balance>=summ:
                                cursor.execute(f"UPDATE chats SET balance={summ+int(balance_chat[0])} WHERE chat_id={message.chat.id}")
                                cursor.execute(
                                f"UPDATE users SET balance={balance - summ} WHERE user_id={user_id}")
                                connect.commit()
                                await message.reply(
                                    f'💰 <a href="tg://user?id={user_id}">{user_name}</a> Вы пополнили баланс чата на сумму: {summ2} ₸',
                                    parse_mode='html')
                            else:
                                await message.reply(
                                    f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> недостаточно средств',
                                    parse_mode='html')
                        else:
                            await message.reply(f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> нельзя пополнить отрицательные числа',
                                                parse_mode='html')
                    else:
                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)
                        await bot.send_message(message.chat.id,
                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, Это команда работает только в группе {rloser}',
                                               parse_mode='html')
                if message.text.startswith("Чат снять"):
                    if message.chat.type != 'private':
                        try:
                            su = msg.text.split()[2]
                            su2 = (su).replace('к', '000')
                            su3 = (su2).replace('м', '000000')
                            su4 = (su3).replace('.', '')
                            su5 = float(su4)
                            summ = int(su5)
                            summ2 = '{:,}'.format(summ).replace(',', '.')
                        except:
                            await message.reply('‼️ Неправильный ввод команды!\nПример: Чат снять 1 ')
                            return
                        chat_id = message.chat.id
                        balance_chat = cursor.execute(f"SELECT balance FROM chats WHERE chat_id={message.chat.id}")
                        balance_chat = cursor.fetchone()
                        data = await get_rang(message)
                        user_name = data[9]
                        user_id = message.from_user.id
                        balance = int(data[2])
                        if summ>0:
                            if int(balance_chat[0])>=summ:
                                cursor.execute(f"UPDATE chats SET balance={int(balance_chat[0])-summ} WHERE chat_id={message.chat.id}")
                                cursor.execute(
                                f"UPDATE users SET balance={balance + summ} WHERE user_id={user_id}")
                                connect.commit()
                                await message.reply(
                                    f'💰 <a href="tg://user?id={user_id}">{user_name}</a> Вы сняли с баланса чата в размере: {summ2} ₸',
                                    parse_mode='html')
                            else:
                                await message.reply(
                                    f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> недостаточно средств в чате',
                                    parse_mode='html')
                        else:
                            await message.reply(f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> нельзя снять отрицательные числа',
                                                parse_mode='html')
                    else:
                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)
                        await bot.send_message(message.chat.id,
                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, Это команда работает только в группе {rloser}',
                                               parse_mode='html')
                if message.text.lower() in ["профиль", "Профиль"]:
                    msg = message
                    chat_id = message.chat.id
                    data = await get_rang(message)
                    user_name = data[9]
                    balance = int(data[2])
                    bank = int(data[3])
                    rating = int(data[11])
                    fantom = cursor.execute(
                        "SELECT fantom from users where user_id = ?", (message.from_user.id,))
                    fantom = cursor.fetchone()
                    fantom = int(fantom[0])
                    level = float(data[1])
                    work = int(data[12])
                    energy = int(data[6])
                    expe = int(data[7])
                    games = int(data[8])
                    Ecoins = int(data[5])

                    expe2 = '{:,}'.format(expe).replace(",", ".")

                    work_shop = cursor.execute("SELECT work_shop from workshop where user_id = ?",
                                               (message.from_user.id,))
                    work_shop = cursor.fetchone()
                    work_shop = int(work_shop[0])

                    games2 = '{:,}'.format(games).replace(',', '.')

                    Ecoins2 = "{:,}".format(Ecoins).replace(",", ".")

                    data2 = await get_property(message.from_user.id)
                    have = str(data2[2])
                    yacht = int(data2[3])
                    cars = int(data2[4])
                    plane = int(data2[5])
                    helicopter = int(data2[6])
                    house = int(data2[7])
                    phone = int(data2[8])
                    data3 = await get_rang2(message.from_user.id)
                    Farm = int(data3[35])

                    business = cursor.execute(
                        "SELECT business from business where user_id = ?", (message.from_user.id,))
                    business = cursor.fetchone()
                    business = int(business[0])
                    data = await get_rang2(message.from_user.id)
                    register_time = str(data[60])
                    register_time2 = register_time.split('.')[0]
                    try:
                        data = await get_any(message.from_user.id, table='clan', id2='user_id')
                        clan_id = data[3]
                        data = await get_any(clan_id, table='clans', id2='clan_id')
                        name = data[2]
                        data = await get_any(clan_id, table='clans', id2='clan_id')
                        type_clan = int(data[4])
                        status = cursor.execute("SELECT status FROM clan WHERE user_id=? and clan_id=?",
                                                (user_id, clan_id,))
                        status = cursor.fetchone()
                        status = status[0]
                        if status == "SOZD":
                            rang = '👑 Владелец клана'
                        if status == "member":
                            rang = '👤 участник '
                        if status == "soryk":
                            rang = '👮 Соруководитель '
                        if type_clan == 1:
                            type = ' 🔓 Открытый'
                        if type_clan == 0:
                            type = '🔒 Закрытый'
                        sozd = cursor.execute(f"SELECT user_name FROM clan WHERE status='SOZD' and clan_id=?", (clan_id,))
                        sozd = cursor.fetchone()
                        sozd = sozd[0]

                        data_с = await get_clan(message.from_user.id)
                        if data_с is None:
                            have_clan = '\n‼️ Вы не состоите в клане!'
                        if data_с != None:
                            have_clan = f"""
☑️ Название клана: {name}
🤴 Создатель клана: {sozd}
🔶 Ранг в клане: {rang}
🆔 Айди клана: {clan_id}
⚔️ Тип клана: {type}
                                    """
                    except:
                        have_clan = '\n‼️ Вы не состоите в клане!'
                    if Farm == 1:
                        farm2 = '♻️NVIDIA GeForce GTX 1650'
                    if Farm == 2:
                        farm2 = '♻️NVIDIA GeForce RTX 3100'
                    if Farm == 3:
                        farm2 = '♻️NVIDIA GeForce RTX 4100'
                    if Farm == 0:
                        farm2 = 'У вас нету майнинг фермы'

                    if business == 1:
                        business2 = '🏪 Ларек'
                    if business == 2:
                        business2 = '🛍️ Маркет'
                    if business == 3:
                        business2 = '🍟 Сеть кафешек'
                    if business == 4:
                        business2 = '🌐 Интернет-агенство '
                    if business == 5:
                        business2 = '🧥 Ателье'
                    if business == 6:
                        business2 = '🏠 Сеть ресторанов'
                    if business == 7:
                        business2 = '💵  Банк'
                    if business == 8:
                        business2 = '💶 Международный банк'
                    if business == 9:
                        business2 = '🛌 Порностудия'
                    if business == 10:
                        business2 = '🏬 Ялан '
                    if business == 0:
                        business2 = 'У вас нету бизнеса'
                    if work == 0:
                        work2 = 'Без работный'
                        zp = '0₸ '
                    if work == 1:
                        work2 = 'Фермер🍎'
                        zp = '50.000.000₸ '
                    if work == 2:
                        work2 = 'Шахтёр⛏'
                        zp = '100.000.000₸ '
                    if work == 3:
                        work2 = 'Строитель🧱'
                        zp = ' 500.000.000₸ '
                    if work == 4:
                        work2 = 'Сантехник🛠'
                        zp = '1.000.000.000₸ '
                    if work == 5:
                        work2 = 'Электрик💡'
                        zp = '10.000.000.000₸ '
                    if work == 6:
                        work2 = 'Пожарник🧯'
                        zp = '30.000.000.000₸ '
                    if work == 7:
                        work2 = 'Официант☕️'
                        zp = ' 50.000.000.000 ₸ '
                    if work == 8:
                        work2 = 'Повар🍰'
                        zp = '80.000.000.000₸ '
                    if work == 9:
                        work2 = 'Полицейский👮‍♂'
                        zp = '90.000.000.000₸ '
                    if work == 10:
                        work2 = 'Доктор👨‍⚕'
                        zp = '100.000.000.000₸ '
                    if work == 11:
                        work2 = 'Педагог👩‍🏫'
                        zp = '300.000.000.000₸ '
                    if work == 12:
                        work2 = 'Пилот✈️'
                        zp = '500.000.000.000₸ '
                    if work == 13:
                        work2 = 'Генерал👨‍✈️'
                        zp = '800.000.000.000₸ '
                    if work == 14:
                        work2 = 'Бизнесмен💍'
                        zp = '900.000.000.000₸ '
                    if work == 15:
                        work2 = 'Программист🖥'
                        zp = '1.000.000.000.000₸ '

                    # Телефоны
                    if phone == 0:
                        phone2 = ''
                    if phone == 1:
                        phone2 = '📱 Телефон: Nokia 3310'
                    if phone == 2:
                        phone2 = '📱 Телефон: ASUS ZenFone 4'
                    if phone == 3:
                        phone2 = '📱 Телефон: BQ Aquaris X'
                    if phone == 4:
                        phone2 = '📱 Телефон: Huawei P40'
                    if phone == 5:
                        phone2 = '📱 Телефон: Samsung Galaxy S21 Ultra'
                    if phone == 6:
                        phone2 = '📱 Телефон: Xiaomi Mi 11'
                    if phone == 7:
                        phone2 = '📱 Телефон: iPhone 11 Pro'
                    if phone == 8:
                        phone2 = '📱 Телефон: iPhone 12 Pro Max'
                    if phone == 9:
                        phone2 = '📱 Телефон: Blackberry'
                    # Дома
                    if house == 0:
                        house2 = ''
                    if house == 1:
                        house2 = '🏠 Дом: Коробка'
                    if house == 2:
                        house2 = '🏠 Дом: Подвал'
                    if house == 3:
                        house2 = '🏠 Дом: Сарай'
                    if house == 4:
                        house2 = '🏠 Дом: Маленький домик'
                    if house == 5:
                        house2 = '🏠 Дом: Квартира'
                    if house == 6:
                        house2 = '🏠 Дом: Огромный дом'
                    if house == 7:
                        house2 = '🏠 Дом: Коттедж'
                    if house == 8:
                        house2 = '🏠 Дом: Вилла'
                    if house == 9:
                        house2 = '🏠 Дом: Таунхаус  '
                    if house == 10:
                        house2 = '🏠 Дом: Небоскрёб'
                    if house == 11:
                        house2 = '🏠 Дом: плавучий дом '
                    if house == 12:
                        house2 = '🏠 Дом: Технологичный небосрёб'
                    if house == 13:
                        house2 = '🏠 Дом: Собственный остров'
                    if house == 14:
                        house2 = '🏠 Дом: Общежитие '
                    if house == 15:
                        house2 = '🏠 Дом: Приют '
                    if house == 16:
                        house2 = '🏠 Дом: Дом престарелых'

                    # Вертолёты
                    if helicopter == 0:
                        helicopter2 = ''
                    if helicopter == 1:
                        helicopter2 = '🚁 Вертолёт: Воздушный шар'
                    if helicopter == 2:
                        helicopter2 = '🚁 Вертолёт: RotorWay Exec 162F'
                    if helicopter == 3:
                        helicopter2 = '🚁 Вертолёт: Robinson R44'
                    if helicopter == 4:
                        helicopter2 = '🚁 Вертолёт: Hiller UH-12C'
                    if helicopter == 5:
                        helicopter2 = '🚁 Вертолёт: AW119 Koala'
                    if helicopter == 6:
                        helicopter2 = '🚁 Вертолёт: MBB BK 117'
                    if helicopter == 7:
                        helicopter2 = '🚁 Вертолёт: Eurocopter EC130'
                    if helicopter == 8:
                        helicopter2 = '🚁 Вертолёт: Leonardo AW109 Power'
                    if helicopter == 9:
                        helicopter2 = '🚁 Вертолёт: Sikorsky S-76'
                    if helicopter == 10:
                        helicopter2 = '🚁 Вертолёт: Bell 429WLG'
                    if helicopter == 11:
                        helicopter2 = '🚁 Вертолёт: NHI NH90'
                    if helicopter == 12:
                        helicopter2 = '🚁 Вертолёт: Kazan Mi-35M'
                    if helicopter == 13:
                        helicopter2 = '🚁 Вертолёт: Bell V-22 Osprey'
                    # Самолёты
                    if plane == 0:
                        plane2 = ''
                    if plane == 1:
                        plane2 = '✈️ Самолёт: Параплан'
                    if plane == 2:
                        plane2 = '✈️ Самолёт: АН-2'
                    if plane == 3:
                        plane2 = '✈️ Самолёт: Cessna-172E'
                    if plane == 4:
                        plane2 = '✈️ Самолёт: BRM NG-5'
                    if plane == 5:
                        plane2 = '✈️ Самолёт: Cessna T210'
                    if plane == 6:
                        plane2 = '✈️ Самолёт: Beechcraft 1900D'
                    if plane == 7:
                        plane2 = '✈️ Самолёт: Cessna 550'
                    if plane == 8:
                        plane2 = '✈️ Самолёт: Hawker 4000'
                    if plane == 9:
                        plane2 = '✈️ Самолёт: Learjet 31'
                    if plane == 10:
                        plane2 = '✈️ Самолёт: Airbus A318'
                    if plane == 11:
                        plane2 = '✈️ Самолёт: F-35A'
                    if plane == 12:
                        plane2 = '✈️ Самолёт: Boeing 747-430'
                    if plane == 13:
                        plane2 = '✈️ Самолёт: C-17A Globemaster III'
                    if plane == 14:
                        plane2 = '✈️ Самолёт: F-22 Raptor'
                    if plane == 15:
                        plane2 = '✈️ Самолёт: Airbus 380 Custom'
                    if plane == 16:
                        plane2 = '✈️ Самолёт: B-2 Spirit Stealth Bomber'
                    # Машины
                    if cars == 0:
                        cars2 = ''
                    if cars == 1:
                        cars2 = '🚗 Машина: Самокат'
                    if cars == 2:
                        cars2 = '🚗 Машина: Велосипед'
                    if cars == 3:
                        cars2 = '🚗 Машина: Гироскутер'
                    if cars == 4:
                        cars2 = '🚗 Машина: Сегвей'
                    if cars == 5:
                        cars2 = '🚗 Машина: Мопед'
                    if cars == 6:
                        cars2 = '🚗 Машина: Мотоцикл'
                    if cars == 7:
                        cars2 = '🚗 Машина: ВАЗ 2109'
                    if cars == 8:
                        cars2 = '🚗 Машина: Квадроцикл'
                    if cars == 9:
                        cars2 = '🚗 Машина: Багги'
                    if cars == 10:
                        cars2 = '🚗 Машина: Вездеход'
                    if cars == 11:
                        cars2 = '🚗 Машина: Лада Xray'
                    if cars == 12:
                        cars2 = '🚗 Машина: Audi Q7'
                    if cars == 13:
                        cars2 = '🚗 Машина: BMW X6'
                    if cars == 14:
                        cars2 = '🚗 Машина: Toyota FT-HS'
                    if cars == 15:
                        cars2 = '🚗 Машина: BMW Z4 M'
                    if cars == 16:
                        cars2 = '🚗 Машина: Subaru WRX STI'
                    if cars == 17:
                        cars2 = '🚗 Машина: Lamborghini Veneno'
                    if cars == 18:
                        cars2 = '🚗 Машина: Tesla Roadster'
                    if cars == 19:
                        cars2 = '🚗 Машина: Yamaha YZF R6'
                    if cars == 20:
                        cars2 = '🚗 Машина: Bugatti Chiron'
                    if cars == 21:
                        cars2 = '🚗 Машина: Thrust SSC'
                    if cars == 22:
                        cars2 = '🚗 Машина: Ferrari LaFerrari'
                    if cars == 23:
                        cars2 = '🚗 Машина: Koenigsegg Regear'
                    if cars == 24:
                        cars2 = '🚗 Машина: Tesla Semi'
                    if cars == 25:
                        cars2 = '🚗 Машина: Venom GT'
                    if cars == 26:
                        cars2 = '🚗 Машина: Rolls-Royce'
                    # Яхты
                    if yacht == 0:
                        yacht2 = ''
                    if yacht == 1:
                        yacht2 = '🛥 Яхта: Ванна'
                    if yacht == 2:
                        yacht2 = '🛥 Яхта: Nauticat 331'
                    if yacht == 3:
                        yacht2 = '🛥 Яхта: Nordhavn 56 MS'
                    if yacht == 4:
                        yacht2 = '🛥 Яхта: Princess 60'
                    if yacht == 5:
                        yacht2 = '🛥 Яхта: Bayliner 288'
                    if yacht == 6:
                        yacht2 = '🛥 Яхта: Dominator 40M'
                    if yacht == 7:
                        yacht2 = '🛥 Яхта: Sessa Marine C42'
                    if yacht == 8:
                        yacht2 = '🛥 Яхта: Wider 150'
                    if yacht == 9:
                        yacht2 = '🛥 Яхта: Palmer Johnson 42M SuperSport'
                    if yacht == 10:
                        yacht2 = '🛥 Яхта: Serene'
                    if yacht == 11:
                        yacht2 = '🛥 Яхта: Dubai'
                    if yacht == 12:
                        yacht2 = '🛥 Яхта: Azzam'
                    if yacht == 13:
                        yacht2 = '🛥 Яхта: Streets of Monaco'

                    if have == 'off':
                        have2 = '\n‼️  У вас нету имущества!'

                    if have == 'on':
                        have2 = f"""
📦 Имущество:
🛥 Яхта ›{yacht2}
🚘 Машина ›{cars2}
✈ Самолет ›{plane2}
🚁 Вертолет ›{helicopter2}
🏚 Дом ›{house2}
📱 Телефон ›{phone2}
                                    """

                    balance3 = '{:,}'.format(balance).replace(',', '.')
                    rating3 = '{:,}'.format(rating).replace(',', '.')
                    bank3 = '{:,}'.format(bank).replace(',', '.')
                    fantom3 = '{:,}'.format(fantom).replace(',', '.')
                    user_status2=status_users(user_id)

                    await bot.send_message(message.chat.id,
                                           f'<a href="tg://user?id={user_id}">{user_name}</a>,ваш профиль:\n🔎 ID: <code>{user_id}</code>\n📇 Статус: {user_status2} \n💰 Баланс: {balance3}₸ \n🏦 В банке: {bank3}₸ \n💠 Фантомов: {fantom3}\n🍭 Конфет в корзинке : {Ecoins2} 🍭\n📈 Вакансия: {work2}\n💵 Зарплата: {zp}\n👑 Рейтинг: {rating3}\n🎮 Игр: {games2}\n⚡️ Энергия: {energy}\n📊 Уровень: {level}\n♻️ Ферма: {farm2}\n🏬 Бизнес: {business2}\n➰➰➰➰➰➰➰➰➰➰{have2}\n➰➰➰➰➰➰➰➰➰➰{have_clan}\n📅 Дата регистрации: {register_time2}',
                                           parse_mode='html')
                    ################################################КУРС РУДЫ###############################################################
                if message.text.lower() in ['курс руды', 'Курс руды']:
                    data = await get_rang(message)
                    user_name = str(data[9])
                    user_id = message.from_user.id
                    await bot.send_message(message.chat.id, f'''
                        <a href="tg://user?id={user_id}">{user_name}</a> , курс руды:
⛓ 1 железо - 25.000.000₸ 
🟡 1 золото - 50.000.000₸ 
💎 1 алмаз - 75.000.000₸ 
♒️ 1 аметист - 100.000.000₸ 
💠 1 аквамарин - 125.000.000₸ 
🟢 1 изумруд - 250.000.000₸ 
        
                        ''', parse_mode='html')
                ##############################################ИНВЕНТАРЬ#################################################################
                if message.text.lower() in ['Инвентарь', 'инвентарь']:
                    user_id = message.from_user.id
                    data = await get_any(id=user_id,table='mine',id2='user_id')
                    user_name = str(data[1])
                    iron = int(data[2])
                    gold = int(data[3])
                    diamonds = int(data[4])
                    amethysts = int(data[5])
                    aquamarine = int(data[6])
                    emeralds = int(data[7])

                    await bot.send_message(message.chat.id, f'''
🎒<a href="tg://user?id={user_id}">{user_name}</a>,инвентарь
⛓ Железо: {iron} шт.
🟡 Золото: {gold} шт.
💎 Алмазы: {diamonds} шт.
♒️ Аметисты: {amethysts} шт.
💠 Аквамарин: {aquamarine} шт.
🟢️ Изумруды: {emeralds} шт.
        
                        ''',reply_markup=help_mine, parse_mode='html')

                #######################################БЕСЕДА#############################################
                if message.text.lower() in ['ссылки', 'Ссылки']:
                    data = await get_rang(message)
                    user_name = str(data[9])
                    user_id = message.from_user.id
                    await bot.send_message(message.chat.id,
f'''🔗 | Ссылки по официальным сетей бота:

🗯 | <a href="https://t.me/himera_bo1">Наш общий чатик</a>  там ты можешь:
✨ | Свободно играть в бота
🥂 | Искать пару
🎯 | Находить друзей
💸 | Побеждать в розыгрыше и т.д

🤑 | Обязательно присоединяйся туда!''',
                                           parse_mode='html')
                #######################################РП Команды#########################################
                if message.text.lower() in ['отлизать', 'отлизать'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} отлизал(а)  {reply_name}', parse_mode='html')

                if message.text.lower() in ['Отсосать', 'отсосать'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} отсосал(а)  {reply_name}', parse_mode='html')
                if message.text.lower() in ['Облизать', 'облизать'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} облизал(а) всего  {reply_name}', parse_mode='html')
                if message.text.lower() in ['Шлепнуть', 'шлепнуть'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} шлепнул(а) {reply_name}', parse_mode='html')
                if message.text.lower() in ['Убить', 'убить'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} убил(а) с оружия {reply_name}', parse_mode='html')
                if message.text.lower() in ['Укусить', 'укусить'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} укусил(а) {reply_name}', parse_mode='html')
                if message.text.lower() in ['Ударить', 'ударить'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} ударил(а) по голове  {reply_name}', parse_mode='html')
                if message.text.lower() in ['Уебать', 'уебать'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} жоско уебал(а) по ебалу {reply_name}', parse_mode='html')
                if message.text.lower() in ['Ущепнуть', 'ущепнуть'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} ущепнул(а) {reply_name}', parse_mode='html')
                if message.text.lower() in ['Трахнуть', 'трахнуть'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} занялся(лась) сексом в анал с {reply_name}',
                                           parse_mode='html')
                if message.text.lower() in ['Сжечь', 'сжечь'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} спалил(а) на костре  {reply_name}', parse_mode='html')
                if message.text.lower() in ['Секс', 'секс'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} пошёл(а) заниматься сексом с  {reply_name}',
                                           parse_mode='html')
                if message.text.lower() in ['Расстрелять', 'расстрелять'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} расстрелял(а) на палигоне  {reply_name}',
                                           parse_mode='html')

                if message.text.lower() in ['Покормить', 'покормить'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} покормил(а)  {reply_name}', parse_mode='html')
                if message.text.lower() in ['обнять', 'Обнять'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} обнял(а)  {reply_name}', parse_mode='html')
                if message.text.lower() in ['Пнуть', 'пнуть'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} дал по жопе с ноги  {reply_name}', parse_mode='html')
                if message.text.lower() in ['Дать по лбу', 'дать по лбу'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} дал лычку  {reply_name}', parse_mode='html')
                if message.text.lower() in ['Погладить', 'погладить'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} погладил(а) по голове  {reply_name}', parse_mode='html')
                if message.text.lower() in ['Понюхать', 'понюхать'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} принюхался(лась) к  {reply_name}', parse_mode='html')
                if message.text.lower() in ['Похвалить', 'похвалить'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} похвалил(а)  {reply_name}', parse_mode='html')
                if message.text.lower() in ['Послать нахуй', 'послать нахуй'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} послал(а) нахуй  {reply_name}', parse_mode='html')
                if message.text.lower() in ['Пожать руку', 'пожать руку'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} пожал(а) руку очень крепко  {reply_name}',
                                           parse_mode='html')
                if message.text.lower() in ['Потрогать', 'потрогать'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} потрогал(а)  {reply_name}', parse_mode='html')
                if message.text.lower() in ['Прижать', 'прижать'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} прижал(а) к себе  {reply_name}', parse_mode='html')
                if message.text.lower() in ['Поцеловать', 'поцеловать'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} поцеловал(а)  {reply_name}', parse_mode='html')
                if message.text.lower() in ['Поздравить', 'поздравить'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} поздравил с праздником  {reply_name}', parse_mode='html')
                if message.text.lower() in ['Отдаться', 'отдаться'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} отдался(лась) в кровате  {reply_name}', parse_mode='html')
                if message.text.lower() in ['Отравить', 'отравить'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} отравил(а) ядом  {reply_name}', parse_mode='html')
                if message.text.lower() in ['Обнять', 'Обнять'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} обнял(а) очень крепко  {reply_name}', parse_mode='html')
                if message.text.lower() in ['Лизь', 'Лизь'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} лизнул(а)  {reply_name}', parse_mode='html')
                if message.text.lower() in ['Лизнуть', 'лизнуть'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} лизнуть в щёку  {reply_name}', parse_mode='html')
                if message.text.lower() in ['Кастрировать', 'кастрировать'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} пошёл кастрировать  {reply_name}', parse_mode='html')
                if message.text.lower() in ['Кусь', 'кусь'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} куснул  {reply_name}', parse_mode='html')
                if message.text.lower() in ['Изнасиловать', 'изнасиловать'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} изнасиловал {reply_name}', parse_mode='html')
                if message.text.lower() in ['Извиниться', 'извиниться'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} извинилься перед {reply_name}', parse_mode='html')
                if message.text.lower() in ['Испугать', 'испугать'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} испугал(а) {reply_name}', parse_mode='html')
                if message.text.lower() in ['Дать пять', 'дать пять'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} дал(а) пять {reply_name}', parse_mode='html')
                if message.text.lower() in ['Выебать', 'выебать'] and message.reply_to_message:
                    name = message.from_user.get_mention(as_html=True)
                    reply_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)

                    await bot.send_message(message.chat.id, f'{name} пошел(ла) заниматься интимом с {reply_name}',
                                           parse_mode='html')
                if message.text.lower() in ['Рп Команды', 'рп команды']:
                    name = message.from_user.get_mention(as_html=True)

                    await bot.send_message(message.chat.id, f'''
{name}, вот все доступные РП команды:
1) Выебать
2) Дать пять
3) Испугать
4) Изиниться
5) Извиниться
6) Кусь
7) Кастрировать
8) Лизнуть
9) Лизь
10) Обнять
11) Отравить
12) Отдаться
13) Поздравить
14) Поцеловать
15) Прижать
16) Потрогать
17) Пожать руку
18) Послать нахуй
19) Похвалить
20) Понюхать
21) Погладить
22) Дать по лбу
23) Пнуть
24) Покормить
25) Расстрелять
26) Секс
27) Сжечь
28) Трахнуть
29) Ущепнуть
30) Уебать
31) Ударить
32) Укусить
33) Убить
34) Шлепнуть
35) Куснуть
36) Облизать
37) Отсосать
38) Отлизать
39) обнять
                        ''', parse_mode='html')
                #####################################bonus#################################################
                if message.text.startswith("Бонус"):
                    message = message
                    data = await get_rang(message)
                    user_name = str(data[9])

                    user_id = message.from_user.id
                    await bot.send_message(message.chat.id,
                                           f' {user_name}, Для получения бонуса нажми кнопку ниже',reply_markup=help_bonus2,
                                           parse_mode='html')


                #######################################НИК################################################

                if message.text.startswith("Сменить ник"):
                    data = await get_rang(message)
                    user_name = str(data[9])
                    chat_id = message.chat.id
                    user_id = message.from_user.id
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    try:
                        name = " ".join(message.text.split()[2:])
                    except:
                        await message.reply('‼️  Не хватает аргументов!\nПример: Сменить ник (name) ')
                        return

                    name = name.replace('<', '').replace('>', '')
                    user_status = str(data[10])
                    if user_status == 'vip':
                        if len(name) <= 25 and len(name) >= 4:
                            await bot.send_message(message.chat.id, f'✏️ | {user_name}, вы успешно поменяли свой ник на: {name}!',
                                                   parse_mode='html')
                            cursor.execute(
                                f"UPDATE clan SET user_name ='{name}' WHERE user_id = {user_id}")
                            cursor.execute(
                                f"UPDATE users SET user_name ='{name}' WHERE user_id = {user_id}")
                            connect.commit()
                        else:
                            await bot.send_message(message.chat.id, f'Вы не можете поставить ник больше чем на 25 символов и короче 4 символов.',
                                                   parse_mode='html')
                    elif user_status == 'premium':
                        if len(name) <= 30 and len(name) >= 4:
                            await bot.send_message(message.chat.id, f'✏️ | {user_name}, вы успешно поменяли свой ник на: {name}!',
                                                   parse_mode='html')
                            cursor.execute(
                                f"UPDATE clan SET user_name ='{name}' WHERE user_id = {user_id}")
                            cursor.execute(
                                f"UPDATE users SET user_name ='{name}' WHERE user_id = {user_id}")
                            connect.commit()
                        else:
                            await bot.send_message(message.chat.id, f'Вы не можете поставить ник больше чем на 30 символов и короче 4 символов.',
                                                   parse_mode='html')
                    elif user_status == 'delux':
                        if len(name) <= 40 and len(name) >= 4:
                            await bot.send_message(message.chat.id, f'✏️ | {user_name}, вы успешно поменяли свой ник на: {name}!',
                                                   parse_mode='html')
                            cursor.execute(
                                f"UPDATE clan SET user_name ='{name}' WHERE user_id = {user_id}")
                            cursor.execute(
                                f"UPDATE users SET user_name ='{name}' WHERE user_id = {user_id}")
                            connect.commit()
                        else:
                            await bot.send_message(message.chat.id, f'Вы не можете поставить ник больше чем на 40 символов и короче 4 символов.',
                                                   parse_mode='html')
                    else:
                        if len(name) <= 20 and len(name) >= 4:
                            await bot.send_message(message.chat.id, f'✏️ | {user_name}, вы успешно поменяли свой ник на: {name}!',
                                                   parse_mode='html')
                            cursor.execute(
                                f"UPDATE clan SET user_name ='{name}' WHERE user_id = {user_id}")
                            cursor.execute(
                                f"UPDATE users SET user_name ='{name}' WHERE user_id = {user_id}")
                            connect.commit()
                        else:
                            await bot.send_message(message.chat.id, f'Вы не можете поставить ник больше чем на 20 символов и короче 4 символов.',
                                                   parse_mode='html')
                if message.text.lower() == 'опыт':
                    data = await get_rang(message)
                    expe = int(data[7])
                    user_id = message.from_user.id
                    user_name = str(data[9])
                    photo = open("assets/expe.png", 'rb')
                    await bot.send_photo(message.chat.id, photo=photo, caption=f'<a href="tg://user?id={user_id}">{user_name}</a> Ваш опыт {expe}  🏆 ',
                                         parse_mode='html')
                if message.text.startswith("Купить валюту"):
                    data = await get_rang(message)
                    user_name = str(data[9])
                    user_id = message.from_user.id
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    donat = int(data[5])

                    try:
                        summ = message.text.split()[2]
                    except:
                        await message.reply('‼️  Не хватает аргументов!\nПример: Купить валюту число ')
                        return
                    if summ.isdigit:
                        valut = cursor.execute("SELECT valut FROM kurs")
                        valut = cursor.fetchone()
                        valut = int(valut[0])
                        valut2 = cursor.execute("SELECT valut2 FROM kurs")
                        valut2 = cursor.fetchone()
                        valut2 = int(valut2[0])
                        valut3 = cursor.execute("SELECT valut3 FROM kurs")
                        valut3 = cursor.fetchone()
                        valut3 = int(valut3[0])
                        valut4 = cursor.execute("SELECT valut4 FROM kurs")
                        valut4 = cursor.fetchone()
                        valut4 = int(valut4[0])

                        perevod = '{:,}'.format(valut).replace(',', '.')
                        perevod2 = '{:,}'.format(valut2).replace(',', '.')
                        perevod3 = '{:,}'.format(valut3).replace(',', '.')
                        perevod4 = '{:,}'.format(valut4).replace(',', '.')
                        balance = int(data[2])
                        if summ == "1":
                            price = 50
                            if donat >= price:

                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили  {perevod}',
                                                       parse_mode='html')
                                cursor.execute(
                                    f"UPDATE users SET balance ={balance+valut} WHERE user_id = {user_id}")
                                cursor.execute(
                                    f'UPDATE users SET ecoins = {donat - price}  WHERE user_id = {user_id}')

                                connect.commit()

                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного доната {rloser}',
                                                       parse_mode='html')

                        elif summ == "2":
                            price = 100
                            if donat >= price:

                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили  {perevod2}',
                                                       parse_mode='html')
                                cursor.execute(
                                    f"UPDATE users SET balance ={balance+valut2} WHERE user_id = {user_id}")
                                cursor.execute(
                                    f'UPDATE users SET ecoins = {donat - price}  WHERE user_id = {user_id}')

                                connect.commit()

                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного доната {rloser}',
                                                       parse_mode='html')
                        elif summ == "3":
                            price = 150
                            if donat >= price:

                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили  {perevod3}',
                                                       parse_mode='html')
                                cursor.execute(
                                    f"UPDATE users SET balance ={balance+valut3} WHERE user_id = {user_id}")
                                cursor.execute(
                                    f'UPDATE users SET ecoins = {donat - price}  WHERE user_id = {user_id}')

                                connect.commit()

                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного доната {rloser}',
                                                       parse_mode='html')
                        elif summ == "4":
                            price = 200
                            if donat >= price:

                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили  {perevod4}',
                                                       parse_mode='html')
                                cursor.execute(
                                    f"UPDATE users SET balance ={balance+valut4} WHERE user_id = {user_id}")
                                cursor.execute(
                                    f'UPDATE users SET ecoins = {donat - price}  WHERE user_id = {user_id}')

                                connect.commit()

                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного доната {rloser}',
                                                       parse_mode='html')

                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Введите целое число {rloser}',
                                               parse_mode='html')

                if message.text.startswith("Пополнить"):
                    if message.chat.type == 'private':
                        data = await get_rang(message)
                        user_name = str(data[9])
                        user_id = message.from_user.id
                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)


                        try:
                            summ = int(message.text.split()[1])
                        except :
                            await message.reply('‼️  Не хватает аргументов!\nПример: Пополнить число ')
                            return

                        message_money = int(summ)
                        if message_money >= 2:
                            comment = str(message.from_user.id) + \
                                "_" + str(random.randint(1000, 9999))
                            bill = p2p.bill(amount=message_money,
                                            lifetime=15, comment=comment)
                            add_check(message.from_user.id,
                                      message_money, bill.bill_id)
                            await bot.send_message(message.from_user.id,
                                                   f"Нажмите на ссылку ниже для оплаты счета\nСсылку:{bill.pay_url}\n Указав комментаний:{comment}",
                                                   reply_markup=buy_menu(url=bill.pay_url, bill=bill.bill_id))
                        else:
                            await bot.send_message(message.chat.id,
                                                   f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Минимальная сумма 2 руб{rloser}',
                                                   parse_mode='html')

                    else:
                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)
                        await bot.send_message(message.chat.id,
                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, Пополнить можно только в лс {rloser}',
                                               parse_mode='html')

                ###########################################БИТКОИН########################################
                if message.text.lower() in ['Фантомы', 'фантомы']:
                    data = await get_rang(message)
                    user_name = str(data[9])
                    user_id = message.from_user.id
                    fantom =  int(data[4])
                    fantom2 = '{:,}'.format(fantom).replace(',', '.')
                    photo = open("assets/fantom.jpg", 'rb')
                    await bot.send_photo(message.chat.id, photo=photo, caption=f'<a href="tg://user?id={user_id}">{user_name}</a>, на вашем балансе {fantom2} 💠',
                                         parse_mode='html')
                if message.text.startswith("Продать фантомы"):
                    data = await get_rang(message)
                    user_name = str(data[9])
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    if message.text != 'Продать фантомы':
                        try:
                            fantom_c = int(message.text.split()[2])
                        except:
                            await message.reply('‼️  Не хватает аргументов!\nПример:Продать фантомы число ')
                            return

                        fantom_c = Decimal(fantom_c)

                        balance =int(data[2])
                        fantom = int(data[4])
                        kurs = cursor.execute("SELECT kurs FROM cooldown")
                        kurs = cursor.fetchone()
                        kurs = int(kurs[0])
                        win = ['🙂', '😋', '😄', '🤑', '😃']
                        rwin = random.choice(win)
                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)

                        c = kurs

                        summ = fantom_c * c
                        summ2 = '{:,}'.format(summ).replace(',', '.')

                        if fantom >= fantom_c:
                            if fantom-fantom_c >= 0 and fantom_c > 0:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали {fantom_c} Фантомов за {summ2}₸  {rwin}',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance + summ}  WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET fantom = {fantom - fantom_c}  WHERE user_id = {user_id}')
                                connect.commit()
                                return
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, нельзя продать отрицательное число {rloser}',
                                                       parse_mode='html')
                                return
                        else:
                            await bot.send_message(message.chat.id, f'{name}, У вас нету столько фантомов 💠! {rloser}', parse_mode='html')
                            return
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример продать фантомы 1 {rloser}',
                                               parse_mode='html')
                if message.text.startswith("продать фантомы"):
                    data = await get_rang(message)
                    user_name = str(data[9])
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    if message.text != 'продать фантомы':
                        try:
                            fantom_c = int(message.text.split()[2])
                        except:
                            await message.reply('‼️  Не хватает аргументов!\nПример: Продать фантомы число ')
                            return

                        fantom_c = Decimal(fantom_c)

                        balance = int(data[2])
                        fantom = cursor.execute(
                            "SELECT fantom from users where user_id = ?", (message.from_user.id,))
                        fantom = cursor.fetchone()
                        fantom = int(fantom[0])
                        kurs = cursor.execute("SELECT kurs FROM cooldown")
                        kurs = cursor.fetchone()
                        kurs = int(kurs[0])
                        win = ['🙂', '😋', '😄', '🤑', '😃']
                        rwin = random.choice(win)

                        c = kurs

                        summ = fantom_c * c
                        summ2 = '{:,}'.format(summ).replace(',', '.')

                        if fantom >= fantom_c:
                            if fantom - fantom_c >= 0 and fantom_c > 0:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали {fantom_c} Фантомов за {summ2}₸  {rwin}',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance + summ}  WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET fantom = {fantom - fantom_c}  WHERE user_id = {user_id}')
                                connect.commit()
                                return
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, нельзя продать отрицательное число {rloser}',
                                                       parse_mode='html')
                                return
                        else:
                            await bot.send_message(message.chat.id, f'{name}, недостаточно средств! {rloser}', parse_mode='html')
                            return
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример продать фантомы 1 {rloser}',
                                               parse_mode='html')
                        return

                if message.text.startswith("купить фантомы"):
                    data = await get_rang(message)
                    user_name = str(data[9])
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    if message.text != 'купить фантомы':


                        try:
                            fantom_c = int(message.text.split()[2])
                        except :
                            await message.reply('‼️  Не хватает аргументов!\nПример: купить фантомы число ')
                            return
                        fantom_c = Decimal(fantom_c)
                        balance = int(data[2])
                        fantom =  int(data[4])
                        kurs = cursor.execute("SELECT kurs FROM cooldown")
                        kurs = cursor.fetchone()
                        kurs = int(kurs[0])
                        win = ['🙂', '😋', '😄', '🤑', '😃']
                        rwin = random.choice(win)
                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)

                        c = kurs

                        summ = fantom_c * c
                        summ2 = '{:,}'.format(summ).replace(',', '.')

                        if summ <= balance:
                            if fantom_c > 0:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили {fantom_c} Фантомов за {summ2}₸  {rwin}',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - summ}  WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET fantom = {fantom + fantom_c}  WHERE user_id = {user_id}')
                                connect.commit()
                                return
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, нельзя купить отрицательное число {rloser}',
                                                       parse_mode='html')
                                return
                        else:
                            await bot.send_message(message.chat.id, f'{name}, недостаточно средств! {rloser}', parse_mode='html')
                            return
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример купить фантомы 1 {rloser}',
                                               parse_mode='html')
                        return
                if message.text.startswith("Купить фантомы"):
                    data = await get_rang(message)
                    user_name = str(data[9])
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    if message.text != 'Купить фантомы':
                        try:
                            fantom_c = int(message.text.split()[2])
                        except:
                            await message.reply('‼️  Не хватает аргументов!\nПример: купить фантомы число ')
                            return

                        fantom_c = Decimal(fantom_c)

                        balance = int(data[2])
                        fantom =  int(data[4])
                        kurs = cursor.execute("SELECT kurs FROM cooldown")
                        kurs = cursor.fetchone()
                        kurs = int(kurs[0])
                        win = ['🙂', '😋', '😄', '🤑', '😃']
                        rwin = random.choice(win)
                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)

                        c = kurs

                        summ = fantom_c * c
                        summ2 = '{:,}'.format(summ).replace(',', '.')

                        if summ <= balance:
                            if fantom_c > 0:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили {fantom_c} Фантомов за {summ2}₸  {rwin}',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - summ}  WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET fantom = {fantom + fantom_c}  WHERE user_id = {user_id}')
                                connect.commit()
                                return
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, нельзя купить отрицательное число {rloser}',
                                                       parse_mode='html')
                                return
                        else:
                            await bot.send_message(message.chat.id, f'{name}, недостаточно средств! {rloser}', parse_mode='html')
                            return
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример купить фантомы 1 {rloser}',
                                               parse_mode='html')
                        return
                if message.text.lower() in ['курс фантома', 'Курс фантома']:
                    data = await get_rang(message)
                    user_name = str(data[9])
                    user_id = message.from_user.id
                    kurs = cursor.execute(f'SELECT kurs FROM cooldown')
                    kurs = cursor.fetchone()
                    kurs = int(kurs[0])
                    c2 = '{:,}'.format(kurs).replace(',', '.')
                    photo = open("assets/fantom.jpg", 'rb')
                    await bot.send_photo(message.chat.id, photo=photo, caption=f'<a href="tg://user?id={user_id}">{user_name}</a>, на данный момент курс 1 Фантом состовляет - {c2}💠',
                                         parse_mode='html')
                if message.text.startswith('гонка') or message.text.startswith('Гонка'):
                    data = await get_rang(message)
                    user_name = str(data[9])
                    user_id = message.from_user.id
                    balance = int(data[2])
                    data1 = await get_any(id=user_id,table='property',id2='user_id')
                    cars = int(data1[4])
                    data2 = await get_any(id=user_id, table='cars', id2='user_id')

                    if data2 is None:
                        return await message.reply('‼️  У вас нету машины \n➖ Команда: Купить машину 1-26 ')
                    hp =  int(data2[2])
                    benz =int(data2[3])
                    try:
                        su = message.text.split()[1]
                        su2 = (su).replace('к', '000')
                        su3 = (su2).replace('м', '000000')
                        su4 = (su3).replace('.', '')
                        su5 = float(su4)
                        summ = int(su5)
                        summ3 = summ * 2
                        summ2 = '{:,}'.format(summ)
                        summ4 = '{:,}'.format(summ3)
                    except :
                        await message.reply('‼️  Неправильный ввод команды!\nПример: гонка 1 ')
                        return

                    if cars == 1:
                        cars_name = 'Самокат'

                    if cars == 2:
                        cars_name = 'Велосипед'

                    if cars == 3:
                        cars_name = 'Гироскутер'

                    if cars == 4:
                        cars_name = 'Сегвей'
                    if cars == 5:
                        cars_name = 'Мопед'

                    if cars == 6:
                        cars_name = 'Мотоцикл'

                    if cars == 7:
                        cars_name = 'ВАЗ 2109'

                    if cars == 8:
                        cars_name = 'Квадроцикл'

                    if cars == 9:
                        cars_name = 'Багги'

                    if cars == 10:
                        cars_name = 'Вездеход'

                    if cars == 11:
                        cars_name = 'Лада Xray'

                    if cars == 12:
                        cars_name = 'Audi Q7'

                    if cars == 13:
                        cars_name = 'BMW X6'

                    if cars == 14:
                        cars_name = 'Toyota FT-HS'

                    if cars == 15:
                        cars_name = 'BMW Z4 M'

                    if cars == 16:
                        cars_name = 'Subaru WRX STI'

                    if cars == 17:
                        cars_name = 'Lamborghini Veneno'

                    if cars == 18:
                        cars_name = 'Tesla Roadster'

                    if cars == 19:
                        cars_name = 'Yamaha YZF R6'
                    if cars == 20:
                        cars_name = 'Bugatti Chiron'
                    if cars == 21:
                        cars_name = 'Thrust SSC'
                    if cars == 22:
                        cars_name = 'Ferrari LaFerrari'
                    if cars == 23:
                        cars_name = 'Koenigsegg Regear'
                    if cars == 24:
                        cars_name = 'Tesla Semi'
                    if cars == 25:
                        cars_name = 'Venom GT'
                    if cars == 26:
                        cars_name = 'Rolls-Royce'
                    rx = random.randint(0, 1000)
                    rx2 = random.randint(2, 5)

                    chat_id = message.chat.id
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    if summ <= balance:
                        if cars > 0:
                            if hp > 0:
                                if benz > 0:
                                    if int(rx) in range(0, 800):

                                        await bot.send_message(message.chat.id,
                                                               f"🤵‍♂︄ | Игрок: <a href='tg://user?id={user_id}'>{user_name}</a>\n🏎 | Игра: Гонки\n🚘 | Машина: {cars_name}\n🎟 | Ставка: {summ2}₸\n🧾 | Проигрыш:  {summ2}₸",
                                                               parse_mode='html')
                                        cursor.execute(
                                            f'UPDATE cars SET hp = {hp - rx2} WHERE user_id = {user_id}')
                                        cursor.execute(
                                            f'UPDATE users SET balance = {balance - summ} WHERE user_id = {user_id}')
                                        cursor.execute(
                                            f'UPDATE cars SET benz = {benz - rx2} WHERE user_id = {user_id}')

                                        connect.commit()
                                    if int(rx) in range(801, 1000):

                                        await bot.send_message(message.chat.id,
                                                               f"🤵‍♂︄ | Игрок: <a href='tg://user?id={user_id}'>{user_name}</a>\n🏎 | Игра: Гонки\n🚘 | Машина: {cars_name}\n🎟 | Ставка: {summ2}₸\n🧾 | Выигрыш: {summ4}₸",
                                                               parse_mode='html')
                                        cursor.execute(
                                            f'UPDATE users SET balance = {balance - summ} WHERE user_id = {user_id}')
                                        cursor.execute(
                                            f'UPDATE users SET balance = {balance + summ * 2} WHERE user_id = {user_id}')
                                        cursor.execute(
                                            f'UPDATE cars SET hp = {hp - rx2} WHERE user_id = {user_id}')
                                        cursor.execute(
                                            f'UPDATE cars SET benz = {benz - rx2} WHERE user_id = {user_id}')

                                        connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f"‼️ <a href='tg://user?id={user_id}'>{user_name}</a>, подождите! У вас закончился бензин в автомобиле",
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f"‼️ <a href='tg://user?id={user_id}'>{user_name}</a>, подождите! У вас поломался автомобиль , вы не можете участвовать в гонках",
                                                       parse_mode='html')
                        else:
                            await bot.send_message(message.chat.id,
                                                   f"‼️ <a href='tg://user?id={user_id}'>{user_name}</a>, подождите! Какие гонки без автомобиля? Купите автомобиль",
                                                   parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f"‼️ <a href='tg://user?id={user_id}'>{user_name}</a>, подождите! У вас нехватает средств",
                                               parse_mode='html')



                if message.text.lower() in ['починить', 'Починить']:
                    data = await get_rang(message)
                    user_name = str(data[9])
                    user_id = message.from_user.id

                    loser = ['😐', '😕', '😟', '😔', '😓']
                    rloser = random.choice(loser)

                    balance =int(data[2])
                    data1 = await get_any(id=user_id, table='property', id2='user_id')
                    cars = int(data1[4])
                    data2 = await get_any(id=user_id, table='cars', id2='user_id')
                    hp = int(data2[2])

                    if cars > 0:
                        if hp <= 100:
                            if balance >= 100000000:
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - 100000000 } WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE cars SET hp = {120} WHERE user_id = {user_id}')
                                await bot.send_message(message.chat.id,
                                                       f"‼️ <a href='tg://user?id={user_id}'>{user_name}</a>,Ваш автомобиль успешно починен",
                                                       parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f"‼️ <a href='tg://user?id={user_id}'>{user_name}</a>, подождите! У вас нехватает средств",
                                                       parse_mode='html')
                        else:
                            await bot.send_message(message.chat.id,
                                                   f"‼️ <a href='tg://user?id={user_id}'>{user_name}</a>,Ваш автомобиль не сломан",
                                                   parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f"‼️ <a href='tg://user?id={user_id}'>{user_name}</a>, подождите!  Купите автомобиль",
                                               parse_mode='html')
                if message.text.lower() in ['заправиться', 'Заправиться']:
                    data = await get_rang(message)
                    user_name = str(data[9])
                    user_id = message.from_user.id

                    loser = ['😐', '😕', '😟', '😔', '😓']
                    rloser = random.choice(loser)

                    balance =int(data[2])
                    data1 = await get_any(id=user_id, table='property', id2='user_id')
                    cars = int(data1[4])
                    data2 = await get_any(id=user_id, table='cars', id2='user_id')

                    benz = int(data2[3])
                    if cars > 0:
                        if benz <= 100:
                            if balance >= 10000000:
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - 10000000} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE cars SET benz = {120} WHERE user_id = {user_id}')
                                await bot.send_message(message.chat.id,
                                                       f"  <a href='tg://user?id={user_id}'>{user_name}</a>, Вы заправили машину",
                                                       parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f"‼️ <a href='tg://user?id={user_id}'>{user_name}</a>, подождите! У вас нехватает средств",
                                                       parse_mode='html')
                        else:
                            await bot.send_message(message.chat.id,
                                                   f"‼️ <a href='tg://user?id={user_id}'>{user_name}</a>, В вашей машины достаточно бензина",
                                                   parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f"‼️ <a href='tg://user?id={user_id}'>{user_name}</a>, подождите!  Купите автомобиль",
                                               parse_mode='html')

                        #########################################РАБОТЫ###########################################
                if message.text.lower() in ['уволиться', 'Уволиться']:
                    data = await get_rang(message)
                    user_name = str(data[9])
                    user_id = message.from_user.id

                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    work = int(data[12])

                    if work > 0:
                        await bot.send_message(message.chat.id,
                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, вы уволены с вашей работы {rwin}',
                                               parse_mode='html')
                        cursor.execute(
                            f'UPDATE users SET work = {0}  WHERE user_id = {user_id}')
                        connect.commit()
                    else:
                        await bot.send_message(message.chat.id,
                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, вы уже без работный {rloser}',
                                               parse_mode='html')
                if message.text.lower() in ['работать', 'Работать']:
                    data = await get_rang(message)
                    user_name = str(data[9])
                    user_id = message.from_user.id

                    balance =int(data[2])
                    level = int(data[1])
                    work =int(data[12])

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    rx_rabota=[]
                    if work == 1:
                        rabota = ['собрали яблоки🍎', 'покормили коров🐮',
                                  "зарезали свинью🐷", "покормили курочек🐔"]
                        rx_rabota = random.choice(rabota)
                        zp = 50000000
                        zp2 = '{:,}'.format(zp)
                    if work == 2:
                        rabota = ['выкопали шахту⛏', 'подорвали шахту🧨']
                        rx_rabota = random.choice(rabota)
                        zp = 100000000
                        zp2 = '{:,}'.format(zp)
                    if work == 3:
                        rabota = ['построили дом🏠', 'принесли кирпичи🧱',
                                  "построили квартиру🧱", "построили банк🏦"]
                        rx_rabota = random.choice(rabota)
                        zp = 500000000
                        zp2 = '{:,}'.format(zp)
                    if work == 4:
                        rabota = ['починили кран🚰', 'отремонтировали ванну🛁 ',
                                  "провели воду🚿", "почистили туалет🚽"]
                        rx_rabota = random.choice(rabota)
                        zp = 1000000000
                        zp2 = '{:,}'.format(zp)
                    if work == 5:
                        rabota = ['починили розетку🔌', 'провели ТВ 📡',
                                  "провели интернет🌐", "почистили электронику🧰"]
                        rx_rabota = random.choice(rabota)
                        zp = 10000000000
                        zp2 = '{:,}'.format(zp)
                    if work == 6:
                        rabota = ['потушили дом🏚', 'выехали на вызов🚒',
                                  "потушили квартиру🧯", "потушили лес🔥"]
                        rx_rabota = random.choice(rabota)
                        zp = 30000000000
                        zp2 = '{:,}'.format(zp)
                    if work == 7:
                        rabota = ['принесли чашку кофе☕️', 'принесли блинчики🥞', "принесли гамбургер 🍔",
                                  "принесли кусочек торта 🍰"]
                        rx_rabota = random.choice(rabota)
                        zp = 50000000000
                        zp2 = '{:,}'.format(zp)
                    if work == 8:
                        rabota = ['приготовили чашку кофе☕️', 'сделали блинчики🥞', "приготовили гамбургер 🍔",
                                  "спекли кусочек торта 🍰"]
                        rx_rabota = random.choice(rabota)
                        zp = 80000000000
                        zp2 = '{:,}'.format(zp)
                    if work == 9:
                        rabota = ['остонавили ограбление💰', 'поймали наркомана💉', "нашли закладку🚬",
                                  "поймали преступника🔫 "]
                        rx_rabota = random.choice(rabota)
                        zp = 90000000000
                        zp2 = '{:,}'.format(zp)
                    if work == 10:
                        rabota = ['спасли человеку жизнь👨‍⚕️', 'вылечили от COVID-19 😷', "сделали укол 💉",
                                  "сделали операцию 👨‍⚕️"]
                        rx_rabota = random.choice(rabota)
                        zp = 100000000000
                        zp2 = '{:,}'.format(zp)
                    if work == 11:
                        rabota = ['выдержали урок с 8-В🥳', 'помогли директору школы 💼', "провели ЗНО 🎓",
                                  "провели 7 уроков🛎"]
                        rx_rabota = random.choice(rabota)
                        zp = 300000000000
                        zp2 = '{:,}'.format(zp)
                    if work == 12:
                        rabota = ['пролетели маршрут Киев-Москва🛩', 'пролетели маршрут Саратов-Дубай 🛬',
                                  "пролетели маршрут Харьков-Египет ✈️", "пролетели маршрут Сант-Петербург-Нью-Йорк 🛫"]
                        rx_rabota = random.choice(rabota)
                        zp = 500000000000
                        zp2 = '{:,}'.format(zp)
                    if work == 13:
                        rabota = ['проведали школу МВД🚓', 'провели собеседование 💬', "нашли шпиона 🥷️",
                                  "провели проверку в Москве👨‍✈️"]
                        rx_rabota = random.choice(rabota)
                        zp = 800000000000
                        zp2 = '{:,}'.format(zp)
                    if work == 14:
                        rabota = ['оформили продажу одного своего бизнеса 🏗', 'купили новый бизнес 🏭', "купили новый банк 🏦",
                                  "продали новый музей 🏛"]
                        rx_rabota = random.choice(rabota)
                        zp = 900000000000
                        zp2 = '{:,}'.format(zp)
                    if work == 15:
                        rabota = ['написали телеграм бота 🤖', 'написали сайт 🖥', "выполнили заказ на фрилансе 🧮",
                                  "написали скрипт  ⚙️"]
                        rx_rabota = random.choice(rabota)
                        zp = 1000000000000
                        zp2 = '{:,}'.format(zp)
                    if work > 0:
                        need_seconds3 = 1800
                        current_time_bonus3 = datetime.now()
                        last_datetime3 = work_time.get(message.from_user.id)

                        # Если первое сообщение (время не задано)
                        if not last_datetime3:
                            work_time[message.from_user.id] = current_time_bonus3
                            last_datetime3 = datetime.fromtimestamp(0)
                        if last_datetime3:

                            # Разница в секундах между текущим временем и временем последнего сообщения
                            delta_seconds3 = (current_time_bonus3 - last_datetime3).total_seconds()

                            # Осталось ждать секунд перед отправкой
                            seconds_left3 = int(need_seconds3 - delta_seconds3)

                            # Если время ожидания не закончилось
                            if seconds_left3 > 0:
                                left1 = seconds_left3 / 60
                                await bot.send_message(message.chat.id,
                                                       f'‼️<a href="tg://user?id={user_id}">{user_name}</a>, нельзя так часто работать, работать можно через {round(left1)} минут {rloser}',
                                                       parse_mode='html')
                            else:
                                work_time[message.from_user.id] = current_time_bonus3
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно {rx_rabota} и получили зарплату {zp2}₸   ✅',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance + zp}  WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET level = {level + 1}  WHERE user_id = {user_id}')

                                connect.commit()

                    else:
                        await bot.send_message(message.chat.id, f'{name}, куда работать? вы без работний {rloser}',
                                                       parse_mode='html')

                if message.text.startswith('Устроиться')or message.text.startswith('устроиться'):
                    data = await get_rang(message)
                    user_name = str(data[9])
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    if message.text != 'Устроиться':

                        level = int(data[1])
                        work = int(data[12])
                        user_id = message.from_user.id
                        try:
                            nomer_work = int(message.text.split()[1])
                        except :
                            await message.reply('‼️  Неправильный ввод команды!\nПример:\nУстроиться 1 ')
                            return


                        win = ['🙂', '😋', '😄', '🤑', '😃']
                        rwin = random.choice(win)
                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)
                        if work == 0:
                            if nomer_work == 1:
                                if level >= 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно устроились на работу "Фермер" {rwin}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET work = {1}  WHERE user_id = {user_id}')
                                    connect.commit()
                                    return
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас не достаточный уровень {rloser}',
                                                           parse_mode='html')
                                    return
                            if nomer_work == 2:
                                if level >= 10:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно устроились на работу "Шахтёр" {rwin}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET work = {2}  WHERE user_id = {user_id}')
                                    connect.commit()
                                    return
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас не достаточный уровень {rloser}',
                                                           parse_mode='html')
                                    return
                            if nomer_work == 3:
                                if level >= 25:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно устроились на работу "Строитель" {rwin}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET work = {3}  WHERE user_id = {user_id}')
                                    connect.commit()
                                    return
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас не достаточный уровень {rloser}',
                                                           parse_mode='html')
                                    return
                            if nomer_work == 4:
                                if level >= 35:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно устроились на работу "Сантехник" {rwin}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET work = {4}  WHERE user_id = {user_id}')
                                    connect.commit()
                                    return
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас не достаточный уровень {rloser}',
                                                           parse_mode='html')
                                    return
                            if nomer_work == 5:
                                if level >= 45:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно устроились на работу "Электрик" {rwin}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET work = {5}  WHERE user_id = {user_id}')
                                    connect.commit()
                                    return
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас не достаточный уровень {rloser}',
                                                           parse_mode='html')
                                    return
                            if nomer_work == 6:
                                if level >= 50:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно устроились на работу "Пожарник" {rwin}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET work = {6}  WHERE user_id = {user_id}')
                                    connect.commit()
                                    return
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас не достаточный уровень {rloser}',
                                                           parse_mode='html')
                                    return
                            if nomer_work == 7:
                                if level >= 55:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно устроились на работу "Официант" {rwin}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET work = {7}  WHERE user_id = {user_id}')
                                    connect.commit()
                                    return
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас не достаточный уровень {rloser}',
                                                           parse_mode='html')
                                    return
                            if nomer_work == 8:
                                if level >= 60:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно устроились на работу "Повар" {rwin}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET work = {8}  WHERE user_id = {user_id}')
                                    connect.commit()
                                    return
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас не достаточный уровень {rloser}',
                                                           parse_mode='html')
                                    return
                            if nomer_work == 9:
                                if level >= 65:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно устроились на работу "Полицейский" {rwin}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET work = {9}  WHERE user_id = {user_id}')
                                    connect.commit()
                                    return
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас не достаточный уровень {rloser}',
                                                           parse_mode='html')
                                    return
                            if nomer_work == 10:
                                if level >= 70:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно устроились на работу "Доктор" {rwin}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET work = {10}  WHERE user_id = {user_id}')
                                    connect.commit()
                                    return
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас не достаточный уровень {rloser}',
                                                           parse_mode='html')
                                    return
                            if nomer_work == 11:
                                if level >= 75:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно устроились на работу "Педагог" {rwin}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET work = {11}  WHERE user_id = {user_id}')
                                    connect.commit()
                                    return
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас не достаточный уровень {rloser}',
                                                           parse_mode='html')
                                    return
                            if nomer_work == 12:
                                if level >= 80:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно устроились на работу "Пилот" {rwin}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET work = {12}  WHERE user_id = {user_id}')
                                    connect.commit()
                                    return
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас не достаточный уровень {rloser}',
                                                           parse_mode='html')
                                    return
                            if nomer_work == 13:
                                if level >= 85:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно устроились на работу "Генерал" {rwin}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET work = {13}  WHERE user_id = {user_id}')
                                    connect.commit()
                                    return
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас не достаточный уровень {rloser}',
                                                           parse_mode='html')
                                    return
                            if nomer_work == 14:
                                if level >= 90:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно устроились на работу "Бизнесмен" {rwin}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET work = {14}  WHERE user_id = {user_id}')
                                    connect.commit()
                                    return
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас не достаточный уровень {rloser}',
                                                           parse_mode='html')
                                    return
                            if nomer_work == 15:
                                if level >= 100:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно устроились на работу "Программист" {rwin}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET work = {15}  WHERE user_id = {user_id}')
                                    connect.commit()
                                    return
                                else:
                                    await bot.send_message(message.chat.id, f'{name}, у вас не достаточный уровень {rloser}',
                                                           parse_mode='html')
                                    return
                            else:
                                await bot.send_message(message.chat.id, f'{name}, такой ваканции нету к сожелению {rloser}',
                                                       parse_mode='html')
                        else:
                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы решили работать сразу на 2 работах? Увольтесь для начала {rloser}',
                                                   parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Устроиться 1 {rloser}',
                                               parse_mode='html')
                        return

                if message.text.lower() in ['вакансии', 'Вакансии', 'вакансий', 'Вакансий']:
                    data = await get_rang(message)
                    user_name = str(data[9])
                    user_id = message.from_user.id

                    await bot.send_message(message.chat.id, f'''
<a href="tg://user?id={user_id}">{user_name}</a>, вот все доступные вакансии📑
🍎 1 Фермер -50.000.000 ₸  [1lvl]
⛏ 2 Шахтёр - 100.000.000 ₸  [10lvl]
🧱 3 Строитель - 500.000.000 ₸  [25lvl]
🛠 4 Сантехник - 1.000.000.000 ₸  [35lvl]
💡 5 Электрик - 10.000.000.000₸ ₸  [45lvl]
🧯 6 Пожарник - 30.000.000.000 ₸  [50lvl]
☕️ 7 Официант - 50.000.000.000 ₸  [55lvl]
🍰 8 Повар - 80.000.000.000 ₸  [60lvl]
👮‍♂️ 9 Полицейский - 90.000.000.000 ₸  [65lvl]
👨‍⚕️ 10 Доктор - 100.000.000.000 ₸  [70lvl]
👩‍🏫 11 Педагог - 300.000.000.000 ₸  [75lvl]
✈️ 12 Пилот - 500.000.000.000 ₸  [80lvl]
👨‍✈️ 13 Генерал - 800.000.000.000 ₸  [85lvl]
💍 14 Бизнесмен -900.000.000.000 ₸  [90lvl]
🖥 15 Программист - 1.000.000.000.000 ₸ [100lvl]

📌Что бы устроиться на работу введите команду "Устроиться [номер]"
                    ''', parse_mode='html')
                if message.text.lower() in ['центр занятости']:
                    data = await get_rang(message)
                    user_name = str(data[9])
                    user_id = message.from_user.id

                    level = int(data[1])
                    work =int(data[12])

                    if work == 0:
                        work2 = 'Без работный'
                        zp = '0₸ '
                    if work == 1:
                        work2 = 'Фермер🍎'
                        zp = '50.000.000₸ '
                    if work == 2:
                        work2 = 'Шахтёр⛏'
                        zp = '100.000.000₸ '
                    if work == 3:
                        work2 = 'Строитель🧱'
                        zp = ' 500.000.000₸ '
                    if work == 4:
                        work2 = 'Сантехник🛠'
                        zp = '1.000.000.000₸ '
                    if work == 5:
                        work2 = 'Электрик💡'
                        zp = '10.000.000.000₸ '
                    if work == 6:
                        work2 = 'Пожарник🧯'
                        zp = '30.000.000.000₸ '
                    if work == 7:
                        work2 = 'Официант☕️'
                        zp = ' 50.000.000.000 ₸ '
                    if work == 8:
                        work2 = 'Повар🍰'
                        zp = '80.000.000.000₸ '
                    if work == 9:
                        work2 = 'Полицейский👮‍♂'
                        zp = '90.000.000.000₸ '
                    if work == 10:
                        work2 = 'Доктор👨‍⚕'
                        zp = '100.000.000.000₸ '
                    if work == 11:
                        work2 = 'Педагог👩‍🏫'
                        zp = '300.000.000.000₸ '
                    if work == 12:
                        work2 = 'Пилот✈️'
                        zp = '500.000.000.000₸ '
                    if work == 13:
                        work2 = 'Генерал👨‍✈️'
                        zp = '800.000.000.000₸ '
                    if work == 14:
                        work2 = 'Бизнесмен💍'
                        zp = '900.000.000.000₸ '
                    if work == 15:
                        work2 = 'Программист🖥'
                        zp = '1.000.000.000.000₸ '

                    await bot.send_message(message.chat.id, f'''
<a href="tg://user?id={user_id}">{user_name}</a>, добро пожаловать в центр занятости🏢
👫 Ник: {user_name}
📊 Уровень: {level}
📈 Работа: {work2}
💵 Зарплата: {zp}
                    ''', parse_mode='html')
                ###########################################БАНК###########################################
                # bank
                if message.text.lower() in ["Банк", "банк"]:
                    msg = message
                    chat_id = message.chat.id
                    data = await get_rang(message)
                    user_name = str(data[9])
                    user_id = msg.from_user.id
                    balance =int(data[2])
                    bank = int(data[3])
                    bank2 = '{:,}'.format(bank).replace(',', '.')

                    #photo = open("assets/bank.jpg", 'rb')
                    await bot.send_message(message.chat.id,f'''
<a href="tg://user?id={user_id}">{user_name}</a>, Вы попали в банк 

🏦Банковский счёт: {bank2}

<code>Банк положить</code> - <b>положить в банк</b>
<code>Банк снять</code> - <b>Снять с банка</b>
        
                        ''', parse_mode='html')
                if message.text.lower() in ["депозит"]:
                    msg = message
                    chat_id = message.chat.id
                    data = await get_rang(message)
                    user_name = str(data[9])
                    user_id = msg.from_user.id
                    user_status = str(data[10])

                    times2 = []
                    times = []
                    times2 = scheduler.get_job(job_id="bank_time")
                    times2 = str(times2)
                    time2 = times2.split(",")
                    time3 = time2[1].split('at:')
                    time4 = time3[1].split('+0')
                    times.append(f" <i>Следющая выдача депозита в</i> — <b>{time4[0]}</b> ")
                    time5 = "\n".join(times)
                    procent_donat = cursor.execute("SELECT procent_donate from users where user_id = ?",
                                                   (message.from_user.id,))
                    procent_donat = cursor.fetchone()
                    procent_donat = round(procent_donat[0])
                    if procent_donat == 0:
                        procent = '2%'
                    if procent_donat == 0 and user_status == 'delux':
                        procent = '4%'
                    if procent_donat == 1 and user_status == 'delux':
                        procent = '8%'
                    # photo = open("assets/bank.jpg", 'rb')
                    await bot.send_message(message.chat.id, f'''
👤 Владелец: <a href="tg://user?id={user_id}">{user_name}</a>
〽️Процетная ставка: {procent}
⏰ {time5}
<b>
🕒 Часовой пояс GMT+6

🌃 Для времени по москве = -3 часа </b>


                                    ''', parse_mode='html')
                if message.text.startswith("Банк положить")or message.text.startswith("банк положить"):
                    data = await get_rang(message)
                    user_name = str(data[9])
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    if message.text != 'Банк положить':
                        msg = message
                        chat_id = message.chat.id

                        name = msg.from_user.last_name
                        try:
                            su = msg.text.split()[2]
                            su2 = (su).replace('к', '000')
                            su3 = (su2).replace('м', '000000')
                            su4 = (su3).replace('.', '')
                            su5 = float(su4)

                            bank_p = int(su5)
                            bank_p = Decimal(bank_p)

                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Банк положить 1 ')
                            return

                        deposit_donate=cursor.execute(f"SELECT deposit_donate FROM users WHERE user_id={user_id}")
                        deposit_donate=cursor.fetchone()
                        deposit_donate=int(deposit_donate[0])
                        balance = int(data[2])
                        bank = int(data[3])
                        limitbank =  int(data[43])
                        user_status = str(data[10])
                        bank2 = '{:,}'.format(bank_p).replace(',', '.')
                        win = ['🙂', '😋', '😄', '🤑', '😃']
                        rwin = random.choice(win)
                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)
                        limitbank2=limitbank* deposit_donate
                        if limitbank2 >= bank+bank_p or user_status == 'delux' or user_status == 'Rab'or user_status == 'Admin':

                            if bank_p > 0:
                                if balance >= bank_p:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно положили в банк {bank2}₸  {rwin}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - bank_p} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE users SET bank = {bank + bank_p} WHERE user_id = {user_id}')
                                    connect.commit()

                                elif int(balance) < int(bank_p):
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств! {rloser}',
                                                           parse_mode='html')

                            if bank_p <= 0:
                                await bot.send_message(message.chat.id,
                                                       f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>, нельзя положить в банк отрицательное число! {rloser}',
                                                       parse_mode='html')

                        else:
                            await bot.send_message(message.chat.id,
                                                   f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,У вас лимит для увеличения лимит Банка введить донат {rloser}\n‼️ Сумма возможного вклада: {limitbank2-bank} {rloser}₸'
                                                   ,
                                                   parse_mode='html')
                            return

                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Банк положить [сумма] {rloser}',
                                               parse_mode='html')
                        return

                if message.text.startswith("Банк снять") or message.text.startswith("банк снять"):
                    data = await get_rang(message)
                    user_name = str(data[9])
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    if message.text != "Банк снять":
                        msg = message
                        chat_id = message.chat.id
                        try:
                            su = msg.text.split()[2]
                            su2 = (su).replace('к', '000')
                            su3 = (su2).replace('м', '000000')
                            su4 = (su3).replace('.', '')
                            su5 = float(su4)

                            bank_s = int(su5)
                            bank_s = Decimal(bank_s)
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Банк снять 1 ')
                            return

                        balance = int(data[2])
                        bank = int(data[3])
                        bank2 = '{:,}'.format(bank_s).replace(',', '.')
                        win = ['🙂', '😋', '😄', '🤑', '😃']
                        rwin = random.choice(win)
                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)

                        if bank_s > 0:
                            if bank >= bank_s:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно сняли с банковского счёта {bank2}₸  {rwin}',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET bank = {bank - bank_s} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance + bank_s} WHERE user_id = {user_id}')
                                connect.commit()

                            elif int(bank) < int(bank_s):
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, недостаточно средств на банковском счету! {rloser}',
                                                       parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Банк положить [сумма] {rloser}',
                                               parse_mode='html')
                        return
                if message.text.lower() in ["донат депозит"]:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    ecoins = cursor.execute("SELECT ecoins from users where user_id = ?",
                                            (message.from_user.id,))
                    ecoins = cursor.fetchone()
                    ecoins = round(ecoins[0])
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    procent_donat = cursor.execute("SELECT procent_donate from users where user_id = ?",
                                                   (message.from_user.id,))
                    procent_donat = cursor.fetchone()
                    procent_donat = round(procent_donat[0])
                    if ecoins>=70:
                        if procent_donat!=1:
                            cursor.execute(f"UPDATE users SET procent_donate=1 WHERE user_id={user_id}")
                            cursor.execute(f"UPDATE users SET ecoins={ecoins-70} WHERE user_id={user_id}")
                            connect.commit()
                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, Успешно увеличил процент депозита х2! {rwin}',
                                                   parse_mode='html')
                        else:
                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, У вас уже куплен этот донат! {rloser}',
                                                   parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, недостаточно конфет! {rloser}',
                                               parse_mode='html')
                if message.text.lower() in ["донат банк"]:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    ecoins = cursor.execute("SELECT ecoins from users where user_id = ?",
                                            (message.from_user.id,))
                    ecoins = cursor.fetchone()
                    ecoins = round(ecoins[0])
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    deposit_donat = cursor.execute("SELECT deposit_donate from users where user_id = ?",
                                            (message.from_user.id,))
                    deposit_donat = cursor.fetchone()
                    deposit_donat = round(deposit_donat[0])
                    if ecoins>=50:
                        if deposit_donat!=2:
                            cursor.execute(f"UPDATE users SET deposit_donate=2 WHERE user_id={user_id}")
                            cursor.execute(f"UPDATE users SET ecoins={ecoins-50} WHERE user_id={user_id}")
                            connect.commit()
                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, Успешно увеличил сумму вклада в банк х2! {rwin}',
                                                   parse_mode='html')
                        else:
                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, У вас уже куплен этот донат! {rloser}',
                                                   parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, недостаточно конфет! {rloser}',
                                               parse_mode='html')
                if message.text.lower() in ["купить питомца 1", "Купить питомца 1"]:
                    user_name = message.from_user.get_mention(as_html=True)
                    data = await get_rang(message)

                    pet1 =int(data[13])
                    pet2 =int(data[14])
                    pet3 = int(data[15])
                    pet4 = int(data[16])
                    pet5 = int(data[17])
                    pet6 = int(data[18])
                    pet7 = int(data[19])
                    pet8 = int(data[20])
                    pet9 =int(data[21])
                    pet_name = cursor.execute("SELECT pet_name from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_name = cursor.fetchone()
                    pet_name = str(pet_name[0])
                    pet_hp = cursor.execute(
                        "SELECT pet_hp from users where user_id = ?", (message.from_user.id,))
                    pet_hp = cursor.fetchone()
                    pet_hp = int(pet_hp[0])
                    pet_eat = cursor.execute(
                        "SELECT pet_eat from users where user_id = ?", (message.from_user.id,))
                    pet_eat = cursor.fetchone()
                    pet_eat = int(pet_eat[0])
                    pet_mood = cursor.execute("SELECT pet_mood from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_mood = cursor.fetchone()
                    pet_mood = int(pet_mood[0])
                    chat_id = message.chat.id
                    msg = message
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    user_id = msg.from_user.id
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = round(int(balance[0]))
                    summ = 1000000
                    c = 1
                    pets = pet1 + pet2 + pet3 + pet4 + pet5 + pet6 + pet7 + pet8 + pet9

                    checking = cursor.execute("SELECT checking from users where user_id = ?",
                                              (message.from_user.id,))
                    checking = cursor.fetchone()
                    checking = round(int(checking[0]))
                    if checking == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking1 = cursor.execute("SELECT checking1 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking1 = cursor.fetchone()
                    checking1 = round(int(checking1[0]))
                    if checking1 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking2 = cursor.execute("SELECT checking2 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking2 = cursor.fetchone()
                    checking2 = round(int(checking2[0]))
                    if checking2 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking3 = cursor.execute("SELECT checking3 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking3 = cursor.fetchone()
                    checking3 = round(int(checking3[0]))
                    if checking3 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    if int(pets) == 0:
                        if pet1 == 0:
                            if int(balance) >= int(summ):
                                await bot.send_message(message.chat.id,
                                                       f'� | {user_name}, вы успешно купили цыплёнка за 1.000.000₸ 🎉',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - summ} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet1 = {pet1 + c} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_hp = {100} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_eat = {100} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_mood = {100} WHERE user_id = {user_id}')
                                connect.commit()
                                return
                            else:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                                return
                        if pet1 == 1:
                            await bot.send_message(message.chat.id,
                                                   f'‼️  {user_name}, у вас уже есть данный питомец! {rloser}',
                                                   parse_mode='html')
                            return
                    if pets == 1:
                        await bot.send_message(message.chat.id, f'‼️  {user_name}, у вас уже есть питомец! {rloser}',
                                               parse_mode='html')

                if message.text.lower() in ["купить питомца 2", "Купить питомца 2"]:
                    user_name = message.from_user.get_mention(as_html=True)
                    pet1 = cursor.execute(
                        "SELECT pet1 from users where user_id = ?", (message.from_user.id,))
                    pet1 = cursor.fetchone()
                    pet1 = int(pet1[0])
                    pet2 = cursor.execute(
                        "SELECT pet2 from users where user_id = ?", (message.from_user.id,))
                    pet2 = cursor.fetchone()
                    pet2 = int(pet2[0])
                    pet3 = cursor.execute(
                        "SELECT pet3 from users where user_id = ?", (message.from_user.id,))
                    pet3 = cursor.fetchone()
                    pet3 = int(pet3[0])
                    pet4 = cursor.execute(
                        "SELECT pet4 from users where user_id = ?", (message.from_user.id,))
                    pet4 = cursor.fetchone()
                    pet4 = int(pet4[0])
                    pet5 = cursor.execute(
                        "SELECT pet5 from users where user_id = ?", (message.from_user.id,))
                    pet5 = cursor.fetchone()
                    pet5 = int(pet5[0])
                    pet6 = cursor.execute(
                        "SELECT pet6 from users where user_id = ?", (message.from_user.id,))
                    pet6 = cursor.fetchone()
                    pet6 = int(pet6[0])
                    pet7 = cursor.execute(
                        "SELECT pet7 from users where user_id = ?", (message.from_user.id,))
                    pet7 = cursor.fetchone()
                    pet7 = int(pet7[0])
                    pet8 = cursor.execute(
                        "SELECT pet8 from users where user_id = ?", (message.from_user.id,))
                    pet8 = cursor.fetchone()
                    pet8 = int(pet8[0])
                    pet9 = cursor.execute(
                        "SELECT pet9 from users where user_id = ?", (message.from_user.id,))
                    pet9 = cursor.fetchone()
                    pet9 = int(pet9[0])
                    pet_name = cursor.execute("SELECT pet_name from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_name = cursor.fetchone()
                    pet_name = str(pet_name[0])
                    pet_hp = cursor.execute(
                        "SELECT pet_hp from users where user_id = ?", (message.from_user.id,))
                    pet_hp = cursor.fetchone()
                    pet_hp = int(pet_hp[0])
                    pet_eat = cursor.execute(
                        "SELECT pet_eat from users where user_id = ?", (message.from_user.id,))
                    pet_eat = cursor.fetchone()
                    pet_eat = int(pet_eat[0])
                    pet_mood = cursor.execute("SELECT pet_mood from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_mood = cursor.fetchone()
                    pet_mood = int(pet_mood[0])
                    chat_id = message.chat.id
                    msg = message
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    user_id = msg.from_user.id
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = round(int(balance[0]))
                    summ = 100000000
                    c = 1
                    pets = pet1 + pet2 + pet3 + pet4 + pet5 + pet6 + pet7 + pet8 + pet9

                    checking = cursor.execute("SELECT checking from users where user_id = ?",
                                              (message.from_user.id,))
                    checking = cursor.fetchone()
                    checking = round(int(checking[0]))
                    if checking == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking1 = cursor.execute("SELECT checking1 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking1 = cursor.fetchone()
                    checking1 = round(int(checking1[0]))
                    if checking1 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking2 = cursor.execute("SELECT checking2 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking2 = cursor.fetchone()
                    checking2 = round(int(checking2[0]))
                    if checking2 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking3 = cursor.execute("SELECT checking3 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking3 = cursor.fetchone()
                    checking3 = round(int(checking3[0]))
                    if checking3 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return

                    if int(pets) == 0:
                        if pet2 == 0:
                            if int(balance) >= int(summ):
                                await bot.send_message(message.chat.id,
                                                       f'� | {user_name}, вы успешно купили кота за 100.000.000₸ 🎉',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - summ} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet2 = {pet2 + c} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_hp = {100} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_eat = {100} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_mood = {100} WHERE user_id = {user_id}')
                                connect.commit()
                                return
                            else:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                                return
                        if pet2 == 1:
                            await bot.send_message(message.chat.id,
                                                   f'‼️  {user_name}, у вас уже есть данный питомец! {rloser}',
                                                   parse_mode='html')
                            return
                    if pets == 1:
                        await bot.send_message(message.chat.id, f'‼️  {user_name}, у вас уже есть питомец! {rloser}',
                                               parse_mode='html')

                if message.text.lower() in ["купить питомца 3", "Купить питомца 3"]:
                    user_name = message.from_user.get_mention(as_html=True)
                    pet1 = cursor.execute(
                        "SELECT pet1 from users where user_id = ?", (message.from_user.id,))
                    pet1 = cursor.fetchone()
                    pet1 = int(pet1[0])
                    pet2 = cursor.execute(
                        "SELECT pet2 from users where user_id = ?", (message.from_user.id,))
                    pet2 = cursor.fetchone()
                    pet2 = int(pet2[0])
                    pet3 = cursor.execute(
                        "SELECT pet3 from users where user_id = ?", (message.from_user.id,))
                    pet3 = cursor.fetchone()
                    pet3 = int(pet3[0])
                    pet4 = cursor.execute(
                        "SELECT pet4 from users where user_id = ?", (message.from_user.id,))
                    pet4 = cursor.fetchone()
                    pet4 = int(pet4[0])
                    pet5 = cursor.execute(
                        "SELECT pet5 from users where user_id = ?", (message.from_user.id,))
                    pet5 = cursor.fetchone()
                    pet5 = int(pet5[0])
                    pet6 = cursor.execute(
                        "SELECT pet6 from users where user_id = ?", (message.from_user.id,))
                    pet6 = cursor.fetchone()
                    pet6 = int(pet6[0])
                    pet7 = cursor.execute(
                        "SELECT pet7 from users where user_id = ?", (message.from_user.id,))
                    pet7 = cursor.fetchone()
                    pet7 = int(pet7[0])
                    pet8 = cursor.execute(
                        "SELECT pet8 from users where user_id = ?", (message.from_user.id,))
                    pet8 = cursor.fetchone()
                    pet8 = int(pet8[0])
                    pet9 = cursor.execute(
                        "SELECT pet9 from users where user_id = ?", (message.from_user.id,))
                    pet9 = cursor.fetchone()
                    pet9 = int(pet9[0])
                    pet_name = cursor.execute("SELECT pet_name from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_name = cursor.fetchone()
                    pet_name = str(pet_name[0])
                    pet_hp = cursor.execute(
                        "SELECT pet_hp from users where user_id = ?", (message.from_user.id,))
                    pet_hp = cursor.fetchone()
                    pet_hp = int(pet_hp[0])
                    pet_eat = cursor.execute(
                        "SELECT pet_eat from users where user_id = ?", (message.from_user.id,))
                    pet_eat = cursor.fetchone()
                    pet_eat = int(pet_eat[0])
                    pet_mood = cursor.execute("SELECT pet_mood from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_mood = cursor.fetchone()
                    pet_mood = int(pet_mood[0])
                    chat_id = message.chat.id
                    msg = message
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    user_id = msg.from_user.id
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = round(int(balance[0]))
                    summ = 500000000
                    c = 1
                    pets = pet1 + pet2 + pet3 + pet4 + pet5 + pet6 + pet7 + pet8 + pet9

                    checking = cursor.execute("SELECT checking from users where user_id = ?",
                                              (message.from_user.id,))
                    checking = cursor.fetchone()
                    checking = round(int(checking[0]))
                    if checking == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking1 = cursor.execute("SELECT checking1 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking1 = cursor.fetchone()
                    checking1 = round(int(checking1[0]))
                    if checking1 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking2 = cursor.execute("SELECT checking2 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking2 = cursor.fetchone()
                    checking2 = round(int(checking2[0]))
                    if checking2 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking3 = cursor.execute("SELECT checking3 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking3 = cursor.fetchone()
                    checking3 = round(int(checking3[0]))
                    if checking3 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return

                    if int(pets) == 0:
                        if pet3 == 0:
                            if int(balance) >= int(summ):
                                await bot.send_message(message.chat.id,
                                                       f'🐕 | {user_name}, вы успешно купили пса за 500.000.000₸ 🎉',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - summ} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_hp = {100} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_eat = {100} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_mood = {100} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet3 = {pet3 + c} WHERE user_id = {user_id}')
                                connect.commit()
                                return
                            else:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                                return
                        if pet3 == 1:
                            await bot.send_message(message.chat.id,
                                                   f'‼️  {user_name}, у вас уже есть данный питомец! {rloser}',
                                                   parse_mode='html')
                            return
                    if pets == 1:
                        await bot.send_message(message.chat.id, f'‼️  {user_name}, у вас уже есть питомец! {rloser}',
                                               parse_mode='html')

                if message.text.lower() in ["купить питомца 4", "Купить питомца 4"]:
                    user_name = message.from_user.get_mention(as_html=True)
                    pet1 = cursor.execute(
                        "SELECT pet1 from users where user_id = ?", (message.from_user.id,))
                    pet1 = cursor.fetchone()
                    pet1 = int(pet1[0])
                    pet2 = cursor.execute(
                        "SELECT pet2 from users where user_id = ?", (message.from_user.id,))
                    pet2 = cursor.fetchone()
                    pet2 = int(pet2[0])
                    pet3 = cursor.execute(
                        "SELECT pet3 from users where user_id = ?", (message.from_user.id,))
                    pet3 = cursor.fetchone()
                    pet3 = int(pet3[0])
                    pet4 = cursor.execute(
                        "SELECT pet4 from users where user_id = ?", (message.from_user.id,))
                    pet4 = cursor.fetchone()
                    pet4 = int(pet4[0])
                    pet5 = cursor.execute(
                        "SELECT pet5 from users where user_id = ?", (message.from_user.id,))
                    pet5 = cursor.fetchone()
                    pet5 = int(pet5[0])
                    pet6 = cursor.execute(
                        "SELECT pet6 from users where user_id = ?", (message.from_user.id,))
                    pet6 = cursor.fetchone()
                    pet6 = int(pet6[0])
                    pet7 = cursor.execute(
                        "SELECT pet7 from users where user_id = ?", (message.from_user.id,))
                    pet7 = cursor.fetchone()
                    pet7 = int(pet7[0])
                    pet8 = cursor.execute(
                        "SELECT pet8 from users where user_id = ?", (message.from_user.id,))
                    pet8 = cursor.fetchone()
                    pet8 = int(pet8[0])
                    pet9 = cursor.execute(
                        "SELECT pet9 from users where user_id = ?", (message.from_user.id,))
                    pet9 = cursor.fetchone()
                    pet9 = int(pet9[0])
                    pet_name = cursor.execute("SELECT pet_name from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_name = cursor.fetchone()
                    pet_name = str(pet_name[0])
                    pet_hp = cursor.execute(
                        "SELECT pet_hp from users where user_id = ?", (message.from_user.id,))
                    pet_hp = cursor.fetchone()
                    pet_hp = int(pet_hp[0])
                    pet_eat = cursor.execute(
                        "SELECT pet_eat from users where user_id = ?", (message.from_user.id,))
                    pet_eat = cursor.fetchone()
                    pet_eat = int(pet_eat[0])
                    pet_mood = cursor.execute("SELECT pet_mood from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_mood = cursor.fetchone()
                    pet_mood = int(pet_mood[0])
                    chat_id = message.chat.id
                    msg = message
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    user_id = msg.from_user.id
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = round(int(balance[0]))
                    summ = 1000000000
                    c = 1
                    pets = pet1 + pet2 + pet3 + pet4 + pet5 + pet6 + pet7 + pet8 + pet9

                    checking = cursor.execute("SELECT checking from users where user_id = ?",
                                              (message.from_user.id,))
                    checking = cursor.fetchone()
                    checking = round(int(checking[0]))
                    if checking == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking1 = cursor.execute("SELECT checking1 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking1 = cursor.fetchone()
                    checking1 = round(int(checking1[0]))
                    if checking1 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking2 = cursor.execute("SELECT checking2 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking2 = cursor.fetchone()
                    checking2 = round(int(checking2[0]))
                    if checking2 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking3 = cursor.execute("SELECT checking3 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking3 = cursor.fetchone()
                    checking3 = round(int(checking3[0]))
                    if checking3 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return

                    if int(pets) == 0:
                        if pet4 == 0:
                            if int(balance) >= int(summ):
                                await bot.send_message(message.chat.id,
                                                       f'� | {user_name}, вы успешно купили попугая за 1.000.000.000₸ 🎉',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - summ} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet4 = {pet4 + c} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_hp = {100} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_eat = {100} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_mood = {100} WHERE user_id = {user_id}')
                                connect.commit()
                                return
                            else:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                                return
                        if pet4 == 1:
                            await bot.send_message(message.chat.id,
                                                   f'‼️  {user_name}, у вас уже есть данный питомец! {rloser}',
                                                   parse_mode='html')
                            return
                    if pets == 1:
                        await bot.send_message(message.chat.id, f'‼️  {user_name}, у вас уже есть питомец! {rloser}',
                                               parse_mode='html')

                if message.text.lower() in ["купить питомца 5", "Купить питомца 5"]:
                    user_name = message.from_user.get_mention(as_html=True)
                    pet1 = cursor.execute(
                        "SELECT pet1 from users where user_id = ?", (message.from_user.id,))
                    pet1 = cursor.fetchone()
                    pet1 = int(pet1[0])
                    pet2 = cursor.execute(
                        "SELECT pet2 from users where user_id = ?", (message.from_user.id,))
                    pet2 = cursor.fetchone()
                    pet2 = int(pet2[0])
                    pet3 = cursor.execute(
                        "SELECT pet3 from users where user_id = ?", (message.from_user.id,))
                    pet3 = cursor.fetchone()
                    pet3 = int(pet3[0])
                    pet4 = cursor.execute(
                        "SELECT pet4 from users where user_id = ?", (message.from_user.id,))
                    pet4 = cursor.fetchone()
                    pet4 = int(pet4[0])
                    pet5 = cursor.execute(
                        "SELECT pet5 from users where user_id = ?", (message.from_user.id,))
                    pet5 = cursor.fetchone()
                    pet5 = int(pet5[0])
                    pet6 = cursor.execute(
                        "SELECT pet6 from users where user_id = ?", (message.from_user.id,))
                    pet6 = cursor.fetchone()
                    pet6 = int(pet6[0])
                    pet7 = cursor.execute(
                        "SELECT pet7 from users where user_id = ?", (message.from_user.id,))
                    pet7 = cursor.fetchone()
                    pet7 = int(pet7[0])
                    pet8 = cursor.execute(
                        "SELECT pet8 from users where user_id = ?", (message.from_user.id,))
                    pet8 = cursor.fetchone()
                    pet8 = int(pet8[0])
                    pet9 = cursor.execute(
                        "SELECT pet9 from users where user_id = ?", (message.from_user.id,))
                    pet9 = cursor.fetchone()
                    pet9 = int(pet9[0])
                    pet_name = cursor.execute("SELECT pet_name from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_name = cursor.fetchone()
                    pet_name = str(pet_name[0])
                    pet_hp = cursor.execute(
                        "SELECT pet_hp from users where user_id = ?", (message.from_user.id,))
                    pet_hp = cursor.fetchone()
                    pet_hp = int(pet_hp[0])
                    pet_eat = cursor.execute(
                        "SELECT pet_eat from users where user_id = ?", (message.from_user.id,))
                    pet_eat = cursor.fetchone()
                    pet_eat = int(pet_eat[0])
                    pet_mood = cursor.execute("SELECT pet_mood from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_mood = cursor.fetchone()
                    pet_mood = int(pet_mood[0])
                    chat_id = message.chat.id
                    msg = message
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    user_id = msg.from_user.id
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = round(int(balance[0]))
                    summ = 50000000000
                    c = 1
                    pets = pet1 + pet2 + pet3 + pet4 + pet5 + pet6 + pet7 + pet8 + pet9

                    checking = cursor.execute("SELECT checking from users where user_id = ?",
                                              (message.from_user.id,))
                    checking = cursor.fetchone()
                    checking = round(int(checking[0]))
                    if checking == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking1 = cursor.execute("SELECT checking1 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking1 = cursor.fetchone()
                    checking1 = round(int(checking1[0]))
                    if checking1 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking2 = cursor.execute("SELECT checking2 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking2 = cursor.fetchone()
                    checking2 = round(int(checking2[0]))
                    if checking2 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking3 = cursor.execute("SELECT checking3 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking3 = cursor.fetchone()
                    checking3 = round(int(checking3[0]))
                    if checking3 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return

                    if int(pets) == 0:
                        if pet5 == 0:
                            if int(balance) >= int(summ):
                                await bot.send_message(message.chat.id,
                                                       f'🦄 | {user_name}, вы успешно купили единорога за 50.000.000.000₸ 🎉',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - summ} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet5 = {pet5 + c} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_hp = {100} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_eat = {100} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_mood = {100} WHERE user_id = {user_id}')
                                connect.commit()
                                return
                            else:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                                return
                        if pet5 == 1:
                            await bot.send_message(message.chat.id,
                                                   f'‼️  {user_name}, у вас уже есть данный питомец! {rloser}',
                                                   parse_mode='html')
                            return
                    if pets == 1:
                        await bot.send_message(message.chat.id, f'‼️  {user_name}, у вас уже есть питомец! {rloser}',
                                               parse_mode='html')

                if message.text.lower() in ["купить питомца 6", "Купить питомца 6"]:
                    user_name = message.from_user.get_mention(as_html=True)
                    pet1 = cursor.execute(
                        "SELECT pet1 from users where user_id = ?", (message.from_user.id,))
                    pet1 = cursor.fetchone()
                    pet1 = int(pet1[0])
                    pet2 = cursor.execute(
                        "SELECT pet2 from users where user_id = ?", (message.from_user.id,))
                    pet2 = cursor.fetchone()
                    pet2 = int(pet2[0])
                    pet3 = cursor.execute(
                        "SELECT pet3 from users where user_id = ?", (message.from_user.id,))
                    pet3 = cursor.fetchone()
                    pet3 = int(pet3[0])
                    pet4 = cursor.execute(
                        "SELECT pet4 from users where user_id = ?", (message.from_user.id,))
                    pet4 = cursor.fetchone()
                    pet4 = int(pet4[0])
                    pet5 = cursor.execute(
                        "SELECT pet5 from users where user_id = ?", (message.from_user.id,))
                    pet5 = cursor.fetchone()
                    pet5 = int(pet5[0])
                    pet6 = cursor.execute(
                        "SELECT pet6 from users where user_id = ?", (message.from_user.id,))
                    pet6 = cursor.fetchone()
                    pet6 = int(pet6[0])
                    pet7 = cursor.execute(
                        "SELECT pet7 from users where user_id = ?", (message.from_user.id,))
                    pet7 = cursor.fetchone()
                    pet7 = int(pet7[0])
                    pet8 = cursor.execute(
                        "SELECT pet8 from users where user_id = ?", (message.from_user.id,))
                    pet8 = cursor.fetchone()
                    pet8 = int(pet8[0])
                    pet9 = cursor.execute(
                        "SELECT pet9 from users where user_id = ?", (message.from_user.id,))
                    pet9 = cursor.fetchone()
                    pet9 = int(pet9[0])
                    pet_name = cursor.execute("SELECT pet_name from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_name = cursor.fetchone()
                    pet_name = str(pet_name[0])
                    pet_hp = cursor.execute(
                        "SELECT pet_hp from users where user_id = ?", (message.from_user.id,))
                    pet_hp = cursor.fetchone()
                    pet_hp = int(pet_hp[0])
                    pet_eat = cursor.execute(
                        "SELECT pet_eat from users where user_id = ?", (message.from_user.id,))
                    pet_eat = cursor.fetchone()
                    pet_eat = int(pet_eat[0])
                    pet_mood = cursor.execute("SELECT pet_mood from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_mood = cursor.fetchone()
                    pet_mood = int(pet_mood[0])
                    chat_id = message.chat.id
                    msg = message
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    user_id = msg.from_user.id
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = round(int(balance[0]))
                    summ = 100000000000
                    c = 1
                    pets = pet1 + pet2 + pet3 + pet4 + pet5 + pet6 + pet7 + pet8 + pet9

                    checking = cursor.execute("SELECT checking from users where user_id = ?",
                                              (message.from_user.id,))
                    checking = cursor.fetchone()
                    checking = round(int(checking[0]))
                    if checking == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking1 = cursor.execute("SELECT checking1 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking1 = cursor.fetchone()
                    checking1 = round(int(checking1[0]))
                    if checking1 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking2 = cursor.execute("SELECT checking2 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking2 = cursor.fetchone()
                    checking2 = round(int(checking2[0]))
                    if checking2 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking3 = cursor.execute("SELECT checking3 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking3 = cursor.fetchone()
                    checking3 = round(int(checking3[0]))
                    if checking3 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return

                    if int(pets) == 0:
                        if pet6 == 0:
                            if int(balance) >= int(summ):
                                await bot.send_message(message.chat.id,
                                                       f'� | {user_name}, вы успешно купили обезьяну за 100.000.000.000₸ 🎉',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - summ} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet6 = {pet6 + c} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_hp = {100} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_eat = {100} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_mood = {100} WHERE user_id = {user_id}')
                                connect.commit()
                                return
                            else:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                                return
                        if pet6 == 1:
                            await bot.send_message(message.chat.id,
                                                   f'‼️  {user_name}, у вас уже есть данный питомец! {rloser}',
                                                   parse_mode='html')
                            return
                    if pets == 1:
                        await bot.send_message(message.chat.id, f'‼️  {user_name}, у вас уже есть питомец! {rloser}',
                                               parse_mode='html')

                if message.text.lower() in ["купить питомца 7", "Купить питомца 7"]:
                    user_name = message.from_user.get_mention(as_html=True)
                    pet1 = cursor.execute(
                        "SELECT pet1 from users where user_id = ?", (message.from_user.id,))
                    pet1 = cursor.fetchone()
                    pet1 = int(pet1[0])
                    pet2 = cursor.execute(
                        "SELECT pet2 from users where user_id = ?", (message.from_user.id,))
                    pet2 = cursor.fetchone()
                    pet2 = int(pet2[0])
                    pet3 = cursor.execute(
                        "SELECT pet3 from users where user_id = ?", (message.from_user.id,))
                    pet3 = cursor.fetchone()
                    pet3 = int(pet3[0])
                    pet4 = cursor.execute(
                        "SELECT pet4 from users where user_id = ?", (message.from_user.id,))
                    pet4 = cursor.fetchone()
                    pet4 = int(pet4[0])
                    pet5 = cursor.execute(
                        "SELECT pet5 from users where user_id = ?", (message.from_user.id,))
                    pet5 = cursor.fetchone()
                    pet5 = int(pet5[0])
                    pet6 = cursor.execute(
                        "SELECT pet6 from users where user_id = ?", (message.from_user.id,))
                    pet6 = cursor.fetchone()
                    pet6 = int(pet6[0])
                    pet7 = cursor.execute(
                        "SELECT pet7 from users where user_id = ?", (message.from_user.id,))
                    pet7 = cursor.fetchone()
                    pet7 = int(pet7[0])
                    pet8 = cursor.execute(
                        "SELECT pet8 from users where user_id = ?", (message.from_user.id,))
                    pet8 = cursor.fetchone()
                    pet8 = int(pet8[0])
                    pet9 = cursor.execute(
                        "SELECT pet9 from users where user_id = ?", (message.from_user.id,))
                    pet9 = cursor.fetchone()
                    pet9 = int(pet9[0])
                    pet_name = cursor.execute("SELECT pet_name from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_name = cursor.fetchone()
                    pet_name = str(pet_name[0])
                    pet_hp = cursor.execute(
                        "SELECT pet_hp from users where user_id = ?", (message.from_user.id,))
                    pet_hp = cursor.fetchone()
                    pet_hp = int(pet_hp[0])
                    pet_eat = cursor.execute(
                        "SELECT pet_eat from users where user_id = ?", (message.from_user.id,))
                    pet_eat = cursor.fetchone()
                    pet_eat = int(pet_eat[0])
                    pet_mood = cursor.execute("SELECT pet_mood from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_mood = cursor.fetchone()
                    pet_mood = int(pet_mood[0])
                    chat_id = message.chat.id
                    msg = message
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    user_id = msg.from_user.id
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = round(int(balance[0]))
                    summ = 500000000000
                    c = 1
                    pets = pet1 + pet2 + pet3 + pet4 + pet5 + pet6 + pet7 + pet8 + pet9

                    checking = cursor.execute("SELECT checking from users where user_id = ?",
                                              (message.from_user.id,))
                    checking = cursor.fetchone()
                    checking = round(int(checking[0]))
                    if checking == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking1 = cursor.execute("SELECT checking1 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking1 = cursor.fetchone()
                    checking1 = round(int(checking1[0]))
                    if checking1 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking2 = cursor.execute("SELECT checking2 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking2 = cursor.fetchone()
                    checking2 = round(int(checking2[0]))
                    if checking2 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking3 = cursor.execute("SELECT checking3 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking3 = cursor.fetchone()
                    checking3 = round(int(checking3[0]))
                    if checking3 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return

                    if int(pets) == 0:
                        if pet7 == 0:
                            if int(balance) >= int(summ):
                                await bot.send_message(message.chat.id,
                                                       f'� | {user_name}, вы успешно купили дельфина за 500.000.000.000₸ 🎉',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - summ} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet7 = {pet7 + c} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_hp = {100} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_eat = {100} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_mood = {100} WHERE user_id = {user_id}')
                                connect.commit()
                                return
                            else:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                                return
                        if pet7 == 1:
                            await bot.send_message(message.chat.id,
                                                   f'‼️  {user_name}, у вас уже есть данный питомец! {rloser}',
                                                   parse_mode='html')
                            return
                    if pets == 1:
                        await bot.send_message(message.chat.id, f'‼️  {user_name}, у вас уже есть питомец! {rloser}',
                                               parse_mode='html')

                if message.text.lower() in ["купить питомца 8", "Купить питомца 8"]:
                    user_name = message.from_user.get_mention(as_html=True)
                    pet1 = cursor.execute(
                        "SELECT pet1 from users where user_id = ?", (message.from_user.id,))
                    pet1 = cursor.fetchone()
                    pet1 = int(pet1[0])
                    pet2 = cursor.execute(
                        "SELECT pet2 from users where user_id = ?", (message.from_user.id,))
                    pet2 = cursor.fetchone()
                    pet2 = int(pet2[0])
                    pet3 = cursor.execute(
                        "SELECT pet3 from users where user_id = ?", (message.from_user.id,))
                    pet3 = cursor.fetchone()
                    pet3 = int(pet3[0])
                    pet4 = cursor.execute(
                        "SELECT pet4 from users where user_id = ?", (message.from_user.id,))
                    pet4 = cursor.fetchone()
                    pet4 = int(pet4[0])
                    pet5 = cursor.execute(
                        "SELECT pet5 from users where user_id = ?", (message.from_user.id,))
                    pet5 = cursor.fetchone()
                    pet5 = int(pet5[0])
                    pet6 = cursor.execute(
                        "SELECT pet6 from users where user_id = ?", (message.from_user.id,))
                    pet6 = cursor.fetchone()
                    pet6 = int(pet6[0])
                    pet7 = cursor.execute(
                        "SELECT pet7 from users where user_id = ?", (message.from_user.id,))
                    pet7 = cursor.fetchone()
                    pet7 = int(pet7[0])
                    pet8 = cursor.execute(
                        "SELECT pet8 from users where user_id = ?", (message.from_user.id,))
                    pet8 = cursor.fetchone()
                    pet8 = int(pet8[0])
                    pet9 = cursor.execute(
                        "SELECT pet9 from users where user_id = ?", (message.from_user.id,))
                    pet9 = cursor.fetchone()
                    pet9 = int(pet9[0])
                    pet_name = cursor.execute("SELECT pet_name from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_name = cursor.fetchone()
                    pet_name = str(pet_name[0])
                    pet_hp = cursor.execute(
                        "SELECT pet_hp from users where user_id = ?", (message.from_user.id,))
                    pet_hp = cursor.fetchone()
                    pet_hp = int(pet_hp[0])
                    pet_eat = cursor.execute(
                        "SELECT pet_eat from users where user_id = ?", (message.from_user.id,))
                    pet_eat = cursor.fetchone()
                    pet_eat = int(pet_eat[0])
                    pet_mood = cursor.execute("SELECT pet_mood from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_mood = cursor.fetchone()
                    pet_mood = int(pet_mood[0])
                    chat_id = message.chat.id
                    msg = message
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    user_id = msg.from_user.id
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = round(int(balance[0]))
                    summ = 10000000000000
                    c = 1
                    pets = pet1 + pet2 + pet3 + pet4 + pet5 + pet6 + pet7 + pet8 + pet9

                    checking = cursor.execute("SELECT checking from users where user_id = ?",
                                              (message.from_user.id,))
                    checking = cursor.fetchone()
                    checking = round(int(checking[0]))
                    if checking == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking1 = cursor.execute("SELECT checking1 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking1 = cursor.fetchone()
                    checking1 = round(int(checking1[0]))
                    if checking1 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking2 = cursor.execute("SELECT checking2 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking2 = cursor.fetchone()
                    checking2 = round(int(checking2[0]))
                    if checking2 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking3 = cursor.execute("SELECT checking3 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking3 = cursor.fetchone()
                    checking3 = round(int(checking3[0]))
                    if checking3 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return

                    if int(pets) == 0:
                        if pet8 == 0:
                            if int(balance) >= int(summ):
                                await bot.send_message(message.chat.id,
                                                       f'� | {user_name}, вы успешно купили тигра за 10.000.000.000.000₸ 🎉',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - summ} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet8 = {pet8 + c} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_hp = {100} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_eat = {100} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_mood = {100} WHERE user_id = {user_id}')
                                connect.commit()
                                return
                            else:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                                return
                        if pet8 == 1:
                            await bot.send_message(message.chat.id,
                                                   f'‼️  {user_name}, у вас уже есть данный питомец! {rloser}',
                                                   parse_mode='html')
                            return
                    if pets == 1:
                        await bot.send_message(message.chat.id, f'‼️  {user_name}, у вас уже есть питомец! {rloser}',
                                               parse_mode='html')

                if message.text.lower() in ["купить питомца 9", "Купить питомца 9"]:
                    user_name = message.from_user.get_mention(as_html=True)
                    pet1 = cursor.execute(
                        "SELECT pet1 from users where user_id = ?", (message.from_user.id,))
                    pet1 = cursor.fetchone()
                    pet1 = int(pet1[0])
                    pet2 = cursor.execute(
                        "SELECT pet2 from users where user_id = ?", (message.from_user.id,))
                    pet2 = cursor.fetchone()
                    pet2 = int(pet2[0])
                    pet3 = cursor.execute(
                        "SELECT pet3 from users where user_id = ?", (message.from_user.id,))
                    pet3 = cursor.fetchone()
                    pet3 = int(pet3[0])
                    pet4 = cursor.execute(
                        "SELECT pet4 from users where user_id = ?", (message.from_user.id,))
                    pet4 = cursor.fetchone()
                    pet4 = int(pet4[0])
                    pet5 = cursor.execute(
                        "SELECT pet5 from users where user_id = ?", (message.from_user.id,))
                    pet5 = cursor.fetchone()
                    pet5 = int(pet5[0])
                    pet6 = cursor.execute(
                        "SELECT pet6 from users where user_id = ?", (message.from_user.id,))
                    pet6 = cursor.fetchone()
                    pet6 = int(pet6[0])
                    pet7 = cursor.execute(
                        "SELECT pet7 from users where user_id = ?", (message.from_user.id,))
                    pet7 = cursor.fetchone()
                    pet7 = int(pet7[0])
                    pet8 = cursor.execute(
                        "SELECT pet8 from users where user_id = ?", (message.from_user.id,))
                    pet8 = cursor.fetchone()
                    pet8 = int(pet8[0])
                    pet9 = cursor.execute(
                        "SELECT pet9 from users where user_id = ?", (message.from_user.id,))
                    pet9 = cursor.fetchone()
                    pet9 = int(pet9[0])
                    pet_name = cursor.execute("SELECT pet_name from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_name = cursor.fetchone()
                    pet_name = str(pet_name[0])
                    pet_hp = cursor.execute(
                        "SELECT pet_hp from users where user_id = ?", (message.from_user.id,))
                    pet_hp = cursor.fetchone()
                    pet_hp = int(pet_hp[0])
                    pet_eat = cursor.execute(
                        "SELECT pet_eat from users where user_id = ?", (message.from_user.id,))
                    pet_eat = cursor.fetchone()
                    pet_eat = int(pet_eat[0])
                    pet_mood = cursor.execute("SELECT pet_mood from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_mood = cursor.fetchone()
                    pet_mood = int(pet_mood[0])
                    chat_id = message.chat.id
                    msg = message
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    user_id = msg.from_user.id
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = round(int(balance[0]))
                    summ = 100000000000000
                    c = 1
                    pets = pet1 + pet2 + pet3 + pet4 + pet5 + pet6 + pet7 + pet8 + pet9

                    checking = cursor.execute("SELECT checking from users where user_id = ?",
                                              (message.from_user.id,))
                    checking = cursor.fetchone()
                    checking = round(int(checking[0]))
                    if checking == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking1 = cursor.execute("SELECT checking1 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking1 = cursor.fetchone()
                    checking1 = round(int(checking1[0]))
                    if checking1 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking2 = cursor.execute("SELECT checking2 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking2 = cursor.fetchone()
                    checking2 = round(int(checking2[0]))
                    if checking2 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking3 = cursor.execute("SELECT checking3 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking3 = cursor.fetchone()
                    checking3 = round(int(checking3[0]))
                    if checking3 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return

                    if int(pets) == 0:
                        if pet9 == 0:
                            if int(balance) >= int(summ):
                                await bot.send_message(message.chat.id,
                                                       f'🐉 | {user_name}, вы успешно купили дракона за 100.000.000.000.000₸ 🎉',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - summ} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet9 = {pet9 + c} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_hp = {100} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_eat = {100} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_mood = {100} WHERE user_id = {user_id}')
                                connect.commit()
                                return
                            else:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                                return
                        if pet9 == 1:
                            await bot.send_message(message.chat.id,
                                                   f'‼️  {user_name}, у вас уже есть данный питомец! {rloser}',
                                                   parse_mode='html')
                            return
                    if pets == 1:
                        await bot.send_message(message.chat.id, f'‼️ {user_name}, у вас уже есть питомец! {rloser}',
                                               parse_mode='html')

                if message.text.lower() in ["мой питомец", "Мой питомец"]:
                    user_name = message.from_user.get_mention(as_html=True)
                    pet1 = cursor.execute(
                        "SELECT pet1 from users where user_id = ?", (message.from_user.id,))
                    pet1 = cursor.fetchone()
                    pet1 = int(pet1[0])
                    pet2 = cursor.execute(
                        "SELECT pet2 from users where user_id = ?", (message.from_user.id,))
                    pet2 = cursor.fetchone()
                    pet2 = int(pet2[0])
                    pet3 = cursor.execute(
                        "SELECT pet3 from users where user_id = ?", (message.from_user.id,))
                    pet3 = cursor.fetchone()
                    pet3 = int(pet3[0])
                    pet4 = cursor.execute(
                        "SELECT pet4 from users where user_id = ?", (message.from_user.id,))
                    pet4 = cursor.fetchone()
                    pet4 = int(pet4[0])
                    pet5 = cursor.execute(
                        "SELECT pet5 from users where user_id = ?", (message.from_user.id,))
                    pet5 = cursor.fetchone()
                    pet5 = int(pet5[0])
                    pet6 = cursor.execute(
                        "SELECT pet6 from users where user_id = ?", (message.from_user.id,))
                    pet6 = cursor.fetchone()
                    pet6 = int(pet6[0])
                    pet7 = cursor.execute(
                        "SELECT pet7 from users where user_id = ?", (message.from_user.id,))
                    pet7 = cursor.fetchone()
                    pet7 = int(pet7[0])
                    pet8 = cursor.execute(
                        "SELECT pet8 from users where user_id = ?", (message.from_user.id,))
                    pet8 = cursor.fetchone()
                    pet8 = int(pet8[0])
                    pet9 = cursor.execute(
                        "SELECT pet9 from users where user_id = ?", (message.from_user.id,))
                    pet9 = cursor.fetchone()
                    pet9 = int(pet9[0])
                    pet_name = cursor.execute("SELECT pet_name from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_name = cursor.fetchone()
                    pet_name = str(pet_name[0])
                    pet_hp = cursor.execute(
                        "SELECT pet_hp from users where user_id = ?", (message.from_user.id,))
                    pet_hp = cursor.fetchone()
                    pet_hp = int(pet_hp[0])
                    pet_eat = cursor.execute(
                        "SELECT pet_eat from users where user_id = ?", (message.from_user.id,))
                    pet_eat = cursor.fetchone()
                    pet_eat = int(pet_eat[0])
                    pet_mood = cursor.execute("SELECT pet_mood from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_mood = cursor.fetchone()
                    pet_mood = int(pet_mood[0])
                    chat_id = message.chat.id
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    pets = pet1 + pet2 + pet3 + pet4 + pet5 + pet6 + pet7 + pet8 + pet9
                    if pets == 0:
                        await bot.send_message(message.chat.id, f'‼️  {user_name}, у вас нету питомца! {rloser}',
                                               parse_mode='html')
                    if pet1 == 1:
                        await message.bot.send_message(message.chat.id,
                                                       f'🐥 | {user_name}, ваш питомец: цыплёнок \n✏️ | Имя питомца: {pet_name}\n❤️ | ХП: {pet_hp} \n🍗 | Сытость: {pet_eat}\n☀️ | Настроение: {pet_mood} \n\n✏ | Питомец имя [имя] - изменить имя питомца\n❤ | Вылечить питомца - вылечить питомца\n🍗 | Покормить питомца - покормить питомца\n🌳 | Выгулять питомца - поднять настроение питомцу',
                                                       parse_mode='html')
                    if pet2 == 1:
                        await message.bot.send_message(message.chat.id,
                                                       f'🐈 | {user_name}, ваш питомец: кот \n✏️ | Имя питомца: {pet_name}\n❤️ | ХП: {pet_hp} \n🍗 | Сытость: {pet_eat}\n☀️ | Настроение: {pet_mood} \n\n✏ | Питомец имя [имя] - изменить имя питомца\n❤ | Вылечить питомца - вылечить питомца\n🍗 | Покормить питомца - покормить питомца\n🌳 | Выгулять питомца - поднять настроение питомцу',
                                                       parse_mode='html')
                    if pet3 == 1:
                        await message.bot.send_message(message.chat.id,
                                                       '🐕 | {user_name}, ваш питомец: пёс \n✏️ | Имя питомца: {pet_name}\n❤️ | ХП: {pet_hp} \n🍗 | Сытость: {pet_eat}\n☀️ | Настроение: {pet_mood} \n\n✏ | Питомец имя [имя] - изменить имя питомца\n❤ | Вылечить питомца - вылечить питомца\n🍗 | Покормить питомца - покормить питомца\n🌳 | Выгулять питомца - поднять настроение питомцу',
                                                       parse_mode='html')
                    if pet4 == 1:
                        await message.bot.send_message(message.chat.id,
                                                       f'🦜 | {user_name}, ваш питомец: попугай \n✏️ | Имя питомца: {pet_name}\n❤️ | ХП: {pet_hp} \n🍗 | Сытость: {pet_eat}\n☀️ | Настроение: {pet_mood} \n\n✏ | Питомец имя [имя] - изменить имя питомца\n❤ | Вылечить питомца - вылечить питомца\n🍗 | Покормить питомца - покормить питомца\n🌳 | Выгулять питомца - поднять настроение питомцу',
                                                       parse_mode='html')
                    if pet5 == 1:
                        await message.bot.send_message(message.chat.id,
                                                       f'🦄 | {user_name}, ваш питомец: единорог \n✏️ | Имя питомца: {pet_name}\n❤️ | ХП: {pet_hp} \n🍗 | Сытость: {pet_eat}\n☀️ | Настроение: {pet_mood} \n\n✏ | Питомец имя [имя] - изменить имя питомца\n❤ | Вылечить питомца - вылечить питомца\n🍗 | Покормить питомца - покормить питомца\n🌳 | Выгулять питомца - поднять настроение питомцу',
                                                       parse_mode='html')
                    if pet6 == 1:
                        await message.bot.send_message(message.chat.id,
                                                       f'🐒 | {user_name}, ваш питомец: обезьяна \n✏️ | Имя питомца: {pet_name}\n❤️ | ХП: {pet_hp} \n🍗 | Сытость: {pet_eat}\n☀️ | Настроение: {pet_mood} \n\n✏ | Питомец имя [имя] - изменить имя питомца\n❤ | Вылечить питомца - вылечить питомца\n🍗 | Покормить питомца - покормить питомца\n🌳 | Выгулять питомца - поднять настроение питомцу',
                                                       parse_mode='html')
                    if pet7 == 1:
                        await message.bot.send_message(message.chat.id,
                                                       f'🐬 | {user_name}, ваш питомец: дельфин \n✏️ | Имя питомца: {pet_name}\n❤️ | ХП: {pet_hp} \n🍗 | Сытость: {pet_eat}\n☀️ | Настроение: {pet_mood} \n\n✏ | Питомец имя [имя] - изменить имя питомца\n❤ | Вылечить питомца - вылечить питомца\n🍗 | Покормить питомца - покормить питомца\n🌳 | Выгулять питомца - поднять настроение питомцу',
                                                       parse_mode='html')
                    if pet8 == 1:
                        await message.bot.send_message(message.chat.id,
                                                       f'🐅 | {user_name}, ваш питомец: тигр \n✏️ | Имя питомца: {pet_name}\n❤️ | ХП: {pet_hp} \n🍗 | Сытость: {pet_eat}\n☀️ | Настроение: {pet_mood} \n\n✏ | Питомец имя [имя] - изменить имя питомца\n❤ | Вылечить питомца - вылечить питомца\n🍗 | Покормить питомца - покормить питомца\n🌳 | Выгулять питомца - поднять настроение питомцу',
                                                       parse_mode='html')
                    if pet9 == 1:
                        await message.bot.send_message(message.chat.id,
                                                       f'🐉 | {user_name}, ваш питомец: дракон \n✏️ | Имя питомца: {pet_name}\n❤️ | ХП: {pet_hp} \n🍗 | Сытость: {pet_eat}\n☀️ | Настроение: {pet_mood} \n\n✏ | Питомец имя [имя] - изменить имя питомца\n❤ | Вылечить питомца - вылечить питомца\n🍗 | Покормить питомца - покормить питомца\n🌳 | Выгулять питомца - поднять настроение питомцу',
                                                       parse_mode='html')


                if message.text.lower() in ["вылечить питомца", "Вылечить питомца"]:
                    user_name = message.from_user.get_mention(as_html=True)
                    pet1 = cursor.execute(
                        "SELECT pet1 from users where user_id = ?", (message.from_user.id,))
                    pet1 = cursor.fetchone()
                    pet1 = int(pet1[0])
                    pet2 = cursor.execute(
                        "SELECT pet2 from users where user_id = ?", (message.from_user.id,))
                    pet2 = cursor.fetchone()
                    pet2 = int(pet2[0])
                    pet3 = cursor.execute(
                        "SELECT pet3 from users where user_id = ?", (message.from_user.id,))
                    pet3 = cursor.fetchone()
                    pet3 = int(pet3[0])
                    pet4 = cursor.execute(
                        "SELECT pet4 from users where user_id = ?", (message.from_user.id,))
                    pet4 = cursor.fetchone()
                    pet4 = int(pet4[0])
                    pet5 = cursor.execute(
                        "SELECT pet5 from users where user_id = ?", (message.from_user.id,))
                    pet5 = cursor.fetchone()
                    pet5 = int(pet5[0])
                    pet6 = cursor.execute(
                        "SELECT pet6 from users where user_id = ?", (message.from_user.id,))
                    pet6 = cursor.fetchone()
                    pet6 = int(pet6[0])
                    pet7 = cursor.execute(
                        "SELECT pet7 from users where user_id = ?", (message.from_user.id,))
                    pet7 = cursor.fetchone()
                    pet7 = int(pet7[0])
                    pet8 = cursor.execute(
                        "SELECT pet8 from users where user_id = ?", (message.from_user.id,))
                    pet8 = cursor.fetchone()
                    pet8 = int(pet8[0])
                    pet9 = cursor.execute(
                        "SELECT pet9 from users where user_id = ?", (message.from_user.id,))
                    pet9 = cursor.fetchone()
                    pet9 = int(pet9[0])
                    pet_name = cursor.execute("SELECT pet_name from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_name = cursor.fetchone()
                    pet_name = str(pet_name[0])
                    pet_hp = cursor.execute(
                        "SELECT pet_hp from users where user_id = ?", (message.from_user.id,))
                    pet_hp = cursor.fetchone()
                    pet_hp = int(pet_hp[0])
                    pet_eat = cursor.execute(
                        "SELECT pet_eat from users where user_id = ?", (message.from_user.id,))
                    pet_eat = cursor.fetchone()
                    pet_eat = int(pet_eat[0])
                    pet_mood = cursor.execute("SELECT pet_mood from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_mood = cursor.fetchone()
                    pet_mood = int(pet_mood[0])
                    chat_id = message.chat.id
                    user_id = message.from_user.id
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = round(int(balance[0]))
                    pets = pet1 + pet2 + pet3 + pet4 + pet5 + pet6 + pet7 + pet8 + pet9
                    c = Decimal((100 - pet_hp) * 10000)
                    c2 = (100 - pet_hp) * 10000
                    hp = 100 - pet_hp
                    checking = cursor.execute("SELECT checking from users where user_id = ?",
                                              (message.from_user.id,))
                    checking = cursor.fetchone()
                    checking = round(int(checking[0]))
                    if checking == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking1 = cursor.execute("SELECT checking1 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking1 = cursor.fetchone()
                    checking1 = round(int(checking1[0]))
                    if checking1 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking2 = cursor.execute("SELECT checking2 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking2 = cursor.fetchone()
                    checking2 = round(int(checking2[0]))
                    if checking2 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking3 = cursor.execute("SELECT checking3 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking3 = cursor.fetchone()
                    checking3 = round(int(checking3[0]))
                    if checking3 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    if pets == 0:
                        await bot.send_message(message.chat.id, f'‼️  {user_name}, у вас нету питомца! {rloser}',
                                               parse_mode='html')
                    if pet1 == 1:
                        if pet_hp < 100:
                            if c <= balance:
                                await bot.send_message(message.chat.id, f'❤ | {user_name}, вы вылечили своего питомца за {c}!',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c2} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_hp = {pet_hp + hp} WHERE user_id = {user_id}')
                            if c > balance:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                        if pet_hp == 100:
                            await bot.send_message(message.chat.id, f'❤ | {user_name}, ваш питомец не нуждается в лечении!',
                                                   parse_mode='html')
                    if pet2 == 1:
                        if pet_hp < 100:
                            if c <= balance:
                                await bot.send_message(message.chat.id, f'❤ | {user_name}, вы вылечили своего питомца за {c}!',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c2} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_hp = {pet_hp + hp} WHERE user_id = {user_id}')
                            if c > balance:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                        if pet_hp == 100:
                            await bot.send_message(message.chat.id, f'❤ | {user_name}, ваш питомец не нуждается в лечении!',
                                                   parse_mode='html')
                    if pet3 == 1:
                        if pet_hp < 100:
                            if c <= balance:
                                await bot.send_message(message.chat.id, f'❤ | {user_name}, вы вылечили своего питомца за {c}!',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c2} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_hp = {pet_hp + hp} WHERE user_id = {user_id}')
                            if c > balance:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                        if pet_hp == 100:
                            await bot.send_message(message.chat.id, f'❤ | {user_name}, ваш питомец не нуждается в лечении!',
                                                   parse_mode='html')
                    if pet4 == 1:
                        if pet_hp < 100:
                            if c <= balance:
                                await bot.send_message(message.chat.id, f'❤ | {user_name}, вы вылечили своего питомца за {c}!',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c2} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_hp = {pet_hp + hp} WHERE user_id = {user_id}')
                            if c > balance:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                        if pet_hp == 100:
                            await bot.send_message(message.chat.id, f'❤ | {user_name}, ваш питомец не нуждается в лечении!',
                                                   parse_mode='html')
                    if pet5 == 1:
                        if pet_hp < 100:
                            if c <= balance:
                                await bot.send_message(message.chat.id, f'❤ | {user_name}, вы вылечили своего питомца за {c}!',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c2} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_hp = {pet_hp + hp} WHERE user_id = {user_id}')
                            if c > balance:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                        if pet_hp == 100:
                            await bot.send_message(message.chat.id, f'❤ | {user_name}, ваш питомец не нуждается в лечении!',
                                                   parse_mode='html')
                    if pet6 == 1:
                        if pet_hp < 100:
                            if c <= balance:
                                await bot.send_message(message.chat.id, f'❤ | {user_name}, вы вылечили своего питомца за {c}!',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c2} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_hp = {pet_hp + hp} WHERE user_id = {user_id}')
                            if c > balance:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                        if pet_hp == 100:
                            await bot.send_message(message.chat.id, f'❤ | {user_name}, ваш питомец не нуждается в лечении!',
                                                   parse_mode='html')
                    if pet7 == 1:
                        if pet_hp < 100:
                            if c <= balance:
                                await bot.send_message(message.chat.id, f'❤ | {user_name}, вы вылечили своего питомца за {c}',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c2} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_hp = {pet_hp + hp} WHERE user_id = {user_id}')
                            if c > balance:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                        if pet_hp == 100:
                            await bot.send_message(message.chat.id, f'❤ | {user_name}, ваш питомец не нуждается в лечении!',
                                                   parse_mode='html')
                    if pet8 == 1:
                        if pet_hp < 100:
                            if c <= balance:
                                await bot.send_message(message.chat.id, f'❤ | {user_name}, вы вылечили своего питомца за {c}!',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c2} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_hp = {pet_hp + hp} WHERE user_id = {user_id}')
                            if c > balance:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                        if pet_hp == 100:
                            await bot.send_message(message.chat.id, f'❤ | {user_name}, ваш питомец не нуждается в лечении!',
                                                   parse_mode='html')
                    if pet9 == 1:
                        if pet_hp < 100:
                            if c <= balance:
                                await bot.send_message(message.chat.id, f'❤ | {user_name}, вы вылечили своего питомца за {c}!',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c2} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_hp = {pet_hp + hp} WHERE user_id = {user_id}')
                            if c > balance:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                        if pet_hp == 100:
                            await bot.send_message(message.chat.id, f'❤ | {user_name}, ваш питомец не нуждается в лечении!',
                                                   parse_mode='html')



                if message.text.lower() in ["покормить питомца", "Покормить питомца"]:
                    user_name = message.from_user.get_mention(as_html=True)
                    pet1 = cursor.execute(
                        "SELECT pet1 from users where user_id = ?", (message.from_user.id,))
                    pet1 = cursor.fetchone()
                    pet1 = int(pet1[0])
                    pet2 = cursor.execute(
                        "SELECT pet2 from users where user_id = ?", (message.from_user.id,))
                    pet2 = cursor.fetchone()
                    pet2 = int(pet2[0])
                    pet3 = cursor.execute(
                        "SELECT pet3 from users where user_id = ?", (message.from_user.id,))
                    pet3 = cursor.fetchone()
                    pet3 = int(pet3[0])
                    pet4 = cursor.execute(
                        "SELECT pet4 from users where user_id = ?", (message.from_user.id,))
                    pet4 = cursor.fetchone()
                    pet4 = int(pet4[0])
                    pet5 = cursor.execute(
                        "SELECT pet5 from users where user_id = ?", (message.from_user.id,))
                    pet5 = cursor.fetchone()
                    pet5 = int(pet5[0])
                    pet6 = cursor.execute(
                        "SELECT pet6 from users where user_id = ?", (message.from_user.id,))
                    pet6 = cursor.fetchone()
                    pet6 = int(pet6[0])
                    pet7 = cursor.execute(
                        "SELECT pet7 from users where user_id = ?", (message.from_user.id,))
                    pet7 = cursor.fetchone()
                    pet7 = int(pet7[0])
                    pet8 = cursor.execute(
                        "SELECT pet8 from users where user_id = ?", (message.from_user.id,))
                    pet8 = cursor.fetchone()
                    pet8 = int(pet8[0])
                    pet9 = cursor.execute(
                        "SELECT pet9 from users where user_id = ?", (message.from_user.id,))
                    pet9 = cursor.fetchone()
                    pet9 = int(pet9[0])
                    pet_name = cursor.execute("SELECT pet_name from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_name = cursor.fetchone()
                    pet_name = str(pet_name[0])
                    pet_hp = cursor.execute(
                        "SELECT pet_hp from users where user_id = ?", (message.from_user.id,))
                    pet_hp = cursor.fetchone()
                    pet_hp = int(pet_hp[0])
                    pet_eat = cursor.execute(
                        "SELECT pet_eat from users where user_id = ?", (message.from_user.id,))
                    pet_eat = cursor.fetchone()
                    pet_eat = int(pet_eat[0])
                    pet_mood = cursor.execute("SELECT pet_mood from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_mood = cursor.fetchone()
                    pet_mood = int(pet_mood[0])
                    chat_id = message.chat.id
                    user_id = message.from_user.id
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance=cursor.fetchone()
                    balance = round(int(balance[0]))
                    pets = pet1 + pet2 + pet3 + pet4 + pet5 + pet6 + pet7 + pet8 + pet9
                    c = Decimal((100 - pet_eat) * 10000)
                    c2 = (100 - pet_eat) * 10000
                    eat = 100 - pet_eat
                    checking = cursor.execute("SELECT checking from users where user_id = ?",
                                              (message.from_user.id,))
                    checking = cursor.fetchone()
                    checking = round(int(checking[0]))
                    if checking == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking1 = cursor.execute("SELECT checking1 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking1 = cursor.fetchone()
                    checking1 = round(int(checking1[0]))
                    if checking1 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking2 = cursor.execute("SELECT checking2 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking2 = cursor.fetchone()
                    checking2 = round(int(checking2[0]))
                    if checking2 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking3 = cursor.execute("SELECT checking3 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking3 = cursor.fetchone()
                    checking3 = round(int(checking3[0]))
                    if checking3 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    if pets == 0:
                        await bot.send_message(message.chat.id, f'‼️  {user_name}, у вас нету питомца! {rloser}',
                                               parse_mode='html')
                    if pet1 == 1:
                        if pet_eat < 100:
                            if c <= balance:
                                await bot.send_message(message.chat.id,
                                                       f'🍗 | {user_name}, вы покормили своего питомца за {c}!',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c2} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_eat = {pet_eat + eat} WHERE user_id = {user_id}')
                            if c > balance:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                        if pet_eat == 100:
                            await bot.send_message(message.chat.id, f'🍗 | {user_name}, ваш питомец не голоден! {rloser}',
                                                   parse_mode='html')
                    if pet2 == 1:
                        if pet_eat < 100:
                            if c <= balance:
                                await bot.send_message(message.chat.id,
                                                       f'🍗 | {user_name}, вы покормили своего питомца за {c}!',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c2} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_eat = {pet_eat + eat} WHERE user_id = {user_id}')
                            if c > balance:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                        if pet_eat == 100:
                            await bot.send_message(message.chat.id, f'🍗 | {user_name}, ваш питомец не голоден!',
                                                   parse_mode='html')
                    if pet3 == 1:
                        if pet_eat < 100:
                            if c <= balance:
                                await bot.send_message(message.chat.id,
                                                       f'🍗 | {user_name}, вы покормили своего питомца за {c}!',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c2} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_eat = {pet_eat + eat} WHERE user_id = {user_id}')
                            if c > balance:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                        if pet_eat == 100:
                            await bot.send_message(message.chat.id, f'🍗 | {user_name}, ваш питомец не голоден!',
                                                   parse_mode='html')
                    if pet4 == 1:
                        if pet_eat < 100:
                            if c <= balance:
                                await bot.send_message(message.chat.id,
                                                       f'🍗 | {user_name}, вы покормили своего питомца за {c}!',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c2} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_eat = {pet_eat + eat} WHERE user_id = {user_id}')
                            if c > balance:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                        if pet_eat == 100:
                            await bot.send_message(message.chat.id, f'🍗 | {user_name}, ваш питомец не голоден!',
                                                   parse_mode='html')
                    if pet5 == 1:
                        if pet_eat < 100:
                            if c <= balance:
                                await bot.send_message(message.chat.id,
                                                       f'🍗 | {user_name}, вы покормили своего питомца за {c}!',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c2} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_eat = {pet_eat + eat} WHERE user_id = {user_id}')
                            if c > balance:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                        if pet_eat == 100:
                            await bot.send_message(message.chat.id, f'🍗 | {user_name}, ваш питомец не голоден! {rloser}',
                                                   parse_mode='html')
                    if pet6 == 1:
                        if pet_eat < 100:
                            if c <= balance:
                                await bot.send_message(message.chat.id,
                                                       f'🍗 | {user_name}, вы покормили своего питомца за {c}!',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c2} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_eat = {pet_eat + eat} WHERE user_id = {user_id}')
                            if c > balance:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                        if pet_eat == 100:
                            await bot.send_message(message.chat.id, f'🍗 | {user_name}, ваш питомец не голоден!',
                                                   parse_mode='html')
                    if pet7 == 1:
                        if pet_eat < 100:
                            if c <= balance:
                                await bot.send_message(message.chat.id,
                                                       f'🍗 | {user_name}, вы покормили своего питомца за {c}!',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c2} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_eat = {pet_eat + eat} WHERE user_id = {user_id}')
                            if c > balance:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                        if pet_eat == 100:
                            await bot.send_message(message.chat.id, f'🍗 | {user_name}, ваш питомец не голоден!',
                                                   parse_mode='html')
                    if pet8 == 1:
                        if pet_eat < 100:
                            if c <= balance:
                                await bot.send_message(message.chat.id,
                                                       f'🍗 | {user_name}, вы покормили своего питомца за {c}!',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c2} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_eat = {pet_eat + eat} WHERE user_id = {user_id}')
                            if c > balance:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                        if pet_eat == 100:
                            await bot.send_message(message.chat.id, f'🍗 | {user_name}, ваш питомец не голоден!',
                                                   parse_mode='html')
                    if pet9 == 1:
                        if pet_eat < 100:
                            if c <= balance:
                                await bot.send_message(message.chat.id,
                                                       f'🍗 | {user_name}, вы покормили своего питомца за {c}!',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c2} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET pet_eat = {pet_eat + eat} WHERE user_id = {user_id}')
                            if c > balance:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                        if pet_eat == 100:
                            await bot.send_message(message.chat.id, f'🍗 | {user_name}, ваш питомец не голоден!',
                                                   parse_mode='html')



                if message.text.lower() in ["выгулять питомца", "Выгулять питомца"]:
                    user_name = message.from_user.get_mention(as_html=True)
                    pet1 = cursor.execute(
                        "SELECT pet1 from users where user_id = ?", (message.from_user.id,))
                    pet1 = cursor.fetchone()
                    pet1 = int(pet1[0])
                    pet2 = cursor.execute(
                        "SELECT pet2 from users where user_id = ?", (message.from_user.id,))
                    pet2 = cursor.fetchone()
                    pet2 = int(pet2[0])
                    pet3 = cursor.execute(
                        "SELECT pet3 from users where user_id = ?", (message.from_user.id,))
                    pet3 = cursor.fetchone()
                    pet3 = int(pet3[0])
                    pet4 = cursor.execute(
                        "SELECT pet4 from users where user_id = ?", (message.from_user.id,))
                    pet4 = cursor.fetchone()
                    pet4 = int(pet4[0])
                    pet5 = cursor.execute(
                        "SELECT pet5 from users where user_id = ?", (message.from_user.id,))
                    pet5 = cursor.fetchone()
                    pet5 = int(pet5[0])
                    pet6 = cursor.execute(
                        "SELECT pet6 from users where user_id = ?", (message.from_user.id,))
                    pet6 = cursor.fetchone()
                    pet6 = int(pet6[0])
                    pet7 = cursor.execute(
                        "SELECT pet7 from users where user_id = ?", (message.from_user.id,))
                    pet7 = cursor.fetchone()
                    pet7 = int(pet7[0])
                    pet8 = cursor.execute(
                        "SELECT pet8 from users where user_id = ?", (message.from_user.id,))
                    pet8 = cursor.fetchone()
                    pet8 = int(pet8[0])
                    pet9 = cursor.execute(
                        "SELECT pet9 from users where user_id = ?", (message.from_user.id,))
                    pet9 = cursor.fetchone()
                    pet9 = int(pet9[0])
                    pet_name = cursor.execute("SELECT pet_name from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_name = cursor.fetchone()
                    pet_name = str(pet_name[0])
                    pet_hp = cursor.execute(
                        "SELECT pet_hp from users where user_id = ?", (message.from_user.id,))
                    pet_hp = cursor.fetchone()
                    pet_hp = int(pet_hp[0])
                    pet_eat = cursor.execute(
                        "SELECT pet_eat from users where user_id = ?", (message.from_user.id,))
                    pet_eat = cursor.fetchone()
                    pet_eat = int(pet_eat[0])
                    pet_mood = cursor.execute("SELECT pet_mood from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_mood = cursor.fetchone()
                    pet_mood = int(pet_mood[0])

                    chat_id = message.chat.id
                    user_id = message.from_user.id
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance=cursor.fetchone()
                    balance = round(int(balance[0]))
                    pets = pet1 + pet2 + pet3 + pet4 + pet5 + pet6 + pet7 + pet8 + pet9
                    c = Decimal((100 - pet_mood) * 10000)
                    mood = 100 - pet_mood
                    checking = cursor.execute("SELECT checking from users where user_id = ?",
                                              (message.from_user.id,))
                    checking = cursor.fetchone()
                    checking = round(int(checking[0]))
                    if checking == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking1 = cursor.execute("SELECT checking1 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking1 = cursor.fetchone()
                    checking1 = round(int(checking1[0]))
                    if checking1 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking2 = cursor.execute("SELECT checking2 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking2 = cursor.fetchone()
                    checking2 = round(int(checking2[0]))
                    if checking2 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking3 = cursor.execute("SELECT checking3 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking3 = cursor.fetchone()
                    checking3 = round(int(checking3[0]))
                    if checking3 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    if pets == 0:
                        await bot.send_message(message.chat.id, f'‼️  {user_name}, у вас нету питомца! {rloser}',
                                               parse_mode='html')
                    if pet1 == 1:
                        if pet_mood < 100:
                            await bot.send_message(message.chat.id, f'🌳 {user_name}, вы выгуляли своего питомца!',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET pet_mood = {pet_mood + mood} WHERE user_id = {user_id}')
                        if pet_mood == 100:
                            await bot.send_message(message.chat.id, f'🌳 {user_name}, ваш питомец не хочет гулять!',
                                                   parse_mode='html')
                    if pet2 == 1:
                        if pet_mood < 100:
                            await bot.send_message(message.chat.id, f'🌳 {user_name}, вы выгуляли своего питомца!',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET pet_mood = {pet_mood + mood} WHERE user_id = {user_id}')
                        if pet_mood == 100:
                            await bot.send_message(message.chat.id, f'🌳 {user_name}, ваш питомец не хочет гулять!',
                                                   parse_mode='html')
                    if pet3 == 1:
                        if pet_mood < 100:
                            await bot.send_message(message.chat.id, f'🌳 {user_name}, вы выгуляли своего питомца!',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET pet_mood = {pet_mood + mood} WHERE user_id = {user_id}')
                        if pet_mood == 100:
                            await bot.send_message(message.chat.id, f'🌳 {user_name}, ваш питомец не хочет гулять!',
                                                   parse_mode='html')
                    if pet4 == 1:
                        if pet_mood < 100:
                            await bot.send_message(message.chat.id, f'🌳 {user_name}, вы выгуляли своего питомца!',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET pet_mood = {pet_mood + mood} WHERE user_id = {user_id}')
                        if pet_mood == 100:
                            await bot.send_message(message.chat.id, f'🌳 {user_name}, ваш питомец не хочет гулять!',
                                                   parse_mode='html')
                    if pet5 == 1:
                        if pet_mood < 100:
                            await bot.send_message(message.chat.id, f'🌳 {user_name}, вы выгуляли своего питомца!',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET pet_mood = {pet_mood + mood} WHERE user_id = {user_id}')
                        if pet_mood == 100:
                            await bot.send_message(message.chat.id, f'🌳 {user_name}, ваш питомец не хочет гулять!',
                                                   parse_mode='html')
                    if pet6 == 1:
                        if pet_mood < 100:
                            await bot.send_message(message.chat.id, f'🌳 {user_name}, вы выгуляли своего питомца!',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET pet_mood = {pet_mood + mood} WHERE user_id = {user_id}')
                        if pet_mood == 100:
                            await bot.send_message(message.chat.id, f'🌳 {user_name}, ваш питомец не хочет гулять!',
                                                   parse_mode='html')
                    if pet7 == 1:
                        if pet_mood < 100:
                            await bot.send_message(message.chat.id, f'🌳 {user_name}, вы выгуляли своего питомца!',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET pet_mood = {pet_mood + mood} WHERE user_id = {user_id}')
                        if pet_mood == 100:
                            await bot.send_message(message.chat.id, f'🌳 {user_name}, ваш питомец не хочет гулять!',
                                                   parse_mode='html')
                    if pet8 == 1:
                        if pet_mood < 100:
                            await bot.send_message(message.chat.id, f'🌳 {user_name}, вы выгуляли своего питомца!',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET pet_mood = {pet_mood + mood} WHERE user_id = {user_id}')
                        if pet_mood == 100:
                            await bot.send_message(message.chat.id, f'🌳 {user_name}, ваш питомец не хочет гулять!',
                                                   parse_mode='html')
                    if pet9 == 1:
                        if pet_mood < 100:
                            await bot.send_message(message.chat.id, f'🌳 {user_name}, вы выгуляли своего питомца!',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET pet_mood = {pet_mood + mood} WHERE user_id = {user_id}')
                        if pet_mood == 100:
                            await bot.send_message(message.chat.id, f'🌳 {user_name}, ваш питомец не хочет гулять!',
                                                   parse_mode='html')



                if message.text.startswith("питомец имя"):
                    user_name = message.from_user.get_mention(as_html=True)
                    pet1 = cursor.execute(
                        "SELECT pet1 from users where user_id = ?", (message.from_user.id,))
                    pet1 = cursor.fetchone()
                    pet1 = int(pet1[0])
                    pet2 = cursor.execute(
                        "SELECT pet2 from users where user_id = ?", (message.from_user.id,))
                    pet2 = cursor.fetchone()
                    pet2 = int(pet2[0])
                    pet3 = cursor.execute(
                        "SELECT pet3 from users where user_id = ?", (message.from_user.id,))
                    pet3 = cursor.fetchone()
                    pet3 = int(pet3[0])
                    pet4 = cursor.execute(
                        "SELECT pet4 from users where user_id = ?", (message.from_user.id,))
                    pet4 = cursor.fetchone()
                    pet4 = int(pet4[0])
                    pet5 = cursor.execute(
                        "SELECT pet5 from users where user_id = ?", (message.from_user.id,))
                    pet5 = cursor.fetchone()
                    pet5 = int(pet5[0])
                    pet6 = cursor.execute(
                        "SELECT pet6 from users where user_id = ?", (message.from_user.id,))
                    pet6 = cursor.fetchone()
                    pet6 = int(pet6[0])
                    pet7 = cursor.execute(
                        "SELECT pet7 from users where user_id = ?", (message.from_user.id,))
                    pet7 = cursor.fetchone()
                    pet7 = int(pet7[0])
                    pet8 = cursor.execute(
                        "SELECT pet8 from users where user_id = ?", (message.from_user.id,))
                    pet8 = cursor.fetchone()
                    pet8 = int(pet8[0])
                    pet9 = cursor.execute(
                        "SELECT pet9 from users where user_id = ?", (message.from_user.id,))
                    pet9 = cursor.fetchone()
                    pet9 = int(pet9[0])
                    pet_name = cursor.execute("SELECT pet_name from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_name = cursor.fetchone()
                    pet_name = str(pet_name[0])
                    pet_hp = cursor.execute(
                        "SELECT pet_hp from users where user_id = ?", (message.from_user.id,))
                    pet_hp = cursor.fetchone()
                    pet_hp = int(pet_hp[0])
                    pet_eat = cursor.execute(
                        "SELECT pet_eat from users where user_id = ?", (message.from_user.id,))
                    pet_eat = cursor.fetchone()
                    pet_eat = int(pet_eat[0])
                    pet_mood = cursor.execute("SELECT pet_mood from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_mood = cursor.fetchone()
                    pet_mood = int(pet_mood[0])
                    chat_id = message.chat.id
                    user_id = message.from_user.id
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    pets = pet1 + pet2 + pet3 + pet4 + pet5 + pet6 + pet7 + pet8 + pet9
                    try:
                        name = str(message.text.split()[2])
                    except:
                        await message.reply('‼️ Не хватает аргументов!\nПример: Питомец имя (имя) ')
                        return

                    if pets == 0:
                        await bot.send_message(message.chat.id, f'‼️  {user_name}, у вас нету питомца! {rloser}',
                                               parse_mode='html')
                    if pet1 == 1:
                        await bot.send_message(message.chat.id,
                                               f'✏️ | {user_name}, вы успешно поменяли имя своего питомца на: {name}!',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE users SET pet_name = '{name}' WHERE user_id = {user_id}")
                    if pet2 == 1:
                        await bot.send_message(message.chat.id,
                                               f'✏️ | {user_name}, вы успешно поменяли имя своего питомца на: {name}!',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE users SET pet_name = '{name}' WHERE user_id = {user_id}")
                    if pet3 == 1:
                        await bot.send_message(message.chat.id,
                                               f'✏️ | {user_name}, вы успешно поменяли имя своего питомца на: {name}!',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE users SET pet_name = '{name}' WHERE user_id = {user_id}")
                    if pet4 == 1:
                        await bot.send_message(message.chat.id,
                                               f'✏️ | {user_name}, вы успешно поменяли имя своего питомца на: {name}!',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE users SET pet_name = '{name}' WHERE user_id = {user_id}")
                    if pet5 == 1:
                        await bot.send_message(message.chat.id,
                                               f'✏️ | {user_name}, вы успешно поменяли имя своего питомца на: {name}!',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE users SET pet_name = '{name}' WHERE user_id = {user_id}")
                    if pet6 == 1:
                        await bot.send_message(message.chat.id,
                                               f'✏️ | {user_name}, вы успешно поменяли имя своего питомца на: {name}!',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE users SET pet_name = '{name}' WHERE user_id = {user_id}")
                    if pet7 == 1:
                        await bot.send_message(message.chat.id,
                                               f'✏️ | {user_name}, вы успешно поменяли имя своего питомца на: {name}!',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE users SET pet_name = '{name}' WHERE user_id = {user_id}")
                    if pet8 == 1:
                        await bot.send_message(message.chat.id,
                                               f'✏️ | {user_name}, вы успешно поменяли имя своего питомца на: {name}!',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE users SET pet_name = '{name}' WHERE user_id = {user_id}")
                    if pet9 == 1:
                        await bot.send_message(message.chat.id,
                                               f'✏️ | {user_name}, вы успешно поменяли имя своего питомца на: {name}!',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE users SET pet_name = '{name}' WHERE user_id = {user_id}")

                if message.text.startswith("Питомец имя"):
                    user_name = message.from_user.get_mention(as_html=True)
                    pet1 = cursor.execute(
                        "SELECT pet1 from users where user_id = ?", (message.from_user.id,))
                    pet1 = cursor.fetchone()
                    pet1 = int(pet1[0])
                    pet2 = cursor.execute(
                        "SELECT pet2 from users where user_id = ?", (message.from_user.id,))
                    pet2 = cursor.fetchone()
                    pet2 = int(pet2[0])
                    pet3 = cursor.execute(
                        "SELECT pet3 from users where user_id = ?", (message.from_user.id,))
                    pet3 = cursor.fetchone()
                    pet3 = int(pet3[0])
                    pet4 = cursor.execute(
                        "SELECT pet4 from users where user_id = ?", (message.from_user.id,))
                    pet4 = cursor.fetchone()
                    pet4 = int(pet4[0])
                    pet5 = cursor.execute(
                        "SELECT pet5 from users where user_id = ?", (message.from_user.id,))
                    pet5 = cursor.fetchone()
                    pet5 = int(pet5[0])
                    pet6 = cursor.execute(
                        "SELECT pet6 from users where user_id = ?", (message.from_user.id,))
                    pet6 = cursor.fetchone()
                    pet6 = int(pet6[0])
                    pet7 = cursor.execute(
                        "SELECT pet7 from users where user_id = ?", (message.from_user.id,))
                    pet7 = cursor.fetchone()
                    pet7 = int(pet7[0])
                    pet8 = cursor.execute(
                        "SELECT pet8 from users where user_id = ?", (message.from_user.id,))
                    pet8 = cursor.fetchone()
                    pet8 = int(pet8[0])
                    pet9 = cursor.execute(
                        "SELECT pet9 from users where user_id = ?", (message.from_user.id,))
                    pet9 = cursor.fetchone()
                    pet9 = int(pet9[0])
                    pet_name = cursor.execute("SELECT pet_name from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_name = cursor.fetchone()
                    pet_name = str(pet_name[0])
                    pet_hp = cursor.execute(
                        "SELECT pet_hp from users where user_id = ?", (message.from_user.id,))
                    pet_hp = cursor.fetchone()
                    pet_hp = int(pet_hp[0])
                    pet_eat = cursor.execute(
                        "SELECT pet_eat from users where user_id = ?", (message.from_user.id,))
                    pet_eat = cursor.fetchone()
                    pet_eat = int(pet_eat[0])
                    pet_mood = cursor.execute("SELECT pet_mood from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_mood = cursor.fetchone()
                    pet_mood = int(pet_mood[0])
                    chat_id = message.chat.id
                    user_id = message.from_user.id
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    pets = pet1 + pet2 + pet3 + pet4 + pet5 + pet6 + pet7 + pet8 + pet9
                    try:
                        name = str(message.text.split()[2])
                    except:
                        await message.reply('‼️ Не хватает аргументов!\nПример: Питомец имя (имя) ')
                        return

                    if pets == 0:
                        await bot.send_message(message.chat.id, f'‼️  {user_name}, у вас нету питомца! {rloser}',
                                               parse_mode='html')
                    if pet1 == 1:
                        await bot.send_message(message.chat.id,
                                               f'✏️ | {user_name}, вы успешно поменяли имя своего питомца на: {name}!',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE users SET pet_name = '{name}' WHERE user_id = {user_id}")
                    if pet2 == 1:
                        await bot.send_message(message.chat.id,
                                               f'✏️ | {user_name}, вы успешно поменяли имя своего питомца на: {name}!',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE users SET pet_name = '{name}' WHERE user_id = {user_id}")
                    if pet3 == 1:
                        await bot.send_message(message.chat.id,
                                               f'✏️ | {user_name}, вы успешно поменяли имя своего питомца на: {name}!',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE users SET pet_name = '{name}' WHERE user_id = {user_id}")
                    if pet4 == 1:
                        await bot.send_message(message.chat.id,
                                               f'✏️ | {user_name}, вы успешно поменяли имя своего питомца на: {name}!',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE users SET pet_name = '{name}' WHERE user_id = {user_id}")
                    if pet5 == 1:
                        await bot.send_message(message.chat.id,
                                               f'✏️ | {user_name}, вы успешно поменяли имя своего питомца на: {name}!',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE users SET pet_name = '{name}' WHERE user_id = {user_id}")
                    if pet6 == 1:
                        await bot.send_message(message.chat.id,
                                               f'✏️ | {user_name}, вы успешно поменяли имя своего питомца на: {name}!',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE users SET pet_name = '{name}' WHERE user_id = {user_id}")
                    if pet7 == 1:
                        await bot.send_message(message.chat.id,
                                               f'✏️ | {user_name}, вы успешно поменяли имя своего питомца на: {name}!',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE users SET pet_name = '{name}' WHERE user_id = {user_id}")
                    if pet8 == 1:
                        await bot.send_message(message.chat.id,
                                               f'✏️ | {user_name}, вы успешно поменяли имя своего питомца на: {name}!',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE users SET pet_name = '{name}' WHERE user_id = {user_id}")
                    if pet9 == 1:
                        await bot.send_message(message.chat.id,
                                               f'✏️ | {user_name}, вы успешно поменяли имя своего питомца на: {name}!',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE users SET pet_name = '{name}' WHERE user_id = {user_id}")

                if message.text.lower() in ["продать питомца", "Продать питомца"]:
                    user_name = message.from_user.get_mention(as_html=True)
                    pet1 = cursor.execute(
                        "SELECT pet1 from users where user_id = ?", (message.from_user.id,))
                    pet1 = cursor.fetchone()
                    pet1 = int(pet1[0])
                    pet2 = cursor.execute(
                        "SELECT pet2 from users where user_id = ?", (message.from_user.id,))
                    pet2 = cursor.fetchone()
                    pet2 = int(pet2[0])
                    pet3 = cursor.execute(
                        "SELECT pet3 from users where user_id = ?", (message.from_user.id,))
                    pet3 = cursor.fetchone()
                    pet3 = int(pet3[0])
                    pet4 = cursor.execute(
                        "SELECT pet4 from users where user_id = ?", (message.from_user.id,))
                    pet4 = cursor.fetchone()
                    pet4 = int(pet4[0])
                    pet5 = cursor.execute(
                        "SELECT pet5 from users where user_id = ?", (message.from_user.id,))
                    pet5 = cursor.fetchone()
                    pet5 = int(pet5[0])
                    pet6 = cursor.execute(
                        "SELECT pet6 from users where user_id = ?", (message.from_user.id,))
                    pet6 = cursor.fetchone()
                    pet6 = int(pet6[0])
                    pet7 = cursor.execute(
                        "SELECT pet7 from users where user_id = ?", (message.from_user.id,))
                    pet7 = cursor.fetchone()
                    pet7 = int(pet7[0])
                    pet8 = cursor.execute(
                        "SELECT pet8 from users where user_id = ?", (message.from_user.id,))
                    pet8 = cursor.fetchone()
                    pet8 = int(pet8[0])
                    pet9 = cursor.execute(
                        "SELECT pet9 from users where user_id = ?", (message.from_user.id,))
                    pet9 = cursor.fetchone()
                    pet9 = int(pet9[0])
                    pet_name = cursor.execute("SELECT pet_name from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_name = cursor.fetchone()
                    pet_name = str(pet_name[0])
                    pet_hp = cursor.execute(
                        "SELECT pet_hp from users where user_id = ?", (message.from_user.id,))
                    pet_hp = cursor.fetchone()
                    pet_hp = int(pet_hp[0])
                    pet_eat = cursor.execute(
                        "SELECT pet_eat from users where user_id = ?", (message.from_user.id,))
                    pet_eat = cursor.fetchone()
                    pet_eat = int(pet_eat[0])
                    pet_mood = cursor.execute("SELECT pet_mood from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_mood = cursor.fetchone()
                    pet_mood = int(pet_mood[0])
                    chat_id = message.chat.id
                    user_id = message.from_user.id
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance=cursor.fetchone()
                    balance = round(int(balance[0]))
                    checking = cursor.execute("SELECT checking from users where user_id = ?",
                                              (message.from_user.id,))
                    checking = cursor.fetchone()
                    checking = round(int(checking[0]))
                    if checking == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking1 = cursor.execute("SELECT checking1 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking1 = cursor.fetchone()
                    checking1 = round(int(checking1[0]))
                    if checking1 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking2 = cursor.execute("SELECT checking2 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking2 = cursor.fetchone()
                    checking2 = round(int(checking2[0]))
                    if checking2 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    checking3 = cursor.execute("SELECT checking3 from users where user_id = ?",
                                               (message.from_user.id,))
                    checking3 = cursor.fetchone()
                    checking3 = round(int(checking3[0]))
                    if checking3 == 1:
                        await bot.send_message(chat_id, f'‼️  Дождитесь окончания игры! {rloser}', parse_mode='html')
                        return
                    c = 1
                    pets = pet1 + pet2 + pet3 + pet4 + pet5 + pet6 + pet7 + pet8 + pet9
                    if pets == 0:
                        await bot.send_message(message.chat.id, f'‼️  {user_name}, у вас нету питомца! {rloser}',
                                               parse_mode='html')
                    if pet1 == 1:
                        await bot.send_message(message.chat.id,
                                               f'💰 | {user_name}, вы успешно продали своего питомца за 750.000₸',
                                               parse_mode='html')
                        cursor.execute(
                            f'UPDATE users SET balance = {balance + 750000} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet1 = {pet1 - c} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_hp = {100} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_eat = {100} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_mood = {100} WHERE user_id = {user_id}')
                    if pet2 == 1:
                        await bot.send_message(message.chat.id,
                                               f'💰 | {user_name}, вы успешно продали своего питомца за 75.000.000₸',
                                               parse_mode='html')
                        cursor.execute(
                            f'UPDATE users SET balance = {balance + 75000000} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet2 = {pet2 - c} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_hp = {100} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_eat = {100} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_mood = {100} WHERE user_id = {user_id}')
                    if pet3 == 1:
                        await bot.send_message(message.chat.id,
                                               f'💰 | {user_name}, вы успешно продали своего питомца за 375.000.000₸',
                                               parse_mode='html')
                        cursor.execute(
                            f'UPDATE users SET balance = {balance + 375000000} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet3 = {pet3 - c} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_hp = {100} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_eat = {100} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_mood = {100} WHERE user_id = {user_id}')
                    if pet4 == 1:
                        await bot.send_message(message.chat.id,
                                               f'💰 | {user_name}, вы успешно продали своего питомца за 750.000.000₸',
                                               parse_mode='html')
                        cursor.execute(
                            f'UPDATE users SET balance = {balance + 750000000} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet4 = {pet4 - c} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_hp = {100} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_eat = {100} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_mood = {100} WHERE user_id = {user_id}')
                    if pet5 == 1:
                        await bot.send_message(message.chat.id,
                                               f'💰 | {user_name}, вы успешно продали своего питомца за 37.500.000.000₸',
                                               parse_mode='html')
                        cursor.execute(
                            f'UPDATE users SET balance = {balance + 37500000000} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet5 = {pet5 - c} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_hp = {100} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_eat = {100} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_mood = {100} WHERE user_id = {user_id}')
                    if pet6 == 1:
                        await bot.send_message(message.chat.id,
                                               f'💰 | {user_name}, вы успешно продали своего питомца за 75.000.000.000₸',
                                               parse_mode='html')
                        cursor.execute(
                            f'UPDATE users SET balance = {balance + 75000000000} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet6 = {pet6 - c} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_hp = {100} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_eat = {100} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_mood = {100} WHERE user_id = {user_id}')
                    if pet7 == 1:
                        await bot.send_message(message.chat.id,
                                               f'💰 | {user_name}, вы успешно продали своего питомца за 375.000.000.000₸',
                                               parse_mode='html')
                        cursor.execute(
                            f'UPDATE users SET balance = {balance + 375000000000} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet7 = {pet7 - c} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_hp = {100} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_eat = {100} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_mood = {100} WHERE user_id = {user_id}')
                    if pet8 == 1:
                        await bot.send_message(message.chat.id,
                                               f'💰 | {user_name}, вы успешно продали своего питомца за 7.500.000.000.000₸',
                                               parse_mode='html')
                        cursor.execute(
                            f'UPDATE users SET balance = {balance + 7500000000000} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet8 = {pet8 - c} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_hp = {100} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_eat = {100} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_mood = {100} WHERE user_id = {user_id}')
                    if pet9 == 1:
                        await bot.send_message(message.chat.id,
                                               f'💰 | {user_name}, вы успешно продали своего питомца за 75.000.000.000.000₸',
                                               parse_mode='html')
                        cursor.execute(
                            f'UPDATE users SET balance = {balance + 75000000000000} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet9 = {pet9 - c} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_hp = {100} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_eat = {100} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET pet_mood = {100} WHERE user_id = {user_id}')


                if message.text.lower() in ["питомцы", "Питомцы"]:
                    user_name = message.from_user.get_mention(as_html=True)
                    chat_id = message.chat.id
                    await bot.send_message(message.chat.id,
                                           f"{user_name}, доступные питомцы:\n🐥 1. Цыплёнок - 1.000.000₸\n🐈 2. Кот - 100.000.000₸\n🐕 3. Пёс - 500.000.000₸\n🦜 4. Попугай - 1.000.000.000₸\n🦄 5. Единорог - 50.000.000.000₸\n🐒 6. Обезьяна - 100.000.000.000₸\n🐬 7. Дельфин - 500.000.000.000₸\n🐅 8. Тигр - 10.000.000.000.000₸\n🐉 9. Дракон - 100.000.000.000.000₸\n\n🛒 Для покупки питомца введите: Купить питомца [номер]\n‼️ Для просмотра информации о своем питомце введите: Мой питомец",
                                           parse_mode='html')

                if message.text.startswith("Бой") or message.text.startswith("бой"):
                    user_name = message.from_user.get_mention(as_html=True)
                    pet1 = cursor.execute(
                        "SELECT pet1 from users where user_id = ?", (message.from_user.id,))
                    pet1 = cursor.fetchone()
                    pet1 = int(pet1[0])
                    pet2 = cursor.execute(
                        "SELECT pet2 from users where user_id = ?", (message.from_user.id,))
                    pet2 = cursor.fetchone()
                    pet2 = int(pet2[0])
                    pet3 = cursor.execute(
                        "SELECT pet3 from users where user_id = ?", (message.from_user.id,))
                    pet3 = cursor.fetchone()
                    pet3 = int(pet3[0])
                    pet4 = cursor.execute(
                        "SELECT pet4 from users where user_id = ?", (message.from_user.id,))
                    pet4 = cursor.fetchone()
                    pet4 = int(pet4[0])
                    pet5 = cursor.execute(
                        "SELECT pet5 from users where user_id = ?", (message.from_user.id,))
                    pet5 = cursor.fetchone()
                    pet5 = int(pet5[0])
                    pet6 = cursor.execute(
                        "SELECT pet6 from users where user_id = ?", (message.from_user.id,))
                    pet6 = cursor.fetchone()
                    pet6 = int(pet6[0])
                    pet7 = cursor.execute(
                        "SELECT pet7 from users where user_id = ?", (message.from_user.id,))
                    pet7 = cursor.fetchone()
                    pet7 = int(pet7[0])
                    pet8 = cursor.execute(
                        "SELECT pet8 from users where user_id = ?", (message.from_user.id,))
                    pet8 = cursor.fetchone()
                    pet8 = int(pet8[0])
                    pet9 = cursor.execute(
                        "SELECT pet9 from users where user_id = ?", (message.from_user.id,))
                    pet9 = cursor.fetchone()
                    pet9 = int(pet9[0])
                    pet_name = cursor.execute("SELECT pet_name from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_name = cursor.fetchone()
                    pet_name = str(pet_name[0])
                    pet_hp = cursor.execute(
                        "SELECT pet_hp from users where user_id = ?", (message.from_user.id,))
                    pet_hp = cursor.fetchone()
                    pet_hp = int(pet_hp[0])
                    pet_eat = cursor.execute(
                        "SELECT pet_eat from users where user_id = ?", (message.from_user.id,))
                    pet_eat = cursor.fetchone()
                    pet_eat = int(pet_eat[0])
                    pet_mood = cursor.execute("SELECT pet_mood from users where user_id = ?",
                                              (message.from_user.id,))
                    pet_mood = cursor.fetchone()
                    pet_mood = int(pet_mood[0])
                    chat_id = message.chat.id
                    user_id = message.from_user.id
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = round(int(balance[0]))

                    balance2 = '{:,}'.format(balance)

                    c = 1
                    pets = pet1 + pet2 + pet3 + pet4 + pet5 + pet6 + pet7 + pet8 + pet9

                    try:
                        su = msg.text.split()[1]
                        su2 = (su).replace('к', '000')
                        su3 = (su2).replace('м', '000000')
                        su4 = (su3).replace('.', '')
                        su5 = float(su4)
                        summ = int(su5)
                    except:
                        await message.reply('‼️  Неправильный ввод команды!\nПример: Бой 1 ')
                        return


                    name1 = message.from_user.get_mention(as_html=True)
                    period = 5
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    games = cursor.execute(
                        "SELECT games from users where user_id = ?", (message.from_user.id,))
                    games = cursor.fetchone()
                    games = round(int(games[0]))
                    game = cursor.execute(
                        "SELECT game from users where user_id = ?", (message.from_user.id,))
                    game = cursor.fetchone()
                    game = int(game[0])

                    rhp = random.randint(10, 20)
                    reat = random.randint(10, 20)
                    rmood = random.randint(10, 20)
                    #coff = random.randint(0, 100)
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    coff=np.random.choice([1,2], 1, p=[0.52, 0.48])[0]
                    need_seconds3 = 4
                    current_time_bonus3 = datetime.now()
                    last_datetime3 = game_time.get(message.from_user.id)

                    # Если первое сообщение (время не задано)
                    if not last_datetime3:
                        game_time[message.from_user.id] = current_time_bonus3
                        last_datetime3 = datetime.fromtimestamp(0)
                    if last_datetime3:

                        # Разница в секундах между текущим временем и временем последнего сообщения
                        delta_seconds3 = (current_time_bonus3 - last_datetime3).total_seconds()

                        # Осталось ждать секунд перед отправкой
                        seconds_left3 = int(need_seconds3 - delta_seconds3)

                        # Если время ожидания не закончилось
                        if seconds_left3 > 0:
                            left1 = seconds_left3
                            await bot.send_message(message.chat.id,
                                                   f'‼️<a href="tg://user?id={user_id}">{user_name}</a>, играть можно через {round(left1)} сек {rloser}',
                                                   parse_mode='html')
                        else:
                            game_time[message.from_user.id] = current_time_bonus3
                            if balance >= summ:
                                if summ > 0:
                                    if int(pets) >= 1:
                                        if pet_hp >= 20:
                                            if pet_eat >= 20:
                                                if pet_mood >= 20:
                                                    if coff ==2:

                                                        c = Decimal(summ * 2)
                                                        c2 = round(c)
                                                        c2 = '{:,}'.format(c2)
                                                        await bot.send_message(chat_id,
                                                                               f'🎉  {name1}, ваш питомец победил в сражении! Ваш выигрыш: {c2}\n❤️  ХП: -{rhp}\n🍗  Сытость: -{reat}\n☀️  Настроение: -{rmood}',
                                                                               parse_mode='html')
                                                        cursor.execute(
                                                            f'UPDATE users SET balance = {balance - summ + (summ * 2)} WHERE user_id = {user_id}')
                                                        cursor.execute(
                                                            f'UPDATE users SET pet_hp = {pet_hp - rhp} WHERE user_id = {user_id}')
                                                        cursor.execute(
                                                            f'UPDATE users SET pet_eat = {pet_eat - reat} WHERE user_id = {user_id}')
                                                        cursor.execute(
                                                            f'UPDATE users SET pet_mood = {pet_mood - rmood} WHERE user_id = {user_id}')
                                                        cursor.execute(
                                                            f'UPDATE users SET game = {game + 1} WHERE user_id = {user_id}')
                                                        cursor.execute(
                                                            f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                                        cursor.execute(
                                                            f'UPDATE users SET checking3 = {0} WHERE user_id = {user_id}')
                                                        connect.commit()
                                                        return
                                                    if coff  ==1:

                                                        c = Decimal(summ)
                                                        c2 = round(c)
                                                        c2 = '{:,}'.format(c2)
                                                        await bot.send_message(chat_id,
                                                                               f'{rloser}  {name1}, ваш питомец проиграл в сражении! Ваш проигрыш: {c2}\n❤️  ХП: -{rhp}\n🍗  Сытость: -{reat}\n☀️  Настроение: -{rmood}',
                                                                               parse_mode='html')
                                                        cursor.execute(
                                                            f'UPDATE users SET balance = {balance - summ} WHERE user_id = {user_id}')
                                                        cursor.execute(
                                                            f'UPDATE users SET pet_hp = {pet_hp - rhp} WHERE user_id = {user_id}')
                                                        cursor.execute(
                                                            f'UPDATE users SET pet_eat = {pet_eat - reat} WHERE user_id = {user_id}')
                                                        cursor.execute(
                                                            f'UPDATE users SET pet_mood = {pet_mood - rmood} WHERE user_id = {user_id}')


                                                        cursor.execute(
                                                            f'UPDATE users SET checking3 = {0} WHERE user_id = {user_id}')
                                                        if game>0:
                                                            cursor.execute(
                                                                f'UPDATE users SET game = {game - 1} WHERE user_id = {user_id}')
                                                            connect.commit()
                                                        connect.commit()
                                                else:
                                                    await bot.send_message(chat_id,
                                                                           f'‼️  {name1}, у вашего питомца нету настроения! {rloser}',
                                                                           parse_mode='html')
                                            else:
                                                await bot.send_message(chat_id, f'‼️  {name1}, ваш питомец голоден! {rloser}',
                                                                       parse_mode='html')
                                        else:
                                            await bot.send_message(chat_id,
                                                                   f'‼️  {name1}, у вашего питомца недостаточно здоровья! {rloser}',
                                                                   parse_mode='html')
                                    if int(pets) == 0:
                                        await bot.send_message(chat_id, f'‼️  {name1}, у вас нету питомца! {rloser}',
                                                               parse_mode='html')
                                elif summ <= 0:
                                    await bot.send_message(chat_id, f'‼️  {name1}, нельзя ставить отрицательное число! {rloser}',
                                                           parse_mode='html')
                            elif int(balance) <= int(summ):
                                await bot.send_message(chat_id, f'💰  {name1}, недостаточно средств! {rloser}', parse_mode='html')

                if message.text.startswith('Донат админ'):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    if message.text != 'Донат админ':
                        donat = cursor.execute(
                            "SELECT ecoins from users where user_id = ?", (message.from_user.id,))
                        donat = cursor.fetchone()
                        donat = int(donat[0])

                        user_status = cursor.execute(
                            "SELECT user_status from users where user_id = ?", (message.from_user.id,))
                        user_status = cursor.fetchone()
                        user_status = str(user_status[0])

                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)
                        try:
                            nomer = int(message.text.split()[2])
                            if nomer<=0:
                                await message.reply(
                                    '‼️  Вы не можете купить меньше 1 месяца ')
                                return
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Донат админ [На сколько месяцов] ')
                            return

                        price = 500 * nomer
                        if donat >= price:

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили  ADMIN 👮‍♂ ',
                                                   parse_mode='html')
                            cursor.execute(
                                f"UPDATE users SET user_status = 'Admin'  WHERE user_id = {user_id}")
                            cursor.execute(
                                f"UPDATE users SET Admin_time = {nomer} * 2592000  WHERE user_id = {user_id}")
                            cursor.execute(
                                f'UPDATE users SET ecoins = {donat - price}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET limitpered = 200000000000000   WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET cardslimit = 5000  WHERE user_id = {user_id}')
                            cursor.execute(
                                f"UPDATE users SET limitvidach =10000000000000 WHERE user_status='Admin'")
                            connect.commit()

                        else:
                            await bot.send_message(message.chat.id,f'<a href="tg://user?id={user_id}">{user_name}</a>, у вам нехватает {price - donat} для покупки данного доната {rloser}',parse_mode='html')


                    else:
                        await message.reply('‼️  Неправильный ввод команды!\nПример: Донат админ [На сколько месяцов] ')


                ###########################################АДМИН КОМАНДЫ###########################################

                if message.text.lower() == 'выдать адм' and message.reply_to_message:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    msg = message
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    reply_user_id = msg.reply_to_message.from_user.id
                    user_id = msg.from_user.id
                    user_status = cursor.execute("SELECT user_status from users where user_id = ?",
                                                 (message.from_user.id,))
                    user_status = cursor.fetchone()
                    if user_status[0] == 'Rab':
                        await bot.send_message(message.chat.id,
                                               f'Вы успешно выдали администратора игроку <a href="tg://user?id={user_id}">{user_name}</a> {rwin}',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE users SET user_status ='Admin'  WHERE user_id = {reply_user_id}")
                        connect.commit()
                    else:
                        await bot.send_message(message.chat.id,
                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, Доступ к данной команде ограничен. Для покупки администратора обратитесь к создателю 👨‍🦰',
                                               parse_mode='html')

                if message.text.lower() == 'забрать адм' and message.reply_to_message:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    msg = message
                    reply_user_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    reply_user_id = msg.reply_to_message.from_user.id
                    user_id = msg.from_user.id
                    user_status = cursor.execute("SELECT user_status from users where user_id = ?",
                                                 (message.from_user.id,))
                    user_status = cursor.fetchone()
                    if user_status[0] == 'Rab':
                        await bot.send_message(message.chat.id,
                                               f'Вы успешно забрали администратора у игрока {reply_user_name} {rwin}',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE users SET user_status = 'Player'  WHERE user_id = {reply_user_id}")
                        connect.commit()
                    else:
                        await bot.send_message(message.chat.id,
                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, Доступ к данной команде ограничен. Напишите "Донат" для большей информации👨‍🦰',
                                               parse_mode='html')
                if message.text.startswith("Забрать") and message.reply_to_message:
                    message = message

                    user_id = message.from_user.id
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)

                    reply_user_id = message.reply_to_message.from_user.id
                    reply_user_namee = message.reply_to_message.from_user.full_name
                    try:
                        su = message.text.split()[1]
                        su2 = (su).replace('к', '000')
                        su3 = (su2).replace('м', '000000')
                        su4 = (su3).replace('.', '')
                        su5 = float(su4)

                        perevod = int(su5)
                        perevod2 = '{:,}'.format(perevod).replace(',', '.')

                    except:
                        await message.reply('‼️ Не хватает аргументов!\nПример: Забрать 1 ')
                        return


                    user_status = cursor.execute("SELECT user_status from users where user_id = ?",
                                                 (message.from_user.id,))
                    user_status = cursor.fetchone()
                    user_status = str(user_status[0])
                    balance2 = cursor.execute("SELECT balance from users where user_id = ?",
                                              (message.reply_to_message.from_user.id,))
                    balance2 = cursor.fetchone()
                    balance2 = round(balance2[0])

                    if perevod >= 0:
                        if user_status == 'Rab':
                            await message.reply(
                                f'💵 Вы забрали {perevod2}₸  у игрока <a href="tg://user?id={reply_user_id}">{reply_user_namee}</a> {rwin}',
                                parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance2 - perevod} WHERE user_id = {reply_user_id}')
                            await bot.send_message(cfg.log_group, f"""
⚙️LOG: #перевод
<a href="tg://user?id={user_id}">{user_name}</a>(<code>{user_id}</code>)  забрал у игрока
<a href="tg://user?id={reply_user_id}">{reply_user_namee}</a>(<code>{reply_user_id}</code>) в размере: {perevod2}₸ 
                """, parse_mode='html')
                            connect.commit()
                        elif user_status == 'Admin':
                            await message.reply(
                                f'💵 Вы забрали {perevod2}₸  у игрока <a href="tg://user?id={reply_user_id}">{reply_user_namee}</a> {rwin}',
                                parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance2 - perevod} WHERE user_id = {reply_user_id}')
                            await bot.send_message(cfg.log_group, f"""
⚙️LOG: #перевод
<a href="tg://user?id={user_id}">{user_name}</a>(<code>{user_id}</code>)  забрал у игрока
<a href="tg://user?id={reply_user_id}">{reply_user_namee}</a>(<code>{reply_user_id}</code>) в размере: {perevod2}₸ 
                """, parse_mode='html')
                            connect.commit()

                    else:
                        await message.reply(
                            f'💵 Вы не можете забрать отрицательные чила {rwin}',
                            parse_mode='html')
                if message.text.startswith('!warnb') and message.reply_to_message:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    user_status = cursor.execute("SELECT user_status from users where user_id = ?",
                                                 (message.from_user.id,))
                    user_status = cursor.fetchone()

                    reply_user_name = message.reply_to_message.from_user.full_name
                    reply_user_id = message.reply_to_message.from_user.id
                    warn=cursor.execute("SELECT warn FROM users WHERE user_id=? ",(reply_user_id,))
                    warn=cursor.fetchone()
                    warn=int(warn[0])
                    user_status2 = cursor.execute("SELECT user_status from users where user_id = ?",
                                                 (message.reply_to_message.from_user.id,))
                    user_status2 = cursor.fetchone()
                    try:

                        comment = " ".join(message.text.split()[1:])
                    except :
                        await message.reply('‼️  Не хватает аргументов!\nПример: !warn причина')
                        return

                    if user_status[0] == 'Rab' or user_status[0] == 'Admin':
                        if user_status2[0] != 'Rab' and user_status2[0] != 'Admin':

                            cursor.execute(f"UPDATE users SET warn={warn + 1} WHERE user_id={reply_user_id}")

                            await bot.send_message(cfg.log_group, f"""
⚙️LOG: #warn
Администратор <a href="tg://user?id={user_id}">{user_name}</a>(<code>{user_id}</code>) выдал варн игроку
<a href="tg://user?id={reply_user_id}">{reply_user_name}</a>(<code>{reply_user_id}</code>) 
причина : {comment}
""", parse_mode='html')
                            warn = cursor.execute(f"SELECT warn FROM users WHERE user_id={reply_user_id} ")
                            warn = cursor.fetchone()
                            connect.commit()
                            await message.reply(
                                f'Администратор выдал варн игроку <a href="tg://user?id={reply_user_id}">{reply_user_name}</a> ⛔️'
                                f'Варнов у игрока: {int(warn[0])} (3 варна бан на 3 дня)'
                                ,
                                parse_mode='html')
                            if int(warn[0]) == 3:
                                timestamp=3*60*60*24
                                cursor.execute(
                                    f"UPDATE users SET status_block = 'on' WHERE user_id = {reply_user_id}")
                                cursor.execute(
                                    f"UPDATE users SET warn = {0} WHERE user_id = {reply_user_id}")
                                cursor.execute(
                                    "INSERT INTO ban_list VALUES(?, ?,?, ?);",
                                    (reply_user_id, reply_user_name, comment, timestamp))
                                connect.commit()
                        else:
                            await message.reply("Ты не можешь выдать варн администратору",
                                parse_mode='html')

                if message.text.startswith('!unwarnb') and message.reply_to_message:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    user_status = cursor.execute("SELECT user_status from users where user_id = ?",
                                                 (message.from_user.id,))
                    user_status = cursor.fetchone()

                    reply_user_name = message.reply_to_message.from_user.full_name
                    reply_user_id = message.reply_to_message.from_user.id
                    warn = cursor.execute("SELECT warn FROM users WHERE user_id=? ", (reply_user_id,))
                    warn = cursor.fetchone()
                    warn = int(warn[0])
                    user_status2 = cursor.execute("SELECT user_status from users where user_id = ?",
                                                  (message.reply_to_message.from_user.id,))
                    user_status2 = cursor.fetchone()

                    if user_status[0] == 'Rab' or user_status[0] == 'Admin':

                        cursor.execute(f"UPDATE users SET warn={warn - 1} WHERE user_id={reply_user_id}")
                        await message.reply(f"""Администратор <a href="tg://user?id={user_id}">{user_name}</a>(<code>{user_id}</code>) снял варн игроку
        <a href="tg://user?id={reply_user_id}">{reply_user_name}</a>(<code>{reply_user_id}</code>) """,
                                            parse_mode='html')
                        await bot.send_message(cfg.log_group, f"""
⚙️LOG: #unwarn
Администратор <a href="tg://user?id={user_id}">{user_name}</a>(<code>{user_id}</code>) снял варн игроку
<a href="tg://user?id={reply_user_id}">{reply_user_name}</a>(<code>{reply_user_id}</code>) 

""", parse_mode='html')

                        connect.commit()
                if message.text.lower() == '!unbanb' and message.reply_to_message:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    msg = message
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)

                    user_status = cursor.execute("SELECT user_status from users where user_id = ?",
                                                 (message.from_user.id,))
                    user_status = cursor.fetchone()
                    reply_user_name = message.reply_to_message.from_user.get_mention(
                        as_html=True)
                    reply_user_id = message.reply_to_message.from_user.id
                    if user_status[0] == 'Rab' or user_status[0] == 'Admin':
                        await message.reply(
                            f'Администратор снял бан игроку <a href="tg://user?id={reply_user_id}">{reply_user_name}</a> ⛔️',
                            parse_mode='html')
                        cursor.execute(
                            f"UPDATE users SET status_block = 'off' WHERE user_id = {reply_user_id}")
                        cursor.execute(f"DELETE from ban_list where user_id = {reply_user_id}")
                        await bot.send_message(cfg.log_group, f"""
⚙️LOG: #Админ
Администратор <a href="tg://user?id={user_id}">{user_name}</a>(<code>{user_id}</code>)  снял бан игроку 
<a href="tg://user?id={reply_user_id}">{reply_user_name}</a>(<code>{reply_user_id}</code>) 
""", parse_mode='html')
                        connect.commit()

                    if user_status[0] == 'Player':
                        await message.reply(
                            f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>, Доступ к данной команде ограничен. Для покупки администратора обратитесь к создателю 👨‍🦰',
                            parse_mode='html')
                if message.text.startswith('!banb')  and message.reply_to_message:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    msg = message
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    reply_user_name = message.reply_to_message.from_user.full_name
                    reply_user_id = message.reply_to_message.from_user.id
                    user_status = cursor.execute("SELECT user_status from users where user_id = ?",
                                                 (message.from_user.id,))
                    user_status = cursor.fetchone()
                    try:
                        muteint = int(message.text.split()[1])
                        mutetype = message.text.split()[2]
                        comment = " ".join(message.text.split()[3:])
                    except:
                        await message.reply('‼️  Не хватает аргументов!\nПример:\n!banb 1 ч причина')
                        return

                    user_status2 = cursor.execute("SELECT user_status from users where user_id = ?",
                                                  (message.reply_to_message.from_user.id,))
                    user_status2 = cursor.fetchone()
                    if user_status[0] == 'Rab' or user_status[0] == 'Admin':
                        if user_status2[0] != 'Rab' and user_status2[0] != 'Admin':
                            if mutetype == "м" or mutetype == "минут" or mutetype == "минуты":
                                timestamp = muteint * 60
                                await message.reply(
                                    f'Администратор выдал бан игроку <a href="tg://user?id={reply_user_id}">{reply_user_name}</a> ⛔'
                                    f'️',
                                    parse_mode='html')
                                cursor.execute(
                                    f"UPDATE users SET status_block = 'on' WHERE user_id = {reply_user_id}")
                                cursor.execute(
                                    "INSERT INTO ban_list VALUES(?, ?,?, ?);",
                                    (reply_user_id, reply_user_name, comment, timestamp))
                                await bot.send_message(cfg.log_group, f"""
⚙️LOG: #Админ
Администратор <a href="tg://user?id={user_id}">{user_name}</a>(<code>{user_id}</code>)  выдал бан игроку 
<a href="tg://user?id={reply_user_id}">{reply_user_name}</a>(<code>{reply_user_id}</code>) 
причина: {comment}
На:{timestamp}
""", parse_mode='html')
                                connect.commit()
                            if mutetype == "ч" or mutetype == "часов" or mutetype == "час":

                                timestamp=muteint * 60 * 60
                                await message.reply(
                                    f'Администратор выдал бан игроку <a href="tg://user?id={reply_user_id}">{reply_user_name}</a> ⛔'
                                    f'️',
                                    parse_mode='html')
                                cursor.execute(
                                    f"UPDATE users SET status_block = 'on' WHERE user_id = {reply_user_id}")
                                cursor.execute(
                                    "INSERT INTO ban_list VALUES(?, ?,?, ?);", (reply_user_id, reply_user_name,comment,timestamp))
                                await bot.send_message(cfg.log_group, f"""
⚙️LOG: #Админ
Администратор <a href="tg://user?id={user_id}">{user_name}</a>(<code>{user_id}</code>)  выдал бан игроку 
<a href="tg://user?id={reply_user_id}">{reply_user_name}</a>(<code>{reply_user_id}</code>) 
причина: {comment}
На:{timestamp}
        """, parse_mode='html')
                                connect.commit()
                            if mutetype == "д" or mutetype == "дней" or mutetype == "день":

                                timestamp = muteint * 60 * 60 * 24
                                await message.reply(
                                    f'Администратор выдал бан игроку <a href="tg://user?id={reply_user_id}">{reply_user_name}</a> ⛔'
                                    f'️',
                                    parse_mode='html')
                                cursor.execute(
                                    f"UPDATE users SET status_block = 'on' WHERE user_id = {reply_user_id}")
                                cursor.execute(
                                    "INSERT INTO ban_list VALUES(?, ?,?, ?);",
                                    (reply_user_id, reply_user_name, comment, timestamp))
                                await bot.send_message(cfg.log_group, f"""
⚙️LOG: #Админ
Администратор <a href="tg://user?id={user_id}">{user_name}</a>(<code>{user_id}</code>)  выдал бан игроку 
<a href="tg://user?id={reply_user_id}">{reply_user_name}</a>(<code>{reply_user_id}</code>) 
причина: {comment}
На:{timestamp}
    """, parse_mode='html')
                                connect.commit()
                        else:
                            await message.reply(
                                f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>, Вы не можете забанить другого админа',
                                parse_mode='html')
                    if user_status[0] == 'Player':
                        await message.reply(
                            f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>, Доступ к данной команде ограничен. Для покупки администратора обратитесь к создателю 👨‍🦰',
                            parse_mode='html')
                if message.text.startswith("Валюта"):
                    message = message

                    user_id = message.from_user.id
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    perevod = 50000000000
                    perevod2 = '{:,}'.format(perevod).replace(',', '.')

                    user_status = cursor.execute("SELECT user_status from users where user_id = ?",
                                                 (message.from_user.id,))
                    user_status = cursor.fetchone()
                    balance2 = cursor.execute("SELECT balance from users where user_id = ?",
                                              (message.from_user.id,))
                    balance2 = cursor.fetchone()
                    balance2 = round(balance2[0])

                    limitvidach2 = cursor.execute("SELECT limitvidach2 from users where user_id = ?",
                                                  (message.from_user.id,))
                    limitvidach2 = cursor.fetchone()
                    limitvidach2 = round(limitvidach2[0])
                    if user_status[0] == 'premium' or user_status[0] == 'delux' or user_status[0] == 'Admin' or user_status[0] == 'Rab':
                        if limitvidach2 != 0:
                            await message.reply(
                                f'💵 Вы получили {perevod2}₸   {rwin}',
                                parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance2 + perevod} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET limitvidach2 = 0 WHERE user_id = {user_id}')
                            connect.commit()
                        else:
                            await message.reply(
                                f'💵 Вы уже выдавали себе сегодня',
                                parse_mode='html')
                    else:
                        await message.reply(
                            f'Купить премиум чтоб пользоваться этой командой',
                            parse_mode='html')

                if message.text.startswith("Выдать") and message.reply_to_message:
                    message = message

                    user_id = message.from_user.id
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)

                    reply_user_namee = message.reply_to_message.from_user.get_mention(
                        as_html=True)
                    reply_user_id = message.reply_to_message.from_user.id

                    try:
                        su = message.text.split()[1]
                        su2 = (su).replace('к', '000')
                        su3 = (su2).replace('м', '000000')
                        su4 = (su3).replace('.', '')
                        su5 = float(su4)

                        perevod = int(su5)
                        perevod2 = '{:,}'.format(perevod).replace(',', '.')
                    except:
                        await message.reply('‼️ Не хватает аргументов!\nПример: Выдать 1 ')
                        return


                    user_status = cursor.execute("SELECT user_status from users where user_id = ?",
                                                 (message.from_user.id,))
                    user_status = cursor.fetchone()
                    user_status = str(user_status[0])
                    balance2 = cursor.execute("SELECT balance from users where user_id = ?",
                                              (message.reply_to_message.from_user.id,))
                    balance2 = cursor.fetchone()
                    balance2 = round(balance2[0])

                    limitvidach = cursor.execute("SELECT limitvidach from users where user_id = ?",
                                                 (message.from_user.id,))
                    limitvidach = cursor.fetchone()
                    limitvidach = int(limitvidach[0])

                    if perevod > 0:
                        if user_status == 'Rab':
                            await message.reply(
                                f'💵 Вы выдали {perevod2}₸  игроку <a href="tg://user?id={reply_user_id}">{reply_user_namee}</a> {rwin}',
                                parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance2 + perevod} WHERE user_id = {reply_user_id}')
                            await bot.send_message(cfg.log_group, f"""
⚙️LOG: #перевод 
Администратор <a href="tg://user?id={user_id}">{user_name}</a>(<code>{user_id}</code>)  выдал деньги игроку 
<a href="tg://user?id={reply_user_id}">{reply_user_namee}</a>(<code>{reply_user_id}</code>)  в размере {perevod2}₸ 
""", parse_mode='html')
                            connect.commit()
                        elif user_status == 'Admin' and limitvidach-perevod >= 0:
                            await message.reply(
                                f'💵 Вы выдали {perevod2}₸  игроку <a href="tg://user?id={reply_user_id}">{reply_user_namee}</a> {rwin}',
                                parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance2 + perevod} WHERE user_id = {reply_user_id}')

                            await bot.send_message(cfg.log_group, f"""
⚙️LOG: #перевод 
Администратор <a href="tg://user?id={user_id}">{user_name}</a>(<code>{user_id}</code>)  выдал деньги игроку 
<a href="tg://user?id={reply_user_id}">{reply_user_namee}</a>(<code>{reply_user_id}</code>) в размере {perevod2}₸ 
""", parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET limitvidach = {limitvidach - perevod} WHERE user_id = {user_id}')
                            connect.commit()
                        elif user_status == 'delux' and limitvidach-perevod >= 0:
                            await message.reply(
                                f'💵 Вы выдали {perevod2}₸  игроку <a href="tg://user?id={reply_user_id}">{reply_user_namee}</a> {rwin}',
                                parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance2 + perevod} WHERE user_id = {reply_user_id}')
                            cursor.execute(
                                f'UPDATE users SET limitvidach = {limitvidach - perevod} WHERE user_id = {user_id}')
                            connect.commit()
                        elif user_status == 'delux' and limitvidach - perevod <= 0:
                            await message.reply(
                                f'💵 Вы выдали уже дневную норму или же превышает лимит ,для просмотра лимитов введите: лимит',
                                parse_mode='html')
                        elif user_status == 'Admin' and limitvidach - perevod <= 0:
                            await message.reply(
                                f'💵 Вы выдали уже дневную норму или же превышает лимит ,для просмотра лимитов введите: лимит',
                                parse_mode='html')
                        elif user_status == 'Player' or user_status == 'vip':
                            await message.reply(
                                f'<a href="tg://user?id={user_id}">{user_name}</a>, Доступ к данной команде ограничен. Для покупки администратора обратитесь к создателю 👨‍🦰',
                                parse_mode='html')
                    else:
                        await bot.send_message(message.from_user.id,
                                               f"Вы не можете выдать отрецательное число")
                if message.text.startswith("Чупик") and message.reply_to_message:
                    message = message

                    user_id = message.from_user.id
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    try:
                        reply_user_namee = message.reply_to_message.from_user.get_mention(
                            as_html=True)
                        reply_user_id = message.reply_to_message.from_user.id
                    except:
                        await message.reply('‼️Сообщение должно быть ответом на сообщение! ')
                        return


                    try:
                        su = message.text.split()[1]
                        su2 = (su).replace('к', '000')
                        su3 = (su2).replace('м', '000000')
                        su4 = (su3).replace('.', '')
                        su5 = float(su4)

                        perevod = int(su5)
                        perevod2 = '{:,}'.format(perevod).replace(',', '.')
                    except:
                        await message.reply('‼️ Не хватает аргументов!\nПример: чупик 1 ')
                        return

                    user_status = cursor.execute("SELECT user_status from users where user_id = ?",
                                                 (message.from_user.id,))
                    user_status = cursor.fetchone()
                    user_status = str(user_status[0])
                    ecoins = cursor.execute("SELECT ecoins from users where user_id = ?",
                                              (message.reply_to_message.from_user.id,))
                    ecoins = cursor.fetchone()
                    ecoins = round(ecoins[0])



                    if perevod > 0:
                        if user_status == 'Rab':
                            await message.reply(
                                f'💵 Вы выдали {perevod2} 🍭 игроку <a href="tg://user?id={reply_user_id}">{reply_user_namee}</a> {rwin}',
                                parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET ecoins = {ecoins + perevod} WHERE user_id = {reply_user_id}')
                            connect.commit()

                        else:
                            await message.reply(
                                f'<a href="tg://user?id={user_id}">{user_name}</a>, Доступ к данной команде ограничен. Для покупки администратора обратитесь к создателю 👨‍🦰',
                                parse_mode='html')
                    else:
                        await bot.send_message(message.from_user.id,
                                               f"Вы не можете выдать отрецательное число")
                if message.text.lower() in ["реф", "Реф"]:
                    coint = cursor.execute("SELECT countref from users where user_id = ?",
                                           (message.from_user.id,))
                    coint = cursor.fetchone()
                    coint = coint[0]
                    ticket = cursor.execute("SELECT ticket from users where user_id = ?",
                                           (message.from_user.id,))
                    ticket = cursor.fetchone()
                    ticket = ticket[0]

                    await bot.send_message(message.chat.id, f"» Если по ней перейдет человек, не игравший в бота \n💰 Ты получишь  25.000.000.000₸ и 5 тикетов\n💰 Приглашенный пользователь получит 25.000.000.000₸ и 5 тикетов с помощью тикетов можно крутить кейсы с которых могут выпасть донат вещи\n\n📨 Реферальная ссылка: https://t.me/{cfg.BOT_NICKNAME}?start={message.from_user.id}\n👥 Кол-во  рефералов: {coint}\n🎟️ Кол-во  тикетов: {ticket}")
                if message.text.startswith('!раздача') or message.text.startswith('!Раздача'):
                    user_id = message.from_user.id

                    if user_id == cfg.owner_id:
                        type = cursor.execute(f"SELECT type_raz from clans_id ")
                        type = cursor.fetchone()
                        type = type[0]
                        if message.text.split()[1]=="вкл":
                            if type!=1:
                                cursor.execute(f"UPDATE clans_id SET type_raz = {1}")
                                connect.commit()

                                text = f'''
                            ♻️ <b>Доступ к раздаче открыт</b> 
                                        '''
                                await message.reply(text, parse_mode='html')
                            else:
                                text = f'''
                                                            ♻️ <b>Доступ к раздаче уже открыт</b> 
                                                                        '''
                                await message.reply(text, parse_mode='html')
                        if message.text.split()[1] == "выкл":
                            if type != 0:
                                cursor.execute(f"UPDATE clans_id SET type_raz = {0}")
                                connect.commit()

                                text = f'''
                                                        ♻️ <b>Доступ к раздаче закрыт</b> 
                                                                    '''
                                await message.reply(text, parse_mode='html')
                            else:
                                text = f'''
                                                            ♻️ <b>Доступ к раздаче уже закрыт</b> 
                                                                        '''
                                await message.reply(text, parse_mode='html')
                ############################### ВДЗУ - ВЫДАЧА ДЕНЕГ ЗА УЧАСТНИКОВ ################################################
                if message.text.startswith('вдзу') or message.text.startswith('Вдзу'):
                    user_id = message.from_user.id

                    if user_id == cfg.owner_id:
                        if message.text.split()[1]=="вкл":
                            cursor.execute(f"UPDATE wdzy SET wdz ='on' WHERE chat_id={message.chat.id}")
                            connect.commit()

                            text = f'''
                        ♻️ <b>ВДЗУ включена </b> 
                                    '''
                            await message.reply(text, parse_mode='html')
                        if message.text.split()[1] == "выкл":
                            cursor.execute(f"UPDATE wdzy SET wdz ='off' WHERE chat_id={message.chat.id}")
                            connect.commit()

                            text = f'''
                        ♻️ <b>ВДЗУ выключена </b> 
                                    '''
                            await message.reply(text, parse_mode='html')
                    else:
                        return await message.reply(f'❗️ Данная команда доступна только <b>владельцу бота</b>',
                                                   parse_mode='html')
                if message.text.startswith('!чат') or message.text.startswith('!Чат'):
                    user_id = message.from_user.id

                    if user_id == cfg.owner_id:
                        if message.text.split()[1]=="бинд":
                            wdz=cursor.execute(f"SELECT wdz FROM wdzy WHERE chat_id={message.chat.id}")
                            wdz=cursor.fetchone()
                            if wdz is None:
                                wdz="off"
                                cursor.execute(
                                    f'INSERT INTO wdzy VALUES (?, ?, ?, ?);',
                                    (100, wdz, message.chat.id,0,))
                                connect.commit()

                                text = f'''
                            ♻️ <b>ВДЗУ привязана к чату </b> 
                                        '''
                                await message.reply(text, parse_mode='html')

                        if message.text.split()[1] == "анбинд":
                            cursor.execute(f"SELECT wdz FROM wdzy WHERE chat_id={message.chat.id}")
                            if cursor.fetchone != None:
                                cursor.execute("DELETE FROM wdzy WHERE chat_id= ?", (message.chat.id,))
                                connect.commit()

                                text = f'''
                            ♻️ <b>ВДЗУ отвязана от чата </b> 
                                        '''
                                await message.reply(text, parse_mode='html')

                    else:
                        return await message.reply(f'❗️ Данная команда доступна только <b>владельцу бота</b>',
                                                   parse_mode='html')
                if message.text.startswith('вдзу сумма') or message.text.startswith('Вдзу сумма'):

                    user_id = message.from_user.id
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = str(user_name[0])
                    try:
                        su = message.text.split()[2]
                    except:
                        await message.reply('‼️ Не хватает аргументов!\nПример: вдзу сумма 1 ')
                        return

                    su2 = (su).replace(' ', '').replace('k', '000').replace('е', 'e').replace('к', '000').replace(',',
                                                                                                                  '').replace(
                        '.', '')
                    su3 = float(su2)
                    summ = int(su3)

                    if user_id == cfg.owner_id:
                        cursor.execute(f'UPDATE wdzy SET summ = {summ} WHERE chat_id={message.chat.id}')
                        connect.commit()

                        text = f'''
            ♻️ <b>Обновлена</b> сумма за 1 участника - <code>{'{:,}'.format(summ).replace(',', '.')}₸</code>
                        '''
                        await message.reply(text, parse_mode='html')
                    else:
                        return await message.reply(f'❗️ Данная команда доступна только <b>владельцу бота</b>',
                                                   parse_mode='html')
                if message.text.startswith('город построить') or message.text.startswith('Город построить')or message.text.startswith('построить город'):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])
                    cursor.execute("SELECT city_name FROM city WHERE user_id=?",(message.from_user.id,))
                    if cursor.fetchone() is None:
                        if balance>=1_000_000_000_000:
                            try:
                                name = str(message.text.split()[2])
                            except:
                                await message.reply('‼️ Не хватает аргументов!\nПример: Город построить название ')
                                return
                            cursor.execute(f"UPDATE users SET balance={balance - 1_000_000_000_000} WHERE user_id=?",
                                           (message.from_user.id,))
                            cursor.execute(
                                f'INSERT INTO city VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);',
                                (100,user_id, user_name, 0, name, 50, 1, 1, 1, 1000,5,100,30,100,0,0))

                            await message.reply(
                                f'🌆 <a href="tg://user?id={user_id}">{user_name}</a> Вы успешно построили город',
                                parse_mode='html')
                            connect.commit()
                        else:
                            await message.reply(
                                f'💰 <a href="tg://user?id={user_id}">{user_name}</a> Вы не можете построить город (недостаточно средств)\n Стоимость: 1.000.000.000.000 ₸(1трлн) ',
                                parse_mode='html')
                    else:
                        await message.reply('‼️ Вы уже построили город!')
                if message.text.lower() in ["мой город", "Мой город","город","Город"]:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    cursor.execute("SELECT city_name FROM city WHERE user_id=?", (message.from_user.id,))
                    if cursor.fetchone() != None:
                        citizens=cursor.execute("SELECT citizens FROM city WHERE user_id=?", (message.from_user.id,))
                        citizens=cursor.fetchone()
                        citizens=int(citizens[0])

                        kazna = cursor.execute("SELECT kazna FROM city WHERE user_id=?", (message.from_user.id,))
                        kazna = cursor.fetchone()
                        kazna = int(kazna[0])

                        city_name = cursor.execute("SELECT city_name FROM city WHERE user_id=?", (message.from_user.id,))
                        city_name = cursor.fetchone()
                        city_name = str(city_name[0])

                        happynes = cursor.execute("SELECT happynes FROM city WHERE user_id=?", (message.from_user.id,))
                        happynes = cursor.fetchone()
                        happynes = float(happynes[0])

                        electricity = cursor.execute("SELECT electricity FROM city WHERE user_id=?", (message.from_user.id,))
                        electricity = cursor.fetchone()
                        electricity = int(electricity[0])

                        water = cursor.execute("SELECT water FROM city WHERE user_id=?", (message.from_user.id,))
                        water = cursor.fetchone()
                        water = int(water[0])

                        factory = cursor.execute("SELECT factory FROM city WHERE user_id=?", (message.from_user.id,))
                        factory = cursor.fetchone()
                        factory = int(factory[0])

                        road = cursor.execute("SELECT road FROM city WHERE user_id=?", (message.from_user.id,))
                        road = cursor.fetchone()
                        road = int(road[0])

                        houses = cursor.execute("SELECT houses FROM city WHERE user_id=?", (message.from_user.id,))
                        houses = cursor.fetchone()
                        houses = int(houses[0])

                        work_place = cursor.execute("SELECT work_place FROM city WHERE user_id=?", (message.from_user.id,))
                        work_place = cursor.fetchone()
                        work_place = int(work_place[0])

                        taxes = cursor.execute("SELECT taxes FROM city WHERE user_id=?", (message.from_user.id,))
                        taxes = cursor.fetchone()
                        taxes = int(taxes[0])

                        if happynes>20:
                            happynes2 = "🙁"
                        if happynes > 40:
                            happynes2 = "😑"
                        if happynes>60:
                            happynes2 = "🙂"
                        if happynes > 80:
                            happynes2="😇"
                        if happynes < 20:
                            happynes2 = "🤬"
                        material = cursor.execute("SELECT material FROM city WHERE user_id=?", (message.from_user.id,))
                        material = cursor.fetchone()
                        material = int(material[0])
                        kazna2 = '{:,}'.format(kazna).replace(',', '.')
                        material2 = '{:,}'.format(material).replace(',', '.')
                        citizens2 = '{:,}'.format(citizens).replace(',', '.')
                        work_place2 = '{:,}'.format(work_place).replace(',', '.')
                        factory2 = '{:,}'.format(factory).replace(',', '.')
                        houses2 = '{:,}'.format(houses).replace(',', '.')
                        electricity3=round((houses*30)+(factory*45))

                        electricity4 = '{:,}'.format(electricity3).replace(',', '.')
                        water3 = round((houses * 30) + (factory * 45))
                        water4 = '{:,}'.format(water3).replace(',', '.')
                        water5=water*100
                        water2 = '{:,}'.format(water5).replace(',', '.')
                        electricity5=electricity*100
                        electricity2 = '{:,}'.format(electricity5).replace(',', '.')
                        road2 = '{:,}'.format(road).replace(',', '.')
                        if electricity5<electricity3 :
                            problem="⚠️ В городе есть проблемы:\n⚡ Расходы энергий превышают её добычу!\n➖ Постройте АЭС"

                        if water5<water3:
                            problem = "⚠️ В городе есть проблемы:\n💦 Расходы воды превышают её добычу!\n➖ Постройте водонапорную башню"
                        if electricity5<electricity3 and water5<water3:
                            problem = "⚠️ В городе есть проблемы:\n💦 Расходы воды превышают её добычу!\n⚡ Расходы энергий превышают её добычу!\n➖ Постройте водонапорную башню\n➖ Постройте АЭС"
                        if electricity5>electricity3 and water5>water3:
                            problem=""
                        await bot.send_message(message.chat.id, f"""
<a href="tg://user?id={user_id}">{user_name}</a>, информация о Вашем городе:
🏙 Название: {city_name} 
💰 Казна города: {kazna2}
👥 Жителей: {citizens2} чел
⠀{happynes2} Счастье: {round(happynes, 2)}%
⠀👨🏻‍🔧 Работают: {work_place2} чел
⠀💸 Налоги: {taxes}%
⠀💧 Вода: {water2}/{water4}м³/час-[выроботка/затрат]
⠀⚡️ Энергия: {electricity2}/{electricity4}МВт-[выроботка/затрат]
📦 Материалов: {material2} шт
⠀🚙 Дороги: {road2} метров

🏗 Здания:
🏡 Жилой дом: {houses2}x
🔧 Завод: {factory2}x
☢️ АЭС: {electricity}x
💧 Водонапорная башня: {water}x

<b>{problem}</b>
""",
                                               reply_markup=help_city,parse_mode='html')

                    else:
                        await message.reply('‼️ Для начало постройте город : Город построить [название]!')


                if message.text.lower() in ["город снять", "Город снять"]:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    cursor.execute("SELECT city_name FROM city WHERE user_id=?", (message.from_user.id,))
                    if cursor.fetchone() != None:
                        kazna = cursor.execute("SELECT kazna FROM city WHERE user_id=?", (message.from_user.id,))
                        kazna = cursor.fetchone()
                        kazna = int(kazna[0])
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])
                        if kazna>0:
                            cursor.execute(f"UPDATE users SET balance={balance+kazna} WHERE user_id=?", (message.from_user.id,))
                            cursor.execute(f"UPDATE city SET kazna={0} WHERE user_id=?", (message.from_user.id,))
                            connect.commit()
                            kazna2 = '{:,}'.format(kazna).replace(',', '.')
                            balance2 = '{:,}'.format(balance).replace(',', '.')
                            await message.reply(
                                f'‼️<a href="tg://user?id={user_id}">{user_name}</a>, Вы забрали из казны города {kazna2} 👍\n'
                                    f'💰 Баланс: {balance}\n'
                                    f'💳 Казна города: 0',parse_mode='html')

                        else:
                            await message.reply(f'‼️<a href="tg://user?id={user_id}">{user_name}</a>, в казне вашего города нет денег 😔 ',parse_mode='html')
                    else:
                        await message.reply('‼️ Для начало постройте город : Город построить [название]!')
                if message.text.startswith('Г налог') or message.text.startswith('г налог')or message.text.startswith('Город налог'):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    cursor.execute("SELECT city_name FROM city WHERE user_id=?", (message.from_user.id,))
                    if cursor.fetchone() != None:
                        try:
                            count = int(message.text.split()[2])
                        except:
                            await message.reply('‼️ Не хватает аргументов!\nПример: Город налог 1-99 ')
                            return
                        if count>=1:
                            if count<100:
                                cursor.execute(f"UPDATE city SET taxes={count} WHERE user_id=?", (message.from_user.id,))

                                city3 = random.uniform(0.01, 0.99)
                                city4 = random.randint(1, 8)
                                cursor.execute(f"UPDATE city SET happynes={float(city4 + city3)} WHERE taxes<99")
                                cursor.execute(f"UPDATE city SET happynes={20 + city3 + city4} WHERE taxes>80")
                                cursor.execute(f"UPDATE city SET happynes={40 + city3 + city4} WHERE taxes<60")
                                cursor.execute(f"UPDATE city SET happynes={60 + city3 + city4} WHERE taxes<40")
                                cursor.execute(f"UPDATE city SET happynes={80 + city3 + city4} WHERE taxes<20")
                                if count in range(90,100):
                                    await message.reply(
                                    f'‼️<a href="tg://user?id={user_id}">{user_name}</a>, Вы установили размер налога в {count}%! \n'
                                    f'💰 Жители отдают всю свою зарплату. Возможно, стоит уменьшить размер налога?',parse_mode='html')
                                else:
                                    await message.reply(
                                        f'‼️<a href="tg://user?id={user_id}">{user_name}</a>, Вы установили размер налога в {count}%! ',parse_mode='html')
                            else:
                                await message.reply('‼️ Установите размер налоговой ставки с помощью «Г налог [1-99]» 👍🏼')
                        else:
                            await message.reply('‼️ Установите размер налоговой ставки с помощью «Г налог [1-99]» 👍🏼')
                    else:
                        await message.reply('‼️ Для начало постройте город : Город построить [название]!')
                if message.text.startswith('Город дорога') or message.text.startswith('город дорога'):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    cursor.execute("SELECT city_name FROM city WHERE user_id=?", (message.from_user.id,))

                    if cursor.fetchone() != None:
                        try:
                            count = int(message.text.split()[2])
                        except:
                            await message.reply('‼️ Не хватает аргументов!\nПример: город дорога 1 ')
                            return

                        price = 10
                        material = cursor.execute("SELECT material FROM city WHERE user_id=?", (message.from_user.id,))
                        material = cursor.fetchone()
                        material = int(material[0])
                        zavodov=round(int(material / price))

                        road = cursor.execute("SELECT road FROM city WHERE user_id=?", (message.from_user.id,))
                        road = cursor.fetchone()
                        road = int(road[0])

                        if count>0:
                            if material>=price*count:

                                cursor.execute(f"UPDATE city SET material={material-(price*count)} WHERE user_id=?", (message.from_user.id,))
                                cursor.execute(f"UPDATE city SET road={road+count} WHERE user_id=?", (message.from_user.id,))

                                connect.commit()

                                await message.reply(
                                    f'<a href="tg://user?id={user_id}">{user_name}</a>, Вы проложили {count} метров дороги  ☺️',parse_mode='html')

                            else:
                                await message.reply(f'‼️ Недостаточно материалов ! Вам хватит на {zavodov} метров!')
                        else:
                            await message.reply('‼️ Введите положительно число!')
                    else:
                        await message.reply('‼️ Для начало постройте город : Город построить [название]!')
                if message.text.startswith('Город завод ') or message.text.startswith('город завод '):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    cursor.execute("SELECT city_name FROM city WHERE user_id=?", (message.from_user.id,))
                    if cursor.fetchone() != None:
                        try:
                            count = int(message.text.split()[2])
                        except:
                            await message.reply('‼️ Не хватает аргументов!\nПример: город завод 1 ')
                            return
                        electricity = cursor.execute("SELECT electricity FROM city WHERE user_id=?",
                                                     (message.from_user.id,))
                        electricity = cursor.fetchone()
                        electricity = int(electricity[0])
                        houses = cursor.execute("SELECT houses FROM city WHERE user_id=?", (message.from_user.id,))
                        houses = cursor.fetchone()
                        houses = int(houses[0])
                        water = cursor.execute("SELECT water FROM city WHERE user_id=?", (message.from_user.id,))
                        water = cursor.fetchone()
                        water = int(water[0])
                        factory = cursor.execute("SELECT factory FROM city WHERE user_id=?", (message.from_user.id,))
                        factory = cursor.fetchone()
                        factory = int(factory[0])
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])
                        citizens = cursor.execute("SELECT citizens FROM city WHERE user_id=?", (message.from_user.id,))
                        citizens = cursor.fetchone()
                        citizens = int(citizens[0])
                        work_place = cursor.execute("SELECT work_place FROM city WHERE user_id=?", (message.from_user.id,))
                        work_place = cursor.fetchone()
                        work_place = int(work_place[0])
                        price = 500_000_000_000
                        limit=round((factory*25)+(water*15)+(electricity*15))
                        zavodov=round(int(balance / price ))

                        road = cursor.execute("SELECT road FROM city WHERE user_id=?", (message.from_user.id,))
                        road = cursor.fetchone()
                        road = int(road[0])
                        build=(electricity+houses+factory+water) * 100
                        if count>0:
                            if balance>=price*count:
                                if citizens>=limit+(count*25):
                                    if road>=build+(count*100):
                                        cursor.execute(f"UPDATE users SET balance={balance-(price*count)} WHERE user_id=?", (message.from_user.id,))
                                        cursor.execute(f"UPDATE city SET factory={factory+count} WHERE user_id=?", (message.from_user.id,))
                                        cursor.execute(f"UPDATE city SET work_place={work_place + (count*25)} WHERE user_id=?",
                                                       (message.from_user.id,))
                                        connect.commit()
                                        work_place2 = '{:,}'.format(work_place).replace(',', '.')
                                        await message.reply(
                                            f'<a href="tg://user?id={user_id}">{user_name}</a>, Вы построили «Завод» {count}х ☺️\n'
                                            f'🔧 Рабочих мест : {work_place2} [+{count*25}]!',parse_mode='html')
                                    else:
                                        await message.reply(
                                            f'‼️ Для постройки большего кол-во заводов нужно построить дороги'
                                            )
                                else:
                                    await message.reply(
                                        f'‼️ Для постройки большего кол-во заводов нужно больше жителей')
                            else:
                                await message.reply(f'‼️ Недостаточно средств ! Вам хватит на {zavodov} заводов!')
                        else:
                            await message.reply('‼️ Введите положительно число!')
                    else:
                        await message.reply('‼️ Для начало постройте город : Город построить [название]!')
                if message.text.startswith('Город вода') or message.text.startswith('город вода'):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    cursor.execute("SELECT city_name FROM city WHERE user_id=?", (message.from_user.id,))
                    if cursor.fetchone() != None:
                        try:
                            count = int(message.text.split()[2])
                        except:
                            await message.reply('‼️ Не хватает аргументов!\nПример: Город вода 1 ')
                            return
                        electricity = cursor.execute("SELECT electricity FROM city WHERE user_id=?",
                                                     (message.from_user.id,))
                        electricity = cursor.fetchone()
                        electricity = int(electricity[0])
                        houses = cursor.execute("SELECT houses FROM city WHERE user_id=?", (message.from_user.id,))
                        houses = cursor.fetchone()
                        houses = int(houses[0])
                        water = cursor.execute("SELECT water FROM city WHERE user_id=?", (message.from_user.id,))
                        water = cursor.fetchone()
                        water = int(water[0])
                        factory = cursor.execute("SELECT factory FROM city WHERE user_id=?", (message.from_user.id,))
                        factory = cursor.fetchone()
                        factory = int(factory[0])

                        citizens = cursor.execute("SELECT citizens FROM city WHERE user_id=?", (message.from_user.id,))
                        citizens = cursor.fetchone()
                        citizens = int(citizens[0])
                        work_place = cursor.execute("SELECT work_place FROM city WHERE user_id=?", (message.from_user.id,))
                        work_place = cursor.fetchone()
                        work_place = int(work_place[0])
                        material = cursor.execute("SELECT material FROM city WHERE user_id=?", (message.from_user.id,))
                        material = cursor.fetchone()
                        material = int(material[0])
                        price = 500
                        limit=round((factory*25)+(water*15)+(electricity*15))
                        zavodov=round(int(material / price))

                        road = cursor.execute("SELECT road FROM city WHERE user_id=?", (message.from_user.id,))
                        road = cursor.fetchone()
                        road = int(road[0])
                        build=(electricity+houses+factory+water) * 100
                        if count>0:
                            if material>=price*count:
                                if citizens>=limit+(count*25):
                                    if road>=build+(count*100):
                                        cursor.execute(f"UPDATE city SET material={material-(price*count)} WHERE user_id=?", (message.from_user.id,))
                                        cursor.execute(f"UPDATE city SET water={water+count} WHERE user_id=?", (message.from_user.id,))
                                        cursor.execute(f"UPDATE city SET work_place={work_place + (count*15)} WHERE user_id=?",
                                                       (message.from_user.id,))
                                        connect.commit()
                                        work_place2 = '{:,}'.format(work_place).replace(',', '.')
                                        await message.reply(
                                            f'<a href="tg://user?id={user_id}">{user_name}</a>, Вы построили «Водонапорную башню» {count}х ☺️\n'
                                            f'🔧 Рабочих мест : {work_place2} [+{count*15}]!',parse_mode='html')
                                    else:
                                        await message.reply(
                                            f'‼️ Для постройки большего кол-во Водонапорных башен нужно построить дороги'
                                            )
                                else:
                                    await message.reply(
                                        f'‼️ Для постройки большего кол-во Водонапорных башен нужно больше жителей')
                            else:
                                await message.reply(f'‼️ Недостаточно материалов ! Вам хватит на {zavodov} Водонапорных башен!')
                        else:
                            await message.reply('‼️ Введите положительно число!')
                    else:
                        await message.reply('‼️ Для начало постройте город : Город построить [название]!')
                if message.text.startswith('Город энергия') or message.text.startswith('город энергия'):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    cursor.execute("SELECT city_name FROM city WHERE user_id=?", (message.from_user.id,))
                    if cursor.fetchone() != None:
                        try:
                            count = int(message.text.split()[2])
                        except:
                            await message.reply('‼️ Не хватает аргументов!\nПример: город энергия 1 ')
                            return
                        electricity = cursor.execute("SELECT electricity FROM city WHERE user_id=?",
                                                     (message.from_user.id,))
                        electricity = cursor.fetchone()
                        electricity = int(electricity[0])
                        houses = cursor.execute("SELECT houses FROM city WHERE user_id=?", (message.from_user.id,))
                        houses = cursor.fetchone()
                        houses = int(houses[0])
                        water = cursor.execute("SELECT water FROM city WHERE user_id=?", (message.from_user.id,))
                        water = cursor.fetchone()
                        water = int(water[0])
                        factory = cursor.execute("SELECT factory FROM city WHERE user_id=?", (message.from_user.id,))
                        factory = cursor.fetchone()
                        factory = int(factory[0])

                        citizens = cursor.execute("SELECT citizens FROM city WHERE user_id=?", (message.from_user.id,))
                        citizens = cursor.fetchone()
                        citizens = int(citizens[0])
                        work_place = cursor.execute("SELECT work_place FROM city WHERE user_id=?", (message.from_user.id,))
                        work_place = cursor.fetchone()
                        work_place = int(work_place[0])
                        material = cursor.execute("SELECT material FROM city WHERE user_id=?", (message.from_user.id,))
                        material = cursor.fetchone()
                        material = int(material[0])
                        price = 500
                        limit = round((factory * 25) + (water * 15) + (electricity * 15))
                        zavodov=round(int(material / price))

                        road = cursor.execute("SELECT road FROM city WHERE user_id=?", (message.from_user.id,))
                        road = cursor.fetchone()
                        road = int(road[0])
                        build = (electricity + houses + factory + water) * 100
                        if count > 0:
                            if material >= price * count:
                                if citizens >= limit + (count * 25):
                                    if road >= build + (count * 100):
                                        cursor.execute(
                                            f"UPDATE city SET material={material - (price*count)} WHERE user_id=?",
                                            (message.from_user.id,))
                                        cursor.execute(f"UPDATE city SET electricity={electricity + count} WHERE user_id=?",
                                                       (message.from_user.id,))
                                        cursor.execute(
                                            f"UPDATE city SET work_place={work_place + (count * 15)} WHERE user_id=?",
                                            (message.from_user.id,))
                                        connect.commit()
                                        work_place2 = '{:,}'.format(work_place).replace(',', '.')
                                        await message.reply(
                                            f'<a href="tg://user?id={user_id}">{user_name}</a>, Вы построили «АЭС» {count}х ☺️\n'
                                            f'🔧 Рабочих мест : {work_place2} [+{count * 15}]!',parse_mode='html')
                                    else:
                                        await message.reply(
                                            f'‼️ Для постройки большего кол-во АЭС нужно построить дороги'
                                        )
                                else:
                                    await message.reply(
                                        f'‼️ Для постройки большего кол-во АЭС нужно больше жителей')
                            else:
                                await message.reply(
                                    f'‼️ Недостаточно материалов ! Вам хватит на {zavodov} АЭС!')
                        else:
                            await message.reply('‼️ Введите положительно число!')
                    else:
                        await message.reply('‼️ Для начало постройте город : Город построить [название]!')
                if message.text.startswith('Город дом') or message.text.startswith('город дом'):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    cursor.execute("SELECT city_name FROM city WHERE user_id=?", (message.from_user.id,))
                    if cursor.fetchone() != None:
                        try:
                            count = int(message.text.split()[2])
                        except:
                            await message.reply('‼️ Не хватает аргументов!\nПример: Город дом 1 ')
                            return
                        electricity = cursor.execute("SELECT electricity FROM city WHERE user_id=?",
                                                     (message.from_user.id,))
                        electricity = cursor.fetchone()
                        electricity = int(electricity[0])
                        houses = cursor.execute("SELECT houses FROM city WHERE user_id=?", (message.from_user.id,))
                        houses = cursor.fetchone()
                        houses = int(houses[0])
                        water = cursor.execute("SELECT water FROM city WHERE user_id=?", (message.from_user.id,))
                        water = cursor.fetchone()
                        water = int(water[0])
                        factory = cursor.execute("SELECT factory FROM city WHERE user_id=?", (message.from_user.id,))
                        factory = cursor.fetchone()
                        factory = int(factory[0])

                        citizens = cursor.execute("SELECT citizens FROM city WHERE user_id=?", (message.from_user.id,))
                        citizens = cursor.fetchone()
                        citizens = int(citizens[0])
                        work_place = cursor.execute("SELECT work_place FROM city WHERE user_id=?", (message.from_user.id,))
                        work_place = cursor.fetchone()
                        work_place = int(work_place[0])
                        material = cursor.execute("SELECT material FROM city WHERE user_id=?", (message.from_user.id,))
                        material = cursor.fetchone()
                        material = int(material[0])
                        price = 150

                        zavodov=round(int(material / price))

                        road = cursor.execute("SELECT road FROM city WHERE user_id=?", (message.from_user.id,))
                        road = cursor.fetchone()
                        road = int(road[0])
                        build = (electricity + houses + factory + water) * 100
                        if count > 0:
                            if material >= price * count:
                                if road >= build + (count * 100):
                                    cursor.execute(
                                        f"UPDATE city SET material={material - (price*count)} WHERE user_id=?",
                                        (message.from_user.id,))
                                    cursor.execute(f"UPDATE city SET houses={houses + count} WHERE user_id=?",
                                                   (message.from_user.id,))
                                    cursor.execute(
                                        f"UPDATE city SET citizens={citizens + (count * 15)} WHERE user_id=?",
                                        (message.from_user.id,))
                                    connect.commit()
                                    work_place2 = '{:,}'.format(work_place).replace(',', '.')
                                    await message.reply(
                                        f'<a href="tg://user?id={user_id}">{user_name}</a>, Вы построили «Жилой дом» {count}х ☺️\n'
                                        f'👤 Вместимость жителей: {houses*15} [+{count * 15}]!',parse_mode='html')
                                else:
                                    await message.reply(
                                        f'‼️ Для постройки большего кол-во Жилых домов нужно построить дороги'
                                    )
                            else:
                                await message.reply(
                                    f'‼️ Недостаточно материалов ! Вам хватит на {zavodov} Жилых домов!')
                        else:
                            await message.reply('‼️ Введите положительно число!')
                    else:
                        await message.reply('‼️ Для начало постройте город : Город построить [название]!')
                if message.text.lower() in ['город переработка']:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    cursor.execute("SELECT city_name FROM city WHERE user_id=?", (message.from_user.id,))
                    if cursor.fetchone() != None:


                        ore_processing_plant = cursor.execute("SELECT ore_processing_plant FROM city WHERE user_id=?", (message.from_user.id,))
                        ore_processing_plant = cursor.fetchone()
                        ore_processing_plant = int(ore_processing_plant[0])
                        citizens = cursor.execute("SELECT citizens FROM city WHERE user_id=?", (message.from_user.id,))
                        citizens = cursor.fetchone()
                        citizens = int(citizens[0])
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])

                        if ore_processing_plant ==0:
                            if citizens >=100000:
                                if balance>=200_000_000_000_000:
                                    cursor.execute(
                                        f"UPDATE city SET ore_processing_plant={1} WHERE user_id=?",
                                        (message.from_user.id,))
                                    cursor.execute(
                                        f"UPDATE users SET balance={balance-200_000_000_000_000} WHERE user_id=?",
                                        (message.from_user.id,))
                                    await message.reply(
                                        f'<a href="tg://user?id={user_id}">{user_name}</a>, Вы построили завод по «♻️Переработки руды» ☺️\n'
                                        ,parse_mode='html')
                                else:
                                    await message.reply(
                                        f'‼️ Недостаточно средств ! 💰 Цена: 200.000.000.000.000₸')
                            else:
                                await message.reply(
                                    f'‼️ Для постройки завода по «♻️Переработки руды» нужно больше 100.000 жителей'
                                )
                        else:
                            await message.reply(
                                f'‼️ У вас уже есть завод по переработки руды'
                            )


                    else:
                        await message.reply('‼️ Для начало постройте город : Город построить [название]!')
                if message.text.lower() in ['город аренда']:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    cursor.execute("SELECT city_name FROM city WHERE user_id=?", (message.from_user.id,))
                    if cursor.fetchone() != None:


                        earning = cursor.execute("SELECT earning FROM city WHERE user_id=?", (message.from_user.id,))
                        earning = cursor.fetchone()
                        earning = int(earning[0])
                        citizens = cursor.execute("SELECT citizens FROM city WHERE user_id=?", (message.from_user.id,))
                        citizens = cursor.fetchone()
                        citizens = int(citizens[0])
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])

                        if earning == 0:
                            if citizens >=1000000:
                                if balance>=250_000_000_000_000:
                                    cursor.execute(
                                        f"UPDATE city SET earning={1} WHERE user_id=?",
                                        (message.from_user.id,))
                                    cursor.execute(
                                        f"UPDATE users SET balance={balance-250_000_000_000_000} WHERE user_id=?",
                                        (message.from_user.id,))
                                    await message.reply(
                                        f'✅ <a href="tg://user?id={user_id}">{user_name}</a>, Вы развили «Аренду» в городе☺️\n'
                                        ,parse_mode='html')
                                else:
                                    await message.reply(
                                        f'‼️ Недостаточно средств ! 💰 Цена: 200.000.000.000.000₸')
                            else:
                                await message.reply(
                                    f'‼️ Для развития  «Аренды» в городе нужно больше 1.000.000 жителей'
                                )
                        else:
                            await message.reply(
                                f'‼️ Вы уже развили Аренду в городе!'
                            )

                    else:
                        await message.reply('‼️ Для начало постройте город : Город построить [название]!')
                if message.text.lower() in ['кланы']:
                    number_clans=0
                    await bot.send_message(message.chat.id,
                                           f"""
🛡️ <code>Клан создать</code> (название)
🛡️ <code>Клан покинуть</code> - если вы создатель управление кланом перейдет другому игроку 
🛡️ <code>Клан вступить</code> (id)- если клан закрыт вы не сможете вступить
📁 <code>Мой клан</code> - информация о клане
👥 <code>Клан участники</code> - вывод участников клана
💰 <code>Казна пополнить</code> - деньги клана
💰 <code>Казна снять</code> - снимать может только создатель
📛 <code>Клан кик </code>(id) - изгоняет игрока из клана
🔐 <code>Клан приватность</code> 
⚔️ <code>Клан атака</code> (id)
💪 <code>Клан усилить</code> (число)
⏫ <code>Клан повысить</code>
⏬ <code>Клан понизить</code>

🛑 Будьте осторожны повышая ранг игрокам они могут управлять вашим кланом !

‼️  Текст кликабельный""", reply_markup=list_clans_get(number_clans),
                                           parse_mode='html')
                if message.text.startswith('клан создать') or message.text.startswith('Клан создать'):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])
                    data_с = await get_clan(message.from_user.id)
                    if data_с is None:
                        if balance>=100_000_000_000_000:

                            try:
                                name = str(message.text.split()[2])
                                if len(name) <= 30 and len(name) >= 4:
                                    pass
                                else:
                                    await message.reply('‼️Название клана должно быть не меньше 4 символов и не больше 30 символов')
                                    return
                            except:
                                await message.reply('‼️ Не хватает аргументов!\nПример: клан создать название ')
                                return
                            new_clan_id = cursor.execute(
                                "SELECT new_clan_id from clans_id ")
                            new_clan_id=cursor.fetchone()
                            new_clan_id=int(new_clan_id[0])
                            cursor.execute(f"UPDATE users SET balance={balance - 100_000_000_000_000} WHERE user_id=?",(message.from_user.id,))
                            cursor.execute(
                                f'INSERT INTO clans VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?);',(1,new_clan_id,name,0,1,new_clan_id,0,0,0,0))
                            cursor.execute(
                                f'INSERT INTO clan VALUES (?, ?, ?, ?, ?);', (user_id, user_name, "SOZD", new_clan_id,name))
                            connect.commit()
                            await message.reply(
                                f'🛡️ <a href="tg://user?id={user_id}">{user_name}</a> Вы успешно создали клан',
                                parse_mode='html')
                            cursor.execute(f"UPDATE clans_id SET new_clan_id={new_clan_id+1}")
                            connect.commit()
                        else:
                            await message.reply(f'💰 <a href="tg://user?id={user_id}">{user_name}</a> Нищий не может создать клан (недостаточно средств)\n Стоимость: 100.000.000.000.000 ₸(100трлн) ',
                                                parse_mode='html')
                    else:
                        await message.reply(f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> вы уже в клане',parse_mode='html')

                if message.text.startswith('клан вступить') or message.text.startswith('Клан вступить'):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    data_с = await get_clan(message.from_user.id)
                    if data_с is None:
                        try:
                            id = message.text.split()[2]
                            if id.isdigit():
                                pass
                            else:
                                await message.reply('‼️ Не хватает аргументов!\nПример:клан вступить id ')
                                return
                        except:
                            await message.reply( '‼️ Не хватает аргументов!\nПример: клан вступить id ')
                            return

                        cursor.execute(f"SELECT clan_id FROM clans WHERE clan_id =?",(id,))
                        if cursor.fetchone() != None:
                            cursor.execute(f"SELECT type_clan FROM clans WHERE clan_id =?", (id,))
                            type_clan=cursor.fetchone()
                            type_clan=int(type_clan[0])
                            if type_clan == 1:
                                name=cursor.execute(f"SELECT clan_name FROM clans WHERE clan_id=?",(id,))
                                name = cursor.fetchone()
                                name = name[0]

                                member = cursor.execute(f"SELECT members FROM clans WHERE clan_id=?", (id,))
                                member = cursor.fetchone()
                                member=int(member[0])

                                if member > 0:
                                    cursor.execute(
                                        f'INSERT INTO clan VALUES (?, ?, ?, ?, ?);',
                                        (user_id, user_name, "member", id, name))
                                    cursor.execute(
                                        f"UPDATE clans SET members={member+1} WHERE clan_id=?", (id,))
                                    await message.reply(
                                        f'🛡️ <a href="tg://user?id={user_id}">{user_name}</a> Вы вступили в клан',
                                        parse_mode='html')
                                    connect.commit()
                                if member == 0:
                                    cursor.execute(
                                        f'INSERT INTO clan VALUES (?, ?, ?, ?, ?);',
                                        (user_id, user_name, "SOZD", id, name))
                                    cursor.execute(
                                        f"UPDATE clans SET members={member + 1} WHERE clan_id=?", (id,))
                                    await message.reply(
                                        f'🛡️ <a href="tg://user?id={user_id}">{user_name}</a> Вы вступили в клан\b‼️ Так как в клане было пусто вы теперь новый глава клана',
                                        parse_mode='html')
                                    connect.commit()
                            else:
                                await message.reply(
                                    f'🛡️ <a href="tg://user?id={user_id}">{user_name}</a> Клан закрыт',
                                    parse_mode='html')
                        else:
                            await message.reply(f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>такого  клана не существует',
                                                parse_mode='html')
                    else:
                        await message.reply(f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>вы уже в клане',
                                            parse_mode='html')
                if message.text.lower() in ["Клан покинуть", "клан покинуть"]:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    data_с = await get_clan(message.from_user.id)
                    if data_с != None:
                        status = cursor.execute("SELECT status FROM clan WHERE user_id=?", (user_id,))
                        status = cursor.fetchone()
                        status = status[0]
                        if status=="SOZD":

                            clan_id = cursor.execute(f"SELECT clan_id FROM clan WHERE user_id=?", (message.from_user.id,))
                            clan_id = cursor.fetchone()
                            clan_id =clan_id[0]
                            member = cursor.execute(f"SELECT members FROM clans WHERE clan_id=?", (clan_id,))
                            member = cursor.fetchone()
                            member = int(member[0])

                            cursor.execute(
                                f"UPDATE clans SET members={member - 1} WHERE clan_id=?", (clan_id,))

                            cursor.execute("DELETE FROM clan WHERE user_id= ?", (message.from_user.id,))
                            connect.commit()

                            member = cursor.execute(f"SELECT members FROM clans WHERE clan_id=?", (clan_id,))
                            member = cursor.fetchone()
                            member = int(member[0])
                            if member >0:
                                user_ids = cursor.execute("SELECT user_id FROM clan WHERE clan_id=?", (clan_id,))
                                user_ids = cursor.fetchall()
                                list = []

                                for user in user_ids:
                                    list.append(f"{user[0]}")

                                random_index = random.randrange(len(list))
                                new_id=list[random_index]
                                user_name_new = cursor.execute("SELECT user_name from users where user_id = ?",
                                                           (new_id,))
                                user_name_new  = cursor.fetchone()
                                user_name_new  = user_name_new [0]
                                cursor.execute(f"UPDATE clan SET status='SOZD' WHERE user_id={new_id} and clan_id={clan_id}")
                                await message.reply(f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> вы больше не состоите в клане \n🆕 Новый глава клана:  <a href="tg://user?id={new_id}">{user_name_new}</a>({new_id}) ',
                                                    parse_mode='html')
                                connect.commit()

                            if member==0:
                                await message.reply(
                                    f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> вы больше не состоите в клане ',
                                    parse_mode='html')
                        else:
                            clan_id = cursor.execute(f"SELECT clan_id FROM clan WHERE user_id=?", (message.from_user.id,))
                            clan_id = cursor.fetchone()
                            clan_id = clan_id[0]
                            member = cursor.execute(f"SELECT members FROM clans WHERE clan_id=?", (clan_id,))
                            member = cursor.fetchone()
                            member = int(member[0])

                            cursor.execute(
                                f"UPDATE clans SET members={member - 1} WHERE clan_id=?", (clan_id,))

                            cursor.execute("DELETE FROM clan WHERE user_id= ?", (message.from_user.id,))
                            connect.commit()
                            await message.reply(
                                f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> вы больше не состоите в клане ',
                                parse_mode='html')

                    else:
                        await message.reply(f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> вы не состоите в клане',
                                            parse_mode='html')
                if message.text.startswith('Клан повысить'):

                    user_id = message.from_user.id
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    data_с = await get_clan(message.from_user.id)
                    if data_с != None:
                        try:
                            user_kik=message.text.split()[2]
                            if user_kik.isdigit():
                                pass
                            else:
                                await message.reply('‼️ Не хватает аргументов!\nПример: Клан повысить id ')
                                return
                        except:
                            await message.reply( '‼️ Не хватает аргументов!\nПример: Клан повысить id ')
                            return

                        cursor.execute("SELECT * FROM clan WHERE user_id=?", (user_kik,))
                        if cursor.fetchone() != None:
                            status=cursor.execute("SELECT status FROM clan WHERE user_id=?", (user_id,))
                            status=cursor.fetchone()
                            status=status[0]
                            ruser_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                                       (user_kik,))
                            ruser_name = cursor.fetchone()
                            ruser_name = ruser_name[0]
                            if status=="SOZD":
                                clan_id = cursor.execute(f"SELECT clan_id FROM clan WHERE user_id=?", (user_kik,))
                                clan_id = cursor.fetchone()
                                clan_id =clan_id[0]
                                clan_id1 = cursor.execute(f"SELECT clan_id FROM clan WHERE user_id=?", (user_id,))
                                clan_id1 = cursor.fetchone()
                                clan_id1 = clan_id1[0]
                                if clan_id1==clan_id:
                                    cursor.execute(f"UPDATE clan SET status='soryk' WHERE user_id=?", (user_kik,))
                                    await message.reply(
                                        f'⏫️  <a href="tg://user?id={user_id}">{user_name}</a> ,вы повысили статус игрока(<a href="tg://user?id={user_kik}">{ruser_name}</a>) до суроководителя !\n'
                                        f'🛑 Будьте осторожны повышая ранг игрокам они могут управлять вашим кланом !',
                                        parse_mode='html')
                                else:
                                    await message.reply(
                                        f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> игрок не состоит в вашем клане',
                                        parse_mode='html')
                            else:
                                await message.reply(
                                    f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> Вы не создатель клана',
                                    parse_mode='html')
                        else:
                            await message.reply(f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> игрок не состоит в клане',
                                                parse_mode='html')
                    else:
                        await message.reply(f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> вы не состоите в клане',
                                            parse_mode='html')
                if message.text.startswith('Клан понизить'):

                    user_id = message.from_user.id
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    data_с = await get_clan(message.from_user.id)
                    if data_с != None:
                        try:
                            user_kik = message.text.split()[2]
                            if user_kik.isdigit():
                                pass
                            else:
                                await message.reply('‼️ Не хватает аргументов!\nПример: Клан понизить id ')
                                return
                        except:
                            await message.reply('‼️ Не хватает аргументов!\nПример: Клан понизить id ')
                            return

                        cursor.execute("SELECT * FROM clan WHERE user_id=?", (user_kik,))
                        if cursor.fetchone() != None:
                            status=cursor.execute("SELECT status FROM clan WHERE user_id=?", (user_id,))
                            status=cursor.fetchone()
                            status=status[0]
                            ruser_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                                       (user_kik,))
                            ruser_name = cursor.fetchone()
                            ruser_name = ruser_name[0]
                            if status=="SOZD":
                                clan_id = cursor.execute(f"SELECT clan_id FROM clan WHERE user_id=?", (user_kik,))
                                clan_id = cursor.fetchone()
                                clan_id =clan_id[0]
                                clan_id1 = cursor.execute(f"SELECT clan_id FROM clan WHERE user_id=?", (user_id,))
                                clan_id1 = cursor.fetchone()
                                clan_id1 = clan_id1[0]
                                if clan_id1==clan_id:
                                    cursor.execute(f"UPDATE clan SET status='soryk' WHERE user_id=?", (user_kik,))
                                    await message.reply(
                                        f'⏬️  <a href="tg://user?id={user_id}">{user_name}</a> ,вы понизили статус игрока(<a href="tg://user?id={user_kik}">{ruser_name}</a>) до участника !', parse_mode='html')
                                else:
                                    await message.reply(
                                        f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> игрок не состоит в вашем клане',
                                        parse_mode='html')
                            else:
                                await message.reply(
                                    f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> Вы не создатель клана',
                                    parse_mode='html')
                        else:
                            await message.reply(f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> игрок не состоит в клане',
                                                parse_mode='html')
                    else:
                        await message.reply(f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> вы не состоите в клане',
                                            parse_mode='html')

                if message.text.startswith('Клан кик'):

                    user_id = message.from_user.id
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    data_с = await get_clan(message.from_user.id)
                    if data_с != None:
                        try:
                            user_kik = message.text.split()[2]
                            if user_kik.isdigit():
                                pass
                            else:
                                await message.reply('‼️ Не хватает аргументов!\nПример: Клан кик id ')
                                return
                        except:
                            await message.reply('‼️ Не хватает аргументов!\nПример: Клан кик id ')
                            return

                        cursor.execute("SELECT * FROM clan WHERE user_id=?", (user_kik,))
                        if cursor.fetchone() != None:
                            status=cursor.execute("SELECT status FROM clan WHERE user_id=?", (user_id,))
                            status=cursor.fetchone()
                            status=status[0]
                            if status=="SOZD" or status=="soryk":
                                clan_id = cursor.execute(f"SELECT clan_id FROM clan WHERE user_id=?", (user_kik,))
                                clan_id = cursor.fetchone()
                                clan_id =clan_id[0]
                                clan_id1 = cursor.execute(f"SELECT clan_id FROM clan WHERE user_id=?", (user_id,))
                                clan_id1 = cursor.fetchone()
                                clan_id1 = clan_id1[0]
                                if clan_id1==clan_id:
                                    rstatus = cursor.execute("SELECT status FROM clan WHERE user_id=?", (user_kik,))
                                    rstatus = cursor.fetchone()
                                    rstatus = rstatus[0]
                                    if rstatus!="SOZD":
                                        ruser_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                                                   (user_kik,))
                                        ruser_name = cursor.fetchone()
                                        ruser_name = ruser_name[0]

                                        member = cursor.execute(f"SELECT members FROM clans WHERE clan_id=?", (clan_id,))
                                        member = cursor.fetchone()
                                        member = int(member[0])
                                        cursor.execute(
                                            f"UPDATE clans SET members={member - 1} WHERE clan_id=?", (clan_id,))

                                        cursor.execute("DELETE FROM clan WHERE user_id= ?", (user_kik,))
                                        connect.commit()
                                        await message.reply(f'⛔️ <a href="tg://user?id={user_id}">{user_name}</a> вы кикнули из клана игрока  <a href="tg://user?id={user_kik}">{ruser_name}</a>',
                                                            parse_mode='html')
                                    else:
                                        await message.reply(
                                            f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> вы не можете кикнуть создателя',
                                            parse_mode='html')
                                else:
                                    await message.reply(
                                        f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> игрок не состоит в вашем клане',
                                        parse_mode='html')
                            else:
                                await message.reply(
                                    f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> выгонять из клана может только админы клана',
                                    parse_mode='html')
                        else:
                            await message.reply(f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> игрок не состоит в клане',
                                                parse_mode='html')
                    else:
                        await message.reply(f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> вы не состоите в клане',
                                            parse_mode='html')
                if message.text.startswith('Клан атака'):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    data_с = await get_clan(message.from_user.id)
                    if data_с != None:
                        clan_id1 = cursor.execute(f"SELECT clan_id FROM clan WHERE user_id=?", (user_id,))
                        clan_id1 = cursor.fetchone()
                        clan_id1 = clan_id1[0]
                        status = cursor.execute("SELECT status FROM clan WHERE user_id=?", (user_id,))
                        status = cursor.fetchone()
                        status = status[0]

                        if status == "SOZD" or status == "soryk":
                            try:
                                id_clan = message.text.split()[2]
                                if id_clan.isdigit():
                                    pass
                                else:
                                    await message.reply('‼️ Не хватает аргументов!\nПример:клан атака id ')
                                    return
                            except:
                                await message.reply('‼️ Не хватает аргументов!\nПример: Клан атака (id) ')
                                return
                            cursor.execute(f"SELECT clan_id FROM clans WHERE clan_id =?", (id_clan,))
                            if cursor.fetchone() != None:
                                if clan_id1 != id_clan:
                                    period=1
                                    get = cursor.execute(
                                        "SELECT last_stavka FROM clans WHERE clan_id = ?", (clan_id1,))
                                    get = cursor.fetchone()
                                    get=int(get[0])
                                    if get == period:
                                        win = cursor.execute(f"SELECT win FROM clans WHERE clan_id=?", (clan_id1,))
                                        win = cursor.fetchone()
                                        win = int(win[0])
                                        lose = cursor.execute(f"SELECT lose FROM clans WHERE clan_id=?", (clan_id1,))
                                        lose = cursor.fetchone()
                                        lose = int(lose[0])
                                        win2 = cursor.execute(f"SELECT win FROM clans WHERE clan_id=?", (id_clan,))
                                        win2 = cursor.fetchone()
                                        win2 = int(win2[0])
                                        lose2 = cursor.execute(f"SELECT lose FROM clans WHERE clan_id=?", (id_clan,))
                                        lose2 = cursor.fetchone()
                                        lose2 = int(lose2[0])
                                        power = cursor.execute(f"SELECT power FROM clans WHERE clan_id=?", (clan_id1,))
                                        power = cursor.fetchone()
                                        power = int(power[0])
                                        power2 = cursor.execute(f"SELECT power FROM clans WHERE clan_id=?", (id_clan,))
                                        power2 = cursor.fetchone()
                                        power2 = int(power2[0])
                                        clan_name=cursor.execute(f"SELECT clan_name FROM clans WHERE clan_id=?", (id_clan,))
                                        clan_name = cursor.fetchone()
                                        clan_name=clan_name[0]
                                        if power2>power:
                                            cursor.execute(f"UPDATE clans SET power={power2-power} WHERE clan_id=?", (id_clan,))
                                            cursor.execute(f"UPDATE clans SET win={win2 + 1} WHERE clan_id=?", (id_clan,))
                                            cursor.execute(f"UPDATE clans SET lose={lose + 1} WHERE clan_id=?", (clan_id1,))
                                            cursor.execute(
                                                f'UPDATE clans SET last_stavka={0} WHERE clan_id=?', (clan_id1,))
                                            connect.commit()
                                            await message.reply(
f"""
‼️ <a href="tg://user?id={user_id}">{user_name}</a> ⚔️Вы атакавали клан {clan_name}
📋Результат:
 💀 К сожелению вражеский клан оказался сильнее """, parse_mode='html')

                                        elif power2<power:
                                            cursor.execute(f"UPDATE clans SET power={power - power2} WHERE clan_id=?", (clan_id1,))
                                            cursor.execute(f"UPDATE clans SET win={win + 1} WHERE clan_id=?", (clan_id1,))
                                            cursor.execute(f"UPDATE clans SET lose={lose2 + 1} WHERE clan_id=?", (id_clan,))
                                            cursor.execute(
                                                f'UPDATE clans SET last_stavka={0} WHERE clan_id=?', (clan_id1,))
                                            connect.commit()
                                            await message.reply(
f"""
‼️ <a href="tg://user?id={user_id}">{user_name}</a> ⚔️Вы атакавали клан {clan_name}
📋Результат:
 🏅 Поздравляю с победой над кланом {clan_name}""",
                                        parse_mode='html')
                                        else:
                                            cursor.execute(f"UPDATE clans SET power={0} WHERE clan_id=?", (clan_id1,))
                                            cursor.execute(f"UPDATE clans SET power={0} WHERE clan_id=?", (id_clan,))
                                            cursor.execute(f"UPDATE clans SET lose={lose2 + 1} WHERE clan_id=?", (clan_id1,))
                                            cursor.execute(f"UPDATE clans SET lose={lose + 1} WHERE clan_id=?", (id_clan,))
                                            cursor.execute(
                                                f'UPDATE clans SET last_stavka={0} WHERE clan_id=?', (clan_id1,))
                                            connect.commit()
                                            await message.reply(
                f"""
‼️ <a href="tg://user?id={user_id}">{user_name}</a> ⚔️Вы атакавали клан {clan_name}
📋Результат:
💀 Оба кланы потерпели поражения """,
                                            parse_mode='html')
                                    else:
                                        await message.reply(
                                            f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> атаковывать кланы можно раз в 12ч',
                                            parse_mode='html')
                                else:
                                    await message.reply(
                                        f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> вы не можете атаковать свой клан',
                                        parse_mode='html')
                            else:
                                await message.reply(
                                    f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> такого клана не существует',
                                    parse_mode='html')
                        else:
                            await message.reply(
                                f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> атаковать кланы может только создатель клана',
                                        parse_mode='html')
                    else:
                        await message.reply(
                            f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> вы не состоите в клане',
                            parse_mode='html')
                if message.text.startswith('Клан усилить') or message.text.startswith('клан усилить'):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    data_с = await get_clan(message.from_user.id)
                    if data_с != None:
                        clan_id1 = cursor.execute(f"SELECT clan_id FROM clan WHERE user_id=?", (user_id,))
                        clan_id1 = cursor.fetchone()
                        clan_id1 = clan_id1[0]
                        status = cursor.execute("SELECT status FROM clan WHERE user_id=?", (user_id,))
                        status = cursor.fetchone()
                        status = status[0]
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])
                        power=cursor.execute(f"SELECT power FROM clans WHERE clan_id=?", (clan_id1,))
                        power = cursor.fetchone()
                        power = int(power[0])
                        if status=="SOZD" or status=="soryk":
                            try:
                                summ = int(message.text.split()[2])
                            except:
                                await message.reply('‼️ Не хватает аргументов!\nПример: Клан усилить (число) ')
                                return
                            if summ>0:
                                if balance>=summ*100_000_000_000_00:
                                    summ3 = '{:,}'.format(summ).replace(',', '.')
                                    cursor.execute(f"UPDATE users SET balance={balance-summ*100_000_000_000_00} WHERE user_id={user_id}")
                                    cursor.execute(f"UPDATE clans SET power={power+summ} WHERE clan_id={clan_id1}")
                                    await message.reply(
                                        f'💰 <a href="tg://user?id={user_id}">{user_name}</a> Вы успешно усилили клан на: {summ3} 💪',
                                        parse_mode='html')
                                else:
                                    await message.reply(
                                        f'💰 ️<a href="tg://user?id={user_id}">{user_name}</a> недостаточно средств - 10.000.000.000.000',
                                        parse_mode='html')
                            else:
                                await message.reply(
                                    f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> нельзя вводить отрицательные числа',
                                    parse_mode='html')

                        else:
                            await message.reply(
                                f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> усилить клан может только админ клана',
                                        parse_mode='html')
                    else:
                        await message.reply(
                                    f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> вы не состоите в клане',
                                    parse_mode='html')
                if message.text.startswith('Казна снять') or message.text.startswith('казна снять'):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])
                    clan_id1 = cursor.execute(f"SELECT clan_id FROM clan WHERE user_id=?", (user_id,))
                    clan_id1 = cursor.fetchone()
                    clan_id1 = clan_id1[0]
                    kazna = cursor.execute(f"SELECT kazna FROM clans WHERE clan_id=?", (clan_id1,))
                    kazna = cursor.fetchone()
                    kazna = int(kazna[0])
                    data_с = await get_clan(message.from_user.id)
                    if data_с != None:
                        try:
                            su = msg.text.split()[2]
                            su2 = (su).replace('к', '000')
                            su3 = (su2).replace('м', '000000')
                            su4 = (su3).replace('.', '')
                            su5 = float(su4)
                            summ = int(su5)

                        except:
                            await message.reply( '‼️ Не хватает аргументов!\nПример: Казна снять сумма ')
                            return
                        if summ>0:
                            if kazna>=summ:
                                status = cursor.execute("SELECT status FROM clan WHERE user_id=? and clan_id=?",
                                                        (user_id, clan_id1,))
                                status = cursor.fetchone()
                                status = status[0]
                                if status == "SOZD" or status=="soryk":
                                    summ3 = '{:,}'.format(summ).replace(',', '.')
                                    cursor.execute(f"UPDATE users SET balance={balance + summ} WHERE user_id=?",
                                                   (message.from_user.id,))
                                    cursor.execute(f"UPDATE clans SET kazna={kazna - summ} WHERE clan_id=?", (clan_id1,))
                                    await message.reply(
                                        f'💰 ️ <a href="tg://user?id={user_id}">{user_name}</a> Вы сняли с казны сумму: {summ3} ₸',
                                        parse_mode='html')
                                    connect.commit()
                                else:
                                    await message.reply(
                                        f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> снимать деньги с казны может только админ клана',
                                        parse_mode='html')
                            else:
                                await message.reply(
                                    f'💰 ️<a href="tg://user?id={user_id}">{user_name}</a> недостаточно средств',
                                    parse_mode='html')
                        else:
                            await message.reply(
                                f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> нельзя снять отрицательные числа',
                                parse_mode='html')
                    else:
                        await message.reply(f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> вы не состоите в клане',
                                            parse_mode='html')
                if message.text.startswith('Казна пополнить') or message.text.startswith('казна пополнить'):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])
                    clan_id1 = cursor.execute(f"SELECT clan_id FROM clan WHERE user_id=?", (user_id,))
                    clan_id1 = cursor.fetchone()
                    clan_id1 = clan_id1[0]
                    kazna = cursor.execute(f"SELECT kazna FROM clans WHERE clan_id=?", (clan_id1,))
                    kazna = cursor.fetchone()
                    kazna = int(kazna[0])
                    data_с = await get_clan(message.from_user.id)
                    if data_с != None:
                        try:
                            su = msg.text.split()[2]
                            su2 = (su).replace('к', '000')
                            su3 = (su2).replace('м', '000000')
                            su4 = (su3).replace('.', '')
                            su5 = float(su4)
                            summ = int(su5)

                        except :
                            await message.reply( '‼️ Не хватает аргументов!\nПример: Казна пополнить сумма ')
                            return
                        if summ>0:
                            if balance >=summ:
                                summ3 = '{:,}'.format(summ).replace(',', '.')
                                cursor.execute(f"UPDATE users SET balance={balance - summ} WHERE user_id=?",(message.from_user.id,))
                                cursor.execute(f"UPDATE clans SET kazna={kazna + summ} WHERE clan_id=?",(clan_id1,))
                                await message.reply(
                                    f'💰 <a href="tg://user?id={user_id}">{user_name}</a> Вы пополнили казну клана на сумму: {summ3} ₸',
                                    parse_mode='html')
                                connect.commit()

                            else:
                                await message.reply(
                                    f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> недостаточно средств',
                                    parse_mode='html')
                        else:
                            await message.reply(f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> нельзя пополнить отрицательные числа',
                                                parse_mode='html')
                    else:
                        await message.reply(f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> вы не состоите в клане',
                                            parse_mode='html')
                if message.text.lower() in ["клан приватность"]:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    data_с = await get_clan(message.from_user.id)
                    if data_с != None:
                        clan_id = cursor.execute(f"SELECT clan_id FROM clan WHERE user_id=?", (message.from_user.id,))
                        clan_id = cursor.fetchone()
                        clan_id = clan_id[0]
                        type_clan = cursor.execute(f"SELECT type_clan FROM clans WHERE clan_id=?", (clan_id,))
                        type_clan = cursor.fetchone()
                        type_clan = int(type_clan[0])
                        status = cursor.execute("SELECT status FROM clan WHERE user_id=? and clan_id=?", (user_id,clan_id,))
                        status = cursor.fetchone()
                        status = status[0]
                        if status=="SOZD":
                            if type_clan==1:
                                cursor.execute(f"UPDATE clans SET type_clan=0 WHERE clan_id=?", (clan_id,))
                                await message.reply(
                                    f'🔒️ <a href="tg://user?id={user_id}">{user_name}</a> вы закрыли клан',
                                    parse_mode='html')
                                connect.commit()
                            if type_clan==0:
                                cursor.execute(f"UPDATE clans SET type_clan=1 WHERE clan_id=?", (clan_id,))
                                await message.reply(
                                    f'🔓️ <a href="tg://user?id={user_id}">{user_name}</a> вы открыли клан',
                                    parse_mode='html')
                                connect.commit()
                        else:
                            await message.reply(f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> приватность менять может только создатель',
                                                parse_mode='html')
                    else:
                        await message.reply(f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> вы не состоите в клане',
                                            parse_mode='html')
                if message.text.lower() in ["мой клан", "клан"]:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    data_с = await get_clan(message.from_user.id)
                    if data_с != None:
                        clan_id = cursor.execute(f"SELECT clan_id FROM clan WHERE user_id=?", (message.from_user.id,))
                        clan_id = cursor.fetchone()
                        clan_id = clan_id[0]
                        name = cursor.execute(f"SELECT clan_name FROM clans WHERE clan_id=?", (clan_id,))
                        name = cursor.fetchone()
                        name = name[0]
                        member = cursor.execute(f"SELECT members FROM clans WHERE clan_id=?", (clan_id,))
                        member = cursor.fetchone()
                        member = int(member[0])
                        kazna = cursor.execute(f"SELECT kazna FROM clans WHERE clan_id=?", (clan_id,))
                        kazna = cursor.fetchone()
                        kazna = int(kazna[0])
                        type_clan = cursor.execute(f"SELECT type_clan FROM clans WHERE clan_id=?", (clan_id,))
                        type_clan = cursor.fetchone()
                        type_clan = int(type_clan[0])
                        power=cursor.execute(f"SELECT power FROM clans WHERE clan_id=?", (clan_id,))
                        power = cursor.fetchone()
                        power = int(power[0])
                        win = cursor.execute(f"SELECT win FROM clans WHERE clan_id=?", (clan_id,))
                        win = cursor.fetchone()
                        win = int(win[0])
                        lose = cursor.execute(f"SELECT lose FROM clans WHERE clan_id=?", (clan_id,))
                        lose = cursor.fetchone()
                        lose = int(lose[0])
                        status = cursor.execute("SELECT status FROM clan WHERE user_id=? and clan_id=?",
                                                (user_id, clan_id,))
                        status = cursor.fetchone()
                        status = status[0]
                        if status=="SOZD":
                            rang='👑 Владелец клана'
                        if status=="member":
                            rang='👤 участник '
                        if status=="soryk":
                            rang='👮 Соруководитель '
                        if type_clan==1:
                            type=' 🔓 Открытый'
                        if type_clan == 0:
                            type = '🔒 Закрытый'
                        power2 = '{:,}'.format(power).replace(',', '.')
                        win2 = '{:,}'.format(win).replace(',', '.')
                        lose2 = '{:,}'.format(lose).replace(',', '.')
                        summ3 = '{:,}'.format(kazna).replace(',', '.')
                        sozd=cursor.execute(f"SELECT user_name FROM clan WHERE status='SOZD' and clan_id=?", (clan_id,))
                        sozd = cursor.fetchone()
                        sozd = sozd[0]
                        await bot.send_message(message.chat.id,f"""
☑️ Название клана: {name}
🤴 Создатель клана: {sozd}
🔶 Ранг в клане: {rang}
🆔 Айди клана: {clan_id}
⚔️ Тип клана: {type}
👥 Участников: {member}
💸 Казна клана: {summ3} ₸

💪 Мощь : {power2}
🏆 Побед: {win2}
💀 Поражений: {lose2}

‼️ Для просмотра всех участников введите: Клан участники
""",
                                           parse_mode='html')
                    else:
                        await message.reply(f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> вы не состоите в клане',
                                            parse_mode='html')
                if message.text.lower() in ["клан участники","клан игроки"]:
                    data_с = await get_clan(message.from_user.id)
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    if data_с != None:
                        clan_id = cursor.execute(f"SELECT clan_id FROM clan WHERE user_id=?", (message.from_user.id,))
                        clan_id = cursor.fetchone()
                        clan_id = clan_id[0]
                        user_names = cursor.execute("SELECT * FROM clan WHERE clan_id=?", (clan_id,))
                        user_names = cursor.fetchall()
                        list = []
                        list2=[]
                        list3 = []
                        for user in user_names:
                            if user[2]=="SOZD":
                                list2.append(
                                    f"[👑]<i>{user[1]}</i>   | 🔍ID: <code>{user[0]}</code> ")
                            elif user[2]=="soryk":
                                list3.append(
                                    f"[👮]<i>{user[1]}</i>   | 🔍ID: <code>{user[0]}</code> ")
                            else:
                                list.append(
                                f"[👤]<i>{user[1]}</i>   | 🔍ID: <code>{user[0]}</code> ")

                        top = "\n".join(list)
                        topa = "\n".join(list2)
                        tops = "\n".join(list3)
                        await message.reply(f'<a href="tg://user?id={user_id}">{user_name}</a> 👥 Участники :\n'+topa+"➖➖➖➖➖➖➖➖➖➖\n"+tops+"➖➖➖➖➖➖➖➖➖➖\n"+top,
                                            parse_mode='html')
                    else:
                        await message.reply(f'‼️ <a href="tg://user?id={user_id}">{user_name}</a> вы не состоите в клане',
                                            parse_mode='html')
                if message.text.lower() in ["обнулить", "Обнулить"] and message.reply_to_message:
                    msg = message
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    reply_user_id = msg.reply_to_message.from_user.id
                    user_id = msg.from_user.id
                    user_status = cursor.execute("SELECT user_status from users where user_id = ?",
                                                 (message.from_user.id,))
                    user_status = cursor.fetchone()
                    if user_status[0] == 'Player' or user_status[0] == 'vip' or user_status[0] == 'premium' or user_status[0] == 'delux':
                        await message.reply(
                            f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>, Доступ к данной команде ограничен. Для покупки администратора обратитесь к создателю 👨‍🦰',
                            parse_mode='html')
                    else:
                        await message.reply(
                            f'💵 | Вы успешно обнулили игрока <a href="tg://user?id={user_id}">{user_name}</a> {rwin}',
                            parse_mode='html')
                        cursor.execute(
                            f'UPDATE users SET balance = 0 WHERE user_id = {reply_user_id}')
                        cursor.execute(
                            f'UPDATE users SET bank = 0 WHERE user_id = {reply_user_id}')
                        cursor.execute(
                            f'UPDATE users SET rating = 0 WHERE user_id = {reply_user_id}')
                        cursor.execute(
                            f'UPDATE users SET fantom = 0 WHERE user_id = {reply_user_id}')
                        connect.commit()
                ########################################################ФЕРМА##########################################################
                if message.text.startswith("Купить ферму 4")or message.text.startswith("купить ферму 4"):
                    msg = message
                    user_name = message.from_user.get_mention(as_html=True)
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    user_id = msg.from_user.id
                    rwin = random.choice(win)
                    user_name = cursor.execute(
                        "SELECT user_name from users where user_id = ?", (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = str(user_name[0])
                    Farm = cursor.execute(
                        "SELECT Farm2 from ferma where user_id = ?", (message.from_user.id,))
                    Farm = cursor.fetchone()
                    Farm = str(Farm[0])
                    cripto = cursor.execute(
                        "SELECT ecoins from users where user_id = ?", (message.from_user.id,))
                    cripto = cursor.fetchone()
                    cripto = int(cripto[0])

                    if int(cripto) >= 30:
                        await bot.send_message(message.chat.id,
                                               f'{user_name}, вы успешно купили майнинг ферму NVIDIA GeForce RTX 4100 Limited Edition  {rwin} ',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE ferma SET Farm2 = 1 WHERE user_id = {user_id}")
                        cursor.execute(
                            f'UPDATE users SET ecoins = {cripto - 30} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE ferma SET cards2 = 10 WHERE user_id = {user_id}')
                        connect.commit()
                    if int(cripto) < 30:
                        await bot.send_message(message.chat.id, f'{user_name}, у вас не достаточно средств! {rloser} ',
                                               parse_mode='html')
                if message.text.startswith("Купить ферму 3")or message.text.startswith("купить ферму 3"):
                    msg = message
                    user_name = message.from_user.get_mention(as_html=True)
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    user_id = msg.from_user.id
                    rwin = random.choice(win)
                    user_name = cursor.execute(
                        "SELECT user_name from users where user_id = ?", (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = str(user_name[0])
                    Farm = cursor.execute(
                        "SELECT Farm from ferma where user_id = ?", (message.from_user.id,))
                    Farm = cursor.fetchone()
                    Farm = str(Farm[0])
                    cripto = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    cripto = cursor.fetchone()
                    cripto = int(cripto[0])

                    if int(cripto) >= 100000000000:
                        await bot.send_message(message.chat.id,
                                               f'{user_name}, вы успешно купили майнинг ферму NVIDIA GeForce RTX 4100 📡  {rwin} ',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE ferma SET Farm = 3 WHERE user_id = {user_id}")
                        cursor.execute(
                            f'UPDATE users SET balance = {cripto - 100000000000} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE ferma SET cards = 1 WHERE user_id = {user_id}')
                        connect.commit()
                    if int(cripto) < 100000000000:
                        await bot.send_message(message.chat.id, f'{user_name}, у вас не достаточно средств! {rloser} ',
                                               parse_mode='html')

                if message.text.startswith("Купить ферму 2")or message.text.startswith("купить ферму 2"):
                    msg = message
                    user_name = message.from_user.get_mention(as_html=True)
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    user_id = msg.from_user.id
                    rwin = random.choice(win)
                    user_name = cursor.execute(
                        "SELECT user_name from users where user_id = ?", (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = str(user_name[0])
                    Farm = cursor.execute(
                        "SELECT Farm from ferma where user_id = ?", (message.from_user.id,))
                    Farm = cursor.fetchone()
                    Farm = str(Farm[0])
                    Farm = cursor.fetchone()
                    cripto = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    cripto = cursor.fetchone()
                    cripto = int(cripto[0])

                    if int(cripto) >= 20000000000:
                        await bot.send_message(message.chat.id,
                                               f'{user_name}, вы успешно купили майнинг ферму NVIDIA GeForce RTX 3100 🛢  {rwin} ',
                                               parse_mode='html')
                        cursor.execute(
                            f'UPDATE ferma SET Farm = 2 WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE users SET balance = {cripto - 20000000000} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE ferma SET cards = 1 WHERE user_id = {user_id}')
                        connect.commit()
                    if int(cripto) < 20000000000:
                        await bot.send_message(message.chat.id, f'{user_name}, у вас не достаточно средств! {rloser} ',
                                               parse_mode='html')

                if message.text.startswith("Купить ферму 1")or message.text.startswith("купить ферму 1"):
                    msg = message
                    user_name = message.from_user.get_mention(as_html=True)
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    user_id = msg.from_user.id
                    rwin = random.choice(win)
                    user_name = cursor.execute(
                        "SELECT user_name FROM users WHERE user_id = ?", (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = str(user_name[0])
                    Farm = cursor.execute(
                        "SELECT Farm FROM ferma WHERE user_id = ?", (message.from_user.id,))
                    Farm = cursor.fetchone()
                    Farm = str(Farm[0])
                    cripto = cursor.execute(
                        "SELECT balance FROM users WHERE user_id = ?", (message.from_user.id,))
                    cripto = cursor.fetchone()
                    cripto = int(cripto[0])

                    if int(cripto) >= 1000000000:
                        await bot.send_message(message.chat.id,
                                               f'{user_name}, вы успешно купили майнинг ферму NVIDIA GeForce GTX 1650 🔋  {rwin} ',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE ferma SET Farm = 1 WHERE user_id = {user_id}")
                        cursor.execute(
                            f'UPDATE users SET balance = {cripto - 1000000000} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE ferma SET cards = 1 WHERE user_id = {user_id}')
                        connect.commit()
                    if int(cripto) < 1000000000:
                        await bot.send_message(message.chat.id, f'{user_name}, у вас не достаточно средств! {rloser} ',
                                               parse_mode='html')
                if message.text.startswith("Продать ферму")or message.text.startswith("продать ферму"):
                    msg = message
                    user_name = message.from_user.get_mention(as_html=True)
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    user_id = msg.from_user.id
                    rwin = random.choice(win)
                    user_name = cursor.execute(
                        "SELECT user_name FROM users WHERE user_id = ?", (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = str(user_name[0])
                    Farm = cursor.execute(
                        "SELECT Farm FROM ferma WHERE user_id = ?", (message.from_user.id,))
                    Farm = cursor.fetchone()

                    cripto = cursor.execute(
                        "SELECT balance FROM users WHERE user_id = ?", (message.from_user.id,))
                    cripto = cursor.fetchone()
                    cripto = int(cripto[0])

                    if Farm[0] == 1:
                        await bot.send_message(message.chat.id,
                                               f'{user_name}, вы успешно продали майнинг ферму NVIDIA GeForce GTX 1650 🔋  {rwin} ',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE ferma SET Farm = 0 WHERE user_id = {user_id}")
                        cursor.execute(
                            f'UPDATE users SET balance = {cripto + 1000000000} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE ferma SET cards = 0 WHERE user_id = {user_id}')
                        connect.commit()
                    if Farm[0] == 2:
                        await bot.send_message(message.chat.id,
                                               f'{user_name}, вы успешно продали майнинг ферму NVIDIA GeForce RTX 3100 🔋  {rwin} ',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE ferma SET Farm = 0 WHERE user_id = {user_id}")
                        cursor.execute(
                            f'UPDATE users SET balance = {cripto + 20000000000} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE ferma SET cards = 0 WHERE user_id = {user_id}')
                        connect.commit()
                    if Farm[0] == 3:
                        await bot.send_message(message.chat.id,
                                               f'{user_name}, вы успешно продали майнинг ферму NVIDIA GeForce RTX 4100 🔋  {rwin} ',
                                               parse_mode='html')
                        cursor.execute(
                            f"UPDATE ferma SET Farm = 0 WHERE user_id = {user_id}")
                        cursor.execute(
                            f'UPDATE users SET balance = {cripto + 100000000000} WHERE user_id = {user_id}')
                        cursor.execute(
                            f'UPDATE ferma SET cards = 0 WHERE user_id = {user_id}')
                        connect.commit()

                    else:
                        await bot.send_message(message.chat.id, f'{user_name}, у вас нету фермы! {rloser} ',
                                               parse_mode='html'
                                               )

                if message.text.startswith("Ферма снять")or message.text.startswith("ферма снять"):

                    msg = message
                    user_id = msg.from_user.id
                    user_name = message.from_user.get_mention(as_html=True)
                    chat_id = message.chat.id
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    user_name = cursor.execute(
                        "SELECT user_name from users where user_id = ?", (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = str(user_name[0])
                    cripto = cursor.execute(
                        "SELECT fantom from users where user_id = ?", (message.from_user.id,))
                    cripto = cursor.fetchone()
                    cripto = int(cripto[0])
                    balance = cursor.execute(
                        "SELECT ferma_money from ferma where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])
                    balance2 = '{:,}'.format(balance).replace(",", ".")
                    event_febiz = cursor.execute(
                        "SELECT event_febiz from clans_id ")
                    event_febiz = cursor.fetchone()
                    event_febiz = int(event_febiz[0])
                    if event_febiz==0:
                        if int(balance) > 0:
                            await bot.send_message(message.chat.id,
                                                   f'‼️ {user_name}, вы успешно сняли с Баланса Майнинг-Фермы {balance2}💠 на свой баланс {rwin}',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET fantom = {cripto + balance} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE ferma SET ferma_money = {balance - balance} WHERE user_id = {user_id}')
                            connect.commit()
                        else:
                            await bot.send_message(message.chat.id, f'{user_name}, на балансе фермы пусто! {rloser}',
                                                   parse_mode='html')
                    if event_febiz == 1:
                        if int(balance) > 0:
                            balance2 = '{:,}'.format(balance * 2).replace(",", ".")
                            await bot.send_message(message.chat.id,
                                                   f'‼️ {user_name}, вы успешно сняли с Баланса Майнинг-Фермы \nДействует ивент х2 {balance2}💠 на свой баланс {rwin}',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET fantom = {cripto + (balance * 2)} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE ferma SET ferma_money = {balance - balance} WHERE user_id = {user_id}')
                            connect.commit()
                        else:
                            await bot.send_message(message.chat.id, f'{user_name}, на балансе фермы пусто! {rloser}',
                                                   parse_mode='html')
                if message.text.startswith("Ферма видеокарты")or message.text.startswith("ферма видеокарты"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    inp_str = message.text
                    if message.text != 'Ферма видеокарты':
                        message = message
                        chat_id = message.chat.id

                        reply = message.from_user.id
                        try:
                            summ3 = float(message.text.split()[2])
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Ферма видеокарты 1 ')
                            return

                        summ = int(summ3)
                        cards = cursor.execute(
                            "SELECT cards from ferma where user_id = ?", (message.from_user.id,))
                        cards = cursor.fetchone()
                        cards = int(cards[0])
                        cardslimit = cursor.execute(
                            "SELECT cardslimit from users where user_id = ?", (message.from_user.id,))
                        cardslimit = cursor.fetchone()
                        cardslimit = int(cardslimit[0])
                        cripto = cursor.execute(
                            "SELECT balance FROM users WHERE user_id = ?", (message.from_user.id,))
                        cripto = cursor.fetchone()
                        cripto = int(cripto[0])
                        Farm = cursor.execute(
                            "SELECT Farm from ferma where user_id = ?", (message.from_user.id,))
                        Farm = cursor.fetchone()

                        cards1 = 10000000
                        cards2 = 200000000
                        cards3 = 10000000000
                        if cards + summ <= cardslimit:

                            if Farm[0] == 3:
                                if cripto >= cards3 * summ3:
                                    await bot.send_message(message.chat.id,

                                                           f'‼️ {user_name}, вы успешно купили {summ} видеокарты '
                                                           f'на сумму {cards3 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {cripto - cards3 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE ferma SET cards = {summ + cards} WHERE user_id = {user_id}')
                                    connect.commit()
                                if cripto < cards3 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')
                            if Farm[0] == 2:
                                if cripto >= cards2 * summ:
                                    await bot.send_message(message.chat.id,
                                                           f'‼️ {user_name}, вы успешно купили {summ} видеокарты '
                                                           f'на сумму {cards2 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {cripto - cards2 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE ferma SET cards = {summ + cards} WHERE user_id = {user_id}')
                                    connect.commit()
                                if cripto < cards2 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')
                            if Farm[0] == 1:
                                if cripto >= cards1 * summ:
                                    await bot.send_message(message.chat.id,
                                                           f'‼️ {user_name}, вы успешно купили {summ} видеокарты '
                                                           f'на сумму {cards1 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {cripto - cards1 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE ferma SET cards = {summ + cards} WHERE user_id = {user_id}')
                                    connect.commit()
                                if cripto < cards1 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')
                            if Farm[0] == 0:

                                await bot.send_message(message.chat.id, f'{user_name}, у вас нету фермы! {rloser} ',
                                                           parse_mode='html'
                                                           )
                        else:
                            await bot.send_message(message.chat.id,
                                                   f'{user_name},  вы не можете купить такое количество видеокарт , оно превышает норму\n'
                                                   f'Для увеличения видеокарт введите команду донат!',
                                                   parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Ферма видеокарты [кол-во] {rloser}',
                                               parse_mode='html')
                        return
                if message.text.startswith("донат видеокарты")or message.text.startswith("Донат видеокарты"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    if message.text != 'донат видеокарта':

                        try:
                            summ3 = int(message.text.split()[2])
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: донат видеокарты 1 ')
                            return

                        summ = int(summ3)
                        cards2 = cursor.execute(
                            "SELECT cards2 from ferma where user_id = ?", (message.from_user.id,))
                        cards2 = cursor.fetchone()
                        cards2 = int(cards2[0])

                        cripto = cursor.execute(
                            "SELECT ecoins FROM users WHERE user_id = ?", (message.from_user.id,))
                        cripto = cursor.fetchone()
                        cripto = int(cripto[0])
                        Farm2 = cursor.execute(
                            "SELECT Farm2 from ferma where user_id = ?", (message.from_user.id,))
                        Farm2 = cursor.fetchone()

                        cards3 = 5


                        if Farm2[0] == 1:
                            if cripto >= cards3 * summ3:
                                await bot.send_message(message.chat.id,

                                                       f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили {summ} видеокарты '
                                                       f'на сумму {cards3 * summ} 🍭',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET ecoins = {cripto - cards3 * summ} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE ferma SET cards2 = {summ + cards2} WHERE user_id = {user_id}')
                                connect.commit()
                            if cripto < cards3 * summ:
                                await bot.send_message(message.chat.id, f'<a href="tg://user?id={user_id}">{user_name}</a>, недостаточно средств!',parse_mode='html')
                        else:
                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, У вас нет донат фермы!',
                                                   parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Ферма видеокарты [кол-во] {rloser}',
                                               parse_mode='html')
                        return
                if message.text.startswith("Продать видеокарты") or message.text.startswith("продать видеокарты"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    inp_str = message.text
                    if message.text != 'Продать видеокарты':
                        message = message
                        chat_id = message.chat.id

                        reply = message.from_user.id
                        try:
                            summ3 = float(message.text.split()[2])
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Продать видеокарты 1 ')
                            return

                        summ = int(summ3)
                        cards = cursor.execute(
                            "SELECT cards from ferma where user_id = ?", (message.from_user.id,))
                        cards = cursor.fetchone()
                        cards = int(cards[0])
                        cripto = cursor.execute(
                            "SELECT balance FROM users WHERE user_id = ?", (message.from_user.id,))
                        cripto = cursor.fetchone()
                        cripto = int(cripto[0])
                        Farm = cursor.execute(
                            "SELECT Farm from ferma where user_id = ?", (message.from_user.id,))
                        Farm = cursor.fetchone()

                        cards1 = 10000000
                        cards2 = 200000000
                        cards3 = 10000000000
                        if cards - summ <= 999:
                            if Farm[0] == 4:
                                if cards >= summ:
                                    await bot.send_message(message.chat.id,

                                                           f'‼️ {user_name}, вы успешно продали {summ} видеокарты '
                                                           f'на сумму {cards3 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {cripto + cards3 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE ferma SET cards = {cards -summ} WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно видеокарт!',
                                                           parse_mode='html')
                            if Farm[0] == 3:
                                if cards >= summ:
                                    await bot.send_message(message.chat.id,

                                                           f'‼️ {user_name}, вы успешно продали {summ} видеокарты '
                                                           f'на сумму {cards3 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {cripto + cards3 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE ferma SET cards = {cards -summ} WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно видеокарт!',
                                                           parse_mode='html')
                            if Farm[0] == 2:
                                if cards >= summ:
                                    await bot.send_message(message.chat.id,
                                                           f'‼️ {user_name}, вы успешно продали {summ} видеокарты '
                                                           f'на сумму {cards2 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {cripto + cards2 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE ferma SET cards = {cards -summ} WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно видеокарт!',
                                                           parse_mode='html')
                            if Farm[0] == 1:
                                if cards >= summ:
                                    await bot.send_message(message.chat.id,
                                                           f'‼️ {user_name}, вы успешно продали {summ} видеокарты '
                                                           f'на сумму {cards1 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {cripto + cards1 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE ferma SET cards = {cards -summ} WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно видеокарт!',
                                                           parse_mode='html')
                            if Farm[0] == 0:
                                await bot.send_message(message.chat.id, f'{user_name}, у вас нету фермы! {rloser} ',
                                                       parse_mode='html'
                                                       )
                        else:
                            await bot.send_message(message.chat.id,
                                                   f'{user_name},  вы не можете продать такое количество видеокарт , оно превышает норму!', parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Продать видеокарты [кол-во] {rloser}',
                                               parse_mode='html')
                        return

                if message.text.lower() in ['ферма','моя ферма']:

                    msg = message
                    user_name = message.from_user.get_mention(as_html=True)
                    user_name = cursor.execute(
                        "SELECT user_name from users where user_id = ?", (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = str(user_name[0])
                    Farm = cursor.execute(
                        "SELECT Farm from ferma where user_id = ?", (message.from_user.id,))
                    Farm = cursor.fetchone()
                    Farm2 = cursor.execute(
                        "SELECT Farm2 from ferma where user_id = ?", (message.from_user.id,))
                    Farm2 = cursor.fetchone()
                    text=''

                    if Farm2[0] ==0:
                        pass
                    if Farm2[0] ==1:
                        cards3 = cursor.execute(
                            "SELECT cards2 from ferma where user_id = ?", (message.from_user.id,))
                        cards3= cursor.fetchone()
                        cards3 = int(cards3[0])
                        cards22 = '{:,}'.format(cards3).replace(',', '.')
                        text=f'\n🪧️ Название фермы: 🔶️NVIDIA GeForce RTX 4100 Limited Edition \nПрибыль: {cards3 * 10000}💠/чаc\n🔋 Количество видеокарт: {cards22}\n'
                    balance = cursor.execute(
                        "SELECT ferma_money from ferma where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    cards = cursor.execute(
                        "SELECT cards from ferma where user_id = ?", (message.from_user.id,))
                    cards = cursor.fetchone()
                    cards = int(cards[0])
                    cards2 = '{:,}'.format(cards).replace(',', '.')
                    balance = int(balance[0])
                    balance2 = '{:,}'.format(balance).replace(',', '.')
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    #photo = open("assets/ferma.jpg", 'rb')
                    rloser = random.choice(loser)

                    if Farm[0] == 3:

                        await bot.send_message(message.chat.id,f'''
📇 Владелец: {user_name}
🪧️ Название фермы: NVIDIA GeForce RTX 4100
💸 Прибыль: {cards * 3000}💠/чаc
🔋 Количество видеокарт: {cards2}
{text}
💰 На счету: {balance2}💠
                       
❗️Купить видеокарты: <b>Донат видеокарты [кол-во]</b> (только для донатной фермы),
Для обычной : <b>Ферма видеокарты [кол-во]</b> ''',
                                             reply_markup=help_ferma,parse_mode='html')

                    if Farm[0] == 2:
                        await bot.send_message(message.chat.id,f'''
📇 Владелец: {user_name}
🪧️ Название фермы: NVIDIA GeForce RTX 3100
💸 Прибыль: {cards * 1000}💠/чаc
🔋 Количество видеокарт: {cards2}
{text}
💰 На счету: {balance2}💠

❗️Купить видеокарты: <b>Донат видеокарты [кол-во]</b> (только для донатной фермы),
Для обычной : <b>Ферма видеокарты [кол-во]</b>''',
                                             reply_markup=help_ferma,parse_mode='html')

                    if Farm[0] == 1:
                        await bot.send_message(message.chat.id,f'''
📇 Владелец: {user_name}
🪧️ Название фермы: NVIDIA GeForce GTX 1650
💸 Прибыль: {cards * 250}💠/чаc
🔋 Количество видеокарт: {cards2}
{text}
💰 На счету: {balance2}💠

❗️Купить видеокарты: <b>Донат видеокарты [кол-во]</b> (только для донатной фермы),
Для обычной : <b>Ферма видеокарты [кол-во]</b>''',
                                             reply_markup=help_ferma,parse_mode='html')

                    if Farm[0] == 0:
                        if Farm2[0] == 0:
                            await bot.send_message(message.chat.id,
                                                   f'{user_name}, Извините . Но у вас нету майнинг-фермы{rloser}\n‼️ Что бы посмотреть список Майнинг-Ферм для покупки введите команду\n‼️ Фермы',
                                                   parse_mode='html')
                        if Farm2[0] == 1:
                            cards3 = cursor.execute(
                                "SELECT cards2 from ferma where user_id = ?", (message.from_user.id,))
                            cards3 = cursor.fetchone()
                            cards3 = int(cards3[0])
                            cards22 = '{:,}'.format(cards3).replace(',', '.')
                            text = f'\n🪧️ Название фермы: 🔶️NVIDIA GeForce RTX 4100 Limited Edition \nПрибыль: {cards3 * 10000}💠/чаc\n🔋 Количество видеокарт: {cards22}\n'
                            await bot.send_message(message.chat.id, f'''
📇 Владелец: {user_name}{text}
💰 На счету: {balance2}💠
❗️Купить видеокарты: <b>Донат видеокарты (только для донатной фермы)</b>
''',
                       reply_markup=help_ferma, parse_mode='html')

                if message.text.startswith("Фермы"):
                    msg = message
                    user_name = message.from_user.get_mention(as_html=True)
                    user_name = cursor.execute(
                        "SELECT user_name from users where user_id = ?", (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = str(user_name[0])
                    await bot.send_message(message.chat.id, f'''{user_name}, вот список [🗞] Майнинг-Ферм[📡]
1️⃣ ♻️NVIDIA GeForce GTX 1650 - 1.000.000.000₸  250 💠/Час
2️⃣ ️♻️NVIDIA GeForce RTX 3100 - 20.000.000.000₸   1.000 💠/час 
3️⃣ ️♻️NVIDIA GeForce RTX 4100 - 100.000.000.000₸   3.000 💠/час

4️⃣ 🔶️NVIDIA GeForce RTX 4100 Limited Edition  10.000 💠/час

‼️ Что бы купить майнинг-ферму введите команду ниже ⬇️
‼️ Купить ферму [Номер фермы]''', parse_mode='html')
                ##############################################donat######################################################################
                if message.text.startswith("Донат купить"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    if message.text != 'Донат купить':
                        donat = cursor.execute(
                            "SELECT ecoins from users where user_id = ?", (message.from_user.id,))
                        donat = cursor.fetchone()
                        donat = int(donat[0])

                        user_status = cursor.execute(
                            "SELECT user_status from users where user_id = ?", (message.from_user.id,))
                        user_status = cursor.fetchone()
                        user_status = str(user_status[0])

                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)
                        try:
                            nomer = int(message.text.split()[2])
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Донат купить 1 ')
                            return

                        if nomer == 1:
                            price = 100
                            if donat >= price:
                                if user_status != 'vip' and user_status != 'premium' and user_status != 'delux':
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили ⭐️«VIP» Статус  ',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE users SET user_status = 'vip'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET ecoins = {donat - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE users SET limitpered = 10000000000000   WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE users SET cardslimit = 1500  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE users SET limitbank = 1000000000000  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE users SET bonusvip = 1  WHERE user_id = {user_id}')

                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть донат {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного доната {rloser}',
                                                       parse_mode='html')
                        if nomer == 2:
                            price = 250
                            if donat >= price:
                                if donat >= price:
                                    if user_status != 'premium' and user_status != 'delux':
                                        await bot.send_message(message.chat.id,
                                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили 💎 Статус «Premium»',
                                                               parse_mode='html')
                                        cursor.execute(
                                            f"UPDATE users SET user_status = 'premium'  WHERE user_id = {user_id}")
                                        cursor.execute(
                                            f'UPDATE users SET ecoins = {donat - price}  WHERE user_id = {user_id}')
                                        cursor.execute(
                                            f'UPDATE users SET limitpered = 20000000000000  WHERE user_id = {user_id}')
                                        cursor.execute(
                                            f'UPDATE users SET cardslimit = 3000  WHERE user_id = {user_id}')
                                        cursor.execute(
                                            f'UPDATE users SET limitbank = 10000000000000  WHERE user_id = {user_id}')
                                        cursor.execute(
                                            f'UPDATE users SET bonusvip = 1  WHERE user_id = {user_id}')
                                        cursor.execute(
                                            f'UPDATE users SET bonusprem = 1  WHERE user_id = {user_id}')
                                        cursor.execute(
                                            f'UPDATE users SET limitvidach2 = 50000000000  WHERE user_id = {user_id}')
                                        connect.commit()
                                    else:
                                        await bot.send_message(message.chat.id,
                                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть донат {rloser}',
                                                               parse_mode='html')
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного доната {rloser}',
                                                           parse_mode='html')
                        if nomer == 3:
                            price = 500
                            if donat >= price:
                                if user_status != 'delux':
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили 🔥 Статус «Deluxe» ',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE users SET user_status = 'delux'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET ecoins = {donat - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE users SET limitpered = 70000000000000  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE users SET cardslimit = 5000  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE users SET bonusvip = 1  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE users SET bonusprem = 1  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE users SET limitvidach = 1000000000000  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE users SET limitvidach2 = 50000000000  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть донат {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного доната {rloser}',
                                                       parse_mode='html')

                #######################################################ДОМА#############################################################

                if message.text.startswith("Купить дом") or message.text.startswith("купить дом"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    if message.text != 'Купить дом':

                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])

                        house = cursor.execute(
                            "SELECT house from property where user_id = ?", (message.from_user.id,))
                        house = cursor.fetchone()
                        house = int(house[0])

                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)


                        try:
                            nomer = int(message.text.split()[2])
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Купить дом 1 ')
                            return
                        if nomer == 1:
                            price = 500000
                            if balance >= price:
                                if house < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили дом "Коробка" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET house = {1}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть дом {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 2:
                            price = 1000000
                            if balance >= price:
                                if house < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили дом "Подвал" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET house = {2}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть дом {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 3:
                            price = 3000000
                            if balance >= price:
                                if house < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили дом "Сарай" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET house = {3}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть дом {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 4:
                            price = 5000000
                            if balance >= price:
                                if house < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили дом "Маленький домик" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET house = {4}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть дом {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 5:
                            price = 7000000
                            if balance >= price:
                                if house < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили дом "Квартира" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET house = {5}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть дом {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 6:
                            price = 10000000
                            if balance >= price:
                                if house < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили дом "Огромный дом" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET house = {6}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть дом {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 7:
                            price = 50000000
                            if balance >= price:
                                if house < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили дом "Коттедж" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET house = {7}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть дом {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 8:
                            price = 100000000
                            if balance >= price:
                                if house < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили дом "Вилла" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET house = {8}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть дом {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 9:
                            price = 5000000000
                            if balance >= price:
                                if house < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили дом "Таунхаус  " 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET house = {9}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть дом {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 10:
                            price = 50000000000
                            if balance >= price:
                                if house < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили дом "Небоскрёб" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET house = {10}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть дом {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 11:
                            price = 200000000000
                            if balance >= price:
                                if house < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили дом "плавучий дом " 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET house = {11}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть дом {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')

                        if nomer == 12:
                            price = 1000000000000
                            if balance >= price:
                                if house < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили дом "Технологичный небосрёб" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET house = {12}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть дом {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 13:
                            price = 5000000000000
                            if balance >= price:
                                if house < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили дом "Собственный остров" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET house = {13}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть дом {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 14:
                            price = 15000000000000
                            if balance >= price:
                                if house < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили дом "Общежитие" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET house = {14}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть дом {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 15:
                            price = 25000000000000
                            if balance >= price:
                                if house < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили дом "Приют" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET house = {15}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть дом {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 16:
                            price = 50000000000000
                            if balance >= price:
                                if house < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили дом "Дом престарелых" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET house = {16}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть дом {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Купить дом [номер] {rloser}',
                                               parse_mode='html')
                        return

                if message.text.lower() in ['Продать дом', "продать дом"]:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])

                    house = cursor.execute(
                        "SELECT house from property where user_id = ?", (message.from_user.id,))
                    house = cursor.fetchone()
                    house = int(house[0])

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)

                    if house > 0:
                        if house == 1:
                            price = 500000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали дом за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET house = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if house == 2:
                            price = 1000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали дом за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET house = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if house == 3:
                            price = 3000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали дом за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET house = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if house == 4:
                            price = 5000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали дом за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET house = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if house == 5:
                            price = 7000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали дом за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET house = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if house == 6:
                            price = 10000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали дом за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET house = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if house == 7:
                            price = 50000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали дом за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET house = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if house == 8:
                            price = 100000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали дом за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET house = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if house == 9:
                            price = 5000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали дом за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET house = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if house == 10:
                            price = 50000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали дом за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET house = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if house == 11:
                            price = 200000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали дом за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET house = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if house == 12:
                            price = 1000000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали дом за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET house = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if house == 13:
                            price = 5000000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали дом за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET house = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if house == 14:
                            price = 15000000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали дом за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET house = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if house == 15:
                            price = 25000000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали дом за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET house = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if house == 16:
                            price = 50000000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали дом за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET house = {0}  WHERE user_id = {user_id}')
                            connect.commit()

                if message.text.lower() in ['дома', 'Дома']:
                    name = message.from_user.get_mention(as_html=True)
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    await bot.send_message(message.chat.id, f'''
<a href="tg://user?id={user_id}">{user_name}</a>, доступные дома:
🏠 1. Коробка - 500.000₸ 
🏠 2. Подвал - 1.000.000₸ 
🏠 3. Сарай - 3.000.000₸ 
🏠 4. Маленький домик - 5.000.000₸ 
🏠 5. Квартира - 7.000.000₸ 
🏠 6. Огромный дом - 10.000.000₸ 
🏠 7. Коттедж - 50.000.000₸ 
🏠 8. Вилла - 100.000.000₸ 
🏠 9. Таунхаус  - 5.000.000.000₸ 
🏠 10. Небоскрёб - 50.000.000.000₸ 
🏠 11. плавучий дом - 200.000.000.000₸ 
🏠 12. Технологичный небосрёб - 1.000.000.000.000₸ 
🏠 13. Собственный остров - 5.000.000.000.000₸ 
🏠 14. Общежитие - 15.000.000.000.000₸ 
🏠 15. Приют - 25.000.000.000.000₸ 
🏠 16. Дом престарелых - 50.000.000.000.000₸ 

🛒 Для покупки дома введите "Купить дом [номер]"
                        ''', parse_mode='html')
                if message.text.lower() in ['вытянуть тикет', 'тикет вытянуть']:
                    message = message
                    user_name = cursor.execute(
                        "SELECT user_name from users where user_id = ?", (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = str(user_name[0])

                    user_id = message.from_user.id
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    rticket = random.randint(10, 25)
                    ticket = cursor.execute(
                        "SELECT ticket from users where user_id = ?", (message.from_user.id,))
                    ticket = cursor.fetchone()
                    ticket = int(ticket[0])
                    prize = random.randint(1, 100)

                    user_status = cursor.execute(
                        "SELECT user_status from users where user_id = ?", (message.from_user.id,))
                    user_status = cursor.fetchone()
                    user_status = str(user_status[0])

                    if ticket >= 15:
                        if prize in range(1,50):
                            rmoney =  cursor.execute("SELECT AVG(balance) AS Average_balance FROM users WHERE user_status='Player' or user_status='vip' or user_status='premium' or user_status='delux'")
                            rmoney=cursor.fetchone()
                            rmoney=int(rmoney[0])
                            rmoney=round(rmoney/10)
                            balance = cursor.execute(
                                "SELECT balance from users where user_id = ?", (message.from_user.id,))
                            balance = cursor.fetchone()
                            balance = int(balance[0])
                            rmoney2 = '{:,}'.format(rmoney).replace(',', '.')
                            await bot.send_message(message.chat.id, f'💰  {user_name}, вам выпало {rmoney2}₸ ! {rwin}',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + rmoney} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET ticket = {ticket - 15} WHERE user_id = {user_id}')
                            connect.commit()
                        if prize in range(50,60):
                            rrating =  cursor.execute("SELECT AVG(rating) AS Average_balance FROM users WHERE user_status='Player' or user_status='vip' or user_status='premium' or user_status='delux'")
                            rrating = cursor.fetchone()
                            rrating = int(rrating[0])
                            rrating =round( rrating / 10)
                            rating = cursor.execute(
                                "SELECT rating from users where user_id = ?", (message.from_user.id,))
                            rating = cursor.fetchone()
                            rating = int(rating[0])
                            rating2 = '{:,}'.format(rrating).replace(',', '.')
                            await bot.send_message(message.chat.id, f'👑  {user_name}, вам выпало {rating2} рейтинга! {rwin}',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET rating = {rating + rrating} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET ticket = {ticket - 15} WHERE user_id = {user_id}')
                            connect.commit()
                        if prize in range(60,65):
                            recoins = random.randint(3, 15)
                            ecoins = cursor.execute(
                                "SELECT ecoins from users where user_id = ?", (message.from_user.id,))
                            ecoins = cursor.fetchone()
                            ecoins = int(ecoins[0])
                            recoins2 = '{:,}'.format(recoins).replace(',', '.')
                            await bot.send_message(message.chat.id, f'🍭  {user_name}, вам выпало {recoins2} конфет! {rwin}',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET ecoins = {ecoins + recoins} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET ticket = {ticket - 15} WHERE user_id = {user_id}')
                            connect.commit()
                        if prize in range(65,96):

                            await bot.send_message(message.chat.id, f'🎟️  {user_name}, вам выпало {rticket} тикетов! {rwin}',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET ticket = {ticket - 15 + rticket} WHERE user_id = {user_id}')
                            connect.commit()
                        if prize in range(96,98):

                            if user_status != 'premium' and user_status != 'delux':
                                await bot.send_message(message.chat.id,
                                                       f'🤯 {user_name}, вам выпал 💎 «Premium» Статус!  {rwin}',
                                                       parse_mode='html')
                                cursor.execute(
                                    f"UPDATE users SET user_status = 'premium'  WHERE user_id = {user_id}")

                                cursor.execute(
                                    f'UPDATE users SET limitpered = 20000000000000  WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET cardslimit = 3000  WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET limitbank = 10000000000000  WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET bonusvip = 1  WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET bonusprem = 1  WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET limitvidach2 = 50000000000  WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET ticket = {ticket - 15} WHERE user_id = {user_id}')
                                connect.commit()
                            else:
                                ecoins = cursor.execute(
                                    "SELECT ecoins from users where user_id = ?", (message.from_user.id,))
                                ecoins = cursor.fetchone()
                                ecoins = int(ecoins[0])
                                await bot.send_message(message.chat.id,
                                                       f'🍭  {user_name}, вам выпал премиум так как он у вас есть вам выдано {100} конфет! {rwin}',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET ecoins = {ecoins + 100} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET ticket = {ticket - 15} WHERE user_id = {user_id}')
                                connect.commit()
                        if prize in range(98,100):


                            if user_status != 'vip' and user_status != 'premium' and user_status != 'delux':
                                await bot.send_message(message.chat.id,
                                                       f'🤯  {user_name}, вам выпал ⭐️«VIP» Статус! {rwin}',
                                                       parse_mode='html')
                                cursor.execute(
                                    f"UPDATE users SET user_status = 'vip'  WHERE user_id = {user_id}")

                                cursor.execute(
                                    f'UPDATE users SET limitpered = 10000000000000  WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET cardslimit = 1500  WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET limitbank = 1000000000000  WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET bonusvip = 1  WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET ticket = {ticket - 15} WHERE user_id = {user_id}')

                                connect.commit()
                            else:
                                ecoins = cursor.execute(
                                    "SELECT ecoins from users where user_id = ?", (message.from_user.id,))
                                ecoins = cursor.fetchone()
                                ecoins = int(ecoins[0])
                                await bot.send_message(message.chat.id,
                                                       f'🍭  {user_name}, вам выпал вип так как он у вас есть вам выдано {25} конфет! {rwin}',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET ecoins = {ecoins + 25} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET ticket = {ticket - 15} WHERE user_id = {user_id}')
                                connect.commit()
                    else:
                        await bot.send_message(message.chat.id, f'‼️  {user_name}, у вас недостаточно тикетов! {rloser} \nТребуется 15 тикетов !',
                                               parse_mode='html')
                if message.text.lower() in ['открыть кейс 5']:
                    message = message
                    user_name = cursor.execute(
                        "SELECT user_name from users where user_id = ?", (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = str(user_name[0])

                    user_id = message.from_user.id
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    rticket = random.randint(5, 15)
                    case5 = cursor.execute(
                        "SELECT case5 from users where user_id = ?", (message.from_user.id,))
                    case5 = cursor.fetchone()
                    case5 = int(case5[0])
                    prize = random.randint(1, 100)
                    ticket = cursor.execute(
                        "SELECT ticket from users where user_id = ?", (message.from_user.id,))
                    ticket = cursor.fetchone()
                    ticket = int(ticket[0])
                    user_status = cursor.execute(
                        "SELECT user_status from users where user_id = ?", (message.from_user.id,))
                    user_status = cursor.fetchone()
                    user_status = str(user_status[0])

                    if case5 >= 1:
                        if prize in range(1,50):
                            rmoney = cursor.execute("SELECT AVG(balance) AS Average_balance FROM users WHERE user_status='Player' or user_status='vip' or user_status='premium' or user_status='delux'")
                            rmoney=cursor.fetchone()
                            rmoney=int(rmoney[0])
                            rmoney=round(rmoney/5)
                            balance = cursor.execute(
                                "SELECT balance from users where user_id = ?", (message.from_user.id,))
                            balance = cursor.fetchone()
                            balance = int(balance[0])
                            rmoney2 = '{:,}'.format(rmoney).replace(',', '.')
                            await bot.send_message(message.chat.id, f'💰  {user_name}, вам выпало {rmoney2}₸ ! {rwin}',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + rmoney} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET case5 = {case5 - 1} WHERE user_id = {user_id}')
                            connect.commit()
                        if prize in range(50,80):
                            rrating =cursor.execute("SELECT AVG(rating) AS Average_balance FROM users WHERE user_status='Player' or user_status='vip' or user_status='premium' or user_status='delux'")
                            rrating = cursor.fetchone()
                            rrating = round(int(rrating[0]))
                            rrating = round(rrating / 10)
                            rating = cursor.execute(
                                "SELECT rating from users where user_id = ?", (message.from_user.id,))
                            rating = cursor.fetchone()
                            rating = int(rating[0])
                            rating2 = '{:,}'.format(rrating).replace(',', '.')
                            await bot.send_message(message.chat.id, f'👑  {user_name}, вам выпало {rating2} рейтинга! {rwin}',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET rating = {rating + rrating} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET case5 = {case5 - 1} WHERE user_id = {user_id}')
                            connect.commit()
                        if prize in range(90,94):
                            recoins = random.randint(3, 5)
                            ecoins = cursor.execute(
                                "SELECT ecoins from users where user_id = ?", (message.from_user.id,))
                            ecoins = cursor.fetchone()
                            ecoins = int(ecoins[0])
                            recoins2 = '{:,}'.format(recoins).replace(',', '.')
                            await bot.send_message(message.chat.id, f'🍭  {user_name}, вам выпало {recoins2} конфет! {rwin}',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET ecoins = {ecoins + recoins} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET case5 = {case5 - 1} WHERE user_id = {user_id}')
                            connect.commit()
                        if prize in range(94,100):

                            await bot.send_message(message.chat.id, f'🎟️  {user_name}, вам выпало {rticket} тикетов! {rwin}',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET ticket = {ticket + rticket} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET case5 = {case5 - 1} WHERE user_id = {user_id}')
                            connect.commit()

                    else:
                        await bot.send_message(message.chat.id, f'‼️  {user_name}, у вас нету данного кейса',
                                               parse_mode='html')
                #######################################################КЕЙСЫ############################################################
                if message.text.lower() in ['Кейсы', 'кейсы']:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = str(user_name[0])

                    case1 = cursor.execute(
                        "SELECT case1 from users where user_id = ?", (message.from_user.id,))
                    case1 = cursor.fetchone()
                    case2 = cursor.execute(
                        "SELECT case2 from users where user_id = ?", (message.from_user.id,))
                    case2 = cursor.fetchone()
                    case3 = cursor.execute(
                        "SELECT case3 from users where user_id = ?", (message.from_user.id,))
                    case3 = cursor.fetchone()
                    case1 = int(case1[0])
                    case2 = int(case2[0])
                    case3 = int(case3[0])
                    case4 = cursor.execute(
                        "SELECT case4 from users where user_id = ?", (message.from_user.id,))
                    case4 = cursor.fetchone()

                    case4 = int(case4[0])
                    case5 = cursor.execute(
                        "SELECT case4 from users where user_id = ?", (message.from_user.id,))
                    case5 = cursor.fetchone()

                    case5 = int(case5[0])
                    c = int(case1) + int(case2) + int(case3) + int(case4)+ int(case5)
                    c = int(c)
                    if c == 0:
                        m = '😕  У вас нету кейсов.\n'
                        m1 = "🛒  Для покупки кейса введите «Купить кейс [1/2/3/4] [количество]»\n\n🔐  Для открытия кейсов используйте - «Открыть кейс [1/2/3/4]»"
                    if c >= 1:
                        m = "🧾  Ваши кейсы:\n"
                        m1 = "🔐  Для открытия кейсов используйте - «Открыть кейс [1/2/3/4]»\n\n🛒  Для покупки кейса введите «Купить кейс [1/2/3/4] [количество]»"
                    if case1 == 0:
                        s1 = ""
                    if case1 >= 1:
                        s1 = f'   📦 Обычный кейс - {case1}шт.\n'
                    if case2 == 0:
                        s2 = ""
                    if case2 >= 1:
                        s2 = f'   🏵 Золотой кейс - {case2}шт.\n'
                    if case3 == 0:
                        s3 = ""
                    if case3 >= 1:
                        s3 = f'   💎 Алмазный кейс - {case3}шт.\n'
                    if case4 == 0:
                        s4 = ""
                    if case4 >= 1:
                        s4 = f'   💡 Опытный кейс - {case4}шт.\n'
                    if case5 == 0:
                        s5 = ""
                    if case5 >= 1:
                        s5 = f'🤐 Секретный кейс {case5}шт.\n'
                    reply = message.from_user.id
                    await bot.send_message(message.chat.id,
                                           f'<a href="tg://user?id={reply}">{user_name}</a>, доступные кейсы:\n📦 1. Обычный кейс - 50 млн.\n🏵 2. Золотой кейс - 150 млн.\n💎 3. Алмазный кейс - 250 млн.\n💡 4. Опытный кейс - 500 млн.\n\n\n{m}{s1}{s2}{s3}{s4}{s5}{m1}',
                                           parse_mode='html')

                if message.text.startswith("Купить кейс 1") or message.text.startswith("купить кейс 1"):
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    if message.text != 'Купить кейс 1':
                        message = message
                        user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                                   (message.from_user.id,))
                        user_name = cursor.fetchone()
                        user_name = str(user_name[0])
                        reply = message.from_user.id
                        case1 = cursor.execute(
                            "SELECT case1 from users where user_id = ?", (message.from_user.id,))
                        case1 = cursor.fetchone()
                        case1 = int(case1[0])
                        user_id = message.from_user.id
                        win = ['🙂', '😋', '😄', '🤑', '😃']
                        rwin = random.choice(win)
                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)
                        try:
                            summ = int(message.text.split()[3])
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Купить кейс 1 ')
                            return

                        c = 50000000 * summ
                        c2 = '{:,}'.format(c).replace(',', '.')
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = round(int(balance[0]))
                        if summ >= 1:
                            if balance >= c:
                                await bot.send_message(message.chat.id,
                                                       f'🎁 | {user_name}, вы успешно купили {summ} обычных кейсов за {c2}₸ ',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET case1 = {case1 + summ} WHERE user_id = {user_id}')
                                connect.commit()
                                return
                            if balance < c:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                                return
                        if summ <= 0:
                            await bot.send_message(message.chat.id,
                                                   f'‼️  {user_name}, нельзя купить отрицательное число! {rloser}',
                                                   parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Купить кейс 1 [кол-во] {rloser}',
                                               parse_mode='html')
                        return
                if message.text.startswith("Купить кейс 2") or message.text.startswith("купить кейс 2"):
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    if message.text != 'Купить кейс 2':
                        message = message
                        user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                                   (message.from_user.id,))
                        user_name = cursor.fetchone()
                        user_name = str(user_name[0])
                        reply = message.from_user.id
                        case2 = cursor.execute(
                            "SELECT case2 from users where user_id = ?", (message.from_user.id,))
                        case2 = cursor.fetchone()
                        case2 = int(case2[0])
                        user_id = message.from_user.id
                        win = ['🙂', '😋', '😄', '🤑', '😃']
                        rwin = random.choice(win)
                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)

                        try:
                            summ = int(message.text.split()[3])
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Купить кейс 1 ')
                            return
                        c = 150000000 * summ
                        c2 = '{:,}'.format(c).replace(',', '.')
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = round(int(balance[0]))
                        if summ >= 1:
                            if balance >= c:
                                await bot.send_message(message.chat.id,
                                                       f'🎁 | {user_name}, вы успешно купили {summ} золотых кейсов за {c2}₸ ',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET case2 = {case2 + summ} WHERE user_id = {user_id}')
                                connect.commit()
                                return
                            if balance < c:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                                return
                        if summ <= 0:
                            await bot.send_message(message.chat.id,
                                                   f'‼️  {user_name}, нельзя купить отрицательное число! {rloser}',
                                                   parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Купить кейс 2 [кол-во] {rloser}',
                                               parse_mode='html')
                        return
                if message.text.startswith("Купить кейс 3") or message.text.startswith("купить кейс 3"):
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    if message.text != 'Купить кейс 3':
                        message = message
                        user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                                   (message.from_user.id,))
                        user_name = cursor.fetchone()
                        user_name = str(user_name[0])
                        reply = message.from_user.id
                        case3 = cursor.execute(
                            "SELECT case3 from users where user_id = ?", (message.from_user.id,))
                        case3 = cursor.fetchone()
                        case3 = int(case3[0])
                        user_id = message.from_user.id
                        win = ['🙂', '😋', '😄', '🤑', '😃']
                        rwin = random.choice(win)
                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)

                        try:
                            summ = int(message.text.split()[3])
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Купить кейс 1 ')
                            return
                        c = 250000000 * summ
                        c2 = '{:,}'.format(c).replace(',', '.')
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = round(int(balance[0]))
                        if summ >= 1:
                            if balance >= c:
                                await bot.send_message(message.chat.id,
                                                       f'🎁 | {user_name}, вы успешно купили {summ} Алмазный кейс за {c2}₸ ',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET case3 = {case3 + summ} WHERE user_id = {user_id}')
                                connect.commit()
                                return
                            if balance < c:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                                return
                        if summ <= 0:
                            await bot.send_message(message.chat.id,
                                                   f'‼️  {user_name}, нельзя купить отрицательное число! {rloser}',
                                                   parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Купить кейс 3 [кол-во] {rloser}',
                                               parse_mode='html')
                        return
                if message.text.startswith("Купить кейс 4") or message.text.startswith("купить кейс 4"):
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    if message.text != 'Купить кейс 4':
                        message = message
                        user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                                   (message.from_user.id,))
                        user_name = cursor.fetchone()
                        user_name = str(user_name[0])
                        reply = message.from_user.id
                        case4 = cursor.execute(
                            "SELECT case4 from users where user_id = ?", (message.from_user.id,))
                        case4 = cursor.fetchone()
                        case4 = int(case4[0])
                        user_id = message.from_user.id
                        win = ['🙂', '😋', '😄', '🤑', '😃']
                        rwin = random.choice(win)
                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)

                        try:
                            summ = int(message.text.split()[3])
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Купить кейс 1 ')
                            return
                        c = 500000000 * summ
                        c2 = '{:,}'.format(c).replace(',', '.')
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = round(int(balance[0]))
                        if summ >= 1:
                            if balance >= c:
                                await bot.send_message(message.chat.id,
                                                       f'🎁 | {user_name}, вы успешно купили {summ} Опытный кейс за {c2}₸ ',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET case4 = {case4 + summ} WHERE user_id = {user_id}')
                                connect.commit()
                                return
                            if balance < c:
                                await bot.send_message(message.chat.id, f'💰 | {user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')
                                return
                        if summ <= 0:
                            await bot.send_message(message.chat.id,
                                                   f'‼️  {user_name}, нельзя купить отрицательное число! {rloser}',
                                                   parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Купить кейс 4 [кол-во] {rloser}',
                                               parse_mode='html')
                        return
                if message.text.startswith("Открыть кейс 1") or message.text.startswith("открыть кейс 1"):
                    message = message
                    user_name = cursor.execute(
                        "SELECT user_name from users where user_id = ?", (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = str(user_name[0])
                    try:
                        summ = int(message.text.split()[3])
                        if summ<=0:
                            await message.reply('‼️  Неправильный ввод кол-во должно быть больше нуля ')
                            return
                    except:
                        await message.reply('‼️  Неправильный ввод команды!\nПример: Открыть кейс 1 [кол-во] ')
                        return
                    reply = message.from_user.id
                    case1 = cursor.execute(
                        "SELECT case1 from users where user_id = ?", (message.from_user.id,))
                    case1 = cursor.fetchone()
                    case1 = int(case1[0])
                    user_id = message.from_user.id
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    rmoney = random.randint(20000000, 90000000)
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])
                    rmoney2 = '{:,}'.format(rmoney*summ).replace(',', '.')
                    rrating = random.randint(100, 300)
                    fantom = cursor.execute(
                        "SELECT fantom from users where user_id = ?", (message.from_user.id,))
                    fantom = cursor.fetchone()
                    fantom = int(fantom[0])
                    rating2 = '{:,}'.format(rrating*summ).replace(',', '.')
                    prize = random.randint(1, 3)
                    user_status = cursor.execute(
                        "SELECT user_status from users where user_id = ?", (message.from_user.id,))
                    user_status = cursor.fetchone()
                    user_status = str(user_status[0])
                    if user_status=='delux':
                        if summ<=50:
                            pass
                        else:
                            await message.reply('‼️Максимум открытий за раз 50!')
                            return
                    if user_status=='premium':
                        if summ<=25:
                            pass
                        else:
                            await message.reply('‼️Максимум открытий за раз 25!  У 🔥 Статуса «Deluxe» 50')
                            return
                    if user_status=='vip':
                        if summ<=10:
                            pass
                        else:
                            await message.reply('‼️Максимум открытий за раз 10! У 💎 Статуса «Premium» 25')
                            return
                    if user_status=='Player':
                        if summ<=5:
                            pass
                        else:
                            await message.reply('‼️Максимум открытий за раз 5! У ⭐️ Статуса «VIP» 10')
                            return
                    if case1 >= summ:
                        if prize == 1:
                            await bot.send_message(message.chat.id, f'💰 {user_name}, вам выпало {rmoney2}₸ ! {rwin}',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + rmoney*summ} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET case1 = {case1 - summ} WHERE user_id = {user_id}')
                            connect.commit()
                        if prize == 2:
                            await bot.send_message(message.chat.id, f'💠 {user_name}, вам выпало {rating2} фантомов! {rwin}',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET fantom = {fantom + rrating*summ} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET case1 = {case1 - summ} WHERE user_id = {user_id}')
                            connect.commit()
                        if prize == 3:
                            await bot.send_message(message.chat.id, f'💠 {user_name}, вам выпало {rating2} фантомов! \n💰 {rmoney2}₸ ! {rwin}',
                                                   parse_mode='html')

                            cursor.execute(
                                f'UPDATE users SET balance = {balance + rmoney*summ} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET case1 = {case1 - summ} WHERE user_id = {user_id}')
                            connect.commit()
                            cursor.execute(
                                f'UPDATE users SET fantom = {fantom + rrating*summ} WHERE user_id = {user_id}')

                            connect.commit()
                    if case1 <= 0:
                        await bot.send_message(message.chat.id, f'‼️  {user_name}, у вас нехватает данного кейса! {rloser}',
                                               parse_mode='html')
                if message.text.startswith("Открыть кейс 2") or message.text.startswith("открыть кейс 2"):
                    message = message
                    user_name = cursor.execute(
                        "SELECT user_name from users where user_id = ?", (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = str(user_name[0])
                    reply = message.from_user.id
                    try:
                        summ = int(message.text.split()[3])
                        if summ<=0:
                            await message.reply('‼️  Неправильный ввод кол-во должно быть больше нуля ')
                            return
                    except:
                        await message.reply('‼️  Неправильный ввод команды!\nПример: Открыть кейс 2 [кол-во] ')
                        return
                    case1 = cursor.execute(
                        "SELECT case2 from users where user_id = ?", (message.from_user.id,))
                    case1 = cursor.fetchone()
                    case1 = int(case1[0])
                    user_id = message.from_user.id
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    rmoney = random.randint(60000000, 200000000)
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])
                    rmoney2 = '{:,}'.format(rmoney*summ).replace(',', '.')
                    rrating = random.randint(200, 400)
                    fantom = cursor.execute(
                        "SELECT fantom from users where user_id = ?", (message.from_user.id,))
                    fantom = cursor.fetchone()
                    fantom = int(fantom[0])
                    rating2 = '{:,}'.format(rrating*summ).replace(',', '.')
                    prize = random.randint(1, 3)
                    user_status = cursor.execute(
                        "SELECT user_status from users where user_id = ?", (message.from_user.id,))
                    user_status = cursor.fetchone()
                    user_status = str(user_status[0])
                    if user_status == 'delux':
                        if summ <= 50:
                            pass
                        else:
                            await message.reply('‼️Максимум открытий за раз 50!')
                            return
                    if user_status == 'premium':
                        if summ <= 25:
                            pass
                        else:
                            await message.reply('‼️Максимум открытий за раз 25!  У 🔥 Статуса «Deluxe» 50')
                            return
                    if user_status == 'vip':
                        if summ <= 10:
                            pass
                        else:
                            await message.reply('‼️Максимум открытий за раз 10! У 💎 Статуса «Premium» 25')
                            return
                    if user_status == 'Player':
                        if summ <= 5:
                            pass
                        else:
                            await message.reply('‼️Максимум открытий за раз 5! У ⭐️ Статуса «VIP» 10')
                            return
                    if case1 >= summ:
                        if prize == 1:
                            await bot.send_message(message.chat.id, f'💰  {user_name}, вам выпало {rmoney2}₸ ! {rwin}',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + rmoney*summ} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET case2 = {case1 - summ} WHERE user_id = {user_id}')
                            connect.commit()
                        if prize == 2:
                            await bot.send_message(message.chat.id, f'💠  {user_name}, вам выпало {rating2} фантомов! {rwin}',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET fantom = {fantom + rrating*summ} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET case2 = {case1 - summ} WHERE user_id = {user_id}')
                            connect.commit()
                        if prize == 3:
                            await bot.send_message(message.chat.id, f'💠  {user_name}, вам выпало {rating2} фантомов!, 💰  {rmoney2}₸ ! {rwin}',
                                                   parse_mode='html')

                            cursor.execute(
                                f'UPDATE users SET balance = {balance + rmoney*summ} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET case2 = {case1 - summ} WHERE user_id = {user_id}')
                            connect.commit()
                            cursor.execute(
                                f'UPDATE users SET fantom = {fantom + rrating*summ} WHERE user_id = {user_id}')

                            connect.commit()
                    if case1 <= 0:
                        await bot.send_message(message.chat.id, f'‼️  {user_name}, у вас нехватает данного кейса! {rloser}',
                                               parse_mode='html')
                if message.text.startswith("Открыть кейс 3") or message.text.startswith("открыть кейс 3"):
                    message = message
                    user_name = cursor.execute(
                        "SELECT user_name from users where user_id = ?", (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = str(user_name[0])
                    reply = message.from_user.id
                    try:
                        summ = int(message.text.split()[3])
                        if summ<=0:
                            await message.reply('‼️  Неправильный ввод кол-во должно быть больше нуля ')
                            return
                    except:
                        await message.reply('‼️  Неправильный ввод команды!\nПример: Открыть кейс 3 [кол-во] ')
                        return
                    case1 = cursor.execute(
                        "SELECT case3 from users where user_id = ?", (message.from_user.id,))
                    case1 = cursor.fetchone()
                    case1 = int(case1[0])
                    user_id = message.from_user.id
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    rmoney = random.randint(200000000, 280000000)
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])
                    rmoney2 = '{:,}'.format(rmoney*summ).replace(',', '.')
                    rrating = random.randint(500, 800)
                    fantom = cursor.execute(
                        "SELECT fantom from users where user_id = ?", (message.from_user.id,))
                    fantom = cursor.fetchone()
                    fantom = int(fantom[0])
                    rating2 = '{:,}'.format(rrating*summ).replace(',', '.')
                    prize = random.randint(1, 2)
                    user_status = cursor.execute(
                        "SELECT user_status from users where user_id = ?", (message.from_user.id,))
                    user_status = cursor.fetchone()
                    user_status = str(user_status[0])
                    if user_status == 'delux':
                        if summ <= 50:
                            pass
                        else:
                            await message.reply('‼️Максимум открытий за раз 50!')
                            return
                    if user_status == 'premium':
                        if summ <= 25:
                            pass
                        else:
                            await message.reply('‼️Максимум открытий за раз 25!  У 🔥 Статуса «Deluxe» 50')
                            return
                    if user_status == 'vip':
                        if summ <= 10:
                            pass
                        else:
                            await message.reply('‼️Максимум открытий за раз 10! У 💎 Статуса «Premium» 25')
                            return
                    if user_status == 'Player':
                        if summ <= 5:
                            pass
                        else:
                            await message.reply('‼️Максимум открытий за раз 5! У ⭐️ Статуса «VIP» 10')
                            return
                    if case1 >= summ:
                        if prize == 1:
                            await bot.send_message(message.chat.id, f'💰  {user_name}, вам выпало {rmoney2}₸ ! {rwin}',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + rmoney * summ} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET case3 = {case1 - summ} WHERE user_id = {user_id}')
                            connect.commit()
                        if prize == 2:
                            await bot.send_message(message.chat.id,
                                                   f'💠  {user_name}, вам выпало {rating2} фантомов! {rwin}',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET fantom = {fantom + rrating * summ} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET case3 = {case1 - summ} WHERE user_id = {user_id}')
                            connect.commit()


                            connect.commit()
                    if case1 <= 0:
                        await bot.send_message(message.chat.id,
                                               f'‼️  {user_name}, у вас нехватает данного кейса! {rloser}',
                                               parse_mode='html')
                if message.text.startswith("Открыть кейс 4") or message.text.startswith("открыть кейс 4"):
                    message = message
                    user_name = cursor.execute(
                        "SELECT user_name from users where user_id = ?", (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = str(user_name[0])
                    reply = message.from_user.id
                    try:
                        summ = int(message.text.split()[3])
                        if summ<=0:
                            await message.reply('‼️  Неправильный ввод кол-во должно быть больше нуля ')
                            return
                    except:
                        await message.reply('‼️  Неправильный ввод команды!\nПример: Открыть кейс 4 [кол-во] ')
                        return
                    case1 = cursor.execute(
                        "SELECT case4 from users where user_id = ?", (message.from_user.id,))
                    case1 = cursor.fetchone()
                    case1 = int(case1[0])
                    user_id = message.from_user.id
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    rmoney = random.randint(300000000, 600000000)
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])
                    rmoney2 = '{:,}'.format(rmoney*summ).replace(',', '.')
                    rrating = random.randint(1000, 1200)
                    fantom = cursor.execute(
                        "SELECT fantom from users where user_id = ?", (message.from_user.id,))
                    fantom = cursor.fetchone()
                    fantom = int(fantom[0])
                    rating2 = '{:,}'.format(rrating*summ).replace(',', '.')
                    expe = cursor.execute(
                        "SELECT expe from users where user_id = ?", (message.from_user.id,))
                    expe = cursor.fetchone()
                    expe = int(expe[0])
                    expee = random.randint(20, 100)
                    expee2 = '{:,}'.format(expee*summ).replace(',', '.')
                    prize = random.randint(1, 2)
                    user_status = cursor.execute(
                        "SELECT user_status from users where user_id = ?", (message.from_user.id,))
                    user_status = cursor.fetchone()
                    user_status = str(user_status[0])
                    if user_status == 'delux':
                        if summ <= 50:
                            pass
                        else:
                            await message.reply('‼️Максимум открытий за раз 50!')
                            return
                    if user_status == 'premium':
                        if summ <= 25:
                            pass
                        else:
                            await message.reply('‼️Максимум открытий за раз 25!  У 🔥 Статуса «Deluxe» 50')
                            return
                    if user_status == 'vip':
                        if summ <= 10:
                            pass
                        else:
                            await message.reply('‼️Максимум открытий за раз 10! У 💎 Статуса «Premium» 25')
                            return
                    if user_status == 'Player':
                        if summ <= 5:
                            pass
                        else:
                            await message.reply('‼️Максимум открытий за раз 5! У ⭐️ Статуса «VIP» 10')
                            return
                    if case1 >= summ:
                        if prize == 1:
                            await bot.send_message(message.chat.id, f'💰  {user_name}, вам выпало {rmoney2}₸ ! {rwin}',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + rmoney*summ} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET case4 = {case1 - summ} WHERE user_id = {user_id}')
                            connect.commit()

                        if prize == 2:
                            await bot.send_message(message.chat.id, f'💠  {user_name}, вам выпало {rating2} фантомов! \n💰  {rmoney2}₸ ! \n, {expee2}💡! {rwin}',
                                                   parse_mode='html')

                            cursor.execute(
                                f'UPDATE users SET balance = {balance + rmoney*summ} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET case4 = {case1 - summ} WHERE user_id = {user_id}')
                            connect.commit()
                            cursor.execute(
                                f'UPDATE users SET fantom = {fantom + rrating*summ} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET expe = {expe + expee*summ} WHERE user_id = {user_id}')
                            connect.commit()
                    if case1 <= 0:
                        await bot.send_message(message.chat.id, f'‼️  {user_name}, у вас нехватает данного кейса! {rloser}',
                                               parse_mode='html')

                #############################################БИЗНЕСЫ#####################################################
                if message.text.lower() in ['бизнес', 'мой бизнес']:

                    msg = message
                    user_name = message.from_user.get_mention(as_html=True)
                    user_name = cursor.execute(
                        "SELECT user_name from users where user_id = ?", (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = str(user_name[0])
                    business = cursor.execute(
                        "SELECT business from business where user_id = ?", (message.from_user.id,))
                    business = cursor.fetchone()
                    balance = cursor.execute(
                        "SELECT balance from business where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    workers = cursor.execute(
                        "SELECT workers from business where user_id = ?", (message.from_user.id,))
                    workers = cursor.fetchone()
                    workers = int(workers[0])
                    workers2 = '{:,}'.format(workers).replace(',', '.')
                    balance = int(balance[0])
                    balance2 = '{:,}'.format(balance).replace(',', '.')
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    #photo = open("assets/business.jpg", 'rb')
                    rloser = random.choice(loser)
                    if business[0] == 10:
                        await bot.send_message(message.chat.id,f'''
[👫] Владелец: {user_name}
‼️ Название бизнеса: Ялан 
💸 Прибыль: {workers * 10000000}₸ /чаc
👨‍💼 Количество Рабочих: {workers2}
💰 На счету: {balance2}₸ 

❗️Увеличить рабочих: <b>Нанять рабочих [кол-во]</b> 
                                                    ''',
                                             reply_markup=help_biz,parse_mode='html')

                    if business[0] == 9:
                        await bot.send_message(message.chat.id,f'''
[👫] Владелец: {user_name}
‼️ Название бизнеса: Порностудия
💸 Прибыль: {workers *8000000}₸ /чаc
👨‍💼 Количество Рабочих: {workers2}
💰 На счету: {balance2}₸ 

❗️Увеличить рабочих: <b>Нанять рабочих [кол-во]</b> ''',
                                             reply_markup=help_biz,parse_mode='html')

                    if business[0] == 8:
                        await bot.send_message(message.chat.id,f'''
[👫] Владелец: {user_name}
‼️ Название бизнеса: Международный банк
💸 Прибыль: {workers * 6000000}₸ /чаc
👨‍💼 Количество Рабочих: {workers2}
💰 На счету: {balance2}₸ 

❗️Увеличить рабочих: <b>Нанять рабочих [кол-во]</b> ''',
                                             reply_markup=help_biz,parse_mode='html')
                    if business[0] == 7:
                        await bot.send_message(message.chat.id,f'''
[👫] Владелец: {user_name}
‼️ Название бизнеса: Банк 
💸 Прибыль: {workers * 4000000}₸ /чаc
👨‍💼 Количество Рабочих: {workers2}
💰 На счету: {balance2}₸ 

❗️Увеличить рабочих: <b>Нанять рабочих [кол-во]</b> 
                                                    ''',
                                             reply_markup=help_biz,parse_mode='html')

                    if business[0] == 6:
                        await bot.send_message(message.chat.id,f'''
[👫] Владелец: {user_name}
‼️ Название бизнеса: Сеть ресторанов
💸 Прибыль: {workers *2000000}₸ /чаc
👨‍💼 Количество Рабочих: {workers2}
💰 На счету: {balance2}₸ 

❗️Увеличить рабочих: <b>Нанять рабочих [кол-во]</b> 
                                        ''',
                                             reply_markup=help_biz,parse_mode='html')

                    if business[0] == 5:
                        await bot.send_message(message.chat.id,f'''
[👫] Владелец: {user_name}
‼️ Название бизнеса: Ателье 
💸 Прибыль: {workers * 1000000}₸ /чаc
👨‍💼 Количество Рабочих: {workers2}
💰 На счету: {balance2}₸ 

❗️Увеличить рабочих: <b>Нанять рабочих [кол-во]</b> ''',
                                             reply_markup=help_biz,parse_mode='html')

                    if business[0] == 4:
                        await bot.send_message(message.chat.id,f'''
[👫] Владелец: {user_name}
‼️ Название бизнеса: Интернет-агенство
💸 Прибыль: {workers * 800000}₸ /чаc
👨‍💼 Количество Рабочих: {workers2}
💰 На счету: {balance2}₸ 

❗️Увеличить рабочих: <b>Нанять рабочих [кол-во]</b> ''',
                                             reply_markup=help_biz,parse_mode='html')
                    if business[0] == 3:
                        await bot.send_message(message.chat.id,f'''
[👫] Владелец: {user_name}
‼️ Название бизнеса: Сеть кафешек
💸 Прибыль: {workers * 600000}₸ /чаc
👨‍💼 Количество Рабочих: {workers2}
💰 На счету: {balance2}₸ 

❗️Увеличить рабочих: <b>Нанять рабочих [кол-во]</b> 
                                    ''',
                                             reply_markup=help_biz,parse_mode='html')

                    if business[0] == 2:
                        await bot.send_message(message.chat.id,f'''
[👫] Владелец: {user_name}
‼️ Название бизнеса: Маркет
💸 Прибыль: {workers * 400000}₸ /чаc
👨‍💼 Количество Рабочих: {workers2}
💰 На счету: {balance2}₸ 

❗️Увеличить рабочих: <b>Нанять рабочих [кол-во]</b> ''',
                                             reply_markup=help_biz,parse_mode='html')

                    if business[0] == 1:
                        await bot.send_message(message.chat.id,f'''
[👫] Владелец: {user_name}
‼️ Название бизнеса: Ларек 
💸 Прибыль: {workers * 200000}₸ /чаc
👨‍💼 Количество Рабочих: {workers2}
💰 На счету: {balance2}₸ 

❗️Увеличить рабочих: <b>Нанять рабочих [кол-во]</b> ''',
                                             reply_markup=help_biz,parse_mode='html')

                    if business[0] == 0:
                        await bot.send_message(message.chat.id,
                                               f'{user_name}, Извините . Но у вас нету бизнеса{rloser}\n‼️ Что бы посмотреть список бизнесов для покупки введите команду\n‼️ бизнесы',
                                               parse_mode='html')
                if message.text.lower() in ['бизнес снять', 'Бизнес снять']:

                    msg = message
                    user_id = msg.from_user.id
                    user_name = message.from_user.get_mention(as_html=True)
                    chat_id = message.chat.id
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    user_name = cursor.execute(
                        "SELECT user_name from users where user_id = ?", (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = str(user_name[0])
                    cripto = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    cripto = cursor.fetchone()
                    cripto = int(cripto[0])
                    balance = cursor.execute(
                        "SELECT balance from business where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])
                    balance2 = '{:,}'.format(balance).replace(",", ".")
                    event_febiz = cursor.execute(
                        "SELECT event_febiz from clans_id ")
                    event_febiz = cursor.fetchone()
                    event_febiz = int(event_febiz[0])
                    if event_febiz == 0:
                        if int(balance) > 0:

                            await bot.send_message(message.chat.id,
                                                   f'‼️ {user_name}, вы успешно сняли с Баланса бизнеса {balance2}₸  на свой баланс{rwin}',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {cripto + balance} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE business SET balance = {balance - balance} WHERE user_id = {user_id}')
                            connect.commit()
                        else:
                            await bot.send_message(message.chat.id, f'{user_name}, на балансе бизнеса пусто! {rloser}',
                                                   parse_mode='html')
                    if event_febiz == 1:
                        balance2 = '{:,}'.format(balance*2).replace(",", ".")
                        if int(balance) > 0:

                            await bot.send_message(message.chat.id,
                                                   f'‼️ {user_name}, вы успешно сняли с Баланса бизнеса '
                                                   f'\nДействует ивент х2 {balance2}₸  на свой баланс{rwin}',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {cripto + (balance*2)} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE business SET balance = {balance - balance} WHERE user_id = {user_id}')
                            connect.commit()
                        else:
                            await bot.send_message(message.chat.id, f'{user_name}, на балансе бизнеса пусто! {rloser}',
                                                   parse_mode='html')
                if message.text.startswith("Нанять рабочих") or message.text.startswith("нанять рабочих"):
                    message = message
                    chat_id = message.chat.id
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    if message.text != 'Нанять рабочих' or message.text != 'нанять рабочих':
                        reply = message.from_user.id
                        try:
                            summ3 = int(message.text.split()[2])
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Нанять рабочих 1 ')
                            return

                        summ = summ3
                        business = cursor.execute(
                            "SELECT business from business where user_id = ?", (message.from_user.id,))
                        business = cursor.fetchone()
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        workers = cursor.execute(
                            "SELECT workers from business where user_id = ?", (message.from_user.id,))
                        workers = cursor.fetchone()
                        workers = int(workers[0])
                        workers2 = '{:,}'.format(workers).replace(',', '.')
                        balance = int(balance[0])
                        balance2 = '{:,}'.format(balance).replace(',', '.')

                        workers1 = 2000000
                        workers2 = 3000000
                        workers3 = 4000000
                        workers4 = 5000000
                        workers5 = 7000000
                        workers6 = 8000000
                        workers7 = 50000000
                        workers8 = 100000000
                        workers9 = 500000000
                        workers10 = 5000000000

                        user_status = cursor.execute(
                            "SELECT user_status from users where user_id = ?", (message.from_user.id,))
                        user_status = cursor.fetchone()
                        user_status = str(user_status[0])

                        if user_status == "delux" and workers + summ <= 20000:
                            if business[0] == 10:
                                if balance >= workers10 * summ3:
                                    await bot.send_message(message.chat.id,

                                                           f'‼️ {user_name}, вы успешно наняли {summ} рабочих '
                                                           f'на сумму {workers10 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - workers10 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET workers = {summ + workers} WHERE user_id = {user_id}')
                                    connect.commit()
                                if balance < workers10 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')
                            if business[0] == 9:
                                if balance >= workers9 * summ:
                                    await bot.send_message(message.chat.id,
                                                           f'‼️ {user_name}, вы успешно наняли {summ} рабочих '
                                                           f'на сумму {workers9 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - workers9 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET workers = {summ + workers} WHERE user_id = {user_id}')
                                    connect.commit()
                                if balance < workers9 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')
                            if business[0] == 8:
                                if balance >= workers8 * summ:
                                    await bot.send_message(message.chat.id,
                                                           f'‼️ {user_name}, вы успешно наняли {summ} рабочих '
                                                           f'на сумму {workers8 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - workers8 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET workers = {summ + workers} WHERE user_id = {user_id}')
                                    connect.commit()
                                if balance < workers8 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')

                            if business[0] == 7:
                                if balance >= workers7 * summ3:
                                    await bot.send_message(message.chat.id,

                                                           f'‼️ {user_name}, вы успешно наняли {summ} рабочих '
                                                           f'на сумму {workers7 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - workers7 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET workers = {summ + workers} WHERE user_id = {user_id}')
                                    connect.commit()
                                if balance < workers7 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')
                            if business[0] == 6:
                                if balance >= workers6 * summ3:
                                    await bot.send_message(message.chat.id,

                                                           f'‼️ {user_name}, вы успешно наняли {summ} рабочих '
                                                           f'на сумму {workers6 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - workers6 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET workers = {summ + workers} WHERE user_id = {user_id}')
                                    connect.commit()
                                if balance < workers6 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')
                            if business[0] == 5:
                                if balance >= workers5 * summ:
                                    await bot.send_message(message.chat.id,
                                                           f'‼️ {user_name}, вы успешно наняли {summ} рабочих '
                                                           f'на сумму {workers5 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - workers5* summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET workers = {summ + workers} WHERE user_id = {user_id}')
                                    connect.commit()
                                if balance < workers5 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')
                            if business[0] == 4:
                                if balance >= workers4 * summ:
                                    await bot.send_message(message.chat.id,
                                                           f'‼️ {user_name}, вы успешно наняли {summ} рабочих '
                                                           f'на сумму {workers4 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - workers4 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET workers = {summ + workers} WHERE user_id = {user_id}')
                                    connect.commit()
                                if balance < workers4 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')

                            if business[0] == 3:
                                if balance >= workers3 * summ3:
                                    await bot.send_message(message.chat.id,

                                                           f'‼️ {user_name}, вы успешно наняли {summ} рабочих '
                                                           f'на сумму {workers3 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - workers3 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET workers = {summ + workers} WHERE user_id = {user_id}')
                                    connect.commit()
                                if balance < workers3 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')
                            if business[0] == 2:
                                if balance >= workers2 * summ:
                                    await bot.send_message(message.chat.id,
                                                           f'‼️ {user_name}, вы успешно наняли {summ} рабочих '
                                                           f'на сумму {workers2 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - workers2 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET workers = {summ + workers} WHERE user_id = {user_id}')
                                    connect.commit()
                                if balance < workers2 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')
                            if business[0] == 1:
                                if balance >= workers1 * summ:
                                    await bot.send_message(message.chat.id,
                                                           f'‼️ {user_name}, вы успешно наняли {summ} рабочих '
                                                           f'на сумму {workers1 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - workers1 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET workers = {summ + workers} WHERE user_id = {user_id}')
                                    connect.commit()
                                if balance < workers1 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')
                            if business[0] == 0:
                                await bot.send_message(message.chat.id, f'{user_name},  для начало купи бизнес!',
                                                       parse_mode='html')

                        elif workers + summ <= 10000:
                            if business[0] == 10:
                                if balance >= workers10 * summ3:
                                    await bot.send_message(message.chat.id,

                                                           f'‼️ {user_name}, вы успешно наняли {summ} рабочих '
                                                           f'на сумму {workers10 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - workers10 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET workers = {summ + workers} WHERE user_id = {user_id}')
                                    connect.commit()
                                if balance < workers10 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')
                            if business[0] == 9:
                                if balance >= workers9 * summ:
                                    await bot.send_message(message.chat.id,
                                                           f'‼️ {user_name}, вы успешно наняли {summ} рабочих '
                                                           f'на сумму {workers9 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - workers9 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET workers = {summ + workers} WHERE user_id = {user_id}')
                                    connect.commit()
                                if balance < workers9 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')
                            if business[0] == 8:
                                if balance >= workers8 * summ:
                                    await bot.send_message(message.chat.id,
                                                           f'‼️ {user_name}, вы успешно наняли {summ} рабочих '
                                                           f'на сумму {workers8 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - workers8 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET workers = {summ + workers} WHERE user_id = {user_id}')
                                    connect.commit()
                                if balance < workers8 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')

                            if business[0] == 7:
                                if balance >= workers7 * summ3:
                                    await bot.send_message(message.chat.id,

                                                           f'‼️ {user_name}, вы успешно наняли {summ} рабочих '
                                                           f'на сумму {workers7 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - workers7 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET workers = {summ + workers} WHERE user_id = {user_id}')
                                    connect.commit()
                                if balance < workers7 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')
                            if business[0] == 6:
                                if balance >= workers6 * summ3:
                                    await bot.send_message(message.chat.id,

                                                           f'‼️ {user_name}, вы успешно наняли {summ} рабочих '
                                                           f'на сумму {workers6 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - workers6 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET workers = {summ + workers} WHERE user_id = {user_id}')
                                    connect.commit()
                                if balance < workers6 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')
                            if business[0] == 5:
                                if balance >= workers5 * summ:
                                    await bot.send_message(message.chat.id,
                                                           f'‼️ {user_name}, вы успешно наняли {summ} рабочих '
                                                           f'на сумму {workers5 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - workers5* summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET workers = {summ + workers} WHERE user_id = {user_id}')
                                    connect.commit()
                                if balance < workers5 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')
                            if business[0] == 4:
                                if balance >= workers4 * summ:
                                    await bot.send_message(message.chat.id,
                                                           f'‼️ {user_name}, вы успешно наняли {summ} рабочих '
                                                           f'на сумму {workers4 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - workers4 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET workers = {summ + workers} WHERE user_id = {user_id}')
                                    connect.commit()
                                if balance < workers4 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')

                            if business[0] == 3:
                                if balance >= workers3 * summ3:
                                    await bot.send_message(message.chat.id,

                                                           f'‼️ {user_name}, вы успешно наняли {summ} рабочих '
                                                           f'на сумму {workers3 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - workers3 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET workers = {summ + workers} WHERE user_id = {user_id}')
                                    connect.commit()
                                if balance < workers3 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')
                            if business[0] == 2:
                                if balance >= workers2 * summ:
                                    await bot.send_message(message.chat.id,
                                                           f'‼️ {user_name}, вы успешно наняли {summ} рабочих '
                                                           f'на сумму {workers2 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - workers2 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET workers = {summ + workers} WHERE user_id = {user_id}')
                                    connect.commit()
                                if balance < workers2 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')
                            if business[0] == 1:
                                if balance >= workers1 * summ:
                                    await bot.send_message(message.chat.id,
                                                           f'‼️ {user_name}, вы успешно наняли {summ} рабочих '
                                                           f'на сумму {workers1 * summ}',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - workers1 * summ} WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET workers = {summ + workers} WHERE user_id = {user_id}')
                                    connect.commit()
                                if balance < workers1 * summ:
                                    await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств!',
                                                           parse_mode='html')
                            if business[0] == 0:
                                await bot.send_message(message.chat.id, f'{user_name},  для начало купи бизнес!',
                                                       parse_mode='html')

                        else:
                            await bot.send_message(message.chat.id,
                                                   f'{user_name},  вы не можете нанять такое количество рабочих , оно превышает норму!',
                                                   parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Нанять рабочих [кол-во] {rloser}',
                                               parse_mode='html')
                        return

                if message.text.lower() in ['бизнесы', 'Бизнесы']:
                    name = message.from_user.get_mention(as_html=True)
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    await bot.send_message(message.chat.id, f'''
<a href="tg://user?id={user_id}">{user_name}</a>, доступные бизнесы:
🏪 1. Ларек - 5.000.000₸ 
🛍️ 2. Маркет - 10.000.000₸ 
🍟 3. Сеть кафешек - 30.000.000₸ 
🌐 4. Интернет-агенство - 50.000.000₸ 
🧥 5. Ателье - 70.000.000₸ 
🏠 6. Сеть ресторанов - 100.000.000₸ 
💵 7. Банк - 500.000.000₸ 
💶 8. Международный банк - 1.000.000.000₸ 
🛌 9. Порностудия  - 50.000.000.000₸ 
🏬 10. Ялан - 500.000.000.000₸ 


🛒 Для покупки дома введите "Купить бизнес [номер]"
                            ''', parse_mode='html')
                if message.text.startswith("Купить бизнес") or message.text.startswith("купить бизнес"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    if message.text != 'Купить бизнес':

                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])

                        business = cursor.execute(
                            "SELECT business from business where user_id = ?", (message.from_user.id,))
                        business = cursor.fetchone()
                        business = int(business[0])

                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)
                        try:
                            nomer = int(message.text.split()[2])
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Купить бизнес 1 ')
                            return


                        if nomer == 1:
                            price = 5000000
                            if balance >= price:
                                if business < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили бизнес "Ларек " 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE business SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET business = {1}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть бизнес {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 2:
                            price = 10000000
                            if balance >= price:
                                if business < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили бизнес "Маркет " 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE business SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET business = {2}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть бизнес {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 3:
                            price = 30000000
                            if balance >= price:
                                if business < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили бизнес "Сеть кафешек" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE business SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET business = {3}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть бизнес {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 4:
                            price = 50000000
                            if balance >= price:
                                if business < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили бизнес "Интернет-агенство" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE business SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET business = {4}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть бизнес {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 5:
                            price = 70000000
                            if balance >= price:
                                if business < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили бизнес "Ателье " 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE business SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET business = {5}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть бизнес {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 6:
                            price = 100000000
                            if balance >= price:
                                if business < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили бизнес "Сеть ресторанов" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE business SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET business = {6}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть бизнес {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 7:
                            price = 500000000
                            if balance >= price:
                                if business < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили бизнес "Банк " 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE business SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET business = {7}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть бизнес {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 8:
                            price = 1000000000
                            if balance >= price:
                                if business < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили бизнес "Международный банк" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE business SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET business = {8}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть бизнес {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 9:
                            price = 50000000000
                            if balance >= price:
                                if business < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили бизнес "Порностудия" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE business SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET business = {9}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть бизнес {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 10:
                            price = 500000000000

                            if balance >= price:
                                if business < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили бизнес "Ялан " 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE business SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE business SET business = {10}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть бизнес {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')

                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Купить бизнес [номер] {rloser}',
                                               parse_mode='html')
                        return

                if message.text.startswith("Купить кирку") or message.text.startswith("купить кирку"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    if message.text != 'Купить кирку':

                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)
                        try:
                            nomer = int(message.text.split()[2])
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Купить кирку [1-6] ')
                            return
                        expe = cursor.execute(
                            "SELECT expe from users where user_id = ?", (message.from_user.id,))
                        expe = cursor.fetchone()
                        expe = int(expe[0])
                        iron = cursor.execute(
                            "SELECT iron from mine where user_id = ?", (message.from_user.id,))
                        iron = cursor.fetchone()
                        iron = int(iron[0])
                        gold = cursor.execute(
                            "SELECT gold from mine where user_id = ?", (message.from_user.id,))
                        gold = cursor.fetchone()
                        gold = int(gold[0])
                        diamonds = cursor.execute(
                            "SELECT diamonds from mine where user_id = ?", (message.from_user.id,))
                        diamonds = cursor.fetchone()
                        diamonds = int(diamonds[0])
                        amethysts = cursor.execute("SELECT amethysts from mine where user_id = ?",
                                                   (message.from_user.id,))
                        amethysts = cursor.fetchone()
                        amethysts = int(amethysts[0])
                        aquamarine = cursor.execute("SELECT aquamarine from mine where user_id = ?",
                                                    (message.from_user.id,))
                        aquamarine = cursor.fetchone()
                        aquamarine = int(aquamarine[0])


                        if nomer == 1:

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили Железную кирку',
                                                   parse_mode='html')

                            cursor.execute(
                                f'UPDATE mine SET pick = {1}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE mine SET hp = {100}  WHERE user_id = {user_id}')
                            connect.commit()

                        if nomer == 2:
                            if expe >= 2500 :
                                if iron>=500:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили Золотую кирку',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE mine SET pick = {2}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE mine SET hp = {100}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE mine SET iron = {iron - 500}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нехватает Железа: {500-iron} для покупки данной кирки {rloser}\n'
                                                       ,
                                                       parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нехватает Опыта: {2500-expe} для покупки данной кирки {rloser}\n'
                                                       ,
                                                       parse_mode='html')
                        if nomer == 3:
                            if expe >= 5000 :
                                if iron>=250:
                                    if gold >= 100:
                                        await bot.send_message(message.chat.id,
                                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили Алмазную кирку',
                                                               parse_mode='html')
                                        cursor.execute(
                                            f'UPDATE mine SET pick = {3}  WHERE user_id = {user_id}')
                                        cursor.execute(
                                            f'UPDATE mine SET hp = {100}  WHERE user_id = {user_id}')
                                        cursor.execute(
                                            f'UPDATE mine SET iron = {iron - 250}  WHERE user_id = {user_id}')
                                        cursor.execute(
                                            f'UPDATE mine SET gold = {gold - 100}  WHERE user_id = {user_id}')
                                        connect.commit()
                                    else:
                                         await bot.send_message(message.chat.id,
                                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нехватает Золота: {100 - gold} для покупки данной кирки {rloser}\n'
                                                               ,
                                                               parse_mode='html')
                                else:
                                    await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нехватает Железа: {250-iron} для покупки данной кирки {rloser}\n'
                                                       ,
                                                       parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нехватает Опыта: {5000-expe} для покупки данной кирки {rloser}\n'
                                                       ,
                                                       parse_mode='html')
                        if nomer == 4:
                            if expe >= 7500:
                                if iron >= 100:
                                    if gold >= 200:
                                        if diamonds >= 50:
                                            await bot.send_message(message.chat.id,
                                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили Аметистувую кирку',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE mine SET pick = {4}  WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE mine SET hp = {100}  WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE mine SET iron = {iron - 250}  WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE mine SET gold = {gold - 100}  WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE mine SET diamonds = {diamonds - 25}  WHERE user_id = {user_id}')
                                            connect.commit()
                                        else:
                                            await bot.send_message(message.chat.id,
                                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нехватает Алмазов: {50 - diamonds} для покупки данной кирки {rloser}\n'
                                                                   ,
                                                                   parse_mode='html')
                                    else:
                                        await bot.send_message(message.chat.id,
                                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нехватает Золота: {100 - gold} для покупки данной кирки {rloser}\n'
                                                               ,
                                                               parse_mode='html')
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нехватает Железа: {250 - iron} для покупки данной кирки {rloser}\n'
                                                           ,
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нехватает Опыта: {7500 - expe} для покупки данной кирки {rloser}\n'
                                                       ,
                                                       parse_mode='html')
                        if nomer == 5:
                            if expe >= 10000:
                                if amethysts >= 100:
                                    if gold >= 200:
                                        if diamonds >= 10:
                                            await bot.send_message(message.chat.id,
                                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили Аквамариновую кирку',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE mine SET pick = {5}  WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE mine SET hp = {100}  WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE mine SET amethysts = {amethysts - 5}  WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE mine SET gold = {gold - 200}  WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE mine SET diamonds = {diamonds - 10}  WHERE user_id = {user_id}')
                                            connect.commit()
                                        else:
                                            await bot.send_message(message.chat.id,
                                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нехватает Алмазов: {10 - diamonds} для покупки данной кирки {rloser}\n'
                                                                   ,
                                                                   parse_mode='html')
                                    else:
                                        await bot.send_message(message.chat.id,
                                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нехватает Золота: {100 - gold} для покупки данной кирки {rloser}\n'
                                                               ,
                                                               parse_mode='html')
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нехватает Аметистов: {5 - amethysts} для покупки данной кирки {rloser}\n'
                                                           ,
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нехватает Опыта: {10000 - expe} для покупки данной кирки {rloser}\n'
                                                       ,
                                                       parse_mode='html')
                        if nomer == 6:
                            if expe >= 12500:
                                if aquamarine >= 30:

                                    if diamonds >= 25:
                                        await bot.send_message(message.chat.id,
                                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили Изумрудную кирку',
                                                               parse_mode='html')
                                        cursor.execute(
                                            f'UPDATE mine SET pick = {6}  WHERE user_id = {user_id}')
                                        cursor.execute(
                                            f'UPDATE mine SET hp = {100}  WHERE user_id = {user_id}')
                                        cursor.execute(
                                            f'UPDATE mine SET aquamarine = {aquamarine - 30}  WHERE user_id = {user_id}')

                                        cursor.execute(
                                            f'UPDATE mine SET diamonds = {diamonds - 25}  WHERE user_id = {user_id}')
                                        connect.commit()
                                    else:
                                        await bot.send_message(message.chat.id,
                                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нехватает Алмазов: {25 - diamonds} для покупки данной кирки {rloser}\n'
                                                               ,
                                                               parse_mode='html')

                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нехватает Аквамаринов: {30 - aquamarine} для покупки данной кирки {rloser}\n'
                                                           ,
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нехватает Опыта: {12500 - expe} для покупки данной кирки {rloser}\n'
                                                       ,
                                                       parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Купить кирку [1-6] {rloser}',
                                               parse_mode='html')
                        return
                if message.text.lower() in ['кирки']:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    await bot.send_message(message.chat.id, f'''
🎒<a href="tg://user?id={user_id}">{user_name}</a>,инвентарь
1.⛓ Железная кирка - Бесплатная
2.🟡 Золотая кирка - 2500💡 500⛓ 100 🟡
3.💎 Алмазная кирка - 5000💡 250⛓ 200 🟡 
4.♒️ Аметистовая кирка - 7500💡 100⛓  200🟡 50💎
5.💠 Аквамариновая кирка - 10000💡 10💎 5♒
6.🟢️ Изумрудная кирка - 12500💡 25💎 30💠

➖ Купить кирку 1-6
                                            ''', reply_markup=help_mine, parse_mode='html')

                if message.text.lower() in ['Продать бизнес', "продать бизнес"]:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])

                    business = cursor.execute(
                        "SELECT business from business where user_id = ?", (message.from_user.id,))
                    business = cursor.fetchone()
                    business = int(business[0])

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)

                    if business > 0:
                        if business == 1:
                            price = 5000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали бизнес за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE business SET business = {0}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE business SET workers =  {1} WHERE user_id = {user_id}')
                            connect.commit()
                        if business == 2:
                            price = 10000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали бизнес за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE business SET business = {0}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE business SET workers =  {1} WHERE user_id = {user_id}')
                            connect.commit()
                        if business == 3:
                            price = 30000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали бизнес за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE business SET business = {0}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE business SET workers =  {1} WHERE user_id = {user_id}')
                            connect.commit()
                        if business == 4:
                            price = 50000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали бизнес за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE business SET business = {0}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE business SET workers =  {1} WHERE user_id = {user_id}')
                            connect.commit()
                        if business == 5:
                            price = 70000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали бизнес за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE business SET business = {0}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE business SET workers =  {1} WHERE user_id = {user_id}')
                            connect.commit()
                        if business == 6:
                            price = 100000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали бизнес за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE business SET business = {0}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE business SET workers =  {1} WHERE user_id = {user_id}')
                            connect.commit()
                        if business == 7:
                            price = 500000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали бизнес за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE business SET business = {0}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE business SET workers =  {1} WHERE user_id = {user_id}')
                            connect.commit()
                        if business == 8:
                            price = 1000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали бизнес за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE business SET business = {0}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE business SET workers =  {1} WHERE user_id = {user_id}')
                            connect.commit()
                        if business == 9:
                            price = 50000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали бизнес за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE business SET business = {0}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE business SET workers =  {1} WHERE user_id = {user_id}')
                            connect.commit()
                        if business == 10:
                            price = 500000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали бизнес за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE business SET business = {0}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE business SET workers =  {1} WHERE user_id = {user_id}')
                            connect.commit()

                if message.text.lower() in ["Брак", "брак"]:
                    data = await get_rang(message)
                    if data is None:
                        return await message.reply(f"🚫 <b>Не найден в базе данных.</b>\n\n"
                                                   f"/start в лс у бота!")
                    user = message.from_user
                    usid = user.id
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?", (usid,))
                    user_name=cursor.fetchone()
                    user_name = user_name[0]
                    reply = message.reply_to_message
                    if reply:
                        replyuser = reply.from_user
                        rid = replyuser.id
                        ruser_name = cursor.execute("SELECT user_name from users where user_id = ?", (rid,))
                        ruser_name=cursor.fetchone()
                        ruser_name = ruser_name[0]

                        if data[53] == 0:
                            if replyuser.id == user.id:
                                return await message.reply(f"‼️  Вы не можете сделать брак с самим собой.")
                            replydata = await reply_get_rang(message)
                            if replydata[53] == 0:
                                marry_me.append(user.id)
                                marry_rep.append(replyuser.id)
                                await bot.send_message(message.chat.id,
                                                       f"💍 <a href='tg://user?id={rid}'>{ruser_name}</a>, минуточку внимания.\n💖 <a href='tg://user?id={usid}'>{user_name}</a> сделал вам предложение руки и сердца.\n😍 Принять решение можно нажав на одну из кнопок ниже.",
                                                       parse_mode='html', reply_markup=button_marry)
                            else:
                                replyuser = reply.from_user
                                rid = replyuser.id
                                repuser_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                                              (rid,))
                                repuser_name=cursor.fetchone()
                                repuser_name = repuser_name[0]
                                marry = cursor.execute("SELECT marry FROM users WHERE user_id=?", (rid,))
                                marry=cursor.fetchall()
                                marry1 = int(marry[0][0])
                                m_name = cursor.execute("SELECT user_name from users where user_id =?", (marry1,))
                                m_name=cursor.fetchone()
                                m_name = m_name[0]
                                return await message.reply(
                                    f"‼️  <a href='tg://user?id={rid}'>{repuser_name}</a> уже находится в браке с <a href='tg://user?id={marry1}'>{m_name}</a>!",
                                    parse_mode='html')
                        else:
                            user = message.from_user
                            usid = user.id
                            marry = cursor.execute("SELECT marry FROM users WHERE user_id=?", (usid,))
                            marry=cursor.fetchall()
                            marry1 = int(marry[0][0])

                            m_name = cursor.execute("SELECT user_name from users where user_id = ?", (marry1,))
                            m_name=cursor.fetchone()
                            m_name = m_name[0]
                            return await message.reply(
                                f"‼️  Вы уже находитесь в браке с <a href='tg://user?id={marry1}'>{m_name}</a>!",
                                parse_mode='html')

                if message.text.lower() in ["Развод", "развод"]:
                    data = await get_rang(message)
                    if data is None:
                        return await message.reply(f"🚫 <b>Не найден в базе данных.</b>\n\n"
                                                   f"/start в лс у бота!")
                    user = message.from_user
                    name = quote_html(user.full_name)
                    if data[53] == 0:
                        return await message.reply(f"‼️ Вы не состоите не с кем в браке!")
                    else:
                        marry = cursor.execute("SELECT marry FROM users WHERE user_id=?", (user.id,))
                        marry=cursor.fetchall()
                        marred = await bot.get_chat(str(marry[0][0]))
                        mname = quote_html(marred.full_name)

                        divorce_me.append(user.id)
                        divorce_rep.append(marred.id)
                        await bot.send_message(message.chat.id,
                                               f"📝 Убедить что вы согласны разводится.\n💔 Принять решение можно нажав на одну из кнопок ниже.",
                                               parse_mode='html', reply_markup=button_divorce)

                if message.text.lower() in ["Мой брак", "мой брак"]:
                    data = await get_rang(message)
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name=cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    if data[53] == 0:
                        await bot.send_message(message.chat.id,
                                               f"💔 | <a href='tg://user?id={user_id}'>{user_name}</a>, вы пока не состоите ни с кем в браке",
                                               parse_mode='html')
                    else:
                        marry = cursor.execute("SELECT marry FROM users WHERE user_id = ?", (message.from_user.id,))
                        marry=cursor.fetchone()
                        marry = int(marry[0])
                        mname = cursor.execute("SELECT user_name FROM users WHERE user_id=?", (marry,))
                        mname=cursor.fetchone()
                        mname = mname[0]

                        get = cursor.execute("SELECT marry_date FROM users WHERE user_id=?", (message.from_user.id,))
                        get=cursor.fetchall()

                        date_time =datetime.fromisoformat(str(get[0][0]))

                        times = date_time.strftime("%Y.%m.%d %H:%M:?")
                        await bot.send_message(message.chat.id,
                                               f"❤️ Брак между <a href='tg://user?id={user_id}'>{user_name}</a> и <a href='tg://user?id={marry}'>{mname}</a>:\n📆 Зарегистрирован: {times}",
                                               parse_mode='html')

                ######################################################ЯХТЫ##############################################################
                if message.text.lower() in ['Продать яхту', "продать яхту"]:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])

                    yacht = cursor.execute(
                        "SELECT yacht from property where user_id = ?", (message.from_user.id,))
                    yacht = cursor.fetchone()
                    yacht = int(yacht[0])

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)

                    if yacht > 0:
                        if yacht == 1:
                            price = 1000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали яхту за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET yacht = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if yacht == 2:
                            price = 10000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали яхту за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET yacht = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if yacht == 3:
                            price = 30000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали яхту за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET yacht = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if yacht == 4:
                            price = 100000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали яхту за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET yacht = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if yacht == 5:
                            price = 500000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали яхту за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET yacht = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if yacht == 6:
                            price = 800000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали яхту за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET yacht = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if yacht == 7:
                            price = 5000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали яхту за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET yacht = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if yacht == 8:
                            price = 15000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали яхту за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET yacht = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if yacht == 9:
                            price = 40000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали яхту за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET yacht = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if yacht == 10:
                            price = 90000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали яхту за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET yacht = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if yacht == 11:
                            price = 200000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали яхту за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET yacht = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if yacht == 12:
                            price = 600000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали яхту за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET yacht = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if yacht == 13:
                            price = 1600000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали яхту за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET yacht = {0}  WHERE user_id = {user_id}')
                            connect.commit()

                if message.text.startswith("Купить яхту") or message.text.startswith("купить яхту"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    if message.text != 'Купить яхту':
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])

                        yacht = cursor.execute(
                            "SELECT yacht from property where user_id = ?", (message.from_user.id,))
                        yacht = cursor.fetchone()
                        yacht = int(yacht[0])

                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)
                        try:
                            nomer = int(message.text.split()[2])
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Купить яхту 1 ')
                            return



                        if nomer == 1:
                            price = 1000000
                            if balance >= price:
                                if yacht < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили яхту "Ванна" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET yacht = {1}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть яхта {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 2:
                            price = 10000000
                            if balance >= price:
                                if yacht < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили яхту "Nauticat 331" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET yacht = {2}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть яхта {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 3:
                            price = 30000000
                            if balance >= price:
                                if yacht < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили яхту "Nordhavn 56 MS" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET yacht = {3}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть яхта {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 4:
                            price = 100000000
                            if balance >= price:
                                if yacht < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили яхту "Princess 60" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET yacht = {4}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть яхта {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 5:
                            price = 500000000
                            if balance >= price:
                                if yacht < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили яхту "Bayliner 288" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET yacht = {5}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть яхта {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 6:
                            price = 800000000
                            if balance >= price:
                                if yacht < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили яхту "Dominator 40M" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET yacht = {6}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть яхта {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 7:
                            price = 5000000000
                            if balance >= price:
                                if yacht < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили яхту "Sessa Marine C42" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET yacht = {7}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть яхта {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 8:
                            price = 15000000000
                            if balance >= price:
                                if yacht < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили яхту "Wider 150" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET yacht = {8}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть яхта {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 9:
                            price = 40000000000
                            if balance >= price:
                                if yacht < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили яхту "Palmer Johnson 42M SuperSport" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET yacht = {9}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть яхта {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 10:
                            price = 90000000000
                            if balance >= price:
                                if yacht < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили яхту "Serene" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET yacht = {10}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть яхта {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 11:
                            price = 200000000000
                            if balance >= price:
                                if yacht < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили яхту "Dubai" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET yacht = {11}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть яхта {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')

                        if nomer == 12:
                            price = 600000000000
                            if balance >= price:
                                if yacht < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили яхту "Azzam" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET yacht = {12}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть яхта {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 13:
                            price = 1600000000000
                            if balance >= price:
                                if yacht < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили яхту "Streets of Monaco" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET yacht = {13}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть яхта {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Купить яхту [номер] {rloser}',
                                               parse_mode='html')
                        return
                if message.text.lower() in ['Яхты', 'яхты']:
                    name = message.from_user.get_mention(as_html=True)
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    await bot.send_message(message.chat.id, f'''
<a href="tg://user?id={user_id}">{user_name}</a>, доступные яхты:
🛳 1. Ванна - 1.000.000₸ 
🛳 2. Nauticat 331 - 10.000.000₸ 
🛳 3. Nordhavn 56 MS - 30.000.000₸ 
🛳 4. Princess 60 - 100.000.000₸ 
🛳 5. Bayliner 288 - 500.000.000₸ 
🛳 6. Dominator 40M - 800.000.000₸ 
🛳 7. Sessa Marine C42 - 5.000.000.000₸ 
🛳 8. Wider 150 - 15.000.000.000₸ 
🛳 9. Palmer Johnson 42M SuperSport - 40.000.000.000₸ 
🛳 10. Serene - 90.000.000.000₸ 
🛳 11. Dubai - 200.000.000.000₸ 
🛳 12. Azzam - 600.000.000.000₸ 
🛳 13. Streets of Monaco - 1.600.000.000.000₸ 

🛒 Для покупки яхты введите "Купить яхту [номер]"
                        ''', parse_mode='html')
                ######################################################ВЕРТОЛЁТЫ#########################################################
                if message.text.startswith("Купить вертолёт") or message.text.startswith("купить вертолёт"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    if message.text != 'Купить вертолёт':
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])

                        helicopter = cursor.execute("SELECT helicopter from property where user_id = ?",
                                                    (message.from_user.id,))
                        helicopter = cursor.fetchone()
                        helicopter = int(helicopter[0])

                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)
                        try:
                            nomer = int(message.text.split()[2])
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Купить вертолёт 1 ')
                            return


                        if nomer == 1:
                            price = 100000
                            if balance >= price:
                                if helicopter < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a> вы успешно купили вертолёт "Воздушный шар" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET helicopter = {1}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть вертолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 2:
                            price = 3500000
                            if balance >= price:
                                if helicopter < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили вертолёт "RotorWay Exec 162F" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET helicopter = {2}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть вертолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 3:
                            price = 10000000
                            if balance >= price:
                                if helicopter < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили вертолёт "Robinson R44" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET helicopter = {3}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть вертолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 4:
                            price = 30000000
                            if balance >= price:
                                if helicopter < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили вертолёт "Hiller UH-12C" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET helicopter = {4}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть вертолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 5:
                            price = 63400000
                            if balance >= price:
                                if helicopter < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили вертолёт "AW119 Koala" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET helicopter = {5}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть вертолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 6:
                            price = 150000000
                            if balance >= price:
                                if helicopter < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили вертолёт "MBB BK 117" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET helicopter = {6}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть вертолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 7:
                            price = 350000000
                            if balance >= price:
                                if helicopter < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили вертолёт "Eurocopter EC130" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET helicopter = {7}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть вертолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 8:
                            price = 750000000
                            if balance >= price:
                                if helicopter < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили вертолёт "Leonardo AW109 Power" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET helicopter = {8}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть вертолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 9:
                            price = 1240000000
                            if balance >= price:
                                if helicopter < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили вертолёт "Sikorsky S-76" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET helicopter = {9}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть вертолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 10:
                            price = 8890000000
                            if balance >= price:
                                if helicopter < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили вертолёт "Bell 429WLG" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET helicopter = {10}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть вертолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 11:
                            price = 88330000000
                            if balance >= price:
                                if helicopter < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили вертолёт "NHI NH90" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET helicopter = {11}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть вертолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')

                        if nomer == 12:
                            price = 225750000000
                            if balance >= price:
                                if helicopter < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили вертолёт "Kazan Mi-35M" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET helicopter = {12}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть вертолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 13:
                            price = 945300000000
                            if balance >= price:
                                if helicopter < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили вертолёт "Bell V-22 Osprey" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET plane = {13}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть вертолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Купить вертолёт [номер] {rloser}',
                                               parse_mode='html')
                        return

                if message.text.lower() in ['Продать вертолёт', "продать вертолёт"]:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])

                    helicopter = cursor.execute("SELECT helicopter from property where user_id = ?",
                                                (message.from_user.id,))
                    helicopter = cursor.fetchone()
                    helicopter = int(helicopter[0])

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)

                    if helicopter > 0:
                        if helicopter == 1:
                            price = 100000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали вертолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET helicopter = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if helicopter == 2:
                            price = 3500000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали вертолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET helicopter = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if helicopter == 3:
                            price = 10000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали вертолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET helicopter = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if helicopter == 4:
                            price = 30000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали вертолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET helicopter = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if helicopter == 5:
                            price = 63400000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали вертолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET helicopter = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if helicopter == 6:
                            price = 150000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали вертолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET helicopter = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if helicopter == 7:
                            price = 350000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали вертолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET helicopter = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if helicopter == 8:
                            price = 750000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали вертолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET helicopter = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if helicopter == 9:
                            price = 1240000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали вертолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET helicopter = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if helicopter == 10:
                            price = 8890000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали вертолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET helicopter = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if helicopter == 11:
                            price = 88330000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали вертолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET helicopter = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if helicopter == 12:
                            price = 225750000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали вертолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET helicopter = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if helicopter == 13:
                            price = 945300000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали вертолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET helicopter = {0}  WHERE user_id = {user_id}')
                            connect.commit()

                if message.text.lower() in ['Вертолёты', 'вертолёты']:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    await bot.send_message(message.chat.id, f'''
<a href="tg://user?id={user_id}">{user_name}</a>, доступные вертолёты:
🚁 1. Воздушный шар - 100.000₸ 
🚁 2. RotorWay Exec 162F - 3.500.000₸ 
🚁 3. Robinson R44 - 10.000.000₸ 
🚁 4. Hiller UH-12C - 30.000.000₸ 
🚁 5. AW119 Koala - 63.400.000₸ 
🚁 6. MBB BK 117 - 150.000.000₸ 
🚁 7. Eurocopter EC130 - 350.000.000₸ 
🚁 8. Leonardo AW109 Power - 750.000.000₸ 
🚁 9. Sikorsky S-76 - 1.240.000.000₸ 
🚁 10. Bell 429WLG - 8.890.000.000₸ 
🚁 11. NHI NH90 - 88.330.000.000₸ 
🚁 12. Kazan Mi-35M - 225.750.000.000₸ 
🚁 13. Bell V-22 Osprey - 945.300.000.000₸ 

🛒 Для покупки вертолёта введите "Купить вертолет [номер]"
                        ''', parse_mode='html')
                ######################################################САМОЛЁТЫ##########################################################
                if message.text.lower() in ['Продать самолёт', "продать самолёт"]:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name=cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])

                    plane = cursor.execute(
                        "SELECT plane from property where user_id = ?", (message.from_user.id,))
                    plane = cursor.fetchone()
                    plane = int(plane[0])

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)

                    if plane > 0:
                        if plane == 1:
                            price = 100000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали самолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET plane = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if plane == 2:
                            price = 350000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали самолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET plane = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if plane == 3:
                            price = 700000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали самолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET plane = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if plane == 4:
                            price = 1000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали самолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET plane = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if plane == 5:
                            price = 1400000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали самолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET plane = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if plane == 6:
                            price = 2600000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали самолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET plane = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if plane == 7:
                            price = 5500000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали самолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET plane = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if plane == 8:
                            price = 8800000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали самолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET plane = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if plane == 9:
                            price = 450000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали самолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET plane = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if plane == 10:
                            price = 800000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали самолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET plane = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if plane == 11:
                            price = 1600000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали самолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET plane = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if plane == 12:
                            price = 2250000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали самолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET plane = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if plane == 13:
                            price = 3500000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали самолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET plane = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if plane == 14:
                            price = 4000000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали самолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET plane = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if plane == 15:
                            price = 6000000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали самолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET plane = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if plane == 16:
                            price = 13500000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали самолёт за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET plane = {0}  WHERE user_id = {user_id}')
                            connect.commit()

                if message.text.startswith("Купить самолёт") or message.text.startswith("купить самолёт"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    if message.text != 'Купить самолёт':
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])

                        plane = cursor.execute(
                            "SELECT plane from property where user_id = ?", (message.from_user.id,))
                        plane = cursor.fetchone()
                        plane = int(plane[0])

                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)
                        try:
                            nomer = int(message.text.split()[2])
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Купить самолёт 1 ')
                            return


                        if nomer == 1:
                            price = 100000000
                            if balance >= price:
                                if plane < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили самолёт "Параплан" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET plane = {1}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть самолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 2:
                            price = 350000000
                            if balance >= price:
                                if plane < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили самолёт "Параплан" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET plane = {2}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть самолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 3:
                            price = 700000000
                            if balance >= price:
                                if plane < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили самолёт "Cessna-172E" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET plane = {3}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть самолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 4:
                            price = 1000000000
                            if balance >= price:
                                if plane < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили самолёт "BRM NG-5" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET plane = {4}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть самолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 5:
                            price = 1400000000
                            if balance >= price:
                                if plane < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили самолёт "Cessna T210" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET plane = {5}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть самолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 6:
                            price = 2600000000
                            if balance >= price:
                                if plane < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили самолёт "Beechcraft 1900D" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET plane = {6}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть самолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 7:
                            price = 5500000000
                            if balance >= price:
                                if plane < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили самолёт "Cessna 550" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET plane = {7}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть самолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 8:
                            price = 8800000000
                            if balance >= price:
                                if plane < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили самолёт "Hawker 4000" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET plane = {8}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть самолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 9:
                            price = 450000000000
                            if balance >= price:
                                if plane < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили самолёт "Learjet 31" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET plane = {9}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть самолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 10:
                            price = 800000000000
                            if balance >= price:
                                if plane < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили самолёт "Airbus A318" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET plane = {10}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть самолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 11:
                            price = 1600000000000
                            if balance >= price:
                                if plane < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили самолёт "F-35A" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET plane = {11}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть самолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')

                        if nomer == 12:
                            price = 2250000000000
                            if balance >= price:
                                if plane < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили самолёт "Boeing 747-430" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET plane = {12}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть самолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 13:
                            price = 3500000000000
                            if balance >= price:
                                if plane < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили самолёт "C-17A Globemaster III" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET plane = {13}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть самолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 14:
                            price = 4000000000000
                            if balance >= price:
                                if plane < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили самолёт "F-22 Raptor" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET plane = {14}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть самолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 15:
                            price = 6000000000000
                            if balance >= price:
                                if plane < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили самолёт "Airbus 380 Custom" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET plane = {15}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть самолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 16:
                            price = 13500000000000
                            if balance >= price:
                                if plane < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили самолёт "B-2 Spirit Stealth Bomber" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET plane = {16}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть самолёт {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Купить самолёт [номер] {rloser}',
                                               parse_mode='html')
                        return
                if message.text.lower() in ['Самолёты', "самолёты"]:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    await bot.send_message(message.chat.id, f'''
<a href="tg://user?id={user_id}">{user_name}</a>, доступные самолеты:
✈️ 1. Параплан - 100.000.000₸ 
✈️ 2. АН-2 - 350.000.000₸ 
✈️ 3. Cessna-172E - 700.000.000₸ 
✈️ 4. BRM NG-5 - 1.000.000.000₸ 
✈️ 5. Cessna T210 - 1.400.000.000₸ 
✈️ 6. Beechcraft 1900D - 2.600.000.000₸ 
✈️ 7. Cessna 550 - 5.500.000.000₸ 
✈️ 8. Hawker 4000 - 8.800.000.000₸ 
✈️ 9. Learjet 31 - 450.000.000.000₸ 
✈️ 10. Airbus A318 - 800.000.000.000₸ 
✈️ 11. F-35A - 1.600.000.000.000₸ 
✈️ 12. Boeing 747-430 - 2.250.000.000.000₸ 
✈️ 13. C-17A Globemaster III - 3.500.000.000.000₸ 
✈️ 14. F-22 Raptor - 4.000.000.000.000₸ 
✈️ 15. Airbus 380 Custom - 6.000.000.000.000₸ 
✈️ 16. B-2 Spirit Stealth Bomber - 13.500.000.000.000₸ 

🛒 Для покупки самолёта введите "Купить самолёт [номер]"
                        ''', parse_mode='html')

                if message.text.startswith("Купить телефон") or message.text.startswith("купить телефон"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    if message.text != 'Купить телефон':

                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])

                        phone = cursor.execute(
                            "SELECT phone from property where user_id = ?", (message.from_user.id,))
                        phone = cursor.fetchone()
                        phone = int(phone[0])

                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)
                        try:
                            nomer = int(message.text.split()[2])
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Купить телефон 1 ')
                            return



                        if nomer == 1:
                            price = 100000
                            if balance >= price:
                                if phone < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили телефон "Nokia 3310" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET phone = {1}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a> у вас уже есть телефон {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 2:
                            price = 3500000
                            if balance >= price:
                                if phone < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили телефон "ASUS ZenFone 4" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET phone = {2}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть телефон {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 3:
                            price = 10000000
                            if balance >= price:
                                if phone < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили телефон "BQ Aquaris X" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET phone = {3}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть телефон {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 4:
                            price = 30000000
                            if balance >= price:
                                if phone < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили телефон "Huawei P40" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET phone = {4}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть телефон {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 5:
                            price = 63400000
                            if balance >= price:
                                if phone < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили телефон "Samsung Galaxy S21 Ultra" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET phone = {5}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть телефон {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 6:
                            price = 150000000
                            if balance >= price:
                                if phone < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили телефон "Xiaomi Mi 11" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET phone = {6}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть телефон {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 7:
                            price = 350000000
                            if balance >= price:
                                if phone < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили телефон "iPhone 11 Pro" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET phone = {7}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть телефон {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 8:
                            price = 750000000
                            if balance >= price:
                                if phone < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили телефон "iPhone 12 Pro Max" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET phone = {8}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть телефон {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 9:
                            price = 1240000000
                            if balance >= price:
                                if phone < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили телефон "Blackberry" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET phone = {9}  WHERE user_id = {user_id}')
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть телефон {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Купить телефон [номер] {rloser}',
                                               parse_mode='html')
                        return
                if message.text.lower() in ['Продать телефон', "продать телефон"]:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])

                    phone = cursor.execute(
                        "SELECT phone from property where user_id = ?", (message.from_user.id,))
                    phone = cursor.fetchone()
                    phone = int(phone[0])

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)

                    if phone > 0:
                        if phone == 1:
                            price = 100000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали телефон за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET phone = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if phone == 2:
                            price = 3500000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали телефон за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET phone = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if phone == 3:
                            price = 10000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали телефон за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET phone = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if phone == 4:
                            price = 30000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали телефон за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET phone = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if phone == 5:
                            price = 63400000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали телефон за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET phone = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if phone == 6:
                            price = 150000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали телефон за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET phone = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if phone == 7:
                            price = 350000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали телефон за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET phone = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if phone == 8:
                            price = 750000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали телефон за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET phone = {0}  WHERE user_id = {user_id}')
                            connect.commit()
                        if phone == 9:
                            price = 1240000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали телефон за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET phone = {0}  WHERE user_id = {user_id}')
                            connect.commit()

                if message.text.lower() in ['Телефоны', "телефоны"]:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    await bot.send_message(message.chat.id, f'''
<a href="tg://user?id={user_id}">{user_name}</a>, доступные телефоны:
📱 1. Nokia 3310 - 100.000₸ 
📱 2. ASUS ZenFone 4 - 3.500.000₸ 
📱 3. BQ Aquaris X - 10.000.000₸ 
📱 4. Huawei P40 - 30.000.000₸ 
📱 5. Samsung Galaxy S21 Ultra - 63.400.000₸ 
📱 6. Xiaomi Mi 11 - 150.000.000₸ 
📱 7. iPhone 11 Pro - 350.000.000₸ 
📱 8. iPhone 12 Pro Max - 750.000.000₸ 
📱 9. Blackberry - 1.240.000.000₸ 

🛒 Для покупки телефона введите "Купить телефон [номер]"''', parse_mode='html')

                #####################################################МАШИНЫ#############################################################
                if message.text.lower() in ['Продать машину', "продать машину"]:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])

                    cars = cursor.execute(
                        "SELECT cars from property where user_id = ?", (message.from_user.id,))
                    cars = cursor.fetchone()
                    cars = int(cars[0])

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)

                    if cars > 0:
                        if cars == 1:
                            price = 10000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 2:
                            price = 15000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 3:
                            price = 30000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 4:
                            price = 50000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 5:
                            price = 90000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 6:
                            price = 100000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 7:
                            price = 250000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 8:
                            price = 400000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 9:
                            price = 600000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 10:
                            price = 900000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 11:
                            price = 1400000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 12:
                            price = 2500000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 13:
                            price = 6000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 14:
                            price = 8000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 15:
                            price = 10000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 16:
                            price = 40000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 17:
                            price = 100000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 18:
                            price = 300000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 19:
                            price = 500000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 20:
                            price = 700000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 21:
                            price = 900000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 22:
                            price = 210000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 23:
                            price = 310000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 24:
                            price = 443000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 25:
                            price = 643000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                        if cars == 26:
                            price = 943000000000
                            price2 = price / 2
                            price3 = '{:,}'.format(price2)

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно продали машину за {price3}₸  ',
                                                   parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET balance = {balance + price2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE property SET cars = {0}  WHERE user_id = {user_id}')
                            cursor.execute(f"DELETE from cars where user_id = {user_id}")
                            connect.commit()
                    else:
                        await bot.send_message(message.chat.id,
                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нет данного имущества {rloser}',parse_mode='html')
                if message.text.startswith(".реши"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    nomer1 = message.text.split(".реши")[1]
                    result=calc(nomer1)
                    if result is None:
                        await bot.send_message(message.chat.id,f"<b>❌ Не удалось решить ваш пример:</b> <code> {nomer1} </code>" ,parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'<b>🔣 Ваш пример:</b> <code>{nomer1}</code>\n<b>📟 Решение:</b> <code>{result}</code>',
                                               parse_mode='html')

                if message.text.startswith("Промо создать") or message.text.startswith("промо создать"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    try:
                        name = message.text.split()[2]
                        summ = message.text.split()[3]
                        act =int(message.text.split()[4])
                        comment = " ".join(message.text.split()[5:])
                    except:
                        await message.reply('‼️ Не хватает аргументов!\nПример:\nПромо создать [название] [сумма] [активаций] [комментарий]')
                        return
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])
                    try:
                        su2 = (summ).replace('к', '000')
                        su3 = (su2).replace('м', '000000')
                        su4 = float(su3)
                        summ1 = int(su4)
                    except:
                        await message.reply('‼️ Проверьте правильность ввода команды')
                        return
                    if summ1>0 and act >0:
                        if balance >= summ1 * act:
                            f=cursor.execute(f"SELECT name FROM promo WHERE name='{name}'")
                            f=cursor.fetchone()
                            if f is None:
                                cursor.execute(f"UPDATE users SET balance={balance - (summ1 * act)} WHERE user_id={user_id}")
                                cursor.execute(f"INSERT INTO promo VALUES(?,?,?,?,?,?);",(user_id,user_name,act,summ1,name,comment))
                                suu=summ1*act
                                summ2 = '{:,}'.format(suu).replace(',', '.')
                                act2 = '{:,}'.format(act).replace(',', '.')
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, Вы успешно создали промокод \n'
                                                       f'📄 Название: <code>{name}</code>\n'
                                                       f'🧮 Активаций: {act2}\n'
                                                       f'💰 Всего потрачено: {summ2}₸\n'
                                                       f'✉️Комментарий: <i>{comment}</i>',
                                                       parse_mode='html')
                                await bot.send_message(cfg.log_group, f"""
⚙️LOG: #промосозд
<a href="tg://user?id={user_id}">{user_name}</a>(<code>{user_id}</code>)  создал промокод
📄 Название: <code>{name}</code>
🧮 Активаций: {act2}
💰 Всего потрачено: {summ2}₸
✉️Комментарий: <i>{comment}</i>',
""", parse_mode='html')
                                connect.commit()
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, С таким название промокод уже существует',
                                                       parse_mode='html')
                        else:
                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, Недостаточно средств для создания промокода',
                                                   parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, Сумма должна быть положительной',
                                               parse_mode='html')
                if message.text.startswith("Ответ") or message.text.startswith("ответ"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    try:

                        name = message.text
                        name=name[6:]
                        name=name.lower()
                    except:
                        await message.reply(
                            'Не хватает аргументов!\nПример:\nОтвет [название] ')
                        return
                    f = cursor.execute(f"SELECT puzz_name FROM puzzles WHERE puzz_name='{name}'")
                    f = cursor.fetchone()
                    if f != None:
                        act = cursor.execute(f"SELECT activate FROM puzzles WHERE puzz_name='{name}'")
                        act = cursor.fetchone()
                        if int(act[0]) > 0:

                            summ = cursor.execute(f"SELECT balance FROM puzzles WHERE puzz_name='{name}'")
                            summ = cursor.fetchone()
                            summ=int(summ[0])
                            summ2 = '{:,}'.format(summ).replace(',', '.')
                            balance = cursor.execute(
                                "SELECT balance from users where user_id = ?", (message.from_user.id,))
                            balance = cursor.fetchone()
                            balance = int(balance[0])

                            cursor.execute(f"UPDATE users SET balance={summ + balance} WHERE user_id={user_id}")
                            cursor.execute(f"UPDATE puzzles SET activate={0} WHERE puzz_name='{name}'")

                            connect.commit()
                            await bot.send_message(chat_id=cfg.channel_offical,
                                                   text=f'🎉 Разгадал(-a) загадку <a href="tg://user?id={user_id}">{user_name}</a>\n'
                                                        f'✅ Ответ на загадку: {name}',parse_mode='html')

                            await bot.send_message(message.chat.id,
                                                   f'🎉 <a href="tg://user?id={user_id}">{user_name}</a>, Вы успешно разгадали загадку на сумму: {summ2}₸\n'
                                                   ,
                                                   parse_mode='html')

                        else:

                            await bot.send_message(message.chat.id,
                                                   f'🙁 <a href="tg://user?id={user_id}">{user_name}</a>, Данную загадку уже разгадали',
                                                   parse_mode='html')
                    else:

                        await bot.send_message(message.chat.id,
                                               f'🙁 <a href="tg://user?id={user_id}">{user_name}</a>, Неправильный ответ на загадку!',
                                               parse_mode='html')
                if message.text.startswith("Промо") or message.text.startswith("промо"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    try:
                        name = message.text.split()[1]

                    except:
                        await message.reply(
                            'Не хватает аргументов!\nПример:\nПромо [название] ')
                        return
                    f = cursor.execute(f"SELECT name FROM promo WHERE name='{name}'")
                    f = cursor.fetchone()
                    if f != None:
                        act = cursor.execute(f"SELECT activ FROM promo WHERE name='{name}'")
                        act = cursor.fetchone()
                        if int(act[0]) > 0:
                            r = cursor.execute(
                                f"SELECT name FROM promold WHERE name='{name}'and user_id={message.from_user.id} ")
                            r = cursor.fetchone()

                            if r is None:
                                summ = cursor.execute(f"SELECT summ FROM promo WHERE name='{name}'")
                                summ = cursor.fetchone()
                                summ = int(summ[0])
                                summ2 = '{:,}'.format(summ).replace(',', '.')
                                balance = cursor.execute(
                                    "SELECT balance from users where user_id = ?", (message.from_user.id,))
                                balance = cursor.fetchone()
                                balance = int(balance[0])
                                comment = cursor.execute(f"SELECT comment FROM promo WHERE name='{name}'")
                                comment = cursor.fetchone()
                                cursor.execute(
                                    f"UPDATE users SET balance={summ + balance} WHERE user_id={user_id}")
                                cursor.execute(
                                    f"UPDATE promo SET activ={int(act[0]) - 1} WHERE name='{name}'")
                                cursor.execute("INSERT INTO promold VALUES(?,?,?);",
                                               (user_id, user_name, name))
                                connect.commit()
                                await bot.send_message(cfg.log_group, f"""
    ⚙️LOG: #промоактив
    <a href="tg://user?id={user_id}">{user_name}</a>(<code>{user_id}</code>)  активировал промокод
    📄 Название: <code>{name}</code>
    💰 На сумму: {summ2}₸
    """, parse_mode='html')
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>,Вы успешно активировали промокод на сумму : {summ2}\n'
                                                       f'✉️Комментарий: {comment[0]} ',
                                                       parse_mode='html')
                            else:

                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>,Данный промокод вы уже использовали',
                                                       parse_mode='html')
                        else:

                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>,Данный промокод использовали максимально человек',
                                                   parse_mode='html')
                    else:

                        await bot.send_message(message.chat.id,
                                               f'<a href="tg://user?id={user_id}">{user_name}</a>,Данного промокода не существует',
                                               parse_mode='html')
                if message.text.startswith("Купить машину") or message.text.startswith("купить машину"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    if message.text != 'Купить машину':

                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])

                        cars = cursor.execute(
                            "SELECT cars from property where user_id = ?", (message.from_user.id,))
                        cars = cursor.fetchone()
                        cars = int(cars[0])

                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)
                        try:
                            nomer = int(message.text.split()[2])
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Купить машину 1 ')
                            return


                        if nomer == 1:
                            price = 10000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Самокат" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {1}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 2:
                            price = 15000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Велосипед" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {2}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 3:
                            price = 30000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Гироскутер" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {3}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 4:
                            price = 50000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Сегвей" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {4}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 5:
                            price = 90000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Мопед" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {5}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 6:
                            price = 100000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Мотоцикл" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {6}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 7:
                            price = 250000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "ВАЗ 2109" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {7}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 8:
                            price = 400000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Квадроцикл" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {8}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 9:
                            price = 600000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Багги" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {9}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 10:
                            price = 900000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Вездеход" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {10}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 11:
                            price = 1400000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Лада Xray" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {11}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')

                        if nomer == 12:
                            price = 2500000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Audi Q7" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {12}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 13:
                            price = 6000000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "BMW X6" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {13}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 14:
                            price = 8000000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Toyota FT-HS" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {14}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 15:
                            price = 10000000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "BMW Z4 M" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {15}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 16:
                            price = 40000000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Subaru WRX STI" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {16}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 17:
                            price = 100000000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Lamborghini Veneno" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {17}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 18:
                            price = 300000000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Tesla Roadster" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {18}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 19:
                            price = 500000000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Yamaha YZF R6" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {19}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 20:
                            price = 700000000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Bugatti Chiron" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {20}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 21:
                            price = 900000000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Thrust SSC" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {21}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 22:
                            price = 2100000000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Ferrari LaFerrari" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {22}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 23:
                            price = 3100000000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Koenigsegg Regear" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {23}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 24:
                            price = 4430000000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Tesla Semi" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {24}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 25:
                            price = 6430000000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Venom GT" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {25}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')
                        if nomer == 26:
                            price = 9430000000000
                            if balance >= price:
                                if cars < 1:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, вы успешно купили машину "Rolls-Royce" 🎉',
                                                           parse_mode='html')
                                    cursor.execute(
                                        f"UPDATE property SET have = 'on'  WHERE user_id = {user_id}")
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - price}  WHERE user_id = {user_id}')
                                    cursor.execute(
                                        f'UPDATE property SET cars = {26}  WHERE user_id = {user_id}')
                                    cursor.execute("INSERT INTO cars VALUES(?, ?, ?, ?);",
                                                   (user_id, user_name, 120, 120))
                                    connect.commit()
                                else:
                                    await bot.send_message(message.chat.id,
                                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас уже есть машина {rloser}',
                                                           parse_mode='html')
                            else:
                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас недостаточно средств для покупки данного имущества {rloser}',
                                                       parse_mode='html')

                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Купить машину [номер] {rloser}',
                                               parse_mode='html')
                        return

                if message.text.lower() in ['Машины', "машины"]:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    await bot.send_message(message.chat.id, f'''<a href="tg://user?id={user_id}">{user_name}</a>, доступные машины:
🚗 1. Самокат - 10.000.000₸ 
🚗 2. Велосипед - 15.000.000₸ 
🚗 3. Гироскутер - 30.000.000₸ 
🚗 4. Сегвей - 50.000.000₸ 
🚗 5. Мопед - 90.000.000₸ 
🚗 6. Мотоцикл - 100.000.000₸ 
🚗 7. ВАЗ 2109 - 250.000.000₸ 
🚗 8. Квадроцикл - 400.000.000₸ 
🚗 9. Багги - 600.000.000₸ 
🚗 10. Вездеход - 900.000.000₸ 
🚗 11. Лада Xray - 1.400.000.000₸ 
🚗 12. Audi Q7 - 2.500.000.000₸ 
🚗 13. BMW X6 - 6.000.000.000₸ 
🚗 14. Toyota FT-HS - 8.000.000.000₸ 
🚗 15. BMW Z4 M - 10.000.000.000₸ 
🚗 16. Subaru WRX STI - 40.000.000.000₸ 
🚗 17. Lamborghini Veneno - 100.000.000.000₸ 
🚗 18. Tesla Roadster - 300.000.000.000₸ 
🚗 19. Yamaha YZF R6 - 500.000.000.000₸ 
🚗 20. Bugatti Chiron - 700.000.000.000₸ 
🚗 21. Thrust SSC - 900.000.000.000₸ 
🚗 22. Ferrari LaFerrari - 2.100.000.000.000₸ 
🚗 23. Koenigsegg Regear - 3.100.000.000.000₸ 
🚗 24. Tesla Semi - 4.430.000.000.000₸ 
🚗 25. Venom GT - 6.430.000.000.000₸ 
🚗 26. Rolls-Royce - 9.430.000.000.000₸ 

🛒 Для покупки машины введите "Купить машину [номер]"''', parse_mode='html')

                ##########################################ШАХТА#########################################################################
                if message.text.startswith('продать изумруды') or message.text.startswith('Продать изумруды'):
                    try:
                        su = msg.text.split()[2]
                        su2 = (su).replace('к', '000')
                        su3 = (su2).replace('м', '000000')
                        su4 = (su3).replace('.', '')
                        su5 = float(su4)
                        summ = int(su5)

                    except:
                        await message.reply('‼️  Неправильный ввод команды!\nПример: Продать изумруды 1 ')
                        return
                    user_id = message.from_user.id
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    emeralds = cursor.execute(
                        "SELECT emeralds From mine where user_id = ?", (message.from_user.id,))
                    emeralds = cursor.fetchone()
                    emeralds = int(emeralds[0])

                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])

                    price = summ * 250000000
                    price2 = '{:,}'.format(price).replace(',', '.')
                    price3 = emeralds - summ
                    if emeralds <= 0:
                        await bot.send_message(message.chat.id,
                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нет изумрудов {rloser}',
                                               parse_mode='html')
                        return
                    if emeralds > 0:
                        if summ > 0:
                            if price3 >= 0:
                                await bot.send_message(message.chat.id, f'вы продали все свои изумруды за {price2}₸  ✅',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE mine SET emeralds = {emeralds - summ}  WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance + price}  WHERE user_id = {user_id}')
                                connect.commit()
                            else:

                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, У вас нет столько руды {rloser}',
                                                       parse_mode='html')
                        else:
                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, Введите положительное число {rloser}',
                                                   parse_mode='html')
                if message.text.startswith('продать аквамарин') or message.text.startswith('Продать аквамарин'):
                    try:
                        su = msg.text.split()[2]
                        su2 = (su).replace('к', '000')
                        su3 = (su2).replace('м', '000000')
                        su4 = (su3).replace('.', '')
                        su5 = float(su4)
                        summ = int(su5)

                    except:
                        await message.reply('‼️  Неправильный ввод команды!\nПример: Продать аквамарин 1 ')
                        return
                    user_id = message.from_user.id
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    aquamarine = cursor.execute(
                        "SELECT aquamarine From mine where user_id = ?", (message.from_user.id,))
                    aquamarine = cursor.fetchone()
                    aquamarine = int(aquamarine[0])

                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])

                    price = summ * 125000000
                    price2 = '{:,}'.format(price).replace(',', '.')
                    price3 = aquamarine - summ
                    if aquamarine <= 0:
                        await bot.send_message(message.chat.id,
                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нет аквамаринов {rloser}',
                                               parse_mode='html')
                        return
                    if aquamarine > 0:
                        if summ > 0:
                            if price3 >= 0:
                                await bot.send_message(message.chat.id, f'вы продали все свои аквамарины за {price2}₸  ✅',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE mine SET aquamarine = {aquamarine - summ}  WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance + price}  WHERE user_id = {user_id}')
                                connect.commit()
                            else:

                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, У вас нет столько руды {rloser}',
                                                       parse_mode='html')
                        else:
                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, Введите положительное число {rloser}',
                                                   parse_mode='html')
                if message.text.startswith('продать аметисты') or message.text.startswith('Продать аметисты'):
                    try:
                        su = msg.text.split()[2]
                        su2 = (su).replace('к', '000')
                        su3 = (su2).replace('м', '000000')
                        su4 = (su3).replace('.', '')
                        su5 = float(su4)
                        summ = int(su5)

                    except:
                        await message.reply('‼️  Неправильный ввод команды!\nПример: Продать аметисты 1 ')
                        return
                    user_id = message.from_user.id
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    amethysts = cursor.execute(
                        "SELECT amethysts From mine where user_id = ?", (message.from_user.id,))
                    amethysts = cursor.fetchone()
                    amethysts = int(amethysts[0])

                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])

                    price = summ * 100000000
                    price2 = '{:,}'.format(price).replace(',', '.')
                    price3 = amethysts - summ
                    if amethysts <= 0:
                        await bot.send_message(message.chat.id,
                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нет аметистов {rloser}',
                                               parse_mode='html')
                        return
                    if amethysts > 0:
                        if summ > 0:
                            if price3 >= 0:
                                await bot.send_message(message.chat.id, f'вы продали все свои аметисты за {price2}₸  ✅',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE mine SET amethysts = {amethysts - summ}  WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance + price}  WHERE user_id = {user_id}')
                                connect.commit()
                            else:

                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, У вас нет столько руды {rloser}',
                                                       parse_mode='html')
                        else:
                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, Введите положительное число {rloser}',
                                                   parse_mode='html')
                if message.text.startswith('продать алмазы') or message.text.startswith('Продать алмазы'):
                    try:
                        su = msg.text.split()[2]
                        su2 = (su).replace('к', '000')
                        su3 = (su2).replace('м', '000000')
                        su4 = (su3).replace('.', '')
                        su5 = float(su4)
                        summ = int(su5)

                    except:
                        await message.reply('‼️  Неправильный ввод команды!\nПример: Продать алмазы 1 ')
                        return
                    user_id = message.from_user.id
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    diamonds = cursor.execute(
                        "SELECT diamonds From mine where user_id = ?", (message.from_user.id,))
                    diamonds = cursor.fetchone()
                    diamonds = int(diamonds[0])

                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])

                    price = summ * 75000000
                    price2 = '{:,}'.format(price).replace(',', '.')
                    price3 = diamonds - summ
                    if diamonds <= 0:
                        await bot.send_message(message.chat.id,
                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нет алмазов {rloser}',
                                               parse_mode='html')
                        return
                    if diamonds > 0:
                        if summ > 0:
                            if price3 >= 0:
                                await bot.send_message(message.chat.id, f'вы продали все свои алмазы за {price2}₸  ✅',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE mine SET diamonds = {diamonds - summ}  WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance + price}  WHERE user_id = {user_id}')
                                connect.commit()
                            else:

                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, У вас нет столько руды {rloser}',
                                                       parse_mode='html')
                        else:
                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, Введите положительное число {rloser}',
                                                   parse_mode='html')
                if message.text.startswith('продать золото') or message.text.startswith('Продать золото'):
                    try:
                        su = msg.text.split()[2]
                        su2 = (su).replace('к', '000')
                        su3 = (su2).replace('м', '000000')
                        su4 = (su3).replace('.', '')
                        su5 = float(su4)
                        summ = int(su5)

                    except:
                        await message.reply('‼️  Неправильный ввод команды!\nПример: Продать золото 1 ')
                        return
                    user_id = message.from_user.id
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    gold = cursor.execute(
                        "SELECT gold From mine where user_id = ?", (message.from_user.id,))
                    gold = cursor.fetchone()
                    gold = int(gold[0])

                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])

                    price = summ *  50000000
                    price2 = '{:,}'.format(price).replace(',', '.')
                    price3= gold - summ
                    if gold <= 0:
                        await bot.send_message(message.chat.id,
                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нет золота {rloser}',
                                               parse_mode='html')
                        return
                    if gold > 0:
                        if summ>0:
                            if price3>=0:
                                await bot.send_message(message.chat.id, f'вы продали все своё золото за {price2}₸  ✅', parse_mode='html')
                                cursor.execute(
                                    f'UPDATE mine SET gold = {gold - summ}  WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance + price}  WHERE user_id = {user_id}')
                                connect.commit()
                            else:

                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, У вас нет столько руды {rloser}',
                                                       parse_mode='html')
                        else:
                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, Введите положительное число {rloser}',
                                                   parse_mode='html')
                if message.text.startswith('продать железо') or message.text.startswith('Продать железо'):
                    try:
                        su = msg.text.split()[2]
                        su2 = (su).replace('к', '000')
                        su3 = (su2).replace('м', '000000')
                        su4 = (su3).replace('.', '')
                        su5 = float(su4)
                        summ = int(su5)

                    except:
                        await message.reply('‼️  Неправильный ввод команды!\nПример: Продать железо 1 ')
                        return
                    user_id = message.from_user.id
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    iron = cursor.execute(
                        "SELECT iron from mine where user_id = ?", (message.from_user.id,))
                    iron = cursor.fetchone()
                    iron = int(iron[0])

                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])

                    price = summ * 25000000
                    price2 = '{:,}'.format(price).replace(',', '.')
                    price3= iron - summ
                    if iron <= 0:
                        await bot.send_message(message.chat.id,
                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, у вас нет железа {rloser}',
                                               parse_mode='html')
                        return
                    if iron > 0:
                        if summ>0:
                            if price3>=0:
                                await bot.send_message(message.chat.id, f'вы продали все своё железо за {price2}₸  ✅', parse_mode='html')
                                cursor.execute(
                                    f'UPDATE mine SET iron = {iron - summ}  WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance + price}  WHERE user_id = {user_id}')
                                connect.commit()
                            else:

                                await bot.send_message(message.chat.id,
                                                       f'<a href="tg://user?id={user_id}">{user_name}</a>, У вас нет столько руды {rloser}',
                                                       parse_mode='html')
                        else:
                            await bot.send_message(message.chat.id,
                                                   f'<a href="tg://user?id={user_id}">{user_name}</a>, Введите положительное число {rloser}',
                                                   parse_mode='html')
                if message.text.lower() in ['шахта', 'Шахта']:

                    await bot.send_message(message.chat.id,
                                       f"""
‼️  Чтобы продать какую руду , воспользуйтесь командой "Продать [Руда] [Количество]"
‼️  Чтобы копать руду воспользуйтесь кнопкой ниже""",reply_markup=help_mine2,
                                       parse_mode='html')
                ######################################Энергия####################################################
                if message.text.lower() in ['Энергия', "энергия", "енергия", "Енергия"]:
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    energy = cursor.execute(
                        "SELECT energy from users where user_id = ?", (message.from_user.id,))
                    energy = cursor.fetchone()
                    energy = int(energy[0])

                    await bot.send_message(message.chat.id,
                                           f'<a href="tg://user?id={user_id}">{user_name}</a>, на данный момент у тебя {energy} ⚡️',
                                           parse_mode='html')

                ###########################################СПИН#############################################
                if message.text.lower() in ['вб', "вабанк"]:
                    user_id = message.from_user.id
                    user_name = cursor.execute(
                        "SELECT user_name from users where user_id = ?", (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = str(user_name[0])
                    chat_id = message.chat.id
                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = int(balance[0])

                    game = cursor.execute(
                        "SELECT games from users where user_id = ?", (message.from_user.id,))
                    game = cursor.fetchone()
                    game = int(game[0])

                    balance2 = '{:,}'.format(balance).replace(',', '.')

                    rx = random.randint(0, 10000)

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    player = status_users(message.from_user.id)
                    need_seconds3 = 4
                    current_time_bonus3 = datetime.now()
                    last_datetime3 = game_time.get(message.from_user.id)

                    # Если первое сообщение (время не задано)
                    if not last_datetime3:
                        game_time[message.from_user.id] = current_time_bonus3
                        last_datetime3 = datetime.fromtimestamp(0)
                    if last_datetime3:

                        # Разница в секундах между текущим временем и временем последнего сообщения
                        delta_seconds3 = (current_time_bonus3 - last_datetime3).total_seconds()

                        # Осталось ждать секунд перед отправкой
                        seconds_left3 = int(need_seconds3 - delta_seconds3)

                        # Если время ожидания не закончилось
                        if seconds_left3 > 0:
                            left1 = seconds_left3
                            await bot.send_message(message.chat.id,
                                                   f'🪤 <a href="tg://user?id={user_id}">{user_name}</a>, играть можно через {round(left1)} сек {rloser}',
                                                   parse_mode='html')
                        else:
                            game_time[message.from_user.id] = current_time_bonus3
                            if balance > 0:

                                if int(rx) in range(0, 7000):
                                    i = balance - balance * 0.1
                                    i2 = int(i)
                                    i3 =  '{:,}'.format(i2).replace(',', '.')
                                    await  bot.send_message(chat_id,f"""
🤵‍♂︄  {player}: <a href='tg://user?id={user_id}'>{user_name}</a>
🪤  Игра: Ва-банк
🎟  Ставка: {balance2}₸
🧾  Проигрыш: {i3}₸ [0.1X]            
""", parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance - i2} WHERE user_id = {user_id}')

                                    cursor.execute(
                                        f'UPDATE users SET games = {game + 1} WHERE user_id = {user_id}')
                                    connect.commit()
                                    return
                                if int(rx) in range(7001, 10000):

                                    i = balance * 1.5
                                    i2 = int(i)
                                    i3 = '{:,}'.format(i2).replace(',', '.')
                                    await bot.send_message(chat_id,f"""
🤵‍♂︄  {player}: <a href='tg://user?id={user_id}'>{user_name}</a>
🪤  Игра: Ва-банк
🎟  Ставка: {balance2}₸
🧾  Выигрыш: {i3}₸ [1.5X]            
""", parse_mode='html')
                                    cursor.execute(
                                        f'UPDATE users SET balance = {balance + i2} WHERE user_id = {user_id}')

                                    cursor.execute(
                                        f'UPDATE users SET games = {game + 1} WHERE user_id = {user_id}')
                                    connect.commit()
                                    return
                            else:
                                await bot.send_message(chat_id,
                                    f"‼️ <a href='tg://user?id={user_id}'>{user_name}</a>, ошибка! У вас недостаточно средств! ",
                                    parse_mode='html')

                if message.text.startswith("Спин") or message.text.startswith("спин"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id
                    games = cursor.execute(
                        "SELECT games from users where user_id = ?", (message.from_user.id,))
                    games = cursor.fetchone()
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    if message.text != 'Спин' or message.text != 'спин':
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])
                        balance2 = '{:,}'.format(balance).replace(',', '.')
                        msg = message
                        user_id = msg.from_user.id
                        chat_id = message.chat.id

                        msg = message
                        try:
                            su = msg.text.split()[1]
                            su2 = (su).replace('к', '000')
                            su3 = (su2).replace('м', '000000')
                            su4 = (su3).replace('.', '')
                            su5 = float(su4)
                            summ = int(su5)
                            summ2 = '{:,}'.format(summ).replace(',', '.')
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Спин 1 ')
                            return
                        name = msg.from_user.last_name


                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = round(int(balance[0]))

                        rwin = ['🙂', '😋', '😄', '😃']
                        rloser = ['😔', '😕', '😣', '😞', '😢']
                        win = random.choice(rwin)
                        loser = random.choice(rloser)
                        games = int(games[0])
                        balance2 = '{:,}'.format(balance).replace(',', '.')

                        player = status_users(message.from_user.id)
                        num_lose = cursor.execute(
                            "SELECT num_lose FROM users WHERE user_id = ?", (message.from_user.id,))
                        num_lose = cursor.fetchone()
                        num_lose = int(num_lose[0])
                        num_win = cursor.execute(
                            "SELECT num_win FROM users WHERE user_id = ?", (message.from_user.id,))
                        num_win = cursor.fetchone()
                        num_win = int(num_win[0])
                        need_seconds3 = 4
                        current_time_bonus3 = datetime.now()
                        last_datetime3 = game_time.get(message.from_user.id)

                        # Если первое сообщение (время не задано)
                        if not last_datetime3:
                            game_time[message.from_user.id] = current_time_bonus3
                            last_datetime3 = datetime.fromtimestamp(0)
                        if last_datetime3:

                            # Разница в секундах между текущим временем и временем последнего сообщения
                            delta_seconds3 = (current_time_bonus3 - last_datetime3).total_seconds()

                            # Осталось ждать секунд перед отправкой
                            seconds_left3 = int(need_seconds3 - delta_seconds3)

                            # Если время ожидания не закончилось
                            if seconds_left3 > 0:
                                left1 = seconds_left3
                                await bot.send_message(message.chat.id,
                                                       f'🎰️ <a href="tg://user?id={user_id}">{user_name}</a>, играть можно через {round(left1)} сек {loser}',
                                                       parse_mode='html')
                            else:
                                game_time[message.from_user.id] = current_time_bonus3
                                if balance >= summ:
                                    if summ > 0:

                                        rx1 = await message.reply_dice(emoji="🎰")
                                        rx = rx1.dice.value
                                        await asyncio.sleep(2)
                                        if num_lose>=15:
                                            c = Decimal(summ * 1.25-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2)
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, ваша ствака умножилась на x1.25\n🏅 Выйгрыш составляет: +{c2}₸ {win}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 1.25)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')


                                            cursor.execute(
                                                f'UPDATE users SET num_lose={0} WHERE user_id = ?',
                                                (message.from_user.id,))
                                            cursor.execute(
                                                f'UPDATE users SET num_win={num_win+1} WHERE user_id = ?', (message.from_user.id,))
                                            connect.commit()
                                            return
                                        elif num_win>=3:

                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, ваша ствака умножилась на x0\n🎟️ Вы проиграли -{summ2}₸ {loser}',
                                                                   parse_mode='html')

                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 0)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()

                                            cursor.execute(
                                                f'UPDATE users SET num_lose={num_lose+1} WHERE user_id = ?', (message.from_user.id,))
                                            cursor.execute(
                                                f'UPDATE users SET num_win={0} WHERE user_id = ?',(message.from_user.id,))
                                            connect.commit()
                                            return
                                        else:
                                            if int(rx) in range(0, 38):

                                                await bot.send_message(chat_id,
                                                                       f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, ваша ствака умножилась на x0\n🎟️ Вы проиграли -{summ2}₸ {loser}',
                                                                       parse_mode='html')

                                                cursor.execute(
                                                    f'UPDATE users SET balance = {(balance - summ)  + (summ * 0)} WHERE user_id = {user_id}')
                                                cursor.execute(
                                                    f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                                cursor.execute(
                                                    f'UPDATE users SET num_lose={0} WHERE user_id = ?',
                                                    (message.from_user.id,))
                                                cursor.execute(
                                                    f'UPDATE users SET num_win={num_win + 1} WHERE user_id = ?',
                                                    (message.from_user.id,))
                                                connect.commit()
                                                return

                                            if int(rx) in range(38,60):
                                                c = Decimal(summ * 1.25-summ)
                                                c2 = round(c)
                                                c2 = '{:,}'.format(c2)
                                                await bot.send_message(chat_id,
                                                                       f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, ваша ствака умножилась на x1.25\n🏅 Выйгрыш составляет: +{c2}₸ {win}',
                                                                       parse_mode='html')
                                                cursor.execute(
                                                    f'UPDATE users SET balance = {(balance - summ)  + (summ * 1.25)} WHERE user_id = {user_id}')
                                                cursor.execute(
                                                    f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                                cursor.execute(
                                                    f'UPDATE users SET num_lose={num_lose + 1} WHERE user_id = ?',
                                                    (message.from_user.id,))
                                                cursor.execute(
                                                    f'UPDATE users SET num_win={0} WHERE user_id = ?', (message.from_user.id,))

                                                connect.commit()
                                                return
                                            if int(rx) in range(60, 64):
                                                c = Decimal(summ * 2-summ)
                                                c2 = round(c)
                                                c2 = '{:,}'.format(c2)
                                                await bot.send_message(chat_id,
                                                                       f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, ваша ствака умножилась на x2\n🏅 Выйгрыш составляет: +{c2}₸ {win}',
                                                                       parse_mode='html')
                                                cursor.execute(
                                                    f'UPDATE users SET balance = {(balance - summ)  + (summ * 2)} WHERE user_id = {user_id}')
                                                cursor.execute(
                                                    f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                                cursor.execute(
                                                    f'UPDATE users SET num_lose={num_lose + 1} WHERE user_id = ?',
                                                    (message.from_user.id,))
                                                cursor.execute(
                                                    f'UPDATE users SET num_win={0} WHERE user_id = ?', (message.from_user.id,))

                                                connect.commit()
                                                return
                                            if int(rx) ==64:
                                                c = Decimal(summ * 5-summ)
                                                c2 = round(c)
                                                c2 = '{:,}'.format(c2)
                                                await bot.send_message(chat_id,
                                                                       f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, ваша ствака умножилась на x5\n🏅 Выйгрыш составляет: +{c2}₸ {win}',
                                                                       parse_mode='html')
                                                cursor.execute(
                                                    f'UPDATE users SET balance = {(balance - summ) + (summ * 5)} WHERE user_id = {user_id}')
                                                cursor.execute(
                                                    f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                                cursor.execute(
                                                    f'UPDATE users SET num_lose={num_lose + 1} WHERE user_id = ?',
                                                    (message.from_user.id,))
                                                cursor.execute(
                                                    f'UPDATE users SET num_win={0} WHERE user_id = ?', (message.from_user.id,))

                                                connect.commit()
                                                return
                                    elif summ <= 1:

                                        await bot.send_message(chat_id,
                                                               f'🎰 <a href="tg://user?id={user_id}">{user_name}</a>, нельзя ставить отрицательное число! {loser}',
                                                               parse_mode='html')
                                else:

                                    await bot.send_message(chat_id,
                                                           f'🎰 <a href="tg://user?id={user_id}">{user_name}</a>, недостаточно средств! {loser}',
                                                           parse_mode='html')

                    else:

                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Спин [сумма] {rloser}',
                                               parse_mode='html')
                        return
                    ###########################################КАЗИНО###########################################
                if message.text.startswith("Казино") or message.text.startswith("казино"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    if message.text != 'Казино':
                        msg = message
                        user_id = msg.from_user.id
                        chat_id = message.chat.id

                        win = ['🙂', '😋', '😄', '😃']
                        loser = ['😔', '😕', '😣', '😞', '😢']

                        rwin = random.choice(win)
                        rloser = random.choice(loser)
                        rx=np.random.choice([1,2,3,4,5,6,7,8,9,10], 1, p=[0.15, 0.1, 0.1, 0.11, 0.1, 0.12, 0.1, 0.15, 0.05, 0.02])[0]
                        msg = message
                        try:
                            su = msg.text.split()[1]
                            su2 = (su).replace('к', '000')
                            su3 = (su2).replace('м', '000000')
                            su4 = (su3).replace('.', '')
                            su5 = float(su4)
                            summ = int(su5)
                            summ2 = '{:,}'.format(summ).replace(',', '.')
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Казино 1 ')
                            return

                        games = cursor.execute(
                            "SELECT games from users where user_id = ?", (message.from_user.id,))
                        games = cursor.fetchone()

                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = round(int(balance[0]))
                        games = int(games[0])


                        player = status_users(message.from_user.id)
                        need_seconds3 = 4
                        current_time_bonus3 = datetime.now()
                        last_datetime3 = game_time.get(message.from_user.id)

                        # Если первое сообщение (время не задано)
                        if not last_datetime3:
                            game_time[message.from_user.id] = current_time_bonus3
                            last_datetime3 = datetime.fromtimestamp(0)
                        if last_datetime3:

                            # Разница в секундах между текущим временем и временем последнего сообщения
                            delta_seconds3 = (current_time_bonus3 - last_datetime3).total_seconds()

                            # Осталось ждать секунд перед отправкой
                            seconds_left3 = int(need_seconds3 - delta_seconds3)

                            # Если время ожидания не закончилось
                            if seconds_left3 > 0:
                                left1 = seconds_left3
                                await bot.send_message(message.chat.id,
                                                       f'♣️<a href="tg://user?id={user_id}">{user_name}</a>, играть можно через {round(left1)} сек {rloser}',
                                                       parse_mode='html')
                            else:
                                game_time[message.from_user.id] = current_time_bonus3
                                if balance >= summ:
                                    if summ > 0:

                                        if int(rx) ==1:
                                            c = Decimal(summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'♣️Игра: Казино\n{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🕹️ Проигрыш: -{summ2}₸  x0 {rloser}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {balance - summ} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()
                                            return
                                        if int(rx) ==2:
                                            c = Decimal( summ * 0.25)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'♣️Игра: Казино\n{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🕹️ Проигрыш: -{summ2}₸  x0.25 {rloser}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {balance - summ * 0.25} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) ==3:
                                            c = Decimal(summ * 0.5)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'♣️Игра: Казино\n{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🕹️ Проигрыш: -{summ2}₸  x0.5 {rloser}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {balance - summ * 0.5} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) ==4:
                                            c = Decimal( summ * 0.75)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'♣️Игра: Казино\n{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🕹️ Проигрыш: -{summ2}₸  x0.75 {rloser}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {balance - summ * 0.75} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) ==5:
                                            c = summ * 1
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'♣️Игра: Казино\n{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🕹️ Деньги остаются у вас: {summ2}₸  x1 {rwin}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()
                                            return
                                        if int(rx) ==6:
                                            c = Decimal(summ * 1.25-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'♣️Игра: Казино\n{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🕹️ Выигрыш: +{c2}₸  x1.25 {rwin}',
                                                                   parse_mode='html')

                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 1.25)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()
                                            return
                                        if int(rx) ==7:
                                            c = Decimal(summ * 1.5-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'♣️Игра: Казино\n{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🕹️ Выигрыш: +{c2}₸  x1.5 {rwin}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 1.5)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) ==8:
                                            c = Decimal(summ * 1.75-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'♣️Игра: Казино\n{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🕹️ Выигрыш: +{c2}₸  x1.75 {rwin}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 1.75)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) ==9:
                                            c = Decimal(summ * 2-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'♣️Игра: Казино\n{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🕹️ Выигрыш: +{c2}₸  x2 {rwin}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 2)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) ==10:
                                            c = Decimal(summ * 3-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'♣️Игра: Казино\n{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🕹️ Выигрыш: +{c2}₸  x3 {rwin}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 3)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return

                                    elif summ <= 1:

                                        await bot.send_message(chat_id,
                                                               f'♠️ <a href="tg://user?id={user_id}">{user_name}</a>, нельзя ставить отрицательное число! {rloser}',
                                                               parse_mode='html')
                                elif int(balance) <= int(summ):

                                    await bot.send_message(chat_id,
                                                           f'♠️ <a href="tg://user?id={user_id}">{user_name}</a>, недостаточно средств! {rloser}',
                                                           parse_mode='html')

                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Казино [сумма] {rloser}',
                                               parse_mode='html')
                        return

                ###########################################БАСКЕТБОЛ#############################################
                if message.text.startswith("Баскетбол") or message.text.startswith("баскетбол"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    if message.text != 'Баскетбол':
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])
                        balance2 = '{:,}'.format(balance).replace(',', '.')
                        msg = message
                        user_id = msg.from_user.id
                        chat_id = message.chat.id

                        msg = message

                        name = msg.from_user.last_name
                        games = cursor.execute(
                            "SELECT games from users where user_id = ?", (message.from_user.id,))
                        games = cursor.fetchone()
                        try:
                            su = msg.text.split()[1]
                            su2 = (su).replace('к', '000')
                            su3 = (su2).replace('м', '000000')
                            su4 = (su3).replace('.', '')
                            su5 = float(su4)
                            summ = int(su5)
                            summ2 = '{:,}'.format(summ).replace(',', '.')
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Баскетбол 1 ')
                            return

                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = round(int(balance[0]))

                        rwin = ['🙂', '😋', '😄', '😃']
                        rloser = ['😔', '😕', '😣', '😞', '😢']
                        win = random.choice(rwin)
                        loser = random.choice(rloser)
                        games = int(games[0])
                        balance2 = '{:,}'.format(balance).replace(',', '.')
                        num_lose = cursor.execute(
                            "SELECT num_lose FROM users WHERE user_id = ?", (message.from_user.id,))
                        num_lose = cursor.fetchone()
                        num_lose = int(num_lose[0])
                        num_win = cursor.execute(
                            "SELECT num_win FROM users WHERE user_id = ?", (message.from_user.id,))
                        num_win = cursor.fetchone()
                        num_win = int(num_win[0])
                        player = status_users(message.from_user.id)
                        need_seconds3 = 4
                        current_time_bonus3 = datetime.now()
                        last_datetime3 = game_time.get(message.from_user.id)

                        # Если первое сообщение (время не задано)
                        if not last_datetime3:
                            game_time[message.from_user.id] = current_time_bonus3
                            last_datetime3 = datetime.fromtimestamp(0)
                        if last_datetime3:

                            # Разница в секундах между текущим временем и временем последнего сообщения
                            delta_seconds3 = (current_time_bonus3 - last_datetime3).total_seconds()

                            # Осталось ждать секунд перед отправкой
                            seconds_left3 = int(need_seconds3 - delta_seconds3)

                            # Если время ожидания не закончилось
                            if seconds_left3 > 0:
                                left1 = seconds_left3
                                await bot.send_message(message.chat.id,
                                                       f'🏀️ <a href="tg://user?id={user_id}">{user_name}</a>, играть можно через {round(left1)} сек {loser}',
                                                       parse_mode='html')
                            else:
                                game_time[message.from_user.id] = current_time_bonus3
                                if balance >= summ:
                                    if summ > 0:


                                        rx1 = await message.reply_dice(emoji="🏀")

                                        rx = rx1.dice.value
                                        await asyncio.sleep(2)
                                        if num_lose >= 15:
                                            c = Decimal(summ * 2-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2)
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, невероятно,мяч в кольце\n🏅 Выйгрыш составляет: +{c2}₸ {win}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 2)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            cursor.execute(
                                                f'UPDATE users SET num_lose={0} WHERE user_id = ?',
                                                (message.from_user.id,))
                                            cursor.execute(
                                                f'UPDATE users SET num_win={num_win + 1} WHERE user_id = ?',
                                                (message.from_user.id,))
                                            connect.commit()
                                            return
                                        elif num_win >= 3:
                                            c = Decimal(summ * 0)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')

                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, Судья не засчитал!\n🎫 Вы проиграли: -{c2}₸ {loser}',
                                                                   parse_mode='html')

                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 0)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')


                                            cursor.execute(
                                                f'UPDATE users SET num_lose={num_lose + 1} WHERE user_id = ?',
                                                (message.from_user.id,))
                                            cursor.execute(
                                                f'UPDATE users SET num_win={0} WHERE user_id = ?', (message.from_user.id,))
                                            connect.commit()
                                            return
                                        else:

                                            if int(rx) == 1:
                                                c = Decimal(summ * 0)
                                                c2 = round(c)
                                                c2 = '{:,}'.format(c2).replace(',', '.')

                                                await bot.send_message(chat_id,
                                                                       f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>,мяч не попал в кольцо!\n🎫 Вы проиграли: -{c2}₸ {loser}',
                                                                       parse_mode='html')

                                                cursor.execute(
                                                    f'UPDATE users SET balance = {(balance - summ)   + (summ * 0)} WHERE user_id = {user_id}')
                                                cursor.execute(
                                                    f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                                cursor.execute(
                                                    f'UPDATE users SET num_lose={num_lose + 1} WHERE user_id = ?',
                                                    (message.from_user.id,))
                                                cursor.execute(
                                                    f'UPDATE users SET num_win={0} WHERE user_id = ?', (message.from_user.id,))


                                                connect.commit()
                                                return
                                            if int(rx) == 3:
                                                c = Decimal(summ * 0)
                                                c2 = round(c)
                                                c2 = '{:,}'.format(c2).replace(',', '.')

                                                await bot.send_message(chat_id,
                                                                       f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>,мяч не попал в кольцо!\n🎫 Вы проиграли: -{c2}₸ {loser}',
                                                                       parse_mode='html')

                                                cursor.execute(
                                                    f'UPDATE users SET balance = {(balance - summ)   + (summ * 0)} WHERE user_id = {user_id}')
                                                cursor.execute(
                                                    f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                                cursor.execute(
                                                    f'UPDATE users SET num_lose={num_lose + 1} WHERE user_id = ?',
                                                    (message.from_user.id,))
                                                cursor.execute(
                                                    f'UPDATE users SET num_win={0} WHERE user_id = ?', (message.from_user.id,))
                                                connect.commit()
                                                return
                                            if int(rx) == 2:
                                                c = Decimal(summ * 0)
                                                c2 = round(c)
                                                c2 = '{:,}'.format(c2).replace(',', '.')


                                                await bot.send_message(chat_id,
                                                                       f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>,мяч не попал в кольцо!\n🎫 Вы проиграли: -{c2}₸ {loser}',
                                                                       parse_mode='html')

                                                cursor.execute(
                                                    f'UPDATE users SET balance = {(balance - summ)  + (summ * 0)} WHERE user_id = {user_id}')
                                                cursor.execute(
                                                    f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                                cursor.execute(
                                                    f'UPDATE users SET num_lose={num_lose + 1} WHERE user_id = ?',
                                                    (message.from_user.id,))
                                                cursor.execute(
                                                    f'UPDATE users SET num_win={0} WHERE user_id = ?', (message.from_user.id,))
                                                connect.commit()
                                                return
                                            if int(rx) == 5:
                                                c = Decimal(summ * 2-summ)
                                                c2 = round(c)
                                                c2 = '{:,}'.format(c2)
                                                await bot.send_message(chat_id,
                                                                       f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, невероятно,мяч в кольце\n🏅 Выйгрыш составляет: +{c2}₸ {win}',
                                                                       parse_mode='html')
                                                cursor.execute(
                                                    f'UPDATE users SET balance = {(balance - summ)  + (summ * 2)} WHERE user_id = {user_id}')
                                                cursor.execute(
                                                    f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                                cursor.execute(
                                                    f'UPDATE users SET num_lose={num_lose + 1} WHERE user_id = ?',
                                                    (message.from_user.id,))
                                                cursor.execute(
                                                    f'UPDATE users SET num_win={0} WHERE user_id = ?', (message.from_user.id,))
                                                connect.commit()

                                                return

                                            if int(rx) == 4:
                                                c = Decimal(summ * 1)
                                                c2 = round(c)
                                                c2 = '{:,}'.format(c2)
                                                await bot.send_message(chat_id,
                                                                       f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, 🍀 Ваши деньги сохранились \n🎫 Вы сохранили: {c2}₸ {win}',
                                                                       parse_mode='html')

                                                cursor.execute(
                                                    f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                                connect.commit()

                                                return

                                    elif summ <= 1:

                                        await bot.send_message(chat_id,
                                                               f'🏀 <a href="tg://user?id={user_id}">{user_name}</a>, нельзя ставить отрицательное число! {loser}',
                                                               parse_mode='html')
                                elif int(balance) <= int(summ):

                                    await bot.send_message(chat_id,
                                                           f'🏀 <a href="tg://user?id={user_id}">{user_name}</a>, недостаточно средств! {loser}',
                                                           parse_mode='html')

                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Баскетбол [сумма] {rloser}',
                                               parse_mode='html')
                        return



                ####################################футбол##############################################################
                if message.text.startswith("Футбол") or message.text.startswith("футбол"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    rwin = ['🙂', '😋', '😄', '😃']
                    rloser = ['😔', '😕', '😣', '😞', '😢']
                    win = random.choice(rwin)
                    loser = random.choice(rloser)
                    if message.text != 'Футбол':
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])
                        balance2 = '{:,}'.format(balance).replace(',', '.')
                        msg = message
                        user_id = msg.from_user.id
                        chat_id = message.chat.id

                        msg = message

                        name = msg.from_user.last_name

                        try:
                            su = msg.text.split()[1]
                            su2 = (su).replace('к', '000')
                            su3 = (su2).replace('м', '000000')
                            su4 = (su3).replace('.', '')
                            su5 = float(su4)
                            summ = int(su5)
                            summ2 = '{:,}'.format(summ).replace(',', '.')
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Футбол 1 ')
                            return
                        games = cursor.execute(
                            "SELECT games from users where user_id = ?", (message.from_user.id,))
                        games = cursor.fetchone()
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = round(int(balance[0]))

                        num_lose = cursor.execute(
                            "SELECT num_lose FROM users WHERE user_id = ?", (message.from_user.id,))
                        num_lose = cursor.fetchone()
                        num_lose = int(num_lose[0])
                        num_win = cursor.execute(
                            "SELECT num_win FROM users WHERE user_id = ?", (message.from_user.id,))
                        num_win = cursor.fetchone()
                        num_win = int(num_win[0])
                        games = int(games[0])
                        balance2 = '{:,}'.format(balance).replace(',', '.')

                        player = status_users(message.from_user.id)
                        need_seconds3 = 4
                        current_time_bonus3 = datetime.now()
                        last_datetime3 = game_time.get(message.from_user.id)

                        # Если первое сообщение (время не задано)
                        if not last_datetime3:
                            game_time[message.from_user.id] = current_time_bonus3
                            last_datetime3 = datetime.fromtimestamp(0)
                        if last_datetime3:

                            # Разница в секундах между текущим временем и временем последнего сообщения
                            delta_seconds3 = (current_time_bonus3 - last_datetime3).total_seconds()

                            # Осталось ждать секунд перед отправкой
                            seconds_left3 = int(need_seconds3 - delta_seconds3)

                            # Если время ожидания не закончилось
                            if seconds_left3 > 0:
                                left1 = seconds_left3
                                await bot.send_message(message.chat.id,
                                                       f'⚽ <a href="tg://user?id={user_id}">{user_name}</a>, играть можно через {round(left1)} сек {loser}',
                                                       parse_mode='html')
                            else:
                                game_time[message.from_user.id] = current_time_bonus3
                                if balance >= summ:
                                    if summ > 0:
                                        rx1 = await message.reply_dice(emoji="⚽")
                                        await asyncio.sleep(2)
                                        rx = rx1.dice.value
                                        if num_lose >= 15:
                                            c = Decimal(summ * 2-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2)
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, невероятно,мяч попал в ворота\n🏅 Выйгрыш составляет: +{c2}₸ {win}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 2)} WHERE user_id = {user_id}')

                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()

                                            cursor.execute(
                                                f'UPDATE users SET num_lose={0} WHERE user_id = ?',
                                                (message.from_user.id,))
                                            cursor.execute(
                                                f'UPDATE users SET num_win={num_win + 1} WHERE user_id = ?',
                                                (message.from_user.id,))
                                            connect.commit()
                                            return
                                        elif num_win >= 3:

                                            c = Decimal(summ * 0)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')

                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>,Судья не засчитал!\n🎟️ Вы проиграли: -{c2}₸ {loser}',
                                                                   parse_mode='html')

                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 0)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            cursor.execute(
                                                f'UPDATE users SET num_lose={num_lose + 1} WHERE user_id = ?',
                                                (message.from_user.id,))
                                            cursor.execute(
                                                f'UPDATE users SET num_win={0} WHERE user_id = ?', (message.from_user.id,))
                                            connect.commit()
                                            return
                                        else:
                                            if int(rx) == 1:
                                                c = Decimal(summ * 0)
                                                c2 = round(c)
                                                c2 = '{:,}'.format(c2).replace(',', '.')

                                                await bot.send_message(chat_id,
                                                                       f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>,мяч не попал в ворота!\n🎟️ Вы проиграли: -{c2}₸ {loser}',
                                                                       parse_mode='html')

                                                cursor.execute(
                                                    f'UPDATE users SET balance = {(balance - summ)   + (summ * 0)} WHERE user_id = {user_id}')
                                                cursor.execute(
                                                    f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                                cursor.execute(
                                                    f'UPDATE users SET num_lose={num_lose + 1} WHERE user_id = ?',
                                                    (message.from_user.id,))
                                                cursor.execute(
                                                    f'UPDATE users SET num_win={0} WHERE user_id = ?', (message.from_user.id,))


                                                connect.commit()
                                                return
                                            if int(rx) == 3:
                                                c = Decimal(summ * 1.25-summ)
                                                c2 = round(c)
                                                c2 = '{:,}'.format(c2).replace(',', '.')

                                                await bot.send_message(chat_id,
                                                                       f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>,невероятно,мяч попал в ворота\n🏅 Выйгрыш составляет: +{c2}₸ {win}',
                                                                       parse_mode='html')

                                                cursor.execute(
                                                    f'UPDATE users SET balance = {(balance - summ)   + (summ *  1.25)} WHERE user_id = {user_id}')
                                                cursor.execute(
                                                    f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                                cursor.execute(
                                                    f'UPDATE users SET num_lose={0} WHERE user_id = ?',
                                                    (message.from_user.id,))
                                                cursor.execute(
                                                    f'UPDATE users SET num_win={num_win + 1} WHERE user_id = ?',
                                                    (message.from_user.id,))

                                                connect.commit()
                                                return
                                            if int(rx) == 2:
                                                c = Decimal(summ * 0)
                                                c2 = round(c)
                                                c2 = '{:,}'.format(c2).replace(',', '.')

                                                connect.commit()

                                                await bot.send_message(chat_id,
                                                                       f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>,мяч не попал в ворота!\n🎟️ Вы проиграли: -{c2}₸ {loser}',
                                                                       parse_mode='html')

                                                cursor.execute(
                                                    f'UPDATE users SET balance = {(balance - summ)  + (summ * 0)} WHERE user_id = {user_id}')
                                                cursor.execute(
                                                    f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                                cursor.execute(
                                                    f'UPDATE users SET num_lose={num_lose + 1} WHERE user_id = ?',
                                                    (message.from_user.id,))
                                                cursor.execute(
                                                    f'UPDATE users SET num_win={0} WHERE user_id = ?', (message.from_user.id,))

                                                connect.commit()
                                                return
                                            if int(rx) == 5:
                                                c = Decimal(summ * 2-summ)
                                                c2 = round(c)
                                                c2 = '{:,}'.format(c2)
                                                await bot.send_message(chat_id,
                                                                       f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, невероятно,мяч попал в ворота\n🏅 Выйгрыш составляет: +{c2}₸ {win}',
                                                                       parse_mode='html')
                                                cursor.execute(
                                                    f'UPDATE users SET balance = {(balance - summ) + (summ * 2)} WHERE user_id = {user_id}')

                                                cursor.execute(
                                                    f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                                cursor.execute(
                                                    f'UPDATE users SET num_lose={0} WHERE user_id = ?',
                                                    (message.from_user.id,))
                                                cursor.execute(
                                                    f'UPDATE users SET num_win={num_win + 1} WHERE user_id = ?',
                                                    (message.from_user.id,))
                                                connect.commit()
                                                return

                                            if int(rx) == 4:
                                                c = Decimal(summ * 1)
                                                c2 = round(c)
                                                c2 = '{:,}'.format(c2)
                                                await bot.send_message(chat_id,
                                                                       f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, 🍀 Ваши деньги сохранились\n🎟️ Вы сохранили: {c2}₸ {win}',
                                                                       parse_mode='html')


                                                cursor.execute(
                                                    f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                                return

                                    elif summ <= 1:

                                        await bot.send_message(chat_id,
                                                               f'⚽ <a href="tg://user?id={user_id}">{user_name}</a>, нельзя ставить отрицательное число! {loser}',
                                                               parse_mode='html')
                                elif int(balance) <= int(summ):

                                    await bot.send_message(chat_id,
                                                           f'⚽ <a href="tg://user?id={user_id}">{user_name}</a>, недостаточно средств! {loser}',
                                                           parse_mode='html')

                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Футбол [сумма] {rloser}',
                                               parse_mode='html')
                        return
                ##########################################БОУЛИНГ#####################################################
                if message.text.startswith("Боулинг") or message.text.startswith("боулинг"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    if message.text != 'Боулинг':
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])
                        balance2 = '{:,}'.format(balance).replace(',', '.')
                        msg = message
                        user_id = msg.from_user.id
                        chat_id = message.chat.id

                        msg = message

                        name = msg.from_user.last_name

                        try:
                            su = msg.text.split()[1]
                            su2 = (su).replace('к', '000')
                            su3 = (su2).replace('м', '000000')
                            su4 = (su3).replace('.', '')
                            su5 = float(su4)
                            summ = int(su5)
                            summ2 = '{:,}'.format(summ).replace(',', '.')
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Боулинг 1 ')
                            return
                        games = cursor.execute(
                            "SELECT games from users where user_id = ?", (message.from_user.id,))
                        games = cursor.fetchone()
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = round(int(balance[0]))


                        rwin = ['🙂', '😋', '😄', '😃']
                        rloser = ['😔', '😕', '😣', '😞', '😢']
                        win = random.choice(rwin)
                        loser = random.choice(rloser)
                        games = int(games[0])
                        balance2 = '{:,}'.format(balance).replace(',', '.')


                        player = status_users(message.from_user.id)
                        need_seconds3 = 4
                        current_time_bonus3 = datetime.now()
                        last_datetime3 = game_time.get(message.from_user.id)

                        # Если первое сообщение (время не задано)
                        if not last_datetime3:
                            game_time[message.from_user.id] = current_time_bonus3
                            last_datetime3 = datetime.fromtimestamp(0)
                        if last_datetime3:

                            # Разница в секундах между текущим временем и временем последнего сообщения
                            delta_seconds3 = (current_time_bonus3 - last_datetime3).total_seconds()

                            # Осталось ждать секунд перед отправкой
                            seconds_left3 = int(need_seconds3 - delta_seconds3)

                            # Если время ожидания не закончилось
                            if seconds_left3 > 0:
                                left1 = seconds_left3
                                await bot.send_message(message.chat.id,
                                                       f'🎳 <a href="tg://user?id={user_id}">{user_name}</a>, играть можно через {round(left1)} сек {loser}',
                                                       parse_mode='html')
                            else:
                                game_time[message.from_user.id] = current_time_bonus3
                                if balance >= summ:
                                    if summ > 0:

                                        rx1 = await message.reply_dice(emoji="🎳")
                                        await asyncio.sleep(2)
                                        rx = rx1.dice.value

                                        if int(rx) == 1:
                                            c = Decimal(summ * 0)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')

                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, промах !\n🎟️ Вы проиграли: -{c2}₸ {loser}',
                                                                   parse_mode='html')

                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance-summ) + (summ * 0)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) == 2:
                                            c = Decimal(summ * 0)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')

                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, даже не близко!\n🎟️ Вы проиграли: -{c2}₸ {loser}',
                                                                   parse_mode='html')

                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance-summ)  + (summ * 0)} WHERE user_id = {user_id}')

                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()
                                            return
                                        if int(rx) == 3:
                                            c = Decimal(summ * 0)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')

                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, это не страйк!\n🎟️ Вы проиграли: -{c2}₸ {loser}',
                                                                   parse_mode='html')

                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance-summ)  + (summ * 0)} WHERE user_id = {user_id}')

                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()
                                            return
                                        if int(rx) == 4:
                                            c = Decimal(summ * 0)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')

                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, Кидай ровнее!\n🎟️ Вы проиграли: -{c2}₸ {loser}',
                                                                   parse_mode='html')

                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance-summ) + (summ * 0)} WHERE user_id = {user_id}')

                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()
                                            return

                                        if int(rx) == 5:
                                            c = Decimal(summ * 1)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2)


                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                            connect.commit()
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>,Близко\n🍀 Ваши деньги сохранились\n🎟️ Вы сохранили: {c2}₸ {win}',
                                                                   parse_mode='html')
                                        if int(rx) == 6:
                                            c = Decimal(summ * 2.5-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2)
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance-summ) + (summ * 2.5)} WHERE user_id = {user_id}')

                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>,СТРАЙК!!!\n🏅Выйгрыш составляет: +{c2}₸ {win}',
                                                                   parse_mode='html')

                                            return

                                    elif summ <= 1:

                                        await bot.send_message(chat_id,
                                                               f'🎳 <a href="tg://user?id={user_id}">{user_name}</a>, нельзя ставить отрицательное число! {loser}',
                                                               parse_mode='html')
                                elif int(balance) <= int(summ):

                                    await bot.send_message(chat_id,
                                                           f'🎳 <a href="tg://user?id={user_id}">{user_name}</a>, недостаточно средств! {loser}',
                                                           parse_mode='html')

                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Боулинг [сумма] {rloser}',
                                               parse_mode='html')
                        return

                if message.text.lower() in ["Отменить ставку", "отменить ставку"]:
                    user_id = message.from_user.id

                    user_name = cursor.execute("SELECT user_name from users where user_id = ?", (user_id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]

                    user_id = message.from_user.id

                    user_name = cursor.execute("SELECT user_name from users where user_id = ?", (user_id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    data = await get_rang(message)
                    if data[56] == 1:

                        cursor.execute("UPDATE users SET stavka=0 WHERE user_id=?", (user_id,))
                        second_p.clear()
                        first_p.clear()
                        summ_stavka.clear()
                        second_p.clear()
                        return await message.reply(
                            f"‼️ <a href='tg://user?id={user_id}'>{user_name}</a> Вы успешно отменили ставку",
                            parse_mode='html')
                    else:
                        return await message.reply(
                            f"‼️   <a href='tg://user?id={user_id}'>{user_name}</a> У вас нету  активной ставки!",
                            parse_mode='html')

                if message.text.startswith("Дуэль") or message.text.startswith("дуэль") or message.text.startswith("дуель") or message.text.startswith("Дуель"):

                    data = await get_rang(message)
                    if data is None:
                        return await message.reply(f"🚫 <b>Не найден в базе данных.</b>\n\n"
                                                   f"/start в лс у бота!")
                    user_id = message.from_user.id

                    user_name = cursor.execute("SELECT user_name from users where user_id = ?", (user_id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    reply = message.reply_to_message
                    if reply:
                        replyuser = reply.from_user.id

                        ruser_name = cursor.execute("SELECT user_name from users where user_id = ?", (replyuser,))
                        ruser_name = cursor.fetchone()
                        ruser_name = ruser_name[0]

                        if data[56] == 0:
                            if replyuser == user_id:
                                return await message.reply(f"‼️Вы не можете играть с собой.")
                            replydata = await reply_get_rang(message)
                            if replydata[56] == 0:
                                try:
                                    su = msg.text.split()[1]
                                    su2 = (su).replace('к', '000')
                                    su3 = (su2).replace('м', '000000')
                                    su4 = (su3).replace('.', '')
                                    su5 = float(su4)
                                    summ = int(su5)

                                    summ2 = '{:,}'.format(summ).replace(',', '.')
                                except:
                                    await message.reply('‼️Неправильный ввод команды!\nПример: Дуэль 1 ')
                                    return

                                balance = cursor.execute("SELECT balance FROM users WHERE user_id=?", (user_id,))
                                balance = cursor.fetchone()
                                balance = int(balance[0])

                                balance2 = cursor.execute("SELECT balance FROM users WHERE user_id=?", (replyuser,))
                                balance2 = cursor.fetchone()
                                balance2 = int(balance2[0])
                                player=status_users(user_id)
                                player2=status_users(replyuser)
                                if balance >= summ and balance2 >= summ:
                                    if summ > 0:
                                        cursor.execute("UPDATE users SET stavka=1 WHERE user_id=?",(user_id,))
                                        cursor.execute("UPDATE users SET stavka=1 WHERE user_id=?", (replyuser,))
                                        first_p.append(user_id)
                                        summ_stavka.append(summ)
                                        second_p.append(replyuser)
                                        await bot.send_message(message.chat.id,
                                                               f"🏹 {player2} ➪ <a href='tg://user?id={replyuser}'>{ruser_name}</a>, вас вызвал на дуэль {player} ➪ <a href='tg://user?id={user_id}'>{user_name}</a>\n🔀 Принять решение можно нажав на одну из кнопок ниже.\n💰 Сумма ставки: {summ2}",
                                                               parse_mode='html', reply_markup=gamestavka)
                                    else:
                                        return await message.reply(
                                            f"‼️<a href='tg://user?id={user_id}'>{user_name}</a> Нельзя ставить отрицательные числа",
                                            parse_mode='html')
                                else:
                                    return await message.reply(
                                        f"‼️<a href='tg://user?id={user_id}'>{user_name}</a> Не достаточно средств",
                                        parse_mode='html')
                            else:
                                return await message.reply(
                                    f"‼️<a href='tg://user?id={user_id}'>{user_name}</a> у него уже есть активная ставка!\n❌ Для отмены ставки ведите: отменить ставку",
                                    parse_mode='html')

                        else:
                            return await message.reply(
                                f"‼️<a href='tg://user?id={user_id}'>{user_name}</a> у вас уже есть активная ставка!\n❌ Для отмены ставки ведите: отменить ставку",
                                parse_mode='html')

                ########################################ДАРТС################################################
                if message.text.startswith("Дартс") or message.text.startswith("дартс"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    if message.text != 'Дартс':
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])
                        balance2 = '{:,}'.format(balance).replace(',', '.')
                        msg = message
                        user_id = msg.from_user.id
                        chat_id = message.chat.id

                        msg = message

                        name = msg.from_user.last_name

                        try:
                            su = msg.text.split()[1]
                            su2 = (su).replace('к', '000')
                            su3 = (su2).replace('м', '000000')
                            su4 = (su3).replace('.', '')
                            su5 = float(su4)
                            summ = int(su5)

                            summ2 = '{:,}'.format(summ).replace(',', '.')
                        except:
                            await message.reply('‼️Неправильный ввод команды!\nПример: Дартс 1 ')
                            return
                        games = cursor.execute(
                            "SELECT games from users where user_id = ?", (message.from_user.id,))
                        games = cursor.fetchone()
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = round(int(balance[0]))

                        rwin = ['🙂', '😋', '😄', '😃']
                        rloser = ['😔', '😕', '😣', '😞', '😢']
                        win = random.choice(rwin)
                        loser = random.choice(rloser)
                        games = int(games[0])

                        balance2 = '{:,}'.format(balance).replace(',', '.')

                        player = status_users(message.from_user.id)
                        need_seconds3 = 4
                        current_time_bonus3 = datetime.now()
                        last_datetime3 = game_time.get(message.from_user.id)

                        # Если первое сообщение (время не задано)
                        if not last_datetime3:
                            game_time[message.from_user.id] = current_time_bonus3
                            last_datetime3 = datetime.fromtimestamp(0)
                        if last_datetime3:

                            # Разница в секундах между текущим временем и временем последнего сообщения
                            delta_seconds3 = (current_time_bonus3 - last_datetime3).total_seconds()

                            # Осталось ждать секунд перед отправкой
                            seconds_left3 = int(need_seconds3 - delta_seconds3)

                            # Если время ожидания не закончилось
                            if seconds_left3 > 0:
                                left1 = seconds_left3
                                await bot.send_message(message.chat.id,
                                                       f'🎯 <a href="tg://user?id={user_id}">{user_name}</a>, играть можно через {round(left1)} сек {loser}',
                                                       parse_mode='html')
                            else:
                                game_time[message.from_user.id] = current_time_bonus3
                                if balance >= summ:
                                    if summ > 0:
                                        rx1 = await message.reply_dice(emoji="🎯")
                                        await asyncio.sleep(2)
                                        rx = rx1.dice.value

                                        if int(rx) == 1:
                                            c = Decimal(summ * 0)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')

                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, даже не близко!\n🎟️ Вы проиграли: -{c2}₸ {loser}',
                                                                   parse_mode='html')

                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance-summ)  + (summ * 0)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()
                                            return
                                        if int(rx) == 2:
                                            c = Decimal(summ * 0)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')

                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, мимо!\n🎟️ Вы проиграли: -{c2}₸ {loser}',
                                                                   parse_mode='html')

                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance-summ)  + (summ * 0)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()
                                            return
                                        if int(rx) == 3:
                                            c = Decimal(summ * 0)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')

                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>,моя бабушка лучше кидает!\n🎟️ Вы проиграли: -{c2}₸ {loser}',
                                                                   parse_mode='html')

                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance-summ) + (summ * 0)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()
                                            return
                                        if int(rx) == 4:
                                            c = Decimal(summ * 0)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')

                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, мимо!\n🎟️ Вы проиграли: -{c2}₸ {loser}',
                                                                   parse_mode='html')

                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance-summ) + (summ * 0)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return

                                        if int(rx) == 5:
                                            c = Decimal(summ * 1)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2)
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance-summ) + (summ * 1)} WHERE user_id = {user_id}')

                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                            connect.commit()
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, Близко\nВаши деньги сохранились\n🍀Вы сохранили: {c2}₸ {win}',
                                                                   parse_mode='html')
                                        if int(rx) == 6:
                                            c = Decimal(summ * 3-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2)
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance-summ) + (summ * 3)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')


                                            connect.commit()
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>, Глаз алмаз!!!\n🏅 Выйгрыш составляет: +{c2}₸ {win}',
                                                                   parse_mode='html')

                                            return

                                    elif summ <= 1:

                                        await bot.send_message(chat_id,
                                                               f'🎯 <a href="tg://user?id={user_id}">{user_name}</a>, нельзя ставить отрицательное число! {loser}',
                                                               parse_mode='html')
                                elif int(balance) <= int(summ):

                                    await bot.send_message(chat_id,
                                                           f'🎯 <a href="tg://user?id={user_id}">{user_name}</a>, недостаточно средств! {loser}',
                                                           parse_mode='html')

                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Дартс [сумма] {rloser}',
                                               parse_mode='html')
                        return
                ###########################################ТРЕЙД###########################################
                if message.text.startswith("Трейд вверх") or message.text.startswith("трейд вверх"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    if message.text != 'Трейд вверх':
                        msg = message
                        user_id = msg.from_user.id
                        chat_id = message.chat.id

                        win = ['😲', '😋', '😏', '😃']
                        loser = ['🙄', '🙄', '😣', '😞', '😰']
                        rx=np.random.choice([1,2,3,4,5,6,7,8,9,10], 1, p=[0.15, 0.1, 0.1, 0.11, 0.1, 0.12, 0.1, 0.15, 0.05, 0.02])[0]
                        rwin = random.choice(win)
                        rloser = random.choice(loser)

                        msg = message
                        games = cursor.execute(
                            "SELECT games from users where user_id = ?", (message.from_user.id,))
                        games = cursor.fetchone()
                        try:
                            su = msg.text.split()[2]
                            su2 = (su).replace('к', '000')
                            su3 = (su2).replace('м', '000000')
                            su4 = (su3).replace('.', '')
                            su5 = float(su4)
                            summ = int(su5)
                            summ2 = '{:,}'.format(summ).replace(',', '.')
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Трейд вверх 1 ')
                            return



                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = round(int(balance[0]))

                        games = int(games[0])

                        player = status_users(message.from_user.id)
                        need_seconds3 = 4
                        current_time_bonus3 = datetime.now()
                        last_datetime3 = game_time.get(message.from_user.id)

                        # Если первое сообщение (время не задано)
                        if not last_datetime3:
                            game_time[message.from_user.id] = current_time_bonus3
                            last_datetime3 = datetime.fromtimestamp(0)
                        if last_datetime3:

                            # Разница в секундах между текущим временем и временем последнего сообщения
                            delta_seconds3 = (current_time_bonus3 - last_datetime3).total_seconds()

                            # Осталось ждать секунд перед отправкой
                            seconds_left3 = int(need_seconds3 - delta_seconds3)

                            # Если время ожидания не закончилось
                            if seconds_left3 > 0:
                                left1 = seconds_left3
                                await bot.send_message(message.chat.id,
                                                       f'📈 <a href="tg://user?id={user_id}">{user_name}</a>, играть можно через {round(left1)} сек {rloser}',
                                                       parse_mode='html')
                            else:
                                game_time[message.from_user.id] = current_time_bonus3
                                if balance >= summ:
                                    if summ > 0:


                                        if int(rx) ==1:
                                            c = Decimal(summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\nВы проиграли -{c2}₸ \n📈 Трейд пошел вниз на 33% {rloser}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {balance - summ} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) ==2:
                                            c = Decimal(summ * 0.75)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a> вы проиграли -{c2}₸ \n📈 Трейд пошел вниз на 43% {rloser}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {balance - summ * 0.75} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) ==3:
                                            c = Decimal(summ * 0.5)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a> вы проиграли -{c2}₸ \n📈 Трейд пошел вниз на 11% {rloser}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {balance - summ * 0.5} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) ==4:
                                            c = Decimal(summ * 0.25)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a> вы проиграли -{c2}₸ \n📈 Трейд пошел вниз на 56% {rloser}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {balance - summ * 0.25} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) ==5:
                                            c = summ * 1
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a> деньги остаются у вас: {c2}₸ \n📈 Трейд остался на месте. {rwin}',
                                                                   parse_mode='html')

                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                            connect.commit()
                                            return
                                        if int(rx) ==6:
                                            c = Decimal(summ * 1.25-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a> вы выиграли: +{c2}₸ \n📈 Трейд пошел вверх на 77% {rwin}',
                                                                   parse_mode='html')

                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 1.25)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) ==7:
                                            c = Decimal(summ * 1.5-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a> выиграли +{c2}₸  📈 Трейд пошел вверх на 88% {rwin}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 1.5)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) ==8:
                                            c = Decimal(summ * 1.75-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a> выиграли: +{c2}₸  📈 Трейд пошел вниз на 18% {rwin}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 1.75)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) ==9:
                                            c = Decimal(summ * 2-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a> выиграли: +{c2}₸  📈 Трейд пошел вниз на 9% {rwin}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 2)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) ==10:
                                            c = Decimal(summ * 3-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a> выиграли: +{c2}₸  📈 Трейд пошел вверх на 55% {rwin}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 3)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return

                                    elif summ <= 1:

                                        await bot.send_message(chat_id,
                                                               f'<a href="tg://user?id={user_id}">{user_name}</a>, нельзя ставить отрицательное число для этой игры! {rloser}',
                                                               parse_mode='html')
                                elif int(balance) <= int(summ):

                                    await bot.send_message(chat_id, f'😰 {user_name}, недостаточно средств! для этой игры трейд.',
                                                           parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Трейд вверх [сумма] {rloser}',
                                               parse_mode='html')
                        return
                ###########################################ТРЕЙД###########################################
                if message.text.startswith("Трейд вниз") or message.text.startswith("трейд вниз"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    if message.text != 'Трейд вниз':
                        msg = message
                        user_id = msg.from_user.id
                        chat_id = message.chat.id

                        win = ['😲', '😋', '😏', '😃']
                        loser = ['🙄', '🙄', '😣', '😞', '😰']
                        rx=np.random.choice([1,2,3,4,5,6,7,8,9,10], 1, p=[0.15, 0.1, 0.1, 0.11, 0.1, 0.12, 0.1, 0.15, 0.05, 0.02])[0]
                        rwin = random.choice(win)
                        rloser = random.choice(loser)
                        games = cursor.execute(
                            "SELECT games from users where user_id = ?", (message.from_user.id,))
                        games = cursor.fetchone()
                        games = int(games[0])
                        msg = message

                        try:
                            su = msg.text.split()[2]
                            su2 = (su).replace('к', '000')
                            su3 = (su2).replace('м', '000000')
                            su4 = (su3).replace('.', '')
                            su5 = float(su4)
                            summ = int(su5)
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Трейд вниз 1 ')
                            return
                        summ2 = '{:,}'.format(summ).replace(',', '.')

                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = round(int(balance[0]))

                        player = status_users(message.from_user.id)
                        need_seconds3 = 4
                        current_time_bonus3 = datetime.now()
                        last_datetime3 = game_time.get(message.from_user.id)

                        # Если первое сообщение (время не задано)
                        if not last_datetime3:
                            game_time[message.from_user.id] = current_time_bonus3
                            last_datetime3 = datetime.fromtimestamp(0)
                        if last_datetime3:

                            # Разница в секундах между текущим временем и временем последнего сообщения
                            delta_seconds3 = (current_time_bonus3 - last_datetime3).total_seconds()

                            # Осталось ждать секунд перед отправкой
                            seconds_left3 = int(need_seconds3 - delta_seconds3)

                            # Если время ожидания не закончилось
                            if seconds_left3 > 0:
                                left1 = seconds_left3
                                await bot.send_message(message.chat.id,
                                                       f'📈 <a href="tg://user?id={user_id}">{user_name}</a>, играть можно через {round(left1)} сек {rloser}',
                                                       parse_mode='html')
                            else:
                                game_time[message.from_user.id] = current_time_bonus3
                                if balance >= summ:
                                    if summ > 0:

                                        if int(rx) ==1:
                                            c = Decimal(summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\nВы проиграли -{c2}₸ \n📈 Трейд пошел вверх на 33% {rloser}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {balance - summ} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()
                                            return
                                        if int(rx) ==2:
                                            c = Decimal(summ * 0.75)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a> вы проиграли -{c2}₸ \n📈 Трейд пошел вверх на 43% {rloser}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {balance - summ * 0.75} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()
                                            return
                                        if int(rx) ==3:
                                            c = Decimal(summ * 0.5)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a> вы проиграли -{c2}₸ \n📈 Трейд пошел вверх на 81% {rloser}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {balance - summ * 0.5} WHERE user_id = {user_id}')

                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                            connect.commit()
                                            return
                                        if int(rx) ==4:
                                            c = Decimal(summ * 0.25)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a> вы проиграли -{c2}₸ \n📈 Трейд пошел вверх на 56% {rloser}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {balance - summ * 0.25} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()
                                            return
                                        if int(rx) ==5:
                                            c = summ * 1
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a> деньги остаются у вас: {c2}₸ \n📈 Трейд остался на месте. {rwin}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            return
                                        if int(rx) ==6:
                                            c = Decimal(summ * 1.25-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a> вы выиграли: +{c2}₸ \n📈 Трейд пошел низ на 7% {rwin}',
                                                                   parse_mode='html')

                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 1.25)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()
                                            return
                                        if int(rx) ==7:
                                            c = Decimal(summ * 1.5-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a> вы выиграли: +{c2}₸  📈 Трейд пошел на низ 19% {rwin}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 1.5)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()
                                            return
                                        if int(rx) ==8:
                                            c = Decimal(summ * 1.75-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a> выиграли: +{c2}₸  📈 Трейд пошел вниз на 18% {rwin}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 1.75)} WHERE user_id = {user_id}')

                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                            connect.commit()
                                            return
                                        if int(rx) ==9:
                                            c = Decimal(summ * 2-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a> выиграли: +{c2}₸  📈 Трейд пошел вниз на 9% {rwin}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 2)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()
                                            return
                                        if int(rx) ==10:
                                            c = Decimal(summ * 3-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a> выиграли: +{c2}₸  📈 Трейд пошел низ 4% {rwin}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 3)} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()
                                            return

                                    elif summ <= 1:

                                        await bot.send_message(chat_id,
                                                               f'😰 <a href="tg://user?id={user_id}">{user_name}</a>, нельзя ставить отрицательное число для этой игры! {rloser}',
                                                               parse_mode='html')
                                elif int(balance) <= int(summ):

                                    await bot.send_message(chat_id,
                                                           f'😰 <a href="tg://user?id={user_id}">{user_name}</a>, недостаточно средств! для этой игры трейд.',
                                                           parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Трейд вниз [сумма] {rloser}',
                                               parse_mode='html')
                        return


                        ###########################################ДАЙК[К]###########################################

                if message.text.startswith("Дайк к") or message.text.startswith("дайк к"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    if message.text != 'Дайк к':
                        msg = message
                        user_id = msg.from_user.id
                        chat_id = message.chat.id

                        win = ['🙂', '😋', '😄', '😃']
                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rx=np.random.choice([1,2,3,4,5,6,7,8,9,10], 1, p=[0.15, 0.1, 0.1, 0.11, 0.1, 0.12, 0.1, 0.15, 0.05, 0.02])[0]
                        rwin = random.choice(win)
                        rloser = random.choice(loser)

                        msg = message

                        games = cursor.execute(
                            "SELECT games from users where user_id = ?", (message.from_user.id,))
                        games = cursor.fetchone()
                        name = msg.from_user.last_name
                        try:
                            su = msg.text.split()[2]
                            su2 = (su).replace('к', '000')
                            su3 = (su2).replace('м', '000000')
                            su4 = (su3).replace('.', '')
                            su5 = float(su4)
                            summ = int(su5)
                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Дайк к\в 1 ')
                            return


                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = round(int(balance[0]))


                        games = int(games[0])
                        player = status_users(message.from_user.id)
                        need_seconds3 = 4
                        current_time_bonus3 = datetime.now()
                        last_datetime3 = game_time.get(message.from_user.id)

                        # Если первое сообщение (время не задано)
                        if not last_datetime3:
                            game_time[message.from_user.id] = current_time_bonus3
                            last_datetime3 = datetime.fromtimestamp(0)
                        if last_datetime3:

                            # Разница в секундах между текущим временем и временем последнего сообщения
                            delta_seconds3 = (current_time_bonus3 - last_datetime3).total_seconds()

                            # Осталось ждать секунд перед отправкой
                            seconds_left3 = int(need_seconds3 - delta_seconds3)

                            # Если время ожидания не закончилось
                            if seconds_left3 > 0:
                                left1 = seconds_left3
                                await bot.send_message(message.chat.id,
                                                       f'🎱 <a href="tg://user?id={user_id}">{user_name}</a>, играть можно через {round(left1)} сек {rloser}',
                                                       parse_mode='html')
                            else:
                                game_time[message.from_user.id] = current_time_bonus3
                                if balance >= summ:
                                    if summ > 0:


                                        if int(rx) ==1:
                                            c = Decimal(summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🎱  Игра: Дайк\n🗒  Проигрыш: -{c2}₸   \n🎲 Выпала система [В]',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {balance - summ} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()
                                            return

                                        if int(rx) ==2:
                                            c = Decimal(summ * 0.25)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🎱  Игра: Дайк\n🗒  Проигрыш: -{c2}₸   \n🎲 Выпала система [В]',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {balance - summ * 0.25} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) == 3:
                                            c = Decimal(summ * 0.5)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🎱  Игра: Дайк\n🗒  Проигрыш: -{c2}₸   \n🎲 Выпала система [В]',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {balance - summ * 0.5} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) ==4:
                                            c = Decimal(summ * 0.75)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🎱  Игра: Дайк\n🗒  Проигрыш: -{c2}₸   \n🎲 Выпала система [В]',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {balance - summ * 0.75} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) ==5:
                                            c = summ * 1
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🎱  Игра: Дайк\n🧾  Деньги остаются у вас: {c2}₸ ',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()
                                            return
                                        if int(rx) ==6:
                                            c = Decimal(summ * 1.25-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🎱  Игра: Дайк\n📝  Выигрыш: +{c2}₸  \n🎲 Выпала система [К]',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 1.25)} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) ==7:
                                            c = Decimal(summ * 1.5-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🎱 Игра: Дайк\n📝  Выигрыш: +{c2}₸ \n 🎲 Выпала система [К]',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 1.5)} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) ==8:
                                            c = Decimal(summ * 1.75-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🎱  Игра: Дайк\n📝  Выигрыш: +{c2}₸ \n🎲 Выпала система [К]',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 1.75)} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) ==9:
                                            c = Decimal(summ * 2-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🎱  Игра: Дайк\n🧾  Выигрыш: +{c2}₸  \n🎲 Выпала система [К] {rwin}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 2)} WHERE user_id = {user_id}')



                                            connect.commit()
                                            return
                                        if int(rx) ==10:
                                            c = Decimal(summ * 3-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🎱  Игра: Дайк \n🧾  Выигрыш: +{c2}₸ \n🎲 Выпала система [К]',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 3)} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return


                                    elif summ <= 1:

                                        await bot.send_message(chat_id,
                                                               f'⚙ <a href="tg://user?id={user_id}">{user_name}</a>, Нельзя ставить отрицательное число. {rloser}',
                                                               parse_mode='html')
                                elif int(balance) <= int(summ):

                                    await bot.send_message(chat_id,
                                                           f'⚙ <a href="tg://user?id={user_id}">{user_name}</a>, недостаточно средств! {rloser}',
                                                           parse_mode='html')

                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Дайк к [сумма] {rloser}',
                                               parse_mode='html')
                        return

                if message.text.startswith("Монетка") or message.text.startswith("монетка"):
                    message = message
                    user_id = message.from_user.id
                    chat_id = message.chat.id
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name=cursor.fetchone()
                    user_name = str(user_name[0])
                    reply = message.from_user.id
                    win = ['🙂', '😋', '😄', '😃']
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    mon1=["Орёл","Решка"]
                    mon11 = random.choice(mon1)

                    rwin = random.choice(win)
                    rloser = random.choice(loser)


                    try:
                        monet = msg.text.split()[1]
                        su = msg.text.split()[2]
                        su2 = (su).replace('к', '000')
                        su3 = (su2).replace('м', '000000')
                        su4 = (su3).replace('.', '')
                        su5 = float(su4)
                        summ = int(su5)
                    except:
                        await message.reply('‼️  Неправильный ввод команды!\nПример: Монетка Орёл\Решка 1 ')
                        return

                    name1 = cursor.execute("SELECT user_name from users where user_id = ?",
                                           (message.from_user.id,))
                    name1=cursor.fetchone()
                    name1 = (name1[0])
                    name = cursor.execute("SELECT user_name from users where user_id = ?",
                                          (message.from_user.id,))
                    name=cursor.fetchone()
                    name = (name[0])


                    balance = cursor.execute("SELECT balance from users where user_id = ?",
                                             (message.from_user.id,))
                    balance=cursor.fetchone()
                    balance = round(int(balance[0]))

                    games = cursor.execute("SELECT games from users where user_id = ?", (message.from_user.id,))
                    games=cursor.fetchone()
                    games = int(games[0])
                    summ2 = Decimal(summ)
                    summ3 = round(summ)
                    summ3 = '{:,}'.format(summ3).replace(',', '.')

                    num_lose = cursor.execute(
                        "SELECT num_lose FROM users WHERE user_id = ?", (message.from_user.id,))
                    num_lose = cursor.fetchone()
                    num_lose = int(num_lose[0])
                    num_win = cursor.execute(
                        "SELECT num_win FROM users WHERE user_id = ?", (message.from_user.id,))
                    num_win = cursor.fetchone()
                    num_win = int(num_win[0])
                    player = status_users(message.from_user.id)
                    need_seconds3 = 4
                    current_time_bonus3 = datetime.now()
                    last_datetime3 = game_time.get(message.from_user.id)

                    # Если первое сообщение (время не задано)
                    if not last_datetime3:
                        game_time[message.from_user.id] = current_time_bonus3
                        last_datetime3 = datetime.fromtimestamp(0)
                    if last_datetime3:

                        # Разница в секундах между текущим временем и временем последнего сообщения
                        delta_seconds3 = (current_time_bonus3 - last_datetime3).total_seconds()

                        # Осталось ждать секунд перед отправкой
                        seconds_left3 = int(need_seconds3 - delta_seconds3)

                        # Если время ожидания не закончилось
                        if seconds_left3 > 0:
                            left1 = seconds_left3
                            await bot.send_message(message.chat.id,
                                                   f'🎮 <a href="tg://user?id={user_id}">{user_name}</a>, играть можно через {round(left1)} сек {rloser}',
                                                   parse_mode='html')
                        else:
                            game_time[message.from_user.id] = current_time_bonus3
                            if balance >= summ:
                                if summ > 0:
                                    if monet in mon1:

                                        if num_lose >= 15:


                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={reply}">{user_name}</a>\n🎮 Игра: Орёл/Решка \n💸 Ставка: {summ3}₸\n💡 Выводы:\nМонетка упала ребром!\n{rwin}  Выигрыш: 0₸ ',
                                                                   parse_mode='html')


                                            cursor.execute(f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET num_lose={0} WHERE user_id = ?',
                                                (message.from_user.id,))

                                            connect.commit()
                                            return
                                        elif num_win >= 15:

                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={reply}">{user_name}</a>\n🎮 Игра: Орёл/Решка \n💸 Ставка: {summ3}₸\n💡 Выводы:\nМонетка упала ребром!\n{rwin} Проигрыш: 0₸ ',
                                                                   parse_mode='html')


                                            cursor.execute(f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            cursor.execute(
                                                f'UPDATE users SET num_win={0} WHERE user_id = ?', (message.from_user.id,))

                                            connect.commit()
                                            return
                                        else:
                                            if monet==mon11:
                                                c = Decimal(summ * 2-summ)
                                                c2 = round(c)
                                                c2 = '{:,}'.format(c2).replace(',', '.')
                                                await bot.send_message(chat_id,
                                                                       f'{player} ➪ <a href="tg://user?id={reply}">{user_name}</a>\n🎮 Игра: Орёл/Решка \n💸 Ставка: {summ3}₸\n💡 Выводы:\nВыпал {mon11}!\n{rwin} Выигрыш: +{c2}₸ x2',
                                                                       parse_mode='html')
                                                cursor.execute(
                                                    f'UPDATE users SET balance = {(balance - summ) + (summ * 2)} WHERE user_id = {user_id}')

                                                cursor.execute(f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                                cursor.execute(
                                                    f'UPDATE users SET num_lose={0} WHERE user_id = ?',
                                                    (message.from_user.id,))
                                                cursor.execute(
                                                    f'UPDATE users SET num_win={num_win + 1} WHERE user_id = ?',
                                                    (message.from_user.id,))
                                                connect.commit()
                                                return
                                            else:
                                                c = Decimal(summ * 0)
                                                c2 = round(c)
                                                c2 = '{:,}'.format(c2).replace(',', '.')
                                                await bot.send_message(chat_id,
                                                                       f'{player} ➪ <a href="tg://user?id={reply}">{user_name}</a>\n🎮 Игра: Орёл/Решка \n💸 Ставка: {summ3}₸\n💡 Выводы:\nВыпал {mon11}!\n{rloser} Проигрыш: -{summ3}₸ x0',
                                                                       parse_mode='html')
                                                cursor.execute(
                                                    f'UPDATE users SET balance = {balance - summ} WHERE user_id = {user_id}')

                                                cursor.execute(f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                                cursor.execute(
                                                    f'UPDATE users SET num_lose={num_lose + 1} WHERE user_id = ?',
                                                    (message.from_user.id,))
                                                cursor.execute(
                                                    f'UPDATE users SET num_win={0} WHERE user_id = ?', (message.from_user.id,))

                                                connect.commit()
                                                return
                                    else:

                                        await bot.send_message(chat_id,
                                                               f'‼️<a href="tg://user?id={reply}">{user_name}</a>, Проверь правильность ввода Орёл/Решка {rloser}',
                                                               parse_mode='html')
                                elif summ <= 1:

                                    await bot.send_message(chat_id,
                                                           f'‼️<a href="tg://user?id={reply}">{user_name}</a>, нельзя ставить отрицательное число! {rloser}',
                                                           parse_mode='html')
                            elif int(balance) <= int(summ):

                                await bot.send_message(chat_id,
                                                       f'💰 <a href="tg://user?id={reply}">{user_name}</a>, недостаточно средств! {rloser}',
                                                       parse_mode='html')

                    ###########################################ДАЙК[К]###########################################
                if message.text.startswith("Дайк в") or message.text.startswith("дайк в"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    if message.text != 'Дайк в':
                        msg = message
                        user_id = msg.from_user.id
                        chat_id = message.chat.id

                        win = ['🙂', '😋', '😄', '😃']
                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rx=np.random.choice([1,2,3,4,5,6,7,8,9,10], 1, p=[0.15, 0.1, 0.1, 0.11, 0.1, 0.12, 0.1, 0.15, 0.05, 0.02])[0]
                        rwin = random.choice(win)
                        rloser = random.choice(loser)

                        msg = message

                        games = cursor.execute(
                            "SELECT games from users where user_id = ?", (message.from_user.id,))
                        games = cursor.fetchone()
                        name = msg.from_user.last_name

                        try:
                            su = msg.text.split()[2]
                            su2 = (su).replace('к', '000')
                            su3 = (su2).replace('м', '000000')
                            su4 = (su3).replace('.', '')
                            su5 = float(su4)
                            summ = int(su5)

                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Дайк в 1 ')
                            return


                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = round(int(balance[0]))


                        games = int(games[0])
                        player = status_users(message.from_user.id)
                        need_seconds3 = 4
                        current_time_bonus3 = datetime.now()
                        last_datetime3 = game_time.get(message.from_user.id)

                        # Если первое сообщение (время не задано)
                        if not last_datetime3:
                            game_time[message.from_user.id] = current_time_bonus3
                            last_datetime3 = datetime.fromtimestamp(0)
                        if last_datetime3:

                            # Разница в секундах между текущим временем и временем последнего сообщения
                            delta_seconds3 = (current_time_bonus3 - last_datetime3).total_seconds()

                            # Осталось ждать секунд перед отправкой
                            seconds_left3 = int(need_seconds3 - delta_seconds3)

                            # Если время ожидания не закончилось
                            if seconds_left3 > 0:
                                left1 = seconds_left3
                                await bot.send_message(message.chat.id,
                                                       f'🎱 <a href="tg://user?id={user_id}">{user_name}</a>, играть можно через {round(left1)} сек {rloser}',
                                                       parse_mode='html')
                            else:
                                game_time[message.from_user.id] = current_time_bonus3
                                if balance >= summ:
                                    if summ > 0:

                                        if int(rx) == 1:
                                            c = Decimal(summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🎱 Игра: Дайк\n🗒 Проигрыш: -{c2}₸   \n🎲 Выпала система [К]',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {balance - summ} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()
                                            return

                                        if int(rx) == 2:
                                            c = Decimal(summ * 0.25)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🎱 Игра: Дайк\n🗒 Проигрыш: -{c2}₸   \n🎲 Выпала система [К]',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {balance - summ * 0.25} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) == 3:
                                            c = Decimal(summ * 0.5)

                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🎱 Игра: Дайк\n🗒 Проигрыш: -{c2}₸   \n🎲 Выпала система [К]',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {balance - summ * 0.5} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) == 4:
                                            c = Decimal(summ * 0.75)

                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🎱 Игра: Дайк\n🗒 Проигрыш: -{c2}₸   \n🎲 Выпала система [К]]',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {balance - summ * 0.75} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) == 5:
                                            c = summ * 1

                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🎱 Игра: Дайк\n🧾 Деньги остаются у вас: {c2}₸ ',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')

                                            connect.commit()
                                            return
                                        if int(rx) == 6:
                                            c = Decimal(summ * 1.25-summ)

                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🎱 Игра: Дайк\n📝 Выигрыш: +{c2}₸  \n🎲 Выпала система [В]',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 1.25)} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) == 7:
                                            c = Decimal(summ * 1.5-summ)
                                            print(c)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🎱 Игра: Дайк\n📝 Выигрыш: +{c2}₸ \n 🎲 Выпала система [В]',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 1.5)} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) == 8:
                                            c = Decimal(summ * 1.75-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🎱 Игра: Дайк\n📝 Выигрыш: +{c2}₸ \n🎲 Выпала система [В]',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 1.75)} WHERE user_id = {user_id}')


                                            connect.commit()
                                            return
                                        if int(rx) == 9:
                                            c = Decimal(summ * 2-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🎱 Игра: Дайк\n🧾 Выигрыш: +{c2}₸  \n🎲 Выпала система [В] {rwin}',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 2)} WHERE user_id = {user_id}')



                                            connect.commit()
                                            return
                                        if int(rx) == 10:
                                            c = Decimal(summ * 3-summ)
                                            c2 = round(c)
                                            c2 = '{:,}'.format(c2).replace(',', '.')
                                            await bot.send_message(chat_id,
                                                                   f'{player} ➪ <a href="tg://user?id={user_id}">{user_name}</a>\n🎱 Игра: Дайк \n🧾 Выигрыш: +{c2}₸ \n🎲 Выпала система [В]',
                                                                   parse_mode='html')
                                            cursor.execute(
                                                f'UPDATE users SET games = {games + 1} WHERE user_id = {user_id}')
                                            cursor.execute(
                                                f'UPDATE users SET balance = {(balance - summ) + (summ * 3)} WHERE user_id = {user_id}')

                                            connect.commit()
                                            return


                                    elif summ <= 1:

                                        await bot.send_message(chat_id,
                                                               f'⚙ <a href="tg://user?id={user_id}">{user_name}</a> Нельзя ставить отрицательное число. {rloser}',
                                                               parse_mode='html')
                                elif int(balance) <= int(summ):

                                    await bot.send_message(chat_id,
                                                           f'⚙ <a href="tg://user?id={user_id}">{user_name}</a>, недостаточно средств! {rloser}',
                                                           parse_mode='html')

                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Дайк в [сумма] {rloser}',
                                               parse_mode='html')
                        return
                        ###########################################РЕЙТИНГ###########################################
                if message.text.lower() in ["рейтинг", "Рейтинг"]:
                    msg = message
                    name1 = message.from_user.get_mention(as_html=True)

                    rating = cursor.execute(
                        "SELECT rating from users where user_id = ?", (message.from_user.id,))
                    rating = cursor.fetchone()
                    rating = int(rating[0])
                    rating2 = '{:,}'.format(rating).replace(',', '.')

                    await bot.send_message(message.chat.id, f'{name1}, ваш рейтинг {rating2}👑', parse_mode='html')

                if message.text.startswith("Купить рейтинг") or message.text.startswith("купить рейтинг")or message.text.startswith("рейтинг купить"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    if message.text != 'Купить рейтинг':
                        msg = message
                        user_id = msg.from_user.id
                        chat_id = message.chat.id
                        user_name = message.from_user.get_mention(as_html=True)

                        try:
                            su = msg.text.split()[2]
                            su2 = (su).replace('к', '000')
                            su3 = (su2).replace('м', '000000')
                            su4 = (su3).replace('.', '')
                            su5 = float(su4)
                            summ2 = int(su5)

                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Купить рейтинг 1 ')
                            return


                        win = ['🙂', '😋', '😄', '🤑', '😃']
                        rwin = random.choice(win)
                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])
                        rating = cursor.execute(
                            "SELECT rating from users where user_id = ?", (message.from_user.id,))
                        rating = cursor.fetchone()
                        rating = int(rating[0])
                        rating2 = '{:,}'.format(summ2).replace(',', '.')
                        c = summ2 * 150000000
                        c2 = '{:,}'.format(c).replace(',', '.')
                        if summ2 > 0:
                            if int(balance) >= int(summ2 * 150000000):
                                await bot.send_message(message.chat.id,
                                                       f'{user_name}, вы повысили количество вашего рейтинга на {rating2}👑 за {c2}₸ ! {rwin}',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - c} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET rating = {rating + summ2} WHERE user_id = {user_id}')
                                connect.commit()

                            if int(balance) < int(summ2 * 150000000):
                                await bot.send_message(message.chat.id, f'{user_name}, недостаточно средств! {rloser}',
                                                       parse_mode='html')

                        if summ2 <= 0:
                            await bot.send_message(message.chat.id, f'{user_name}, нельзя купить отрицательное число! {rloser}',
                                                   parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Купить рейтинг [сумма] {rloser}',
                                               parse_mode='html')
                        return
                if message.text.startswith("Продать рейтинг")or message.text.startswith("продать рейтинг")or message.text.startswith("рейтинг продать"):
                    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (message.from_user.id,))
                    user_name = cursor.fetchone()
                    user_name = user_name[0]
                    user_id = message.from_user.id

                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    if message.text != 'Продать рейтинг':
                        msg = message
                        user_id = msg.from_user.id
                        chat_id = message.chat.id
                        user_name = message.from_user.get_mention(as_html=True)
                        try:
                            su = msg.text.split()[2]
                            su2 = (su).replace('к', '000')
                            su3 = (su2).replace('м', '000000')
                            su4 = (su3).replace('.', '')
                            su5 = float(su4)
                            summ2 = int(su5)

                        except:
                            await message.reply('‼️  Неправильный ввод команды!\nПример: Продать рейтинг 1 ')
                            return


                        win = ['🙂', '😋', '😄', '🤑', '😃']
                        rwin = random.choice(win)
                        loser = ['😔', '😕', '😣', '😞', '😢']
                        rloser = random.choice(loser)
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (message.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])
                        rating = cursor.execute(
                            "SELECT rating from users where user_id = ?", (message.from_user.id,))
                        rating = cursor.fetchone()
                        rating = int(rating[0])
                        c = summ2 * 100000000
                        c2 = '{:,}'.format(c).replace(',', '.')
                        rating2 = '{:,}'.format(summ2).replace(',', '.')
                        if summ2 > 0:
                            if int(rating) >= int(summ2):
                                await bot.send_message(message.chat.id,
                                                       f'{user_name}, вы понизили количество вашего рейтинга на {rating2}👑 за {c2}₸ ! {rwin}',
                                                       parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance + c} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET rating = {rating - summ2} WHERE user_id = {user_id}')
                                connect.commit()

                            if int(rating) < int(summ2):
                                await bot.send_message(message.chat.id,
                                                       f'{user_name}, у вас недостаточно рейтинга для его продажи! {rloser}',
                                                       parse_mode='html')

                        if summ2 <= 0:
                            await bot.send_message(message.chat.id, f'{user_name}, нельзя продать отрицательное число! {rloser}',
                                                   parse_mode='html')
                    else:
                        await bot.send_message(message.chat.id,
                                               f'‼️ <a href="tg://user?id={user_id}">{user_name}</a>,Ошибка! Пример Продать рейтинг [сумма] {rloser}',
                                               parse_mode='html')
                        return

                ###########################################ПЕРЕВОДЫ###########################################
                if message.text.startswith('тдать') or message.text.startswith('Тдать'):
                    msg = message
                    user_id = msg.from_user.id
                    name = msg.from_user.last_name
                    user_name = message.from_user.get_mention(as_html=True)
                    try:
                        reply_user_name = message.reply_to_message.from_user.get_mention(
                            as_html=True)
                        reply_user_id = msg.reply_to_message.from_user.id
                    except:
                        await message.reply('‼️Сообщение должно быть ответом на сообщение! ')
                        return
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    try:
                        su = msg.text.split()[1]
                        su2 = (su).replace('к', '000')
                        su3 = (su2).replace('м', '000000')
                        su4 = (su3).replace('.', '')
                        su5 = float(su4)
                        perevod = int(su5)
                        perevod2 = '{:,}'.format(perevod).replace(',', '.')
                    except:
                        await message.reply('‼️  Неправильный ввод команды!\nПример: тдать 1 ')
                        return

                    ticket = cursor.execute(
                        "SELECT ticket from users where user_id = ?", (message.from_user.id,))
                    ticket = cursor.fetchone()
                    ticket = round(int(ticket[0]))
                    ticket2 = cursor.execute("SELECT ticket from users where user_id = ?",
                                              (message.reply_to_message.from_user.id,))
                    ticket2 = cursor.fetchone()
                    ticket2 = round(ticket2[0])

                    if reply_user_id == user_id:
                        await message.reply(
                            f' 🎟️ Вы не можете передать тикеты сами себе! {rloser}',
                            parse_mode='html')
                        return

                    if perevod > 0:
                        if ticket >= perevod:


                            await bot.send_message(cfg.log_group, f"""
⚙️LOG: #переводы
{rwin} <a href="tg://user?id={user_id}">{user_name}</a>(<code>{user_id}</code>) совершил перевод игроку
{rwin} <a href="tg://user?id={reply_user_id}">{reply_user_name}</a>(<code>{reply_user_id}</code>) : {perevod2} тикетов 🎟️
""", parse_mode='html')
                            await bot.send_message(message.chat.id,
                                                 text=f'Вы передали {perevod2}🎟️ игроку {reply_user_name} {rwin}',
                                                 parse_mode='html')
                            cursor.execute(
                                f'UPDATE users SET ticket = {ticket - perevod} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET ticket = {ticket2 + perevod} WHERE user_id = {reply_user_id}')
                            connect.commit()
                        else:
                            await message.reply(f'{user_name}, недостаточно тикетов 🎟️! {rloser}',
                                                parse_mode='html')

                    if perevod <= 0:
                        await message.reply(f'{user_name}, нельзя перевести отрицательное число! {rloser}',
                                            parse_mode='html')
                if message.text.startswith('Дать') or message.text.startswith('дать'):
                    msg = message
                    user_id = msg.from_user.id
                    name = msg.from_user.last_name
                    user_name = message.from_user.get_mention(as_html=True)
                    try:
                        reply_user_name = message.reply_to_message.from_user.get_mention(
                            as_html=True)
                        reply_user_id = msg.reply_to_message.from_user.id
                    except:
                        await message.reply('‼️Сообщение должно быть ответом на сообщение! ')
                        return
                    data = await get_rang2(reply_user_id)
                    if data is None:
                        return await message.reply(f"🚫 <b>Не найден в базе данных.</b>", parse_mode='html')
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)

                    try:
                        su = msg.text.split()[1]
                        su2 = (su).replace('к', '000')
                        su3 = (su2).replace('м', '000000')
                        su4= (su3).replace('.', '')
                        su5 = float(su4)
                        perevod = int(su5)
                        perevod2 = '{:,}'.format(perevod).replace(',', '.')
                    except:
                        await message.reply('‼️  Неправильный ввод команды!\nПример: дать 1 ')
                        return
                    user_status = cursor.execute(
                        "SELECT user_status from users where user_id = ?", (message.from_user.id,))
                    user_status = cursor.fetchone()
                    user_status = user_status[0]

                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = round(int(balance[0]))
                    balance2 = cursor.execute("SELECT balance from users where user_id = ?",
                                              (message.reply_to_message.from_user.id,))
                    balance2 = cursor.fetchone()
                    balance2 = round(balance2[0])
                    limit = cursor.execute(
                        "SELECT limitpered from users where user_id = ?", (message.from_user.id,))
                    limit = cursor.fetchone()
                    limit = round(limit[0])

                    if limit - perevod >= 0 or user_status=="Rab":
                        if reply_user_id == user_id:
                            await message.reply_to_message.reply(f'Вы не можете передать деньги сами себе! {rloser}',
                                                                 parse_mode='html')
                            return

                        if perevod > 0:
                            if balance >= perevod:
                                photo = open("assets/perevod.jpg", 'rb')

                                await bot.send_message(cfg.log_group,f"""
⚙️LOG: #переводы
{rwin} <a href="tg://user?id={user_id}">{user_name}</a>(<code>{user_id}</code>) совершил перевод игроку
{rwin} <a href="tg://user?id={reply_user_id}">{reply_user_name}</a>(<code>{reply_user_id}</code>) на сумму в размере {perevod2}₸
""", parse_mode='html')
                                await bot.send_photo(message.chat.id, photo=photo,
                                                     caption=f'Вы передали {perevod2}₸  игроку {reply_user_name} {rwin}',
                                                     parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - perevod} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance2 + perevod} WHERE user_id = {reply_user_id}')

                                cursor.execute(
                                    f'UPDATE users SET limitpered = {limit - perevod} WHERE user_id = {user_id}')
                                connect.commit()
                            else:
                                await message.reply(f'{user_name}, недостаточно средств! {rloser}', parse_mode='html')

                        if perevod <= 0:
                            await message.reply(f'{user_name}, нельзя перевести отрицательное число! {rloser}', parse_mode='html')
                    else:
                        limit = cursor.execute(
                            "SELECT limitpered from users where user_id = ?", (message.from_user.id,))
                        limit = cursor.fetchone()
                        limit = round(limit[0])
                        limit2 = '{:,}'.format(limit).replace(',', '.')

                        await message.reply(
                            f'{user_name},  У вас лимит передачи что увеличить лимит введите команду Донат! {rloser}\n‼️ Сумма возможной передачи: {limit2} 😞₸'
                            ,
                            parse_mode='html')
                if message.text.startswith("передать") or message.text.startswith("Передать"):
                    msg = message
                    user_id = msg.from_user.id
                    win = ['🙂', '😋', '😄', '🤑', '😃']
                    rwin = random.choice(win)
                    loser = ['😔', '😕', '😣', '😞', '😢']
                    rloser = random.choice(loser)
                    try:
                        reply_id=msg.text.split()[1]
                        if reply_id.isdigit():
                            pass
                        else:
                            await message.reply('‼️ Не хватает аргументов!\nПример: передать id ')
                            return
                        data = await get_rang2(reply_id)
                        if data is None:
                            return await message.reply(f"🚫 <b>Не найден в базе данных.</b>",parse_mode='html')
                        su = msg.text.split()[2]
                        su2 = (su).replace('к', '000')
                        su3 = (su2).replace('м', '000000')
                        su4= (su3).replace('.', '')
                        su5 = float(su4)
                        perevod = int(su5)
                        perevod2 = '{:,}'.format(perevod).replace(',', '.')
                    except:
                        await message.reply('‼️  Неправильный ввод команды!\nПример: передать id 1 ')
                        return
                    reply_user = cursor.execute("SELECT user_name from users where user_id = ?",
                                               (reply_id,))
                    reply_user = cursor.fetchone()
                    reply_user = reply_user[0]

                    balance = cursor.execute(
                        "SELECT balance from users where user_id = ?", (message.from_user.id,))
                    balance = cursor.fetchone()
                    balance = round(int(balance[0]))
                    balance2 = cursor.execute("SELECT balance from users where user_id = ?",
                                              (reply_id,))
                    balance2 = cursor.fetchone()
                    balance2 = round(balance2[0])
                    limit = cursor.execute(
                        "SELECT limitpered from users where user_id = ?", (message.from_user.id,))
                    limit = cursor.fetchone()
                    limit = round(limit[0])
                    user_status = cursor.execute(
                        "SELECT user_status from users where user_id = ?", (message.from_user.id,))
                    user_status = cursor.fetchone()
                    user_status = user_status[0]
                    if limit - perevod >= 0 or user_status=="Rab":
                        if int(reply_id) == int(user_id):
                            await message.reply(f'Вы не можете передать деньги сами себе! {rloser}',
                                                                 parse_mode='html')
                            return
                        if perevod > 0:
                            if balance >= perevod:
                                photo = open("assets/perevod.jpg", 'rb')

                                await bot.send_message(cfg.log_group, f"""
⚙️LOG: #переводы
{rwin} <a href="tg://user?id={user_id}">{user_name}</a>(<code>{user_id}</code>) совершил перевод игроку
{rwin} <a href="tg://user?id={reply_id}">{reply_user}</a>(<code>{reply_id}</code>) на сумму в размере {perevod2}₸
""", parse_mode='html')
                                await bot.send_photo(message.chat.id, photo=photo,
                                                     caption=f'Вы передали {perevod2}₸  игроку {reply_user} {rwin}',
                                                     parse_mode='html')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance - perevod} WHERE user_id = {user_id}')
                                cursor.execute(
                                    f'UPDATE users SET balance = {balance2 + perevod} WHERE user_id = {reply_id}')
                                cursor.execute(
                                    f'UPDATE users SET limitpered = {limit - perevod} WHERE user_id = {user_id}')
                                connect.commit()
                            else:
                                await message.reply(f'{user_name}, недостаточно средств! {rloser}', parse_mode='html')

                        else:
                            await message.reply(f'{user_name}, нельзя перевести отрицательное число! {rloser}',
                                                parse_mode='html')

                    else:
                        limit = cursor.execute(
                            "SELECT limitpered from users where user_id = ?", (message.from_user.id,))
                        limit = cursor.fetchone()
                        limit = round(limit[0])
                        limit2 = '{:,}'.format(limit).replace(',', '.')

                        await message.reply(
                            f'{user_name},  У вас лимит передачи что увеличить лимит введите команду Донат! {rloser}\n‼️ Сумма возможной передачи: {limit2} 😞₸'
                            ,
                            parse_mode='html')


            ###########################################ТОП###########################################

@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'main')
async def inlinebutton(callback: types.CallbackQuery):

    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id, text='''

   🏆 Категория основных:

💡 Основное:
   💸 Б/Баланс
   👤 Профиль

🪀 Разное:
   ⚒ Шахта
   💰 Продать [название руды]
   📦 Инвентарь
   
   📊 Курс руды
   🚓 Машины
   📲 Телефоны
   🛩 Самолёты
   🛳 Яхты
   🚁 Вертолёты
   🏘 Дома
   💸 Б/Баланс
   ⚡ Энергия
   🧰 фермы 
   🤝 Дать [сумма] 
   🤝 Передать [айди] 
   💰 Банк положить [сумма]
   💰 Банк снять [сумма]
   〽️Депозит
   💎 Топ
   👥 Сменить ник [новый ник]
   💼 Кейсы
   💠 Курс Фантома 
   💠 Купить фантомы [кол-во]
   💠 Продать фантомы [кол-во]
   ☁ Рп/Рп команды
   🎁 Бонус
   🍭 Донат
   ✉️ Реф - Реферальная ссылка 
💢 Важное:
   🔗 Ссылки - список официальных соц.сетей(канал/чат)''',
                                parse_mode='html', reply_markup=help_back)

@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'games')
async def inlinebutton(callback: types.CallbackQuery):

    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id, text='''
   🎮 | Категория игровых:

🎮 Игры:  
🧩 Дайк [к/в] [сумма]
🎰 Спин [сумма]
🃏 Казино [ставка]
📑 Трейд [вниз, вверх] [ставка]
🏀 Баскетбол [сумма]
🎳 Боулинг [сумма]
🎯 Дартс [сумма]
⚽ Футбол [сумма]
🧊 /gamevb, вб, вабанк
🤼 Бой [сумма]
🪙 Монетка Орёл/Решка [сумма]
🤼 Дуэль [сумма] [ответом на сообщение]
‼️Что бы использовать команду , напишите команду сообщением''', reply_markup=help_back)

@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'clans')
async def inlinebutton(callback: types.CallbackQuery):

    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id, text='''
    
🛡️ <code>Клан создать</code> (название)
🛡️ <code>Клан покинуть</code> - если вы создатель управление кланом перейдет другому игроку 
🛡️ <code>Клан вступить</code> (id)- если клан закрыт вы не сможете вступить
📁 <code>Мой клан</code> - информация о клане
👥 <code>Клан участники</code> - вывод участников клана
💰 <code>Казна пополнить</code> - деньги клана
💰 <code>Казна снять</code> - снимать может только создатель
📛 <code>Клан кик </code>(id) - изгоняет игрока из клана
🔐 <code>Клан приватность</code> 
⚔️ <code>Клан атака</code> (id)
💪 <code>Клан усилить</code> (число)
⏫ <code>Клан повысить</code>
⏬ <code>Клан понизить</code>
📝 <code>Кланы</code> - Список кланов
🛑 Будьте осторожны повышая ранг игрокам они могут управлять вашим кланом !

‼️  Текст кликабельный
''',parse_mode="html",reply_markup=help_back)

@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'city')
async def inlinebutton(callback: types.CallbackQuery):

    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id, text='''
🌇 <code>Город построить</code> - для создание города
🌃 <code>Мой город</code> - информация о вашем городе
💱 <code>Город снять</code> - снимает с казны города
🔂 <code>Г налог</code> - налог для жителей
🛣️ <code>Город дорога</code> - расширает дорогу в городе
🏭 <code>Город завод</code> - для постройки заводов
💦 <code>Город вода</code> - для постройки водонапорных башен
⚡️ <code>Город энергия</code> - для постройки АЭС
🏘️ <code>Город дом</code> - для постройки дома
🪨 <code>Город аренда</code> - можете сдавать в аренду свое имущество
♻️ <code>Город переработка</code> - для переработки руды 
‼️  Текст кликабельный
''',parse_mode="html", reply_markup=help_back)
@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'entertainment')
async def inlinebutton(callback: types.CallbackQuery):

    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id, text='''
    🐬 Категория развлекательных:
    
🎃 Развлекательные:

   🥅 Выбери [фраза1] или [фраза2]
   💽 Инфо [фраза]
   🔮 Шар [фраза]
   📟 .реши 1 + 1
   📄 Промо [название]
   📄 Промо создать [название] [сумма] [активаций] [комментарий]
   🎟️ вытянуть тикет
👰‍♀️👨‍⚖️Браки:
    💒 Брак [ответ на сообщение]
    🤬 Развод
    💍 Мой брак

    
⏰ Деловые штучки:

    🏢 Центр занятости:
        📑 Вакансии
        🖊 Устроиться [Номер]
        📈  Работать
        📉 Уволиться
        
    🧰Майнинг ферма:
        🧰 фермы
        🔋 ферма
        💸 Купить ферму [номер]
        🔌 Ферма видеокарты [кол-во]
        💰 Продать ферму
        💳 Продать видеокарты [кол-во]
        💵 Ферма снять 
        
    🏢Бизнесы:
        💰 Бизнес 
        💵 Купить бизнес [номер]
        💸 Продать бизнес
        💲 Бизнес снять
        ⏭️ Нанять рабочих
        
❄️Питомцы:
       ✏️ Питомец имя [имя]
       ❤️ Вылечить питомца
       🍗 Покормить питомца
       🌳 Выгулять питомца
       🐻‍ Мой питомец - узнать о своём питомце
       
🍑 Информации:
   🏓 /пинг - пинг мой.

    ''', reply_markup=help_back)

@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'moderatia')
async def inlinebutton(callback: types.CallbackQuery):

    user_status = cursor.execute(
        "SELECT user_status from users where user_id = ?", (callback.from_user.id,))
    user_status = cursor.fetchone()

    if user_status[0]=="Admin" or  user_status[0]=="Rab":
        await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id, text='''
🏓 Категория модерации:
выдать [в ответ на сообщение]
обнулить [в ответ на сообщение]
забрать [в ответ на сообщение]
!banb в боте [в ответ на сообщение]
!unbanb в боте [в ответ на сообщение]
!warnb в боте [в ответ на сообщение]
!unwarnb в боте [в ответ на сообщение]
.гбан в группе [в ответ на сообщение] или [id]
.гразбан в группе [в ответ на сообщение] или [id]
.заткнуть [в ответ на сообщение] или [id]
.голос [в ответ на сообщение] или [id]
инфо [в ответ на сообщение]
/info_idb [id] в боте 
/reset_id [id] в боте 
/ban_idb [id] в боте 
/unban_idb [id] в боте 
    ''', reply_markup=help_back)
    else:
        await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id, text='''
‼️ Данная команда доступна только Админам бота''',reply_markup=help_back)

#####################################################################

@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'back')
async def help(callback: types.CallbackQuery):

    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id, text=f'Выберите категорию:\n  💡 Основные\n  🎲 Игры\n  💥 Развлекательное\n  🛠Модерация чата\n  ⚔️ Кланы\n  🌇 Город\n'

                               f'🗯Вот наша беседа бота t.me/himera_bo1\n'
                               f'📣 Официальный канал: t.me/himera_news',
                                reply_markup=help_menu, parse_mode='html')

@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'topb')
async def help(callback: types.CallbackQuery):

    list = cursor.execute(f"SELECT * FROM users ORDER BY balance DESC")
    list = cursor.fetchmany(1000)
    top_list = []
    chat_id = callback.message.chat.id
    name = callback.message.from_user.get_mention(as_html=True)
    num = 1
    stop = ["0️⃣", "1️⃣", "2️⃣", "3️⃣", "4️⃣", "5️⃣", "6️⃣", "7️⃣", "8️⃣", "9️⃣", "🔟"]
    my_list = []
    top_list2 = []


    user_id = callback.from_user.id



    for user in list:
        balance7 = transform(user[2])

        if user[0]==user_id:
            for x in str(num):
                my_list.append(int(x))
                if len(my_list)==1:
                    first = stop[my_list[0]]
                    count=first
                elif len(my_list)==2:
                    first = stop[my_list[0]]
                    second = stop[my_list[1]]
                    count = first + second
                elif len(my_list)==3:
                    first = stop[my_list[0]]
                    second = stop[my_list[1]]
                    third=stop[my_list[2]]
                    count=first+second+third
                else:
                    count="⬅️"
            player = status_users(user[0])
            top_list2.append(
                f"{count} <b>{player} ➪ </b><i>{user[9]} </i> —  | 🔍ID: <code>{user[0]}</code> | <b>{balance7} ₸</b> ")

        if user[10] == 'Admin' or user[10] == 'Rab':
            pass
        else:
            if num <= 10:
                user_status = cursor.execute("SELECT user_status from users where user_id = ?",
                                              (user[0],))
                user_status = cursor.fetchone()
                if user_status[0] == 'delux':
                    user_status2 = '<b>🔥DELUXE ➪ </b>'
                else:
                    user_status2 = ''
                top_list.append(
                f"{stop[num]} {user_status2}<i>{user[9]}</i>  — | 🔍ID: <code>{user[0]}</code> | <b>  {balance7} ₸</b> ")
            num += 1
    top2 = "\n".join(top_list2)
    top = "\n".join(top_list)
    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id, text=f"{name}, Топ 10 игроков бота:\n" + top+ f"\n➖➖➖➖➖➖➖➖➖➖➖ \n"+ top2, reply_markup=help_topback, parse_mode='html')


@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'tope')
async def help(callback: types.CallbackQuery):

    list = cursor.execute(f"SELECT * FROM users ORDER BY expe DESC")
    list = cursor.fetchmany(1000)
    top_list = []
    chat_id = callback.message.chat.id
    name = callback.message.from_user.get_mention(as_html=True)
    num = 1
    my_list = []
    top_list2 = []
    stop = ["0️⃣", "1️⃣", "2️⃣", "3️⃣", "4️⃣", "5️⃣", "6️⃣", "7️⃣", "8️⃣", "9️⃣", "🔟"]

    user_id = callback.from_user.id


    for user in list:

        expe = user[7]
        expe2 = '{:,}'.format(expe).replace(',', '.')
        if user[0]==user_id:
            for x in str(num):
                my_list.append(int(x))
                if len(my_list)==1:
                    first = stop[my_list[0]]
                    count=first
                elif len(my_list)==2:
                    first = stop[my_list[0]]
                    second = stop[my_list[1]]
                    count = first + second
                elif len(my_list)==3:
                    first = stop[my_list[0]]
                    second = stop[my_list[1]]
                    third=stop[my_list[2]]
                    count=first+second+third
                else:
                    count="⬅️"
            player = status_users(user[0])
            top_list2.append(
                f"{count} <b>{player} ➪ </b><i>{user[9]} </i> —  | 🔍ID: <code>{user[0]}</code> | <b>{expe2} 💡</b> ")

        if user[10] == 'Admin' or user[10] == 'Rab':
            pass
        else:

            if num <= 10:
                user_status = cursor.execute("SELECT user_status from users where user_id = ?",
                                             (user[0],))
                user_status = cursor.fetchone()
                if user_status[0] == 'delux':
                    user_status2 = '<b>🔥DELUXE ➪ </b>'
                else:
                    user_status2 = ''
                top_list.append(
                f"{stop[num]}  {user_status2}<i>{user[9]}</i>   | 🔍ID: <code>{user[0]}</code> | <b>  {expe2} 💡</b>")
            num += 1
    top2 = "\n".join(top_list2)
    top = "\n".join(top_list)
    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id, text=f"{name}, Топ 10 игроков бота:\n" + top+ f"\n➖➖➖➖➖➖➖➖➖➖➖ \n"+ top2, reply_markup=help_topback, parse_mode='html')
@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'top_clan')
async def help(callback: types.CallbackQuery):

    list = cursor.execute(f"SELECT * FROM clans ORDER BY win DESC")
    list = cursor.fetchmany(10)
    top_list = []
    chat_id = callback.message.chat.id
    name = callback.message.from_user.get_mention(as_html=True)
    num = 1
    stop = ["0️⃣", "1️⃣", "2️⃣", "3️⃣", "4️⃣", "5️⃣", "6️⃣", "7️⃣", "8️⃣", "9️⃣", "🔟"]

    for user in list:

        win = user[7]
        win2 = '{:,}'.format(win).replace(',', '.')


        top_list.append(
            f"{stop[num]} <i>{user[2]}</i>   | 🔍ID: <code>{user[1]}</code> | <b>  {win2} 🏆</b>")
        num += 1

    top = "\n".join(top_list)
    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id, text=f"{name}, Топ 10 кланов бота:\n" + top, reply_markup=help_topback, parse_mode='html')

@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'toppet')
async def help(callback: types.CallbackQuery):

    list = cursor.execute(f"SELECT * FROM users ORDER BY game DESC")
    list = cursor.fetchmany(1000)
    top_list = []
    chat_id = callback.message.chat.id
    name = callback.message.from_user.get_mention(as_html=True)
    num = 1
    stop = ["0️⃣", "1️⃣", "2️⃣", "3️⃣", "4️⃣", "5️⃣", "6️⃣", "7️⃣", "8️⃣", "9️⃣", "🔟"]

    my_list = []
    top_list2 = []
    user_id = callback.from_user.id

    for user in list:

        petg = user[51]
        petg2 = '{:,}'.format(petg).replace(',', '.')
        if user[0]==user_id:
            for x in str(num):
                my_list.append(int(x))
                if len(my_list)==1:
                    first = stop[my_list[0]]
                    count=first
                elif len(my_list)==2:
                    first = stop[my_list[0]]
                    second = stop[my_list[1]]
                    count = first + second
                elif len(my_list)==3:
                    first = stop[my_list[0]]
                    second = stop[my_list[1]]
                    third=stop[my_list[2]]
                    count=first+second+third

                else:
                    count="⬅️"
            player = status_users(user[0])
            top_list2.append(
                f"{count} <b>{player} ➪ </b><i>{user[9]} </i> —  | 🔍ID: <code>{user[0]}</code> | <b>{petg2} 🤼</b> ")
        if num <= 10:
            user_status = cursor.execute("SELECT user_status from users where user_id = ?",
                                         (user[0],))
            user_status = cursor.fetchone()
            if user_status[0] == 'delux':
                user_status2 = '<b>🔥DELUXE ➪ </b>'
            else:
                user_status2 = ''
            top_list.append(
                f"{stop[num]}.  {user_status2}<i>{user[9]}</i>   | 🔍ID: <code>{user[0]}</code> | <b>{petg2} 🤼</b>")
        num += 1
    top2 = "\n".join(top_list2)
    top = "\n".join(top_list)
    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id, text=f"{name}, Топ 10 игроков бота:\n" + top+ f"\n➖➖➖➖➖➖➖➖➖➖➖ \n "+ top2, reply_markup=help_topback, parse_mode='html')
@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'topg')
async def help(callback: types.CallbackQuery):

    list = cursor.execute(f"SELECT * FROM users ORDER BY games DESC")
    list = cursor.fetchmany(1000)
    top_list = []
    my_list = []
    top_list2 = []
    chat_id = callback.message.chat.id
    name = callback.message.from_user.get_mention(as_html=True)
    num = 1

    stop = ["0️⃣", "1️⃣", "2️⃣", "3️⃣", "4️⃣", "5️⃣", "6️⃣", "7️⃣", "8️⃣", "9️⃣", "🔟"]

    user_id = callback.from_user.id

    for user in list:

        games = user[8]
        games2 = '{:,}'.format(games).replace(',', '.')
        if user[0]==user_id:
            for x in str(num):
                my_list.append(int(x))
                if len(my_list)==1:
                    first = stop[my_list[0]]
                    count=first
                elif len(my_list)==2:
                    first = stop[my_list[0]]
                    second = stop[my_list[1]]
                    count = first + second
                elif len(my_list)==3:
                    first = stop[my_list[0]]
                    second = stop[my_list[1]]
                    third=stop[my_list[2]]
                    count=first+second+third

                else:
                    count="⬅️"
            player = status_users(user[0])
            top_list2.append(
                f"{count} <b>{player} ➪ </b><i>{user[9]} </i> —  | 🔍ID: <code>{user[0]}</code> | <b>{games2} 🎮</b> ")
        if num <= 10:
            user_status = cursor.execute("SELECT user_status from users where user_id = ?",
                                         (user[0],))
            user_status = cursor.fetchone()
            if user_status[0] == 'delux':
                user_status2 = '<b>🔥DELUXE ➪ </b>'
            else:
                user_status2 = ''
            top_list.append(
                f"{stop[num]}.  {user_status2}<i>{user[9]}</i>   | 🔍ID: <code>{user[0]}</code> | <b>{games2} 🎮</b>")
        num += 1
    top2 = "\n".join(top_list2)
    top = "\n".join(top_list)
    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id, text=f"{name}, Топ 10 игроков бота:\n" + top+ f"\n➖➖➖➖➖➖➖➖➖➖➖ \n "+ top2, reply_markup=help_topback, parse_mode='html')
@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'top_city')
async def help(callback: types.CallbackQuery):

    list = cursor.execute(f"SELECT * FROM city ORDER BY work_place DESC")
    list = cursor.fetchmany(1000)
    top_list = []
    my_list = []
    top_list2 = []
    chat_id = callback.message.chat.id
    name = callback.message.from_user.get_mention(as_html=True)
    num = 1

    stop = ["0️⃣", "1️⃣", "2️⃣", "3️⃣", "4️⃣", "5️⃣", "6️⃣", "7️⃣", "8️⃣", "9️⃣", "🔟"]

    user_id = callback.from_user.id

    for user in list:

        work = user[11]
        work2 = '{:,}'.format(work).replace(',', '.')
        if user[1]==user_id:
            for x in str(num):
                my_list.append(int(x))
                if len(my_list)==1:
                    first = stop[my_list[0]]
                    count=first
                elif len(my_list)==2:
                    first = stop[my_list[0]]
                    second = stop[my_list[1]]
                    count = first + second
                elif len(my_list)==3:
                    first = stop[my_list[0]]
                    second = stop[my_list[1]]
                    third=stop[my_list[2]]
                    count=first+second+third

                else:
                    count="⬅️"

            top_list2.append(
                f"{count} <i> {user[4]} </i> —  | 🔍ID: <code>{user[1]}</code> | <b>{work2} 👨🏻‍🔧</b> ")
        if num <= 10:
            top_list.append(
                f"{stop[num]}.  <i>{user[4]}</i>   | 🔍ID: <code>{user[1]}</code> | <b>{work2} 👨🏻‍🔧</b>")
        num += 1
    top2 = "\n".join(top_list2)
    top = "\n".join(top_list)
    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id, text=f"{name}, Топ 10 🌆 бота:\n" + top+ f"\n➖➖➖➖➖➖➖➖➖➖➖ \n "+ top2, reply_markup=help_topback, parse_mode='html')
@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'backtop')
async def backtop(callback: types.CallbackQuery):


    list = cursor.execute(f"SELECT * FROM users ORDER BY rating DESC")
    list = cursor.fetchmany(1000)
    top_list = []
    chat_id = callback.message.chat.id
    name = callback.message.from_user.get_mention(as_html=True)
    num = 1
    my_list = []
    top_list2 = []
    stop = ["0️⃣", "1️⃣", "2️⃣", "3️⃣", "4️⃣", "5️⃣", "6️⃣", "7️⃣", "8️⃣", "9️⃣", "🔟"]

    user_id = callback.from_user.id

    for user in list:
        c6 = user[11]

        c = Decimal(c6)
        c2 = '{:,}'.format(c).replace(',', '.')
        if user[0]==user_id:
            for x in str(num):
                my_list.append(int(x))
                if len(my_list)==1:
                    first = stop[my_list[0]]
                    count=first
                elif len(my_list)==2:
                    first = stop[my_list[0]]
                    second = stop[my_list[1]]
                    count = first + second
                elif len(my_list)==3:
                    first = stop[my_list[0]]
                    second = stop[my_list[1]]
                    third=stop[my_list[2]]
                    count=first+second+third

                else:
                    count="⬅️"
            player = status_users(user[0])
            top_list2.append(
                f"{count} <b>{player} ➪ </b><i>{user[9]} </i> —  | 🔍ID: <code>{user[0]}</code> | <b>👑{c2}</b> ")

        if user[10] == 'Admin' or user[10] == 'Rab':
            pass
        else:
            if num <=10:
                user_status = cursor.execute("SELECT user_status from users where user_id = ?",
                                             (user[0],))
                user_status = cursor.fetchone()
                if user_status[0] == 'delux':
                    user_status2 = '<b>🔥DELUXE ➪ </b>'
                else:
                    user_status2 = ''
                top_list.append(
                    f"{stop[num]} {user_status2}<i> {user[9]} </i> —  | 🔍ID: <code>{user[0]}</code> | <b>👑{c2}</b> ")
                num += 1
    top2 = "\n".join(top_list2)
    top = "\n".join(top_list)

    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id, text=f"{name}, Топ 10 игроков бота:\n" + top + f"""
\n➖➖➖➖➖➖➖➖➖➖➖ \n """+ top2, reply_markup=help_top, parse_mode='html')

@dp.callback_query_handler(lambda c: c.data == "button_marry_y")
async def callback_marry_y(callback_query: types.CallbackQuery):
    user = await bot.get_chat(str(marry_me[0]))
    replyuser = await bot.get_chat(str(marry_rep[0]))
    usid = user.id
    rid = replyuser.id
    ruser_name = cursor.execute("SELECT user_name from users where user_id = ?",(rid,))
    ruser_name=cursor.fetchone()
    ruser_name = ruser_name[0]
    user_name = cursor.execute("SELECT user_name from users where user_id = ?",(usid,))
    user_name=cursor.fetchone()
    user_name = user_name[0]
    if callback_query.from_user.id == replyuser.id:
        cursor.execute(f'UPDATE users SET marry=? WHERE user_id=?', (replyuser.id, user.id,))
        cursor.execute(f'UPDATE users SET marry_time=? WHERE user_id=?', (time.time(), user.id,))
        cursor.execute(f'UPDATE users SET marry_date=? WHERE user_id=?', (datetime.now(), user.id,))

        cursor.execute(f'UPDATE users SET marry=? WHERE user_id=?', (user.id, replyuser.id,))
        cursor.execute(f'UPDATE users SET marry_time=? WHERE user_id=?', (time.time(), replyuser.id,))
        cursor.execute(f'UPDATE users SET marry_date=? WHERE user_id=?', (datetime.now(), replyuser.id,))
        connect.commit()

        marry_me.clear()
        marry_rep.clear()
        await bot.delete_message(callback_query.message.chat.id, callback_query.message.message_id)
        await bot.send_message(callback_query.message.chat.id, f"💍 Вы приняли предложение о браке.\n👰‍♀️👨‍⚖️ С сегодняшего дня <a href='tg://user?id={usid}'>{user_name}</a> и <a href='tg://user?id={rid}'>{ruser_name}</a> состоят в браке.\n✨ Давайте поздравим молодожён!",  parse_mode='html')
    else:
        await bot.answer_callback_query(callback_query.id, show_alert=False, text="⚠️ Не твоё, не трогай!")

@dp.callback_query_handler(lambda c: c.data == "button_marry_n")
async def callback_marry_n(callback_query: types.CallbackQuery):
    user = await bot.get_chat(str(marry_me[0]))
    replyuser = await bot.get_chat(str(marry_rep[0]))
    if callback_query.from_user.id == replyuser.id:

        usid = user.id
        user_name = cursor.execute("SELECT user_name from users where user_id = ?",(usid,))
        user_name=cursor.fetchone()
        user_name = user_name[0]
        marry_me.clear()
        marry_rep.clear()
        await bot.delete_message(callback_query.message.chat.id, callback_query.message.message_id)
        await bot.send_message(callback_query.message.chat.id, f"💔 | <a href='tg://user?id={usid}'>{user_name}</a>, сожалеем, но вам отказали",  parse_mode='html')
    else:
        await bot.answer_callback_query(callback_query.id, show_alert=False, text="⚠️ Не твоё, не трогай!")

@dp.callback_query_handler(lambda c: c.data == "button_divorce_y")
async def callback_divorce_y(callback_query: types.CallbackQuery):
    user = await bot.get_chat(str(divorce_me[0]))

    if callback_query.from_user.id == user.id:
        replyuser = await bot.get_chat(str(divorce_rep[0]))
        usid = user.id
        rid = replyuser.id
        ruser_name = cursor.execute("SELECT user_name from users where user_id = ?",(rid,))
        ruser_name=cursor.fetchone()
        ruser_name = ruser_name[0]
        user_name = cursor.execute("SELECT user_name from users where user_id = ?",(usid,))
        user_name=cursor.fetchone()
        user_name = user_name[0]
        get = cursor.execute("SELECT marry_date FROM users WHERE user_id=?", (user.id,))
        get=cursor.fetchall()
        date_time = str(datetime.fromisoformat(str(get[0][0])))
        date_time2=str(datetime.now())
        d1 = datetime.strptime(date_time, "%Y-%m-%d %H:%M:?.%f")
        d2 = datetime.strptime(date_time2, "%Y-%m-%d %H:%M:?.%f")

        d3=d2-d1
        d4=str(d3).split('.')[0]

        cursor.execute(f"UPDATE users SET marry=0 WHERE user_id=?", ( user.id,))
        cursor.execute(f"UPDATE users SET marry=0 WHERE user_id=?", ( replyuser.id,))
        connect.commit()
        divorce_me.clear()
        divorce_rep.clear()
        await bot.delete_message(callback_query.message.chat.id, callback_query.message.message_id)
        await bot.send_message(callback_query.message.chat.id, f"💔 Брак между <a href='tg://user?id={usid}'>{user_name}</a> и <a href='tg://user?id={rid}'>{ruser_name}</a> расторгнут.\n"
                                                               f"Он просуществовал {d4}",  parse_mode='html')
    else:
        await bot.answer_callback_query(callback_query.id, show_alert=False, text="⚠️ Не твоё, не трогай!")

@dp.callback_query_handler(lambda c: c.data == "button_divorce_n")
async def callback_divorce_n(callback_query: types.CallbackQuery):
    user = await bot.get_chat(str(divorce_me[0]))
    if callback_query.from_user.id == user.id:
        divorce_me.clear()
        divorce_rep.clear()
        await bot.delete_message(callback_query.message.chat.id, callback_query.message.message_id)
    else:
        await bot.answer_callback_query(callback_query.id, show_alert=False, text="⚠️ Не твоё, не трогай!")

@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == "gamestavka2")
async def gamest(callback_query: types.CallbackQuery):
    user = await bot.get_chat(str(first_p[0]))
    replyuser = await bot.get_chat(str(second_p[0]))
    usid = user.id
    rid = replyuser.id
    ruser_name = cursor.execute("SELECT user_name from users where user_id = ?",(rid,))
    ruser_name=cursor.fetchone()
    ruser_name = ruser_name[0]
    user_name = cursor.execute("SELECT user_name from users where user_id = ?",(usid,))
    user_name=cursor.fetchone()
    user_name = user_name[0]
    if callback_query.from_user.id == replyuser.id:
        balance=cursor.execute("SELECT balance FROM users WHERE user_id=?",(usid,))
        balance=cursor.fetchone()
        balance=int(balance[0])

        balance2 = cursor.execute("SELECT balance FROM users WHERE user_id=?", (rid,))
        balance2 = cursor.fetchone()
        balance2 = int(balance2[0])
        summ_stavka1= int(summ_stavka[0])
        summ2 = '{:,}'.format(summ_stavka1).replace(',', '.')
        if balance>=summ_stavka1 and balance2>=summ_stavka1:
            if summ_stavka1>0:
                rx=random.randint(0,5)
                rx1 = random.randint(0, 5)
                if rx1>rx:
                    cursor.execute(f"UPDATE users SET balance={balance + summ_stavka1} WHERE user_id={usid}")
                    cursor.execute(f"UPDATE users SET balance={balance2 - summ_stavka1} WHERE user_id={rid}")
                    cursor.execute("UPDATE users SET stavka=0 WHERE user_id=?", (usid,))
                    cursor.execute("UPDATE users SET stavka=0 WHERE user_id=?", (rid,))
                    first_p.clear()
                    second_p.clear()
                    summ_stavka.clear()

                    await bot.delete_message(callback_query.message.chat.id, callback_query.message.message_id)
                    await bot.send_message(callback_query.message.chat.id, f"🏅 Выйграл <a href='tg://user?id={usid}'>{user_name}</a>({rx1}) ,💀 проиграл <a href='tg://user?id={rid}'>{ruser_name}</a>({rx})\n💰 Сумма выйгрыша:{summ2}", parse_mode='html')
                elif rx1<rx:
                    first_p.clear()
                    second_p.clear()
                    summ_stavka.clear()
                    cursor.execute("UPDATE users SET stavka=0 WHERE user_id=?", (usid,))
                    cursor.execute("UPDATE users SET stavka=0 WHERE user_id=?", (rid,))
                    cursor.execute(f"UPDATE users SET balance={balance - summ_stavka1} WHERE user_id={usid}")
                    cursor.execute(f"UPDATE users SET balance={balance2 + summ_stavka1} WHERE user_id={rid}")

                    await bot.delete_message(callback_query.message.chat.id, callback_query.message.message_id)
                    await bot.send_message(callback_query.message.chat.id, f"🏅 Выйграл <a href='tg://user?id={rid}'>{ruser_name}</a>({rx}) ,💀 проиграл <a href='tg://user?id={usid}'>{user_name}</a>({rx1})\n💰 Сумма выйгрыша:{summ2}", parse_mode='html')
                else:
                    first_p.clear()
                    second_p.clear()
                    summ_stavka.clear()
                    cursor.execute("UPDATE users SET stavka=0 WHERE user_id=?", (usid,))
                    cursor.execute("UPDATE users SET stavka=0 WHERE user_id=?", (rid,))
                    await bot.delete_message(callback_query.message.chat.id, callback_query.message.message_id)
                    await bot.send_message(callback_query.message.chat.id, f"🚫 Оба промахнулись ", parse_mode='html')
    else:
        await bot.answer_callback_query(callback_query.id, show_alert=False, text="⚠️ Не твоё, не трогай!")

@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == "gamestavka1")
async def gamest3(callback_query: types.CallbackQuery):
    user = await bot.get_chat(str(first_p[0]))
    replyuser = await bot.get_chat(str(second_p[0]))
    usid = user.id
    rid = replyuser.id

    if callback_query.from_user.id == replyuser.id:
        first_p.clear()
        second_p.clear()
        summ_stavka.clear()
        cursor.execute("UPDATE users SET stavka=0 WHERE user_id=?", (usid,))
        cursor.execute("UPDATE users SET stavka=0 WHERE user_id=?", (rid,))
        await bot.delete_message(callback_query.message.chat.id, callback_query.message.message_id)
    else:
        await bot.answer_callback_query(callback_query.id, show_alert=False, text="⚠️ Не твоё, не трогай!")

@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'donat1')
async def help(callback: types.CallbackQuery):

    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                text=f"""▶️ Цена: 100 🍭. 
1 руб = 2 🍭

👑 Привилегии:
⠀⭐️ «VIP» отметка в профиле
⠀💸 Увеличен лимит передачи валюты до 10 ТРЛН ₸
⠀➕ Увеличен ежедневный бонус в 2 раза
⠀🔋 Увеличен лимит ферм до 1500
⠀✏️Возможность ставить ник на 5 символов длиннее (25 символов)
⠀💳 Максимальная сумма вклада в банк увеличена до 1.000.000.000.000₸
⠀🎁 Ежедневный V.I.P бонус
⠀ ➖ Команда: «Бонус вип»
 💼 Открытье 10 кейсов  за  раз
 <b>Для покупки введите:</b> <code>Донат купить 1</code>
  
""", reply_markup=help_donat2,
                                parse_mode='html')

@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'donat2')
async def help(callback: types.CallbackQuery):

    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                text=f"""▶️ Цена: 250 🍭. 
1 руб = 2 🍭

👑 Привилегии:
⠀⭐️ Все привилегии VIP
⠀💎 «PREMIUM» отметка в профиле
⠀💸 Увеличен лимит передачи валюты до 20 ТРЛН ₸
⠀💵 Возможность ежедневно выдавать себе  50.000.000.000₸
⠀ ➖ Команда: «Валюта»

 💼 Открытье 25 кейсов  за  раз
⠀🔋 Увеличен лимит ферм до 3000
⠀✏️ Возможность ставить ник на 10 символов длиннее
⠀💳 Максимальная сумма вклада увеличена до 10.000.000.000.000₸
⠀🎁 Ежедневный PREMIUM бонус
⠀ ➖ Команда: «Бонус премиум»
⠀🔎 Возможность просматривать чужие профили 
⠀ ➖ Команда: «инфо»

 <b>Для покупки введите:</b> <code>Донат купить 2</code>


""", reply_markup=help_donat2,
                                parse_mode='html')

@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'donat3')
async def help(callback: types.CallbackQuery):

    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                text=f"""▶️ Цена: 500 🍭. 

1 руб = 2 🍭

👑 Привилегии:
⠀⭐️ Все привилегии VIP
⠀💎 Все привилегии PREMIUM
⠀🔥 «DELUXE» отметка в профиле
⠀💰 Можно выдавать валюту другим игрокам
⠀ ➖ Команда: «выдать [сумма]» до 1.000.000.000.000₸

 💼 Открытье 50 кейсов  за  раз
 🔣 Увеличен процент депозита в банке до 4%
⠀🎁 Бонус и вип/премиум бонус можно получать раз в 12 часов
⠀💸 Увеличен лимит передачи валюты до 70 ТРЛН₸
⠀🔋 Увеличен лимит ферм до 5.000
⠀✏️ Возможность ставить ник до 40 символов
⠀⚡️ Бизнес можно нанять 20.000 рабочих
⠀🔎 Возможность просматривать чужие профили 
⠀ ➖ Команда: «инфо»
💳 Максимальная сумма вклада неограничена

 <b>Для покупки введите:</b> <code>Донат купить 3</code>

""", reply_markup=help_donat2,
                                parse_mode='html')
@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'donat4')
async def help(callback: types.CallbackQuery):

    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                text=f"""▶️📆 1 месяц: 500 🍭  

1 руб = 2 🍭

👑 Привилегии:
⠀ADMIN 👮‍♂️ отметка в профиле
⠀💰 Можно выдавать валюту другим игрокам
⠀ ➖ Команда: «выдать [сумма]» до 10.000.000.000.000₸
⠀🔎 Возможность просматривать чужие профили 
⠀ ➖ Команда: «инфо»
 💳 Максимальная сумма вклада неограничена
 ~ Возможность отбор денег
 ➖ Команда: забрать [в ответ на сообщение]
 ~ Возможность обнулять баланс 
 ➖ Команда: обнулить [в ответ на сообщение]
 ~ Возможность обнулять профиль
 ~ Не входит в топ игроков
 ~ Получение прав администратора в официальном чате
 ~ Получение доступа к логам бота
 ~ Получение доступа к админ чату
 
 ➖ Команда: !banb в боте [в ответ на сообщение]
 ➖ Команда: !unbanb в боте [в ответ на сообщение]
 ➖ Команда: !warnb в боте [в ответ на сообщение]
 ➖ Команда: !unwarnb в боте [в ответ на сообщение]
 ! при покупке скажу остальные команды
 <b>Для покупки введите:</b> <code>Донат админ [На сколько месяцов]</code>

""", reply_markup=help_donat2,
                                parse_mode='html')
@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'donat7')
async def help(callback: types.CallbackQuery):

    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                text=f"Чтобы пополнить счёт, введите команду: пополнить (сумма) ", reply_markup=help_donat2,
                                parse_mode='html')

@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'donat5')
async def help(callback: types.CallbackQuery):

    valut = cursor.execute("SELECT valut FROM kurs")
    valut = cursor.fetchone()
    valut = int(valut[0])
    valut2 = cursor.execute("SELECT valut2 FROM kurs")
    valut2 = cursor.fetchone()
    valut2 = int(valut2[0])
    valut3 = cursor.execute("SELECT valut3 FROM kurs")
    valut3 = cursor.fetchone()
    valut3 = int(valut3[0])
    valut4 = cursor.execute("SELECT valut4 FROM kurs")
    valut4 = cursor.fetchone()
    valut4 = int(valut4[0])
    rvalut=transform(valut)
    rvalut2 = transform(valut2)
    rvalut3 = transform(valut3)
    rvalut4 = transform(valut4)
    perevod = '{:,}'.format(valut).replace(',', '.')
    perevod2 = '{:,}'.format(valut2).replace(',', '.')
    perevod3 = '{:,}'.format(valut3).replace(',', '.')
    perevod4 = '{:,}'.format(valut4).replace(',', '.')

    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                text=f"""
💱 1.Валюта {perevod}({rvalut}) = 50 🍭
💱 2.Валюта {perevod2}({rvalut2}) = 100 🍭
💱 3.Валюта {perevod3}({rvalut3}) = 150 🍭
💱 4.Валюта {perevod4}({rvalut4}) = 200 🍭

  <b>Для покупки введите:</b> <code>Купить валюту [номер]</code>

1 руб = 2 🍭
""", reply_markup=help_donat2,
                                parse_mode='html')
@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'donat6')
async def help(callback: types.CallbackQuery):

    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                text=f"""️Прочее 📁:
↔️ Увелечение суммы вкладов в банк х2
⠀ ➖ Команда: «Донат банк»
▶️ Цена: 50 🍭
 
〽️ Увелечение процента в банке х2
⠀ ➖ Команда: «Донат депозит»
▶️ Цена: 70 🍭

🔶️ Донат ферма
⠀ ➖ Команда: Купить ферму 4
▶️ Цена: 30 🍭
🔶️ Донат видеокарта
⠀ ➖ Команда: Донат видеокарты [кол-во]
▶️ Цена: 5 🍭

""", reply_markup=help_donat2,
                                parse_mode='html')
@rate_limit(limit=1)
@dp.callback_query_handler(IsRegister3(),text_contains='clans_list_')
async def help(callback: types.CallbackQuery):
    number = int(callback.data[11:])
    list = cursor.execute(f"SELECT * FROM clans ")
    list = cursor.fetchall()
    list=list[number:]
    top_list = []
    my_list=[]
    name = callback.message.from_user.get_mention(as_html=True)
    num = 1
    if number==0:
        num2=1
    else:
        num2 =number+1
    stop = ["0️⃣", "1️⃣", "2️⃣", "3️⃣", "4️⃣", "5️⃣", "6️⃣", "7️⃣", "8️⃣", "9️⃣", "🔟"]
    if len(list)<=0:
        await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                    text=f"{name}, Упс Возращайся назад !", reply_markup=list_clans_get2(number, ishave=False), parse_mode='html')
    else:
        for clan in list:
            if num>=11:
                break
            else:
                for x in str(num2):
                    my_list.append(int(x))
                    if len(my_list) == 1:
                        first = stop[my_list[0]]
                        count = first
                    elif len(my_list) == 2:
                        first = stop[my_list[0]]
                        second = stop[my_list[1]]
                        count = first + second
                    elif len(my_list) == 3:
                        first = stop[my_list[0]]
                        second = stop[my_list[1]]
                        third = stop[my_list[2]]
                        count = first + second + third

                    else:
                        count = "⬅️"
                if clan[4]==1:
                    type="✔️"
                if clan[4]==0:
                    type="❌"
                top_list.append(
                    f"{count}({type})<i>{clan[2]}</i>   | 🔍ID: <code>{clan[1]}</code> | <b>  👥{clan[0]}</b>")
                num += 1
                num2 +=1
                my_list.clear()
        top = "\n".join(top_list)
        await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                    text=f"{name}, Топ 10 кланов бота:\n" + top +"\n\n✔️ - Открыт | ❌ - Закрыт", reply_markup=list_clans_get2(number,ishave=True),
                                    parse_mode='html')


@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'earning')
async def city_earning(callback: types.CallbackQuery):
    user_id = callback.from_user.id
    earning = cursor.execute(
        "SELECT earning from city where user_id = ?", (callback.from_user.id,))
    earning = cursor.fetchone()
    if earning != None:
        earning = int(earning[0])
        if earning == 0:
            await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                        text=f"""
В Вашем городе ещё не развита «Аренда» 🙁
Начните развитие ващего города с помощью команды «Город аренда»
💰 Цена: 250.000.000.000.000₸""", reply_markup=back_city)
        else:
            await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                        text=f"""
1. 🚓 Машины — 10.000.000.000
 ➖Требуется : Venom GT или Rolls-Royce
 
2. 🛩 Самолёты — 500.000.000.000
 ➖Требуется : Airbus 380 Custom или B-2 Spirit Stealth Bomber
 
3. 🛳 Яхты — 2.000.000.000.000
 ➖Требуется : Azzam или Streets of Monaco 
 
4. 🚁 Вертолёты — 6.000.000.000.000
 ➖Требуется : Kazan Mi-35M или️ Bell V-22 Osprey
 
5.   🏘 Дома — 10.000.000.000.000
 ➖Требуется : Приют ️или Дом престарелых 

            """, reply_markup=earning_sell)

@rate_limit(limit=1)
@dp.callback_query_handler(IsRegister3(),text_contains="ear_")
async def checksrdfgrty(callback: types.CallbackQuery):
    oer = int(callback.data[4:])
    user_id = callback.from_user.id
    earning = cursor.execute(
        "SELECT earning from city where user_id = ?", (callback.from_user.id,))
    earning = cursor.fetchone()
    if earning != None:
        earning = int(earning[0])
        if earning == 0:
            await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                        text=f"""
В Вашем городе ещё не развита «Аренда» 🙁
Начните развитие ващего города с помощью команды «Город аренда»
💰 Цена: 250.000.000.000.000₸""", reply_markup=back_city)
        else:
            if oer == 1:

                await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                            text=f""" 🚓 Машины — 10.000.000.000
 ➖Требуется : Venom GT или Rolls-Royce""",reply_markup=ear_work(1))
            elif oer == 2:
                await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                            text=f"""🛩 Самолёты — 500.000.000.000
 ➖Требуется : Airbus 380 Custom или B-2 Spirit Stealth Bomber""",reply_markup=ear_work(2))
            elif oer == 3:
                await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                            text=f"""🛳 Яхты — 2.000.000.000.000
 ➖Требуется : Azzam или Streets of Monaco """,reply_markup=ear_work(3))
            elif oer == 4:
                await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                            text=f"""🚁 Вертолёты — 6.000.000.000.000
 ➖Требуется : Kazan Mi-35M или️ Bell V-22 Osprey""",reply_markup=ear_work(4))
            elif oer == 5:
                await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                            text=f""" 🏘 Дома — 10.000.000.000.000
 ➖Требуется : Приют ️или Дом престарелых """,reply_markup=ear_work(5))
CHAT_BY_DATETIME_arenda1 = dict()
CHAT_BY_DATETIME_arenda2 = dict()
CHAT_BY_DATETIME_arenda3 = dict()
CHAT_BY_DATETIME_arenda4 = dict()
CHAT_BY_DATETIME_arenda5 = dict()
@rate_limit(limit=1)
@dp.callback_query_handler(IsRegister3(),text_contains="earwork_")
async def checkgrty(callback: types.CallbackQuery):
    ear = int(callback.data[8:])
    user_id = callback.from_user.id
    earning = cursor.execute(
        "SELECT earning from city where user_id = ?", (callback.from_user.id,))
    earning = cursor.fetchone()
    if earning != None:
        earning = int(earning[0])
        if earning == 0:
            await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                        text=f"""
В Вашем городе ещё не развита «Аренда» 🙁
Начните развитие ващего города с помощью команды «Город аренда»
💰 Цена: 250.000.000.000.000₸""", reply_markup=back_city)
        else:
            if ear == 1:
                need_seconds1 = 10800
                current_time_bonus = datetime.now()
                last_datetime1 = CHAT_BY_DATETIME_arenda1.get(callback.from_user.id)

                # Если первое сообщение (время не задано)
                if not last_datetime1:
                    CHAT_BY_DATETIME_arenda1[callback.from_user.id] = current_time_bonus
                    last_datetime1 = datetime.fromtimestamp(0)
                if last_datetime1:

                    # Разница в секундах между текущим временем и временем последнего сообщения
                    delta_seconds1 = (current_time_bonus - last_datetime1).total_seconds()

                    # Осталось ждать секунд перед отправкой
                    seconds_left1 = int(need_seconds1 - delta_seconds1)

                    # Если время ожидания не закончилось
                    if seconds_left1 > 0:
                        left1 = seconds_left1 / 60 / 60
                        await callback.answer(f'‼️Срок аренды закончиться через {round(left1)}ч ')

                    else:

                        car=cursor.execute(f"SELECT cars FROM property WHERE user_id={callback.from_user.id}")
                        car = cursor.fetchone()
                        car = int(car[0])

                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (callback.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])
                        if car==25 or car==26:
                            CHAT_BY_DATETIME_arenda1[callback.from_user.id] = current_time_bonus
                            cursor.execute(f"UPDATE users SET balance={balance + 10000000000} WHERE user_id={user_id}")
                            await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                                    text=f"""✅ Вы успешно сдали в аренду машину\n💰 Выручка: 10.000.000.000 ₸  """, reply_markup=back_city)
                        else:

                            CHAT_BY_DATETIME_arenda1.clear()
                            await bot.edit_message_text(chat_id=callback.message.chat.id,
                                                        message_id=callback.message.message_id,
                                                        text=f"""❗️ У вас нету данных машин \n➖Требуется : Venom GT или Rolls-Royce""",
                                                        reply_markup=back_city)
            elif ear == 2:
                need_seconds1 = 10800
                current_time_bonus = datetime.now()
                last_datetime1 = CHAT_BY_DATETIME_arenda2.get(callback.from_user.id)

                # Если первое сообщение (время не задано)
                if not last_datetime1:
                    CHAT_BY_DATETIME_arenda2[callback.from_user.id] = current_time_bonus
                    last_datetime1 = datetime.fromtimestamp(0)
                if last_datetime1:

                    # Разница в секундах между текущим временем и временем последнего сообщения
                    delta_seconds1 = (current_time_bonus - last_datetime1).total_seconds()

                    # Осталось ждать секунд перед отправкой
                    seconds_left1 = int(need_seconds1 - delta_seconds1)

                    # Если время ожидания не закончилось
                    if seconds_left1 > 0:
                        left1 = seconds_left1 / 60 / 60
                        await callback.answer(
                            f'‼️Срок аренды закончиться через {round(left1)}ч ')

                    else:

                        plane = cursor.execute(f"SELECT plane FROM property WHERE user_id={callback.from_user.id}")
                        plane = cursor.fetchone()
                        plane = int(plane[0])
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (callback.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])
                        if plane==16 or plane==15:
                            CHAT_BY_DATETIME_arenda2[callback.from_user.id] = current_time_bonus
                            cursor.execute(f"UPDATE users SET balance={balance + 500_000_000_000} WHERE user_id={user_id}")
                            await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                                    text=f"""✅ Вы успешно сдали в аренду Самолёт\n💰 Выручка: 500.000.000.000 ₸ """, reply_markup=back_city)
                        else:
                            CHAT_BY_DATETIME_arenda2.clear()
                            await bot.edit_message_text(chat_id=callback.message.chat.id,
                                                        message_id=callback.message.message_id,
                                                        text=f"""❗️ У вас нету данных Самолётов\n➖Требуется : Airbus 380 Custom или B-2 Spirit Stealth Bomber""",
                                                        reply_markup=back_city)
            elif ear == 3:
                need_seconds1 = 10800
                current_time_bonus = datetime.now()
                last_datetime1 = CHAT_BY_DATETIME_arenda3.get(callback.from_user.id)

                # Если первое сообщение (время не задано)
                if not last_datetime1:
                    CHAT_BY_DATETIME_arenda3[callback.from_user.id] = current_time_bonus
                    last_datetime1 = datetime.fromtimestamp(0)
                if last_datetime1:

                    # Разница в секундах между текущим временем и временем последнего сообщения
                    delta_seconds1 = (current_time_bonus - last_datetime1).total_seconds()

                    # Осталось ждать секунд перед отправкой
                    seconds_left1 = int(need_seconds1 - delta_seconds1)

                    # Если время ожидания не закончилось
                    if seconds_left1 > 0:
                        left1 = seconds_left1 / 60 / 60
                        await callback.answer(
                            f'‼️Срок аренды закончиться через {round(left1)}ч ')

                    else:

                        yacht = cursor.execute(f"SELECT yacht FROM property WHERE user_id={callback.from_user.id}")
                        yacht = cursor.fetchone()
                        yacht = int(yacht[0])
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (callback.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])

                        if yacht==13 or yacht==12:
                            CHAT_BY_DATETIME_arenda3[callback.from_user.id] = current_time_bonus
                            cursor.execute(f"UPDATE users SET balance={balance + 2_000_000_000_000} WHERE user_id={user_id}")
                            await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                                    text=f"""✅ Вы успешно сдали в аренду Яхту\n💰 Выручка: 2.000.000.000.000 ₸ """, reply_markup=back_city)
                        else:
                            CHAT_BY_DATETIME_arenda3.clear()
                            await bot.edit_message_text(chat_id=callback.message.chat.id,
                                                        message_id=callback.message.message_id,
                                                        text=f"""❗️ У вас нету данных Яхт\n➖Требуется : Azzam или Streets of Monaco """,
                                                        reply_markup=back_city)
            elif ear == 4:
                need_seconds1 = 10800
                current_time_bonus = datetime.now()
                last_datetime1 = CHAT_BY_DATETIME_arenda4.get(callback.from_user.id)

                # Если первое сообщение (время не задано)
                if not last_datetime1:
                    CHAT_BY_DATETIME_arenda4[callback.from_user.id] = current_time_bonus
                    last_datetime1 = datetime.fromtimestamp(0)
                if last_datetime1:

                    # Разница в секундах между текущим временем и временем последнего сообщения
                    delta_seconds1 = (current_time_bonus - last_datetime1).total_seconds()

                    # Осталось ждать секунд перед отправкой
                    seconds_left1 = int(need_seconds1 - delta_seconds1)

                    # Если время ожидания не закончилось
                    if seconds_left1 > 0:
                        left1 = seconds_left1 / 60 / 60
                        await callback.answer(
                            f'‼️Срок аренды закончиться через {round(left1)}ч ')

                    else:

                        helicopter = cursor.execute(f"SELECT helicopter FROM property WHERE user_id={callback.from_user.id}")
                        helicopter = cursor.fetchone()
                        helicopter = int(helicopter[0])
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (callback.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])

                        if helicopter==13 or helicopter==12:
                            CHAT_BY_DATETIME_arenda4[callback.from_user.id] = current_time_bonus
                            cursor.execute(f"UPDATE users SET balance={balance + 6_000_000_000_000} WHERE user_id={user_id}")
                            await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                                    text=f"""✅ Вы успешно сдали в аренду Вертолёт\n💰 Выручка: 6.000.000.000.000 ₸ """, reply_markup=back_city)

                        else:
                            CHAT_BY_DATETIME_arenda4.clear()
                            await bot.edit_message_text(chat_id=callback.message.chat.id,
                                    message_id=callback.message.message_id,
                                    text=f"""❗️ У вас нету данных Вертолётов\n ➖Требуется : Kazan Mi-35M или️ Bell V-22 Osprey""",
                                    reply_markup=back_city)
            elif ear == 5:
                need_seconds1 = 10800
                current_time_bonus = datetime.now()
                last_datetime1 = CHAT_BY_DATETIME_arenda5.get(callback.from_user.id)

                # Если первое сообщение (время не задано)
                if not last_datetime1:
                    CHAT_BY_DATETIME_arenda5[callback.from_user.id] = current_time_bonus
                    last_datetime1 = datetime.fromtimestamp(0)
                if last_datetime1:

                    # Разница в секундах между текущим временем и временем последнего сообщения
                    delta_seconds1 = (current_time_bonus - last_datetime1).total_seconds()

                    # Осталось ждать секунд перед отправкой
                    seconds_left1 = int(need_seconds1 - delta_seconds1)

                    # Если время ожидания не закончилось
                    if seconds_left1 > 0:
                        left1 = seconds_left1 / 60 / 60
                        await callback.answer(
                            f'‼️Срок аренды закончиться через {round(left1)}ч ')

                    else:

                        house = cursor.execute(f"SELECT house FROM property WHERE user_id={callback.from_user.id}")
                        house = cursor.fetchone()
                        house = int(house[0])
                        balance = cursor.execute(
                            "SELECT balance from users where user_id = ?", (callback.from_user.id,))
                        balance = cursor.fetchone()
                        balance = int(balance[0])

                        if house==16 or house==15:
                            CHAT_BY_DATETIME_arenda5[callback.from_user.id] = current_time_bonus
                            cursor.execute(f"UPDATE users SET balance={balance + 10_000_000_000_000} WHERE user_id={user_id}")
                            await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                                    text=f"""✅ Вы успешно сдали в аренду Дом\n💰 Выручка: 10.000.000.000.000 ₸ """, reply_markup=back_city)
                        else:
                            CHAT_BY_DATETIME_arenda5.clear()
                            await bot.edit_message_text(chat_id=callback.message.chat.id,
                                    message_id=callback.message.message_id,
                                    text=f"""❗️ У вас нету данных Домов\n➖Требуется : Приют ️или Дом престарелых""",
                                    reply_markup=back_city)

@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'ore_recycling')
async def city_recycling(callback: types.CallbackQuery):
    user_id = callback.from_user.id
    ore_processing_plant = cursor.execute(
        "SELECT ore_processing_plant from city where user_id = ?", (callback.from_user.id,))
    ore_processing_plant = cursor.fetchone()
    if ore_processing_plant != None:
        ore_processing_plant = int(ore_processing_plant[0])
        if ore_processing_plant==0:
            await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                        text=f"""
В Вашем городе ещё не построен завод по «♻️Переработки руды» 🙁
♻ Начните стройку завод с помощью команды «Город переработка»
💰 Цена: 200.000.000.000.000₸""",reply_markup=back_city)
        else:
            await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                        text=f"""
1. 🔌Электротехника — 100.000.000.000
 ➖Требуется : 500⛓️
2. 👑Золотые украшения — 800.000.000.000
 ➖Требуется : 200⛓️ 100🟡
3. 💍Алмазное кольцо — 3.000.000.000.000
 ➖Требуется : 1000⛓️ 10🟡 50💎
4. 📿Ожерелье из аметиста — 6.000.000.000.000
 ➖Требуется : 5🟡 125⛓️ 45♒️
5. 🏮Аквамариновая лампа— 10.000.000.000.000
 ➖Требуется :  1250⛓️ 25♒️ 100💠
6. 🪨Изумрудный камень— 15.000.000.000.000
 ➖Требуется : 50🟡 1405⛓️ 80♒️ 4🟢
""", reply_markup=oer_sell)
@rate_limit(limit=1)
@dp.callback_query_handler(IsRegister3(),text_contains="oersell_")
async def checksrdfgrty(callback: types.CallbackQuery):
    oer = int(callback.data[8:])
    user_id = callback.from_user.id
    ore_processing_plant = cursor.execute(
        "SELECT ore_processing_plant from city where user_id = ?", (callback.from_user.id,))
    ore_processing_plant = cursor.fetchone()
    if ore_processing_plant != None:
        ore_processing_plant = int(ore_processing_plant[0])
        if ore_processing_plant == 0:
            await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                        text=f"""
В Вашем городе ещё не построен завод по «♻️Переработки руды» 🙁
♻ Начните стройку завод с помощью команды «Город переработка»
💰 Цена: 200.000.000.000.000₸""", reply_markup=back_city)
        else:
            if oer == 1:
                await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                            text=f"""🔌Электротехника — 100.000.000.000
 ➖Требуется : 500⛓️""",reply_markup=oer_cycl(1))
            elif oer == 2:
                await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                            text=f"""👑Золотые украшения — 800.000.000.000
 ➖Требуется : 200⛓️ 100🟡""",reply_markup=oer_cycl(2))
            elif oer == 3:
                await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                            text=f"""💍Алмазное кольцо — 3.000.000.000.000
 ➖Требуется : 1000⛓️ 10🟡 50💎""",reply_markup=oer_cycl(3))
            elif oer == 4:
                await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                            text=f"""📿Ожерелье из аметиста — 6.000.000.000.000
 ➖Требуется : 5🟡 125⛓️ 45♒️""",reply_markup=oer_cycl(4))
            elif oer == 5:
                await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                            text=f"""🏮Аквамариновая лампа— 10.000.000.000.000
 ➖Требуется :  1250⛓️ 25♒️ 100💠""",reply_markup=oer_cycl(5))
            elif oer == 6:
                await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                            text=f"""🪨Изумрудный камень— 15.000.000.000.000
 ➖Требуется : 50🟡 1405⛓️ 80♒️ 4🟢""",reply_markup=oer_cycl(6))

@rate_limit(limit=1)
@dp.callback_query_handler(IsRegister3(),text_contains="oer_")
async def checkgrty(callback: types.CallbackQuery):
    oer = int(callback.data[4:])
    user_id = callback.from_user.id
    ore_processing_plant = cursor.execute(
        "SELECT ore_processing_plant from city where user_id = ?", (callback.from_user.id,))
    ore_processing_plant = cursor.fetchone()
    if ore_processing_plant != None:
        ore_processing_plant = int(ore_processing_plant[0])
        if ore_processing_plant == 0:
            await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                        text=f"""
В Вашем городе ещё не построен завод по «♻️Переработки руды» 🙁
♻ Начните стройку завод с помощью команды «Город переработка»
💰 Цена: 200.000.000.000.000₸""", reply_markup=back_city)
        else:
            if oer == 1:
                iron = cursor.execute(
                    "SELECT iron from mine where user_id = ?", (callback.from_user.id,))
                iron = cursor.fetchone()
                iron = int(iron[0])
                balance = cursor.execute(
                    "SELECT balance from users where user_id = ?", (callback.from_user.id,))
                balance = cursor.fetchone()
                balance = int(balance[0])
                if iron>=500:
                    cursor.execute(f"UPDATE mine SET iron={iron - 500} WHERE user_id={user_id}")
                    cursor.execute(f"UPDATE users SET balance={balance + 100000000000} WHERE user_id={user_id}")
                    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                            text=f"""✅ Вы успешно пеработали руду в 🔌Электротехнику\n💰 Выручка: 100.000.000.000 ₸  """, reply_markup=back_city)
                else:
                    await bot.edit_message_text(chat_id=callback.message.chat.id,
                                                message_id=callback.message.message_id,
                                                text=f"""❗️ У вас недостаточно руды для переработки""",
                                                reply_markup=back_city)
            elif oer == 2:
                iron = cursor.execute(
                    "SELECT iron from mine where user_id = ?", (callback.from_user.id,))
                iron = cursor.fetchone()
                iron = int(iron[0])
                gold = cursor.execute(
                    "SELECT gold from mine where user_id = ?", (callback.from_user.id,))
                gold = cursor.fetchone()
                gold = int(gold[0])
                balance = cursor.execute(
                    "SELECT balance from users where user_id = ?", (callback.from_user.id,))
                balance = cursor.fetchone()
                balance = int(balance[0])
                if iron >= 200 and gold>=100:
                    cursor.execute(f"UPDATE mine SET iron={iron - 200} WHERE user_id={user_id}")
                    cursor.execute(f"UPDATE mine SET gold={gold - 100} WHERE user_id={user_id}")
                    cursor.execute(f"UPDATE users SET balance={balance + 800_000_000_000} WHERE user_id={user_id}")
                    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                            text=f"""✅ Вы успешно пеработали руду в  👑Золотые украшения\n💰 Выручка: 800.000.000.000 ₸ """, reply_markup=back_city)
                else:
                    await bot.edit_message_text(chat_id=callback.message.chat.id,
                                                message_id=callback.message.message_id,
                                                text=f"""❗️ У вас недостаточно руды для переработки""",
                                                reply_markup=back_city)
            elif oer == 3:
                iron = cursor.execute(
                    "SELECT iron from mine where user_id = ?", (callback.from_user.id,))
                iron = cursor.fetchone()
                iron = int(iron[0])
                gold = cursor.execute(
                    "SELECT gold from mine where user_id = ?", (callback.from_user.id,))
                gold = cursor.fetchone()
                gold = int(gold[0])
                balance = cursor.execute(
                    "SELECT balance from users where user_id = ?", (callback.from_user.id,))
                balance = cursor.fetchone()
                balance = int(balance[0])
                diamonds = cursor.execute("SELECT diamonds from mine where user_id = ?",
                                          (callback.from_user.id,))
                diamonds = cursor.fetchone()
                diamonds = int(diamonds[0])
                if iron >= 1000 and gold >= 10 and diamonds>=50:
                    cursor.execute(f"UPDATE mine SET diamonds={diamonds - 50} WHERE user_id={user_id}")
                    cursor.execute(f"UPDATE mine SET iron={iron - 1000} WHERE user_id={user_id}")
                    cursor.execute(f"UPDATE mine SET gold={gold - 10} WHERE user_id={user_id}")
                    cursor.execute(f"UPDATE users SET balance={balance + 3_000_000_000_000} WHERE user_id={user_id}")
                    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                            text=f"""✅ Вы успешно пеработали руду в 💍Алмазное кольцо\n💰 Выручка: 3.000.000.000.000 ₸ """, reply_markup=back_city)
                else:
                    await bot.edit_message_text(chat_id=callback.message.chat.id,
                                                message_id=callback.message.message_id,
                                                text=f"""❗️ У вас недостаточно руды для переработки""",
                                                reply_markup=back_city)
            elif oer == 4:
                iron = cursor.execute(
                    "SELECT iron from mine where user_id = ?", (callback.from_user.id,))
                iron = cursor.fetchone()
                iron = int(iron[0])
                gold = cursor.execute(
                    "SELECT gold from mine where user_id = ?", (callback.from_user.id,))
                gold = cursor.fetchone()
                gold = int(gold[0])
                balance = cursor.execute(
                    "SELECT balance from users where user_id = ?", (callback.from_user.id,))
                balance = cursor.fetchone()
                balance = int(balance[0])
                amethysts = cursor.execute("SELECT amethysts from mine where user_id = ?",
                                          (callback.from_user.id,))
                amethysts = cursor.fetchone()
                amethysts = int(amethysts[0])
                if iron >= 125 and gold >= 5 and amethysts >= 45:
                    cursor.execute(f"UPDATE mine SET amethysts={amethysts - 45} WHERE user_id={user_id}")
                    cursor.execute(f"UPDATE mine SET iron={iron - 125} WHERE user_id={user_id}")
                    cursor.execute(f"UPDATE mine SET gold={gold - 5} WHERE user_id={user_id}")
                    cursor.execute(f"UPDATE users SET balance={balance + 6_000_000_000_000} WHERE user_id={user_id}")
                    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                            text=f"""✅ Вы успешно пеработали руду в 📿Ожерелье из аметиста\n💰 Выручка: 6.000.000.000.000 ₸ """, reply_markup=back_city)

                else:
                    await bot.edit_message_text(chat_id=callback.message.chat.id,
                            message_id=callback.message.message_id,
                            text=f"""❗️ У вас недостаточно руды для переработки""",
                            reply_markup=back_city)
            elif oer == 5:
                iron = cursor.execute(
                    "SELECT iron from mine where user_id = ?", (callback.from_user.id,))
                iron = cursor.fetchone()
                iron = int(iron[0])
                aquamarine = cursor.execute(
                    "SELECT aquamarine from mine where user_id = ?", (callback.from_user.id,))
                aquamarine = cursor.fetchone()
                aquamarine = int(aquamarine[0])
                balance = cursor.execute(
                    "SELECT balance from users where user_id = ?", (callback.from_user.id,))
                balance = cursor.fetchone()
                balance = int(balance[0])
                amethysts = cursor.execute("SELECT amethysts from mine where user_id = ?",
                                           (callback.from_user.id,))
                amethysts = cursor.fetchone()
                amethysts = int(amethysts[0])
                if iron >= 1250 and aquamarine >= 100 and amethysts >= 25:
                    cursor.execute(f"UPDATE mine SET amethysts={amethysts - 25} WHERE user_id={user_id}")
                    cursor.execute(f"UPDATE mine SET iron={iron - 1250} WHERE user_id={user_id}")
                    cursor.execute(f"UPDATE mine SET aquamarine={aquamarine - 100} WHERE user_id={user_id}")
                    cursor.execute(f"UPDATE users SET balance={balance + 10_000_000_000_000} WHERE user_id={user_id}")
                    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                            text=f"""✅ Вы успешно пеработали руду в 🏮Аквамариновая лампа\n💰 Выручка: 10.000.000.000.000 ₸ """, reply_markup=back_city)
                else:
                    await bot.edit_message_text(chat_id=callback.message.chat.id,
                            message_id=callback.message.message_id,
                            text=f"""❗️ У вас недостаточно руды для переработки""",
                            reply_markup=back_city)
            elif oer == 6:
                iron = cursor.execute(
                    "SELECT iron from mine where user_id = ?", (callback.from_user.id,))
                iron = cursor.fetchone()
                iron = int(iron[0])
                gold = cursor.execute(
                    "SELECT gold from mine where user_id = ?", (callback.from_user.id,))
                gold = cursor.fetchone()
                gold = int(gold[0])
                balance = cursor.execute(
                    "SELECT balance from users where user_id = ?", (callback.from_user.id,))
                balance = cursor.fetchone()
                balance = int(balance[0])
                amethysts = cursor.execute("SELECT amethysts from mine where user_id = ?",
                                           (callback.from_user.id,))
                amethysts = cursor.fetchone()
                amethysts = int(amethysts[0])
                emeralds = cursor.execute("SELECT emeralds from mine where user_id = ?",
                                          (callback.from_user.id,))
                emeralds = cursor.fetchone()
                emeralds = int(emeralds[0])
                if iron >= 1405 and gold >= 50 and amethysts >= 80 and emeralds>=4:
                    cursor.execute(f"UPDATE mine SET emeralds={emeralds - 4} WHERE user_id={user_id}")
                    cursor.execute(f"UPDATE mine SET amethysts={amethysts - 80} WHERE user_id={user_id}")
                    cursor.execute(f"UPDATE mine SET iron={iron - 1405} WHERE user_id={user_id}")
                    cursor.execute(f"UPDATE mine SET gold={gold - 50} WHERE user_id={user_id}")
                    cursor.execute(f"UPDATE users SET balance={balance + 15_000_000_000_000} WHERE user_id={user_id}")
                    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                            text=f"""✅ Вы успешно пеработали руду в 🪨Изумрудный камень \n💰 Выручка: 15.000.000.000.000 ₸ """, reply_markup=back_city)
                else:
                    await bot.edit_message_text(chat_id=callback.message.chat.id,
                            message_id=callback.message.message_id,
                            text=f"""❗️ У вас недостаточно руды для переработки""",
                            reply_markup=back_city)
@rate_limit(limit=1)
@dp.callback_query_handler(lambda c: c.data == 'back_city')
async def city_main(callback: types.CallbackQuery):
    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                               (callback.from_user.id,))
    user_name = cursor.fetchone()
    user_name = user_name[0]
    user_id = callback.from_user.id

    cursor.execute("SELECT city_name FROM city WHERE user_id=?", (callback.from_user.id,))
    if cursor.fetchone() != None:
        citizens = cursor.execute("SELECT citizens FROM city WHERE user_id=?", (callback.from_user.id,))
        citizens = cursor.fetchone()
        citizens = int(citizens[0])

        kazna = cursor.execute("SELECT kazna FROM city WHERE user_id=?", (callback.from_user.id,))
        kazna = cursor.fetchone()
        kazna = int(kazna[0])

        city_name = cursor.execute("SELECT city_name FROM city WHERE user_id=?", (callback.from_user.id,))
        city_name = cursor.fetchone()
        city_name = str(city_name[0])

        happynes = cursor.execute("SELECT happynes FROM city WHERE user_id=?", (callback.from_user.id,))
        happynes = cursor.fetchone()
        happynes = float(happynes[0])

        electricity = cursor.execute("SELECT electricity FROM city WHERE user_id=?", (callback.from_user.id,))
        electricity = cursor.fetchone()
        electricity = int(electricity[0])

        water = cursor.execute("SELECT water FROM city WHERE user_id=?", (callback.from_user.id,))
        water = cursor.fetchone()
        water = int(water[0])

        factory = cursor.execute("SELECT factory FROM city WHERE user_id=?", (callback.from_user.id,))
        factory = cursor.fetchone()
        factory = int(factory[0])

        road = cursor.execute("SELECT road FROM city WHERE user_id=?", (callback.from_user.id,))
        road = cursor.fetchone()
        road = int(road[0])

        houses = cursor.execute("SELECT houses FROM city WHERE user_id=?", (callback.from_user.id,))
        houses = cursor.fetchone()
        houses = int(houses[0])

        work_place = cursor.execute("SELECT work_place FROM city WHERE user_id=?", (callback.from_user.id,))
        work_place = cursor.fetchone()
        work_place = int(work_place[0])

        taxes = cursor.execute("SELECT taxes FROM city WHERE user_id=?", (callback.from_user.id,))
        taxes = cursor.fetchone()
        taxes = int(taxes[0])

        if happynes > 20:
            happynes2 = "🙁"
        if happynes > 40:
            happynes2 = "😑"
        if happynes > 60:
            happynes2 = "🙂"
        if happynes > 80:
            happynes2 = "😇"
        if happynes < 20:
            happynes2 = "🤬"
        material = cursor.execute("SELECT material FROM city WHERE user_id=?", (callback.from_user.id,))
        material = cursor.fetchone()
        material = int(material[0])
        kazna2 = '{:,}'.format(kazna).replace(',', '.')
        material2 = '{:,}'.format(material).replace(',', '.')
        citizens2 = '{:,}'.format(citizens).replace(',', '.')
        work_place2 = '{:,}'.format(work_place).replace(',', '.')
        factory2 = '{:,}'.format(factory).replace(',', '.')
        houses2 = '{:,}'.format(houses).replace(',', '.')
        electricity3 = round((houses * 30) + (factory * 45))

        electricity4 = '{:,}'.format(electricity3).replace(',', '.')
        water3 = round((houses * 30) + (factory * 45))
        water4 = '{:,}'.format(water3).replace(',', '.')
        water5 = water * 100
        water2 = '{:,}'.format(water5).replace(',', '.')
        electricity5 = electricity * 100
        electricity2 = '{:,}'.format(electricity5).replace(',', '.')
        road2 = '{:,}'.format(road).replace(',', '.')
        if electricity5 < electricity3:
            problem = "⚠️ В городе есть проблемы:\n⚡ Расходы энергий превышают её добычу!\n➖ Постройте АЭС"

        if water5 < water3:
            problem = "⚠️ В городе есть проблемы:\n💦 Расходы воды превышают её добычу!\n➖ Постройте водонапорную башню"
        if electricity5 < electricity3 and water5 < water3:
            problem = "⚠️ В городе есть проблемы:\n💦 Расходы воды превышают её добычу!\n⚡ Расходы энергий превышают её добычу!\n➖ Постройте водонапорную башню\n➖ Постройте АЭС"
        if electricity5 > electricity3 and water5 > water3:
            problem = ""
        await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                    text=f"""
<a href="tg://user?id={user_id}">{user_name}</a>, информация о Вашем городе:
🏙 Название: {city_name} 
💰 Казна города: {kazna2}
👥 Жителей: {citizens2} чел
⠀{happynes2} Счастье: {round(happynes, 2)}%
⠀👨🏻‍🔧 Работают: {work_place2} чел
⠀💸 Налоги: {taxes}%
<b>{problem}</b>
⠀💧 Вода: {water2}/{water4}м³/час-[выроботка/затрат]
⠀⚡️ Энергия: {electricity2}/{electricity4}МВт-[выроботка/затрат]
📦 Материалов: {material2} шт
⠀🚙 Дороги: {road2} метров

🏗 Здания:
🏡 Жилой дом: {houses2}x
🔧 Завод: {factory2}x
☢️ АЭС: {electricity}x
💧 Водонапорная башня: {water}x
""",
                               reply_markup=help_city, parse_mode='html')

    else:
        await callback.message.reply('‼️ Для начало постройте город : Город построить [название]!')


@rate_limit(limit=1)
@dp.callback_query_handler(IsRegister3(),text='bizsnat')
async def craft_res23(callback: types.CallbackQuery):

    user_id = callback.from_user.id
    user_namee = callback.from_user.get_mention(as_html=True)
    chat_id = callback.message.chat.id
    win = ['🙂', '😋', '😄', '🤑', '😃']
    rwin = random.choice(win)
    loser = ['😔', '😕', '😣', '😞', '😢']
    rloser = random.choice(loser)
    cripto = cursor.execute(
        "SELECT balance from users where user_id = ?", (callback.from_user.id,))
    cripto = cursor.fetchone()
    cripto = int(cripto[0])
    balance = cursor.execute(
        "SELECT balance from business where user_id = ?", (callback.from_user.id,))
    balance = cursor.fetchone()
    balance = int(balance[0])
    balance2 = '{:,}'.format(balance).replace(",", ".")
    event_febiz = cursor.execute(
        "SELECT event_febiz from clans_id ")
    event_febiz = cursor.fetchone()
    event_febiz = int(event_febiz[0])
    if event_febiz == 0:
        if int(balance) > 0:


            cursor.execute(
                f'UPDATE users SET balance = {cripto + balance} WHERE user_id = {user_id}')
            cursor.execute(
                f'UPDATE business SET balance = {balance - balance} WHERE user_id = {user_id}')
            await bot.send_message(callback.message.chat.id,
                                   f'‼️ {user_namee}, вы успешно сняли с Баланса бизнеса {balance2}₸  на свой баланс{rwin}',
                                   parse_mode='html')
            connect.commit()

        else:
            await bot.answer_callback_query(
                callback.id, ' На балансе бизнеса пусто!')
    if event_febiz ==1:
        if int(balance) > 0:

            cursor.execute(
                f'UPDATE users SET balance = {cripto + (balance * 2)} WHERE user_id = {user_id}')
            cursor.execute(
                f'UPDATE business SET balance = {balance - balance} WHERE user_id = {user_id}')
            await bot.send_message(callback.message.chat.id,
                                   f'‼️ {user_namee}, вы успешно сняли с Баланса бизнеса \nДействует ивент х2 {balance2}₸  на свой баланс{rwin}',
                                   parse_mode='html')
            connect.commit()

        else:
            await bot.answer_callback_query(
                callback.id, ' На балансе бизнеса пусто!')
@rate_limit(limit=1)
@dp.callback_query_handler(IsRegister3(),text='fermasnat')
async def craft_res23(callback: types.CallbackQuery):
    user_id = callback.from_user.id
    user_name = cursor.execute(
        "SELECT user_name from users where user_id = ?", (callback.from_user.id,))
    user_name = cursor.fetchone()
    user_name = str(user_name[0])

    chat_id = callback.message.chat.id
    win = ['🙂', '😋', '😄', '🤑', '😃']
    rwin = random.choice(win)
    loser = ['😔', '😕', '😣', '😞', '😢']
    rloser = random.choice(loser)
    user_name = cursor.execute(
        "SELECT user_name from users where user_id = ?", (callback.from_user.id,))
    user_name = cursor.fetchone()
    user_name = str(user_name[0])
    cripto = cursor.execute(
        "SELECT fantom from users where user_id = ?",(callback.from_user.id,))
    cripto = cursor.fetchone()
    cripto = int(cripto[0])
    balance = cursor.execute(
        "SELECT ferma_money from ferma where user_id = ?", (callback.from_user.id,))
    balance = cursor.fetchone()
    balance = int(balance[0])
    balance2 = '{:,}'.format(balance).replace(",", ".")
    event_febiz = cursor.execute(
        "SELECT event_febiz from clans_id ")
    event_febiz = cursor.fetchone()
    event_febiz = int(event_febiz[0])
    if event_febiz == 0:
        if int(balance) > 0:
            await bot.send_message(callback.message.chat.id,
                                   f'‼️ {user_name}, вы успешно сняли с Баланса Майнинг-Фермы {balance2}💠 на свой баланс {rwin}',
                                   parse_mode='html')
            cursor.execute(
                f'UPDATE users SET fantom = {cripto + balance} WHERE user_id = {user_id}')
            cursor.execute(
                f'UPDATE ferma SET ferma_money = {balance - balance} WHERE user_id = {user_id}')
            connect.commit()
        else:
            await bot.answer_callback_query(
                callback.id, ' На балансе фермы пусто! ')
    if event_febiz == 1:
        if int(balance) > 0:
            balance2 = '{:,}'.format(balance * 2).replace(",", ".")
            await bot.send_message(callback.message.chat.id,
                                   f'‼️ {user_name}, вы успешно сняли с Баланса Майнинг-Фермы \nДействует ивент х2{balance2}💠 на свой баланс {rwin}',
                                   parse_mode='html')
            cursor.execute(
                f'UPDATE users SET fantom = {cripto + (balance * 2)} WHERE user_id = {user_id}')
            cursor.execute(
                f'UPDATE ferma SET ferma_money = {balance - balance} WHERE user_id = {user_id}')
            connect.commit()
        else:
            await bot.answer_callback_query(
                callback.id, ' На балансе фермы пусто! ')

@rate_limit(limit=1)
@dp.callback_query_handler(IsRegister3(),text='bag')
async def craft_res2s3(callback: types.CallbackQuery):

    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                               (callback.from_user.id,))
    user_name = cursor.fetchone()
    user_name = user_name[0]
    user_id = callback.from_user.id
    iron = cursor.execute(
        "SELECT iron from mine where user_id = ?", (callback.from_user.id,))
    iron = cursor.fetchone()
    iron = int(iron[0])

    gold = cursor.execute(
        "SELECT gold from mine where user_id = ?", (callback.from_user.id,))
    gold = cursor.fetchone()
    gold = int(gold[0])

    diamonds = cursor.execute("SELECT diamonds from mine where user_id = ?",
                              (callback.from_user.id,))
    diamonds = cursor.fetchone()
    diamonds = int(diamonds[0])

    amethysts = cursor.execute("SELECT amethysts from mine where user_id = ?",
                               (callback.from_user.id,))
    amethysts = cursor.fetchone()
    amethysts = int(amethysts[0])

    aquamarine = cursor.execute("SELECT aquamarine from mine where user_id = ?",
                                (callback.from_user.id,))
    aquamarine = cursor.fetchone()
    aquamarine = int(aquamarine[0])

    emeralds = cursor.execute("SELECT emeralds from mine where user_id = ?",
                              (callback.from_user.id,))
    emeralds = cursor.fetchone()
    emeralds = int(emeralds[0])

    await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                text=f'''
🎒<a href="tg://user?id={user_id}">{user_name}</a>,инвентарь
⛓ Железо: {iron} шт.
🌕 Золото: {gold} шт.
💎 Алмазы: {diamonds} шт.
🎆 Аметисты: {amethysts} шт.
💠 Аквамарин: {aquamarine} шт.
❇️ Изумруды: {emeralds} шт.

                        ''',reply_markup=help_mine, parse_mode='html')
CHAT_BY_DATETIME_mine=dict()
@rate_limit(limit=1)
@dp.callback_query_handler(IsRegister3(),text='mine')
async def craft_vres23(callback: types.CallbackQuery):


    user_name = cursor.execute("SELECT user_name from users where user_id = ?",
                               (callback.from_user.id,))
    user_name = cursor.fetchone()
    user_name = user_name[0]
    user_id = callback.from_user.id
    iron = cursor.execute(
        "SELECT iron from mine where user_id = ?", (callback.from_user.id,))
    iron = cursor.fetchone()
    iron = int(iron[0])
    gold = cursor.execute(
        "SELECT gold from mine where user_id = ?", (callback.from_user.id,))
    gold = cursor.fetchone()
    gold = int(gold[0])
    diamonds = cursor.execute(
        "SELECT diamonds from mine where user_id = ?", (callback.from_user.id,))
    diamonds = cursor.fetchone()
    diamonds = int(diamonds[0])
    amethysts = cursor.execute("SELECT amethysts from mine where user_id = ?",
                               (callback.from_user.id,))
    amethysts = cursor.fetchone()
    amethysts = int(amethysts[0])
    aquamarine = cursor.execute("SELECT aquamarine from mine where user_id = ?",
                                (callback.from_user.id,))
    aquamarine = cursor.fetchone()
    aquamarine = int(aquamarine[0])
    emeralds = cursor.execute(
        "SELECT emeralds from mine where user_id = ?", (callback.from_user.id,))
    emeralds = cursor.fetchone()
    emeralds = int(emeralds[0])
    expe = cursor.execute(
        "SELECT expe from users where user_id = ?", (callback.from_user.id,))
    expe = cursor.fetchone()
    expe = int(expe[0])
    pick = cursor.execute("SELECT pick from mine where user_id = ?",
                               (callback.from_user.id,))
    pick = cursor.fetchone()
    pick = int(pick[0])
    hp = cursor.execute("SELECT hp from mine where user_id = ?",
                                (callback.from_user.id,))
    hp = cursor.fetchone()
    hp = float(hp[0])

    rx = random.randint(2, 13)
    rx1 = random.randint(5, 11)
    rx2 = random.randint(3, 9)
    rx3 = random.randint(1, 7)
    rx4 = random.randint(1, 6)
    rx5 = random.randint(1, 3)
    rx6 = random.randint(1, 25)
    loser = ['😔', '😕', '😣', '😞', '😢']
    rloser = random.choice(loser)
    expe2 = '{:,}'.format(rx6)
    expe3 = int(expe2)
    chat_id = callback.message.chat.id
    energy = cursor.execute(
        "SELECT energy from users where user_id = ?", (callback.from_user.id,))
    energy = cursor.fetchone()
    energy = int(energy[0])
    energy2 = energy - 1

    need_seconds1 = 4
    current_time_bonus = datetime.now()
    last_datetime1 = CHAT_BY_DATETIME_mine.get(callback.from_user.id)

    # Если первое сообщение (время не задано)
    if not last_datetime1:
        CHAT_BY_DATETIME_mine[callback.from_user.id] = current_time_bonus
        last_datetime1 = datetime.fromtimestamp(0)
    if last_datetime1:

        # Разница в секундах между текущим временем и временем последнего сообщения
        delta_seconds1 = (current_time_bonus - last_datetime1).total_seconds()

        # Осталось ждать секунд перед отправкой
        seconds_left1 = int(need_seconds1 - delta_seconds1)

        # Если время ожидания не закончилось
        if seconds_left1 > 0:
            await callback.answer(
                f'Добыть руду можно каждые {round(seconds_left1)} сек ')
        else:
            if pick!=0:
                if hp>0:
                    if energy >= 1:
                        CHAT_BY_DATETIME_mine[callback.from_user.id] = current_time_bonus
                        hp_hit = round(random.uniform(0.49, 0.99),2)
                        if pick==1:
                            cursor.execute(
                                f'UPDATE mine SET iron = {iron + rx}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET energy = {energy2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET expe = {expe3 + expe}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE mine SET hp = {hp - hp_hit}  WHERE user_id = {user_id}')

                            await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                                text =f"""
<a href="tg://user?id={user_id}">{user_name}</a>
Вы добыли руду <b>«Железо»</b> в кол-во: {rx} шт
Заработали опыт в размере : <b>{expe3} </b>
💡 Энергия: {energy2},🆙 Ваш опыт: {expe}

⛏️ Прочность кирки: {hp}%""",
                                                 reply_markup=help_mine,parse_mode='html')
                            connect.commit()
                        if pick==2:
                            gold_ran = random.randint(1, 5)
                            text_gold=''
                            if gold_ran==2:
                                cursor.execute(
                                    f'UPDATE mine SET gold = {gold + rx}  WHERE user_id = {user_id}')
                                text_gold=f'\n<b>«Золото»</b> в кол-во: {rx1} шт'
                            cursor.execute(
                                f'UPDATE mine SET iron = {iron + rx1}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET energy = {energy2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET expe = {expe3 + expe} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE mine SET hp = {hp - hp_hit}  WHERE user_id = {user_id}')

                            await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                                text=f"""
<a href="tg://user?id={user_id}">{user_name}</a>
Вы добыли руды:
<b>«Железо»</b> в кол-во: {rx} шт{text_gold}
Заработали опыт в размере : <b>{expe3} </b>
💡 Энергия: {energy2},🆙 Ваш опыт: {expe}

⛏️ Прочность кирки: {hp}%""",

                                                 reply_markup=help_mine,parse_mode='html')
                            connect.commit()
                        if pick==3:
                            gold_ran = random.randint(1, 2)
                            text_gold = ''
                            diamonds_ran = random.randint(1, 6)
                            text_diamonds = ''
                            if gold_ran == 1:
                                cursor.execute(
                                    f'UPDATE mine SET gold = {gold + rx}  WHERE user_id = {user_id}')
                                text_gold = f'\n<b>«Золото»</b> в кол-во: {rx1} шт'
                            if diamonds_ran == 1:
                                cursor.execute(
                                    f'UPDATE mine SET diamonds = {diamonds + rx2}  WHERE user_id = {user_id}')
                                text_diamonds = f'\n<b>«Алмазы»</b> в кол-во: {rx2} шт'
                            cursor.execute(
                                f'UPDATE mine SET iron = {iron + rx}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET energy = {energy2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET expe = {expe3 + expe} WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE mine SET hp = {hp - hp_hit}  WHERE user_id = {user_id}')

                            await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                                        text=f"""
<a href="tg://user?id={user_id}">{user_name}</a>
Вы добыли руды:
<b>«Железо»</b> в кол-во: {rx} шт{text_gold}{text_diamonds}
Заработали опыт в размере : <b>{expe3} </b>
💡 Энергия: {energy2},🆙 Ваш опыт: {expe}

⛏️ Прочность кирки: {hp}%""",

                                                        reply_markup=help_mine, parse_mode='html')
                            connect.commit()
                        if pick==4:
                            gold_ran = random.randint(1, 2)
                            text_gold = ''
                            diamonds_ran = random.randint(1, 6)
                            text_diamonds = ''
                            amethysts_ran = random.randint(1, 7)
                            text_amethysts = ''
                            if gold_ran == 1:
                                cursor.execute(
                                    f'UPDATE mine SET gold = {gold + rx}  WHERE user_id = {user_id}')
                                text_gold = f'\n<b>«Золото»</b> в кол-во: {rx1} шт'
                            if diamonds_ran == 1:
                                cursor.execute(
                                    f'UPDATE mine SET diamonds = {diamonds + rx2}  WHERE user_id = {user_id}')
                                text_diamonds = f'\n<b>«Алмазы»</b> в кол-во: {rx2} шт'
                            if amethysts_ran == 1:
                                cursor.execute(
                                    f'UPDATE mine SET amethysts = {amethysts + rx3}  WHERE user_id = {user_id}')
                                text_amethysts = f'\n<b>«Аметисты»</b> в кол-во: {rx3} шт'

                            cursor.execute(
                                f'UPDATE mine SET iron = {iron + rx}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET energy = {energy2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET expe = {expe3 + expe}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE mine SET hp = {hp - hp_hit}  WHERE user_id = {user_id}')
                            await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                                        text=f"""
<a href="tg://user?id={user_id}">{user_name}</a>
Вы добыли руды:
<b>«Железо»</b> в кол-во: {rx} шт{text_gold}{text_diamonds}{text_amethysts}
Заработали опыт в размере : <b>{expe3} </b>
💡 Энергия: {energy2},🆙 Ваш опыт: {expe}

⛏️ Прочность кирки: {hp}%""",

                                                        reply_markup=help_mine, parse_mode='html')
                            connect.commit()
                        if pick==5:
                            gold_ran = random.randint(1, 2)
                            text_gold = ''
                            diamonds_ran = random.randint(1, 5)
                            text_diamonds = ''
                            amethysts_ran = random.randint(1, 10)
                            text_amethysts = ''
                            aquamarine_ran = random.randint(1, 15)
                            text_aquamarine = ''
                            if gold_ran == 1:
                                cursor.execute(
                                    f'UPDATE mine SET gold = {gold + rx}  WHERE user_id = {user_id}')
                                text_gold = f'\n<b>«Золото»</b> в кол-во: {rx1} шт'
                            if diamonds_ran == 1:
                                cursor.execute(
                                    f'UPDATE mine SET diamonds = {diamonds + rx2}  WHERE user_id = {user_id}')
                                text_diamonds = f'\n<b>«Алмазы»</b> в кол-во: {rx2} шт'
                            if amethysts_ran == 1:
                                cursor.execute(
                                    f'UPDATE mine SET amethysts = {amethysts + rx3}  WHERE user_id = {user_id}')
                                text_amethysts = f'\n<b>«Аметисты»</b> в кол-во: {rx3} шт'
                            if aquamarine_ran == 1:
                                cursor.execute(
                                    f'UPDATE mine SET aquamarine = {aquamarine + rx4}  WHERE user_id = {user_id}')
                                text_amethysts = f'\n<b>«Аквамарин»</b> в кол-во: {rx4} шт'
                            cursor.execute(
                                f'UPDATE mine SET iron = {iron + rx}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET energy = {energy2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET expe = {expe3 + expe}WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE mine SET hp = {hp - hp_hit}  WHERE user_id = {user_id}')

                            await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                                        text=f"""
<a href="tg://user?id={user_id}">{user_name}</a>
Вы добыли руды:
<b>«Железо»</b> в кол-во: {rx} шт{text_gold}{text_diamonds}{text_amethysts}{text_aquamarine}
Заработали опыт в размере : <b>{expe3} </b>
💡 Энергия: {energy2},🆙 Ваш опыт: {expe}

⛏️ Прочность кирки: {hp}%""",reply_markup=help_mine, parse_mode='html')
                            connect.commit()
                        if pick==6:
                            gold_ran = random.randint(1, 2)
                            text_gold = ''
                            diamonds_ran = random.randint(1, 2)
                            text_diamonds = ''
                            amethysts_ran = random.randint(1, 5)
                            text_amethysts = ''
                            aquamarine_ran = random.randint(1, 10)
                            text_aquamarine = ''
                            emeralds_ran = random.randint(1, 50)
                            text_emeralds = ''
                            if gold_ran == 1:
                                cursor.execute(
                                    f'UPDATE mine SET gold = {gold + rx}  WHERE user_id = {user_id}')
                                text_gold = f'\n<b>«Золото»</b> в кол-во: {rx1} шт'
                            if diamonds_ran == 1:
                                cursor.execute(
                                    f'UPDATE mine SET diamonds = {diamonds + rx2}  WHERE user_id = {user_id}')
                                text_diamonds = f'\n<b>«Алмазы»</b> в кол-во: {rx2} шт'
                            if amethysts_ran == 1:
                                cursor.execute(
                                    f'UPDATE mine SET amethysts = {amethysts + rx3}  WHERE user_id = {user_id}')
                                text_amethysts = f'\n<b>«Аметисты»</b> в кол-во: {rx3} шт'
                            if aquamarine_ran == 1:
                                cursor.execute(
                                    f'UPDATE mine SET aquamarine = {aquamarine + rx4}  WHERE user_id = {user_id}')
                                text_aquamarine = f'\n<b>«Аквамарин»</b> в кол-во: {rx4} шт'
                            if emeralds_ran == 1:
                                cursor.execute(
                                    f'UPDATE mine SET emeralds = {emeralds + rx5}  WHERE user_id = {user_id}')
                                text_emeralds = f'\n<b>«Изумрудов»</b> в кол-во: {rx5} шт'


                            cursor.execute(
                                f'UPDATE mine SET iron = {iron + rx}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET energy = {energy2}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE users SET expe = {expe3 + expe}  WHERE user_id = {user_id}')
                            cursor.execute(
                                f'UPDATE mine SET hp = {hp - hp_hit}  WHERE user_id = {user_id}')

                            await bot.edit_message_text(chat_id=callback.message.chat.id, message_id=callback.message.message_id,
                                                        text=f"""
<a href="tg://user?id={user_id}">{user_name}</a>
Вы добыли руды:
<b>«Железа»</b> в кол-во: {rx} шт{text_gold}{text_diamonds}{text_amethysts}{text_aquamarine}{text_emeralds}
Заработали опыт в размере : <b>{expe3} </b>
💡 Энергия: {energy2},🆙 Ваш опыт: {expe}

⛏️ Прочность кирки: {hp}%""", reply_markup=help_mine, parse_mode='html')
                            connect.commit()
                    if energy <= 0:
                        CHAT_BY_DATETIME_mine.clear()
                        await bot.send_message(chat_id=callback.message.chat.id,
                                                    text = f' <a href="tg://user?id={user_id}">{user_name}</a> ,У вас закончилась энергия ', parse_mode = 'html')
                else:
                    CHAT_BY_DATETIME_mine.clear()
                    await bot.send_message(chat_id=callback.message.chat.id,
                                                text = f'⛏️ <a href="tg://user?id={user_id}">{user_name}</a> ,Ваша кирка сломалась'
                                                       f'\n➖ Кирки', parse_mode = 'html')
            else:
                CHAT_BY_DATETIME_mine.clear()
                await bot.send_message(chat_id=callback.message.chat.id,text = f'⛏️ <a href="tg://user?id={user_id}">{user_name}</a> ,Приобретите кирку ! '
                                                                               f'\n➖ Купить кирку 1-6', parse_mode = 'html')


@rate_limit(limit=1)
@dp.callback_query_handler(IsRegister3(),text='bonus1')
async def craft_resurs3(callback: types.CallbackQuery):
    user_id = callback.from_user.id
    user_name = cursor.execute(
        "SELECT user_name from users where user_id = ?", (callback.from_user.id,))
    user_name = cursor.fetchone()
    user_name = str(user_name[0])


    win = ['🙂', '😋', '😄', '🤑', '😃']
    rwin = random.choice(win)
    loser = ['😔', '😕', '😣', '😞', '😢']
    rloser = random.choice(loser)
    rmoney = random.randint(5000000, 80000000)
    balance = cursor.execute(
        "SELECT balance from users where user_id = ?", (callback.from_user.id,))
    balance = cursor.fetchone()
    balance = int(balance[0])
    rmoney2 = '{:,}'.format(rmoney).replace(',', '.')
    rrating = random.randint(100, 300)
    fantom = cursor.execute(
        "SELECT fantom from users where user_id = ?", (callback.from_user.id,))
    fantom = cursor.fetchone()
    fantom = int(fantom[0])
    rating2 = '{:,}'.format(rrating).replace(',', '.')
    prize = random.randint(1, 3)
    need_seconds1 = 86400
    current_time_bonus = datetime.now()
    last_datetime1 = CHAT_BY_DATETIME1.get(callback.from_user.id)

    # Если первое сообщение (время не задано)
    if not last_datetime1:
        CHAT_BY_DATETIME1[callback.from_user.id] = current_time_bonus
        last_datetime1 = datetime.fromtimestamp(0)
    if last_datetime1:

        # Разница в секундах между текущим временем и временем последнего сообщения
        delta_seconds1 = (current_time_bonus - last_datetime1).total_seconds()

        # Осталось ждать секунд перед отправкой
        seconds_left1 = int(need_seconds1 - delta_seconds1)

        # Если время ожидания не закончилось
        if seconds_left1 > 0:
            left1=seconds_left1/60/60
            await bot.answer_callback_query(callback.id, show_alert=False, text=f'‼️Следующий бонус через {round(left1)}ч {rloser}')
        else:


            if prize == 1:
                CHAT_BY_DATETIME1[callback.from_user.id] = current_time_bonus
                await bot.send_message(callback.message.chat.id, f'💰  {user_name}, вам выпало {rmoney2}₸ ! {rwin}',
                                       parse_mode='html')
                cursor.execute(
                    f'UPDATE users SET balance = {balance + rmoney} WHERE user_id = {user_id}')

                connect.commit()
            if prize == 2:
                CHAT_BY_DATETIME1[callback.from_user.id] = current_time_bonus
                await bot.send_message(callback.message.chat.id, f'💠  {user_name}, вам выпало {rating2} фантомов! {rwin}',
                                       parse_mode='html')
                cursor.execute(
                    f'UPDATE users SET fantom = {fantom + rrating} WHERE user_id = {user_id}')

                connect.commit()
            if prize == 3:
                CHAT_BY_DATETIME1[callback.from_user.id] = current_time_bonus
                await bot.send_message(callback.message.chat.id,
                                       f'💠  {user_name}, вам выпало {rating2} фантомов и 💰 {rmoney2}₸ ! {rwin}',
                                       parse_mode='html')

                cursor.execute(
                    f'UPDATE users SET balance = {balance + rmoney} WHERE user_id = {user_id}')

                connect.commit()
                cursor.execute(
                    f'UPDATE users SET fantom = {fantom + rrating} WHERE user_id = {user_id}')

                connect.commit()
@rate_limit(limit=1)
@dp.callback_query_handler(IsRegister3(),text='bonus2')
async def craft_resurs3(callback: types.CallbackQuery):
    user_name = cursor.execute(
        "SELECT user_name from users where user_id = ?", (callback.from_user.id,))
    user_name = cursor.fetchone()
    user_name = str(user_name[0])

    user_id = callback.from_user.id
    win = ['🙂', '😋', '😄', '🤑', '😃']
    rwin = random.choice(win)
    loser = ['😔', '😕', '😣', '😞', '😢']
    rloser = random.choice(loser)
    rmoney = random.randint(50000000, 150000000)
    balance = cursor.execute(
        "SELECT balance from users where user_id = ?", (callback.from_user.id,))
    balance = cursor.fetchone()
    balance = int(balance[0])
    rmoney2 = '{:,}'.format(rmoney).replace(',', '.')
    rrating = random.randint(500, 1300)
    fantom = cursor.execute(
        "SELECT fantom from users where user_id = ?", (callback.from_user.id,))
    fantom = cursor.fetchone()
    fantom = int(fantom[0])
    rating2 = '{:,}'.format(rrating).replace(',', '.')
    prize = random.randint(1, 2)
    case = cursor.execute(
        "SELECT case3 from users where user_id = ?", (callback.from_user.id,))
    case = cursor.fetchone()
    case = int(case[0])
    rcase = random.randint(1, 10)
    rcase2 = '{:,}'.format(rcase).replace(',', '.')
    user_status =cursor.execute(
        "SELECT user_status from users where user_id = ?", (callback.from_user.id,))
    user_status = cursor.fetchone()
    user_status = str(user_status[0])
    need_seconds2 = 86400
    current_time_bonus2 = datetime.now()
    last_datetime2 = CHAT_BY_DATETIME2.get(callback.from_user.id)

    # Если первое сообщение (время не задано)
    if not last_datetime2:
        CHAT_BY_DATETIME2[callback.from_user.id] = current_time_bonus2
        last_datetime2 = datetime.fromtimestamp(0)
    if last_datetime2:

        # Разница в секундах между текущим временем и временем последнего сообщения
        delta_seconds2 = (current_time_bonus2 - last_datetime2).total_seconds()

        # Осталось ждать секунд перед отправкой
        seconds_left2 = int(need_seconds2 - delta_seconds2)

        # Если время ожидания не закончилось
        if seconds_left2 > 0:
            left1 = seconds_left2 / 60 / 60
            await bot.answer_callback_query(callback.id, show_alert=False, text=f'‼️Следующий бонус через {round(left1)}ч {rloser}')

        else:




            if user_status == 'vip' or user_status == 'delux' or user_status == 'premium':

                if prize == 1:
                    CHAT_BY_DATETIME2[callback.from_user.id] = current_time_bonus2
                    await bot.send_message(callback.message.chat.id,
                                           f'💰  {user_name}, вам выпало {rmoney2}₸ ! и 💠 {rating2} фантомов!{rwin}',
                                           parse_mode='html')
                    cursor.execute(
                        f'UPDATE users SET balance = {balance + rmoney} WHERE user_id = {user_id}')

                    connect.commit()
                    cursor.execute(
                        f'UPDATE users SET fantom = {fantom + rrating} WHERE user_id = {user_id}')

                    connect.commit()
                if prize == 2:
                    CHAT_BY_DATETIME2[callback.from_user.id] = current_time_bonus2
                    await bot.send_message(callback.message.chat.id,
                                           f'💠  {user_name}, вам выпало {rating2} фантомов! ,💰  {rmoney2}₸ ! и {rcase2} 💎 Алмазных кейсов!{rwin}',
                                           parse_mode='html')

                    cursor.execute(
                        f'UPDATE users SET balance = {balance + rmoney} WHERE user_id = {user_id}')
                    cursor.execute(
                        f'UPDATE users SET case3 = {case + rcase} WHERE user_id = {user_id}')
                    connect.commit()
                    cursor.execute(
                        f'UPDATE users SET fantom = {fantom + rrating} WHERE user_id = {user_id}')
                    connect.commit()


            else:
                CHAT_BY_DATETIME2.clear()
                await bot.answer_callback_query(callback.id, show_alert=False, text=f'‼️  Это донатный бонус для покупки введите Донат! {rloser}'
                                       )
@rate_limit(limit=1)
@dp.callback_query_handler(IsRegister3(),text='bonus3')
async def craft_resurs3(callback: types.CallbackQuery):
    user_name = cursor.execute(
        "SELECT user_name from users where user_id = ?", (callback.from_user.id,))
    user_name = cursor.fetchone()
    user_name = str(user_name[0])

    user_id = callback.from_user.id
    win = ['🙂', '😋', '😄', '🤑', '😃']
    rwin = random.choice(win)
    loser = ['😔', '😕', '😣', '😞', '😢']
    rloser = random.choice(loser)
    rmoney = random.randint(150000000, 600000000)
    balance = cursor.execute(
        "SELECT balance from users where user_id = ?", (callback.from_user.id,))
    balance = cursor.fetchone()
    balance = int(balance[0])
    rmoney2 = '{:,}'.format(rmoney).replace(',', '.')
    rrating = random.randint(1000, 2300)
    fantom = cursor.execute(
        "SELECT fantom from users where user_id = ?", (callback.from_user.id,))
    fantom = cursor.fetchone()
    fantom = int(fantom[0])
    rating2 = '{:,}'.format(rrating).replace(',', '.')
    prize = random.randint(1, 2)
    case = cursor.execute(
        "SELECT case3 from users where user_id = ?", (callback.from_user.id,))
    case = cursor.fetchone()
    case = int(case[0])
    rcase = random.randint(5, 20)
    rcase2 = '{:,}'.format(rcase).replace(',', '.')
    user_status =cursor.execute(
        "SELECT user_status from users where user_id = ?", (callback.from_user.id,))
    user_status = cursor.fetchone()
    user_status = str(user_status[0])
    need_seconds3 = 86400
    current_time_bonus3 = datetime.now()
    last_datetime3 = CHAT_BY_DATETIME3.get(callback.from_user.id)

    # Если первое сообщение (время не задано)
    if not last_datetime3:
        CHAT_BY_DATETIME3[callback.from_user.id] = current_time_bonus3
        last_datetime3 = datetime.fromtimestamp(0)
    if last_datetime3:

        # Разница в секундах между текущим временем и временем последнего сообщения
        delta_seconds3 = (current_time_bonus3 - last_datetime3).total_seconds()

        # Осталось ждать секунд перед отправкой
        seconds_left3 = int(need_seconds3 - delta_seconds3)

        # Если время ожидания не закончилось
        if seconds_left3 > 0:
            left1 = seconds_left3 / 60 / 60
            await bot.answer_callback_query(callback.id, show_alert=False, text=f'‼️Следующий бонус через {round(left1)}ч {rloser}')


        else:


            if user_status == 'delux' or user_status == 'premium':

                if prize == 1:
                    CHAT_BY_DATETIME3[callback.from_user.id] = current_time_bonus3
                    await bot.send_message(callback.message.chat.id,
                                           f'💰  {user_name}, вам выпало {rmoney2}₸ ! и 💠 {rating2} фантомов!{rwin}',
                                           parse_mode='html')
                    cursor.execute(
                        f'UPDATE users SET balance = {balance + rmoney} WHERE user_id = {user_id}')

                    cursor.execute(
                        f'UPDATE users SET fantom = {fantom + rrating} WHERE user_id = {user_id}')

                    connect.commit()
                if prize == 2:
                    CHAT_BY_DATETIME3[callback.from_user.id] = current_time_bonus3
                    await bot.send_message(callback.message.chat.id,
                                           f'💠 {user_name}, вам выпало {rating2} фантомов!, 💰 {rmoney2}₸ ! и 💎  {rcase2} 💎 Алмазных кейсов!{rwin}',
                                           parse_mode='html')

                    cursor.execute(
                        f'UPDATE users SET balance = {balance + rmoney} WHERE user_id = {user_id}')
                    cursor.execute(
                        f'UPDATE users SET case3 = {case + rcase} WHERE user_id = {user_id}')
                    connect.commit()
                    cursor.execute(
                        f'UPDATE users SET fantom = {fantom + rrating} WHERE user_id = {user_id}')

                    connect.commit()

            else:
                CHAT_BY_DATETIME3.clear()
                await bot.answer_callback_query(callback.id, show_alert=False, text=f'‼️  Это донатный бонус для покупки введите Донат! {rloser}'
                                      )
@dp.callback_query_handler(text_contains="check_")
async def checkrty(callback: types.CallbackQuery):
    bill = str(callback.data[6:])

    info = get_check(bill)

    user_id = callback.from_user.id
    if info != False:
        if str(p2p.check(bill_id=bill).status) == "PAID":
            user_money = cursor.execute(
                "SELECT money FROM fzve WHERE user_id=?", (callback.from_user.id,))
            user_money = cursor.fetchone()
            user_money = int(user_money[0])
            ecoins = cursor.execute(
                "SELECT ecoins FROM users WHERE user_id=?", (callback.from_user.id,))
            ecoins = cursor.fetchone()
            ecoins = int(ecoins[0])
            cursor.execute(
                f"UPDATE users SET ecoins={ecoins + (user_money * 2)}  WHERE user_id={user_id}")

            await bot.send_message(callback.from_user.id, "Ваш счет оплачен")
            cursor.execute("DELETE FROM fzve WHERE bill_id= ?", (bill,))
            connect.commit()
        else:
            await bot.send_message(callback.from_user.id, "Вы не оплатили счет", reply_markup=buy_menu(False, bill=bill))
    else:
        await bot.send_message(callback.from_user.id, "Счет не найден")


@rate_limit(limit=1)
@dp.callback_query_handler(IsRegister3(),text='gamevb')
async def craft_resurs3(callback: types.CallbackQuery):
    #print(callback.messege.from_user.id )
    user_id = callback.message.from_user.id
    user_name = cursor.execute(
        "SELECT user_name from users where user_id = ?", (callback.from_user.id,))
    user_name = cursor.fetchone()
    user_name = str(user_name[0])
    chat_id = callback.message.chat.id
    balance = cursor.execute(
        "SELECT balance from users where user_id = ?", (callback.from_user.id,))
    balance = cursor.fetchone()
    balance = int(balance[0])

    game = cursor.execute(
        "SELECT games from users where user_id = ?", (callback.from_user.id,))
    game = cursor.fetchone()
    game = int(game[0])

    balance2 = '{:,}'.format(balance).replace(',', '.')

    rx = random.randint(0, 10000)
    loser = ['😔', '😕', '😣', '😞', '😢']
    rloser = random.choice(loser)

    player = status_users(callback.from_user.id)
    need_seconds3 = 4
    current_time_bonus3 = datetime.now()
    last_datetime3 = game_time.get(callback.from_user.id)

    # Если первое сообщение (время не задано)
    if not last_datetime3:
        game_time[callback.from_user.id] = current_time_bonus3
        last_datetime3 = datetime.fromtimestamp(0)
    if last_datetime3:

        # Разница в секундах между текущим временем и временем последнего сообщения
        delta_seconds3 = (current_time_bonus3 - last_datetime3).total_seconds()

        # Осталось ждать секунд перед отправкой
        seconds_left3 = int(need_seconds3 - delta_seconds3)

        # Если время ожидания не закончилось
        if seconds_left3 > 0:
            left1 = seconds_left3
            await bot.send_message(callback.message.chat.id,
                                   f'🪤 <a href="tg://user?id={user_id}">{user_name}</a>, играть можно через {round(left1)} сек {rloser}',
                                   parse_mode='html')
        else:
            game_time[callback.from_user.id] = current_time_bonus3
            if balance > 0:

                if int(rx) in range(0, 7000):
                    i = balance - balance * 0.1
                    i2 = int(i)
                    i3 = '{:,}'.format(i2).replace(',', '.')
                    await callback.message.answer( f"""
🤵‍♂︄  {player}: <a href='tg://user?id={user_id}'>{user_name}</a>
🪤  Игра: Ва-банк
🎟  Ставка: {balance2}₸
🧾  Проигрыш: {i3}₸ [0.1X]            
""", parse_mode='html')
                    cursor.execute(
                        f'UPDATE users SET balance = {balance - i2} WHERE user_id = {user_id}')
                    cursor.execute(
                        f'UPDATE users SET games = {game + 1} WHERE user_id = {user_id}')
                    connect.commit()
                    return
                if int(rx) in range(7001, 10000):

                    i = balance * 1.5
                    i2 = int(i)
                    i3 = '{:,}'.format(i2).replace(',', '.')
                    await callback.message.answer( f"""
🤵‍♂︄  {player}: <a href='tg://user?id={user_id}'>{user_name}</a>
🪤  Игра: Ва-банк
🎟  Ставка: {balance2}₸
🧾  Выигрыш: {i3}₸ [1.5X]            
""", parse_mode='html')
                    cursor.execute(
                        f'UPDATE users SET balance = {balance + i2} WHERE user_id = {user_id}')
                    cursor.execute(
                        f'UPDATE users SET games = {game + 1} WHERE user_id = {user_id}')
                    connect.commit()
                    return
            else:

                await callback.message.answer(
                                       f"‼️ <a href='tg://user?id={user_id}'>{user_name}</a>, ошибка! У вас недостаточно средств! ",
                                       parse_mode='html')
#-1001823619866 orig
# -1001856941506 test

async def puzzels():

    with open("assets/puzz.txt", encoding='utf-8') as file:
        int_number = file.read()
    rmoney = cursor.execute("SELECT AVG(balance) AS Average_balance FROM users WHERE user_status='Player' or user_status='vip' or user_status='premium' or user_status='delux'")
    rmoney = cursor.fetchone()
    rmoney = round(int(rmoney[0]))
    rmoney=round(rmoney/2)
    while True:
        cursor.execute("TRUNCATE TABLE puzzles")
        connect.commit()
        v = random.randint(0, 58)
        int_number2 = int_number.split("%")[v]
        description = int_number2.split("*")[0]
        answer = int_number2.split("*")[1]
        f = cursor.execute(f"SELECT puzz_name FROM puzzles_old WHERE puzz_name='{answer}'")
        f = cursor.fetchone()
        if f is None:
            break

    cursor.execute("INSERT INTO puzzles VALUES(?, ? ,?)",
                   (str(answer.lower()), 1, rmoney))
    cursor.execute("INSERT INTO puzzles_old VALUES(?)",
                   (str(answer),))
    connect.commit()

    await bot.send_message(chat_id=cfg.channel_offical,
                           text=f'❓ Загадка\n {description}\n✅ Для ответа введите «Ответ [ответ]»')

async def cd_clan():

    cursor.execute("UPDATE clans SET last_stavka=1 WHERE last_stavka=0")

    connect.commit()
async def cd_limit():

    cursor.execute(
        f"UPDATE users SET limitpered =5000000000000 WHERE user_status='Player'")
    cursor.execute(
        f"UPDATE users SET limitpered =10000000000000 WHERE user_status='vip'")
    cursor.execute(
        f"UPDATE users SET limitpered =20000000000000 WHERE user_status='premium'")
    cursor.execute(
        f"UPDATE users SET limitpered =70000000000000 WHERE user_status='delux'")
    cursor.execute(
        f"UPDATE users SET limitpered =200000000000000 WHERE user_status='Admin'")
    cursor.execute(
        f"UPDATE users SET limitvidach =1000000000000 WHERE user_status='delux'")
    cursor.execute(
        f"UPDATE users SET limitvidach =10000000000000 WHERE user_status='Admin'")
    cursor.execute(f"UPDATE users SET limitvidach2 =50000000000")

    connect.commit()

async def cd_bank():

    cursor.execute(f"UPDATE users SET bank =bank + bank * 0.02 WHERE user_status='Player' and procent_donate=0")
    cursor.execute(
        f"UPDATE users SET bank =bank + bank * 0.02 WHERE user_status='vip' and procent_donate=0")
    cursor.execute(
        f"UPDATE users SET bank =bank + bank * 0.02 WHERE user_status='premium' and procent_donate=0")
    cursor.execute(
        f"UPDATE users SET bank =bank + bank * 0.04 WHERE user_status='delux' and procent_donate=0")
    connect.commit()
    cursor.execute(f"UPDATE users SET bank =bank + bank * 0.04 WHERE user_status='Player' and procent_donate=1")
    cursor.execute(
        f"UPDATE users SET bank =bank + bank * 0.04 WHERE user_status='vip' and procent_donate=1")
    cursor.execute(
        f"UPDATE users SET bank =bank + bank * 0.04 WHERE user_status='premium' and procent_donate=1")
    cursor.execute(
        f"UPDATE users SET bank =bank + bank * 0.08 WHERE user_status='delux' and procent_donate=1")
    connect.commit()

async def ferma():

    kurs = random.randint(600, 1500)
    kurs1 = random.randint(1, 2)
    if kurs1 == 1:
        cursor.execute(f"UPDATE cooldown SET kurs=kurs+{kurs}")
        cursor.execute("SELECT kurs FROM cooldown")
        kurs3 = cursor.fetchone()
        if int(kurs3[0]) > 55000:
            cursor.execute(f"UPDATE cooldown SET kurs=30000")
    else:
        cursor.execute("SELECT kurs FROM cooldown")
        kurs3 = cursor.fetchone()
        cursor.execute(f"UPDATE cooldown SET kurs=kurs-{kurs}")
        if int(kurs3[0]) < 15000:
            cursor.execute(f"UPDATE cooldown SET kurs=30000")
    cursor.execute(f"UPDATE city SET material=material+ factory * 700")
    cursor.execute(
        f"UPDATE business SET balance = balance + 200000 * workers WHERE business =1")
    connect.commit()
    cursor.execute(
        f"UPDATE business SET balance = balance + 400000 * workers WHERE business =2")
    connect.commit()
    cursor.execute(
        f"UPDATE business SET balance = balance + 600000 * workers WHERE business =3")
    connect.commit()
    cursor.execute(
        f"UPDATE business SET balance = balance + 800000 * workers WHERE business =4")
    connect.commit()
    cursor.execute(
        f"UPDATE business SET balance = balance + 1000000 * workers WHERE business =5")
    connect.commit()
    cursor.execute(
        f"UPDATE business SET balance = balance + 2000000 * workers WHERE business =6")
    connect.commit()
    cursor.execute(
        f"UPDATE business SET balance = balance + 4000000 * workers WHERE business =7")
    connect.commit()
    cursor.execute(
        f"UPDATE business SET balance = balance + 6000000 * workers WHERE business =8")
    connect.commit()
    cursor.execute(
        f"UPDATE business SET balance = balance + 8000000 * workers WHERE business =9")
    connect.commit()
    cursor.execute(
        f"UPDATE business SET balance = balance + 10000000 * workers WHERE business =10")
    connect.commit()
    cursor.execute(
        f"UPDATE ferma SET ferma_money = ferma_money + 250 * cards WHERE Farm =1")
    connect.commit()
    cursor.execute(
        f"UPDATE ferma SET ferma_money = ferma_money + 1000 * cards WHERE Farm =2")
    connect.commit()
    cursor.execute(
        f"UPDATE ferma SET ferma_money = ferma_money + 3000 * cards WHERE Farm =3")
    cursor.execute(
        f"UPDATE ferma SET ferma_money = ferma_money + 10000 * cards2 WHERE Farm2=1")
    connect.commit()
async def cd_energy():

    city = random.randint(15, 100)
    cursor.execute(f"UPDATE city SET kazna=kazna+work_place*(taxes*3.5) WHERE happynes>20 ")
    cursor.execute(f"UPDATE city SET citizens=citizens+{city} WHERE houses*15>citizens")
    cursor.execute(f"UPDATE users SET energy =energy + 1 WHERE energy<15")
    connect.commit()
    cursor.execute(f'SELECT user_id FROM ban_list')
    row = cursor.fetchall()
    if row != None:
        users = [user[0] for user in row]
        for i in users:
            timestamp=cursor.execute(f"SELECT time FROM ban_list  WHERE user_id={i}")
            timestamp=cursor.fetchone()
            timestamp=timestamp[0]
            if timestamp > 0:
                cursor.execute(f"UPDATE ban_list SET time = time - 300 WHERE user_id={i}")
                connect.commit()
            else:
                cursor.execute(
                    f"UPDATE users SET status_block = 'off' WHERE user_id={i}")
                cursor.execute(f"DELETE from ban_list where user_id = {i}")
                connect.commit()
    cursor.execute(f'SELECT user_id FROM users WHERE Admin_time>0')
    row2 = cursor.fetchall()
    if row2 != None:
        users2 = [user[0] for user in row2]
        for i in users2:
            Admin_time = cursor.execute(f"SELECT Admin_time FROM users WHERE user_id={i}")
            Admin_time = cursor.fetchone()
            Admin_time = Admin_time[0]
            if Admin_time > 0:
                cursor.execute(f"UPDATE users SET Admin_time = Admin_time - 300 WHERE user_id={i}")
                connect.commit()
            else:
                cursor.execute(
                    f"UPDATE users SET user_status = 'Admin' WHERE user_id={i}")
                cursor.execute(f"UPDATE users SET Admin_time = 0 WHERE user_id={i}")
                connect.commit()
def schedule2r():
    scheduler.add_job(ferma,'interval', hours=1)
    #schedule.every(1).seconds.do(job, n=i)
    scheduler.add_job(cd_bank,'interval', hours=3,id="bank_time")
    #scheduler.add_job(puzzels, 'interval', hours=5)
    scheduler.add_job(cd_clan,'interval', hours=6,
                  next_run_time=datetime.now())
    scheduler.add_job(cd_limit,'interval', hours=24,
                  next_run_time=datetime.now())
    scheduler.add_job(cd_energy,'interval', minutes=5)
    try:
        asyncio.get_event_loop().run_forever()
    except:
        pass
async def on_startup(_):
    #dp.middleware.setup(ThrottlingMiddleware())
    schedule2r()

    await bot.send_message(
                chat_id=cfg.owner_id,text=
    f"""<b>🪄 Бот запущен!</b>
<code>{datetime.now().strftime("%d.%m.%y %H:%M:?")}</code>
"""

        ,parse_mode='html')

async def on_shutdown(_):
    await bot.send_message(
        chat_id=cfg.owner_id,
        text=f"<b>🪄 Бот Выкл!</b> ",parse_mode='html')


if __name__ == "__main__":

    scheduler.start()
    dp.middleware.setup(ThrottlingMiddleware())
    executor.start_polling(dp, skip_updates=True,on_startup=on_startup,on_shutdown=on_shutdown)

